[0m09:04:09.601963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5756B8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575986B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575987A50>]}


============================== 09:04:09.606977 | 26da0885-fa11-4c80-a559-e322f90eb319 ==============================
[0m09:04:09.606977 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:04:09.607964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:04:09.632963 [info ] [MainThread]: dbt version: 1.9.2
[0m09:04:09.633972 [info ] [MainThread]: python version: 3.11.9
[0m09:04:09.634969 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:04:09.634969 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:04:09.694451 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\DBT
[0m09:04:09.695433 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\DBT\profiles.yml
[0m09:04:09.696436 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml
[0m09:04:09.697434 [info ] [MainThread]: Configuration:
[0m09:04:09.697434 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m09:04:09.697434 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m09:04:09.698436 [info ] [MainThread]: Required dependencies:
[0m09:04:09.698436 [debug] [MainThread]: Executing "git --help"
[0m09:04:09.746990 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:04:09.748526 [debug] [MainThread]: STDERR: "b''"
[0m09:04:09.748526 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:04:09.748526 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:04:09.749672 [info ] [MainThread]: [31m2 checks failed:[0m
[0m09:04:09.750602 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "my_dbt_project", target "dev" invalid: '5432' is not of type 'integer'


[0m09:04:09.750602 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml> not found

[0m09:04:09.751641 [debug] [MainThread]: Command `dbt debug` failed at 09:04:09.751641 after 0.21 seconds
[0m09:04:09.751641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56FB09650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56FB81910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A575687790>]}
[0m09:04:09.752659 [debug] [MainThread]: Flushing usage events
[0m09:04:10.481794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:13.429837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAF5D87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAF5DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAF5DA5D0>]}


============================== 09:06:13.433837 | 496cc3bd-a162-4909-8d6e-32a005d1923b ==============================
[0m09:06:13.433837 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:06:13.434836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:13.449836 [info ] [MainThread]: dbt version: 1.9.2
[0m09:06:13.450836 [info ] [MainThread]: python version: 3.11.9
[0m09:06:13.450836 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:06:13.451836 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:06:13.521404 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\DBT
[0m09:06:13.522404 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\DBT\profiles.yml
[0m09:06:13.523387 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml
[0m09:06:13.536387 [info ] [MainThread]: adapter type: postgres
[0m09:06:13.537387 [info ] [MainThread]: adapter version: 1.9.0
[0m09:06:13.537387 [info ] [MainThread]: Configuration:
[0m09:06:13.538386 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:06:13.538386 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m09:06:13.539387 [info ] [MainThread]: Required dependencies:
[0m09:06:13.539387 [debug] [MainThread]: Executing "git --help"
[0m09:06:13.601415 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:06:13.601415 [debug] [MainThread]: STDERR: "b''"
[0m09:06:13.602393 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:06:13.602393 [info ] [MainThread]: Connection:
[0m09:06:13.603392 [info ] [MainThread]:   host: 172.16.0.239
[0m09:06:13.603392 [info ] [MainThread]:   port: 5432
[0m09:06:13.604391 [info ] [MainThread]:   user: dmx-op-user
[0m09:06:13.604391 [info ] [MainThread]:   database: operacoes
[0m09:06:13.605392 [info ] [MainThread]:   schema: public
[0m09:06:13.605392 [info ] [MainThread]:   connect_timeout: 10
[0m09:06:13.605392 [info ] [MainThread]:   role: None
[0m09:06:13.606390 [info ] [MainThread]:   search_path: None
[0m09:06:13.606390 [info ] [MainThread]:   keepalives_idle: 0
[0m09:06:13.606390 [info ] [MainThread]:   sslmode: None
[0m09:06:13.607390 [info ] [MainThread]:   sslcert: None
[0m09:06:13.607390 [info ] [MainThread]:   sslkey: None
[0m09:06:13.608392 [info ] [MainThread]:   sslrootcert: None
[0m09:06:13.608392 [info ] [MainThread]:   application_name: dbt
[0m09:06:13.609395 [info ] [MainThread]:   retries: 1
[0m09:06:13.610394 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:14.059701 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:06:16.266078 [debug] [MainThread]: Using postgres connection "debug"
[0m09:06:16.266078 [debug] [MainThread]: On debug: select 1 as id
[0m09:06:16.267077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:06:16.359970 [debug] [MainThread]: SQL status: SELECT 1 in 0.093 seconds
[0m09:06:16.360973 [debug] [MainThread]: On debug: Close
[0m09:06:16.361972 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:06:16.362970 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:06:16.363969 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml> not found

[0m09:06:16.364970 [debug] [MainThread]: Command `dbt debug` failed at 09:06:16.364970 after 3.00 seconds
[0m09:06:16.365971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:06:16.366970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA97C9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAF8F6CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAF76CDD0>]}
[0m09:06:16.366970 [debug] [MainThread]: Flushing usage events
[0m09:06:17.101340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:15.789082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C928DC54D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C928DC5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C928DC7910>]}


============================== 09:08:15.793085 | caab7638-73ed-4e78-a452-95ab7c0aba54 ==============================
[0m09:08:15.793085 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:08:15.794087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:08:15.806082 [info ] [MainThread]: dbt version: 1.9.2
[0m09:08:15.806082 [info ] [MainThread]: python version: 3.11.9
[0m09:08:15.807087 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:08:15.808088 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:08:15.867616 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\DBT
[0m09:08:15.867616 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\DBT\profiles.yml
[0m09:08:15.868616 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml
[0m09:08:15.869618 [info ] [MainThread]: adapter type: postgres
[0m09:08:15.869618 [info ] [MainThread]: adapter version: 1.9.0
[0m09:08:15.872619 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:08:15.874629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caab7638-73ed-4e78-a452-95ab7c0aba54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C92A07EB50>]}
[0m09:08:15.875618 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:08:15.876624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caab7638-73ed-4e78-a452-95ab7c0aba54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C928EC3890>]}
[0m09:08:15.946153 [info ] [MainThread]: Configuration:
[0m09:08:15.947154 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:08:15.948155 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:08:15.948155 [info ] [MainThread]: Required dependencies:
[0m09:08:15.949157 [debug] [MainThread]: Executing "git --help"
[0m09:08:15.993155 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:08:15.994162 [debug] [MainThread]: STDERR: "b''"
[0m09:08:15.995162 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:08:15.996156 [info ] [MainThread]: Connection:
[0m09:08:15.996156 [info ] [MainThread]:   host: 172.16.0.239
[0m09:08:15.997154 [info ] [MainThread]:   port: 5432
[0m09:08:15.997154 [info ] [MainThread]:   user: dmx-op-user
[0m09:08:15.998153 [info ] [MainThread]:   database: operacoes
[0m09:08:15.999156 [info ] [MainThread]:   schema: public
[0m09:08:15.999156 [info ] [MainThread]:   connect_timeout: 10
[0m09:08:16.000155 [info ] [MainThread]:   role: None
[0m09:08:16.001154 [info ] [MainThread]:   search_path: None
[0m09:08:16.001154 [info ] [MainThread]:   keepalives_idle: 0
[0m09:08:16.002156 [info ] [MainThread]:   sslmode: None
[0m09:08:16.002156 [info ] [MainThread]:   sslcert: None
[0m09:08:16.003156 [info ] [MainThread]:   sslkey: None
[0m09:08:16.003156 [info ] [MainThread]:   sslrootcert: None
[0m09:08:16.004154 [info ] [MainThread]:   application_name: dbt
[0m09:08:16.004154 [info ] [MainThread]:   retries: 1
[0m09:08:16.005154 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:08:16.196377 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:08:16.239892 [debug] [MainThread]: Using postgres connection "debug"
[0m09:08:16.240883 [debug] [MainThread]: On debug: select 1 as id
[0m09:08:16.240883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:16.296879 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m09:08:16.297878 [debug] [MainThread]: On debug: Close
[0m09:08:16.297878 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:08:16.298880 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:08:16.299880 [debug] [MainThread]: Command `dbt debug` succeeded at 09:08:16.299880 after 0.57 seconds
[0m09:08:16.299880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:08:16.299880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C928BDB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9240C18D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C924049610>]}
[0m09:08:16.300879 [debug] [MainThread]: Flushing usage events
[0m09:08:16.999714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:42.826585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D668387C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6683B7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D668387910>]}


============================== 09:08:42.830585 | 474c329e-a72a-42aa-96cc-7682a5926c60 ==============================
[0m09:08:42.830585 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:08:42.831602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:08:42.886585 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:08:42.887586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66819EF10>]}
[0m09:08:42.888585 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:08:42.888585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6683E4650>]}
[0m09:08:43.064621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D668544210>]}
[0m09:08:43.105629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6685FE090>]}
[0m09:08:43.106630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:08:43.319826 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:08:43.320811 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:08:43.321823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6683DB750>]}
[0m09:08:44.645926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m09:08:44.649925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6685A3710>]}
[0m09:08:44.678925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:08:44.683926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:08:44.739451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D668967B50>]}
[0m09:08:44.740452 [info ] [MainThread]: Found 433 macros
[0m09:08:44.741454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '474c329e-a72a-42aa-96cc-7682a5926c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D668839450>]}
[0m09:08:44.743449 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:08:44.743449 [debug] [MainThread]: Command end result
[0m09:08:44.757448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:08:44.759480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:08:44.762450 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:08:44.763449 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:44.763449 after 1.99 seconds
[0m09:08:44.764482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6625D1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D662559650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D662558A50>]}
[0m09:08:44.764482 [debug] [MainThread]: Flushing usage events
[0m09:08:45.474955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:46.308288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A1984D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A19B7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A19DBB50>]}


============================== 09:31:46.313306 | c08004d0-6f5d-4b8e-8b49-3dc99c11e035 ==============================
[0m09:31:46.313306 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:31:46.314290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models titulos_sem_aberto', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:31:46.382216 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:31:46.383217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c08004d0-6f5d-4b8e-8b49-3dc99c11e035', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A1AF3610>]}
[0m09:31:46.383217 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:31:46.384217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c08004d0-6f5d-4b8e-8b49-3dc99c11e035', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A1AF3610>]}
[0m09:31:46.531752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08004d0-6f5d-4b8e-8b49-3dc99c11e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A1B7F910>]}
[0m09:31:46.571471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c08004d0-6f5d-4b8e-8b49-3dc99c11e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449C9B85D0>]}
[0m09:31:46.573642 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:46.844147 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:31:46.946494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:31:46.947495 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:31:47.083246 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a node named 'titulos_sem_aberto' which was not found
[0m09:31:47.084143 [debug] [MainThread]: Command `dbt run` failed at 09:31:47.084143 after 0.85 seconds
[0m09:31:47.084143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A19E56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A2068250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A1FD0990>]}
[0m09:31:47.085142 [debug] [MainThread]: Flushing usage events
[0m09:31:48.093038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:04.266285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2C97D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2C96890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2C94FD0>]}


============================== 09:32:04.270302 | d38b8986-d69c-4099-9107-7e89cb8d8aa5 ==============================
[0m09:32:04.270302 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:32:04.270302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:32:04.320667 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:32:04.321673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd38b8986-d69c-4099-9107-7e89cb8d8aa5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2CEB3D0>]}
[0m09:32:04.321673 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:32:04.322602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd38b8986-d69c-4099-9107-7e89cb8d8aa5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2CEBD10>]}
[0m09:32:04.424635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd38b8986-d69c-4099-9107-7e89cb8d8aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2E57910>]}
[0m09:32:04.463650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd38b8986-d69c-4099-9107-7e89cb8d8aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265BEDA9810>]}
[0m09:32:04.464636 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:04.650685 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:32:04.708005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:32:04.709008 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:32:04.844704 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a node named 'titulos_sem_aberto' which was not found
[0m09:32:04.845610 [debug] [MainThread]: Command `dbt run` failed at 09:32:04.845610 after 0.63 seconds
[0m09:32:04.846718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2CF52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2DAE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C2CE8A90>]}
[0m09:32:04.846718 [debug] [MainThread]: Flushing usage events
[0m09:32:05.501928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:17.206861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F485610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F4D8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F4D9890>]}


============================== 09:32:17.209859 | fb02969b-0445-4b40-b2c4-13baeae809fb ==============================
[0m09:32:17.209859 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:32:17.210861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:17.258889 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:32:17.259888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb02969b-0445-4b40-b2c4-13baeae809fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F4D9650>]}
[0m09:32:17.260868 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:32:17.260868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb02969b-0445-4b40-b2c4-13baeae809fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F4DBD10>]}
[0m09:32:17.365893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb02969b-0445-4b40-b2c4-13baeae809fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F600250>]}
[0m09:32:17.407910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb02969b-0445-4b40-b2c4-13baeae809fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B509610>]}
[0m09:32:17.408892 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:17.600324 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:32:17.655628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:32:17.655628 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:32:17.786161 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a node named 'titulos_sem_aberto' which was not found
[0m09:32:17.786891 [debug] [MainThread]: Command `dbt run` failed at 09:32:17.786891 after 0.63 seconds
[0m09:32:17.788041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F4D9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F8F1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619F65C0D0>]}
[0m09:32:17.788041 [debug] [MainThread]: Flushing usage events
[0m09:32:18.430287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:10.121090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F154885B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F15478D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1548C7F50>]}


============================== 09:34:10.125094 | d0a35316-d63e-4ad3-b8f9-ba26f787fdb1 ==============================
[0m09:34:10.125094 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:34:10.126091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:34:10.178149 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:34:10.178149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0a35316-d63e-4ad3-b8f9-ba26f787fdb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1549F3E90>]}
[0m09:34:10.179129 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:34:10.179804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0a35316-d63e-4ad3-b8f9-ba26f787fdb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F152C97E90>]}
[0m09:34:10.284580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0a35316-d63e-4ad3-b8f9-ba26f787fdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F154A02150>]}
[0m09:34:10.322604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0a35316-d63e-4ad3-b8f9-ba26f787fdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F14F8C9D50>]}
[0m09:34:10.323604 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:10.509191 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:34:10.570186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:34:10.571207 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:34:10.712408 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a node named 'f_titulosemaberto' which was not found
[0m09:34:10.714393 [debug] [MainThread]: Command `dbt run` failed at 09:34:10.714393 after 0.64 seconds
[0m09:34:10.714393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F15469EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F154A64410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F154ECF650>]}
[0m09:34:10.715393 [debug] [MainThread]: Flushing usage events
[0m09:34:11.443809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:38.009322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D116187B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D116187990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1161C7F50>]}


============================== 09:41:38.013347 | 5f72ecaf-8526-418c-9edd-c21f0d371169 ==============================
[0m09:41:38.013347 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:41:38.014323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:41:38.068835 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:41:38.069834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f72ecaf-8526-418c-9edd-c21f0d371169', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1161B7D50>]}
[0m09:41:38.070879 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:41:38.070879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f72ecaf-8526-418c-9edd-c21f0d371169', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1161DBD10>]}
[0m09:41:38.171347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f72ecaf-8526-418c-9edd-c21f0d371169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1163BB1D0>]}
[0m09:41:38.211349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f72ecaf-8526-418c-9edd-c21f0d371169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D112309CD0>]}
[0m09:41:38.212349 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:41:38.403426 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:41:38.462330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:41:38.463332 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\sources.yml
[0m09:41:38.463332 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:41:38.609484 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto' which was not found
[0m09:41:38.610385 [debug] [MainThread]: Command `dbt run` failed at 09:41:38.610385 after 0.66 seconds
[0m09:41:38.610385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D114F9EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1161DA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1168CCF90>]}
[0m09:41:38.611385 [debug] [MainThread]: Flushing usage events
[0m09:41:39.320136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:48.839018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B987A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B6B8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B9DA790>]}


============================== 09:46:48.843968 | 17c2c688-38e4-4459-8368-f8f8042f924e ==============================
[0m09:46:48.843968 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:46:48.844969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m09:46:48.910073 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:46:48.911072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17c2c688-38e4-4459-8368-f8f8042f924e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B9DB290>]}
[0m09:46:48.911072 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:46:48.912074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17c2c688-38e4-4459-8368-f8f8042f924e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B9DA4D0>]}
[0m09:46:49.036562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c2c688-38e4-4459-8368-f8f8042f924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761BBB26D0>]}
[0m09:46:49.080081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c2c688-38e4-4459-8368-f8f8042f924e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027616A09610>]}
[0m09:46:49.081079 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:46:49.280216 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:46:49.359629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:46:49.360629 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\titulosaberto.sql
[0m09:46:49.502481 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto' which was not found
[0m09:46:49.503463 [debug] [MainThread]: Command `dbt run` failed at 09:46:49.503463 after 0.72 seconds
[0m09:46:49.504463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002761B6B8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027615C09810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027615C08CD0>]}
[0m09:46:49.504463 [debug] [MainThread]: Flushing usage events
[0m09:46:50.306194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:34.666779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC2784F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC0B8CBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC2787BD0>]}


============================== 09:49:34.670779 | 66f003c2-1238-4f5f-86cf-0f0b432ab2e1 ==============================
[0m09:49:34.670779 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:49:34.671780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:49:34.729779 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:49:34.730776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66f003c2-1238-4f5f-86cf-0f0b432ab2e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC27B7F50>]}
[0m09:49:34.731777 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:49:34.731777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66f003c2-1238-4f5f-86cf-0f0b432ab2e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC28EFE90>]}
[0m09:49:34.839941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f003c2-1238-4f5f-86cf-0f0b432ab2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC29B0D50>]}
[0m09:49:34.881516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f003c2-1238-4f5f-86cf-0f0b432ab2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBD898250>]}
[0m09:49:34.882498 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:49:35.064629 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:49:35.089727 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:49:35.090629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66f003c2-1238-4f5f-86cf-0f0b432ab2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC0B5FE90>]}
[0m09:49:35.609220 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto' which was not found
[0m09:49:35.611162 [debug] [MainThread]: Command `dbt run` failed at 09:49:35.611162 after 1.01 seconds
[0m09:49:35.612162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC27DB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC2C29090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC2CF21D0>]}
[0m09:49:35.612162 [debug] [MainThread]: Flushing usage events
[0m09:49:36.695069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:54.459174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0D987690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0B613B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0B6137D0>]}


============================== 09:49:54.462178 | d605a2b3-c769-48fe-acec-8d42603a4ffe ==============================
[0m09:49:54.462178 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:49:54.464175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:49:54.519378 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:49:54.520376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd605a2b3-c769-48fe-acec-8d42603a4ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0DAF2BD0>]}
[0m09:49:54.521377 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:49:54.521377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd605a2b3-c769-48fe-acec-8d42603a4ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0D9B7F50>]}
[0m09:49:54.624029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd605a2b3-c769-48fe-acec-8d42603a4ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0DB1DB50>]}
[0m09:49:54.662035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd605a2b3-c769-48fe-acec-8d42603a4ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B089A9C50>]}
[0m09:49:54.663036 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:49:54.837853 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:49:54.860861 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:49:54.861965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd605a2b3-c769-48fe-acec-8d42603a4ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0D4AC290>]}
[0m09:49:55.381083 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto' which was not found
[0m09:49:55.382692 [debug] [MainThread]: Command `dbt run` failed at 09:49:55.382692 after 0.98 seconds
[0m09:49:55.382692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0D79FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0DE01090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B0DF8CCD0>]}
[0m09:49:55.383693 [debug] [MainThread]: Flushing usage events
[0m09:49:56.019893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:27.652342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F0F854D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F0FB4990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F0A915D0>]}


============================== 09:51:27.655346 | 94ec1807-f87c-4405-8f93-8b499e986c69 ==============================
[0m09:51:27.655346 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:51:27.656345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:51:27.679343 [info ] [MainThread]: dbt version: 1.9.2
[0m09:51:27.680348 [info ] [MainThread]: python version: 3.11.9
[0m09:51:27.681350 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:51:27.681350 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:51:27.734864 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\DBT
[0m09:51:27.735864 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\DBT\profiles.yml
[0m09:51:27.736864 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml
[0m09:51:27.736864 [info ] [MainThread]: adapter type: postgres
[0m09:51:27.737915 [info ] [MainThread]: adapter version: 1.9.0
[0m09:51:27.741887 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:51:27.742863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94ec1807-f87c-4405-8f93-8b499e986c69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F216E910>]}
[0m09:51:27.742863 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:51:27.743863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94ec1807-f87c-4405-8f93-8b499e986c69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F216DF10>]}
[0m09:51:27.809376 [info ] [MainThread]: Configuration:
[0m09:51:27.810378 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:51:27.811376 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:51:27.812375 [info ] [MainThread]: Required dependencies:
[0m09:51:27.812375 [debug] [MainThread]: Executing "git --help"
[0m09:51:27.860376 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:51:27.861375 [debug] [MainThread]: STDERR: "b''"
[0m09:51:27.861375 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:51:27.862375 [info ] [MainThread]: Connection:
[0m09:51:27.862375 [info ] [MainThread]:   host: 172.16.0.239
[0m09:51:27.863377 [info ] [MainThread]:   port: 5432
[0m09:51:27.864378 [info ] [MainThread]:   user: dmx-op-user
[0m09:51:27.864378 [info ] [MainThread]:   database: operacoes
[0m09:51:27.865378 [info ] [MainThread]:   schema: public
[0m09:51:27.865378 [info ] [MainThread]:   connect_timeout: 10
[0m09:51:27.866376 [info ] [MainThread]:   role: None
[0m09:51:27.866376 [info ] [MainThread]:   search_path: None
[0m09:51:27.867375 [info ] [MainThread]:   keepalives_idle: 0
[0m09:51:27.869394 [info ] [MainThread]:   sslmode: None
[0m09:51:27.869394 [info ] [MainThread]:   sslcert: None
[0m09:51:27.870377 [info ] [MainThread]:   sslkey: None
[0m09:51:27.870377 [info ] [MainThread]:   sslrootcert: None
[0m09:51:27.871376 [info ] [MainThread]:   application_name: dbt
[0m09:51:27.871376 [info ] [MainThread]:   retries: 1
[0m09:51:27.872376 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:28.061106 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:51:28.108656 [debug] [MainThread]: Using postgres connection "debug"
[0m09:51:28.108656 [debug] [MainThread]: On debug: select 1 as id
[0m09:51:28.108656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:28.164099 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m09:51:28.166090 [debug] [MainThread]: On debug: Close
[0m09:51:28.167087 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:51:28.168088 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:51:28.171100 [debug] [MainThread]: Command `dbt debug` succeeded at 09:51:28.170088 after 0.58 seconds
[0m09:51:28.172101 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:51:28.173084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F23A70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2144F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2778E50>]}
[0m09:51:28.173084 [debug] [MainThread]: Flushing usage events
[0m09:51:28.872624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:35.633298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A92C85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9287F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9284B90>]}


============================== 09:51:35.636285 | a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a ==============================
[0m09:51:35.636285 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:51:35.637284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m09:51:35.690030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:51:35.690030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9287C10>]}
[0m09:51:35.691015 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:51:35.691015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9286B50>]}
[0m09:51:35.792553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A93DA650>]}
[0m09:51:35.830553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A54082D0>]}
[0m09:51:35.831554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:36.018593 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:51:36.043791 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:51:36.044689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A7DAC1D0>]}
[0m09:51:36.744816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m09:51:36.752816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A970C8D0>]}
[0m09:51:36.802323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:51:36.806324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:51:36.826326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9402610>]}
[0m09:51:36.827325 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m09:51:36.827325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A942CDD0>]}
[0m09:51:36.829324 [info ] [MainThread]: 
[0m09:51:36.829324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:51:36.830324 [info ] [MainThread]: 
[0m09:51:36.830324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:36.831325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:51:36.880839 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:51:36.881855 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:51:36.881855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:36.928282 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m09:51:36.930282 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:51:36.934280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:51:36.943378 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:36.943378 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:51:36.944385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:36.995712 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m09:51:36.996762 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:36.997786 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:51:37.020934 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m09:51:37.024081 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:51:37.028672 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:51:37.036467 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.037471 [debug] [MainThread]: On master: BEGIN
[0m09:51:37.038471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:37.102662 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m09:51:37.103674 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.104674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:37.126734 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m09:51:37.130801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9157210>]}
[0m09:51:37.131697 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:37.137774 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.138801 [debug] [MainThread]: On master: BEGIN
[0m09:51:37.146557 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:51:37.147554 [debug] [MainThread]: On master: COMMIT
[0m09:51:37.148649 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.149553 [debug] [MainThread]: On master: COMMIT
[0m09:51:37.154273 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:51:37.155502 [debug] [MainThread]: On master: Close
[0m09:51:37.165714 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:51:37.166703 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m09:51:37.168704 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:51:37.169704 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:51:37.181701 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:51:37.184707 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:51:37.213699 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:51:37.215699 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:51:37.215699 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:51:37.216700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:51:37.276836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m09:51:37.277933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:51:37.278837 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    CREATE VIEW "operacoes"."public"."f_titulosemaberto" AS
SELECT 
    cedente,
    conf,
    conta,
    CAST(cpf_cnpj_cedente AS bigint) AS cpf_cnpj_cedente,
    CAST(cpf_cnpj_sacado AS bigint) AS cpf_cnpj_sacado,
    cr,
    CAST(data_emissao AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(valor AS decimal(18, 2)) AS valor,
    CAST(valor_juros AS decimal(18, 2)) AS valor_juros,
    CAST(valor_multa AS decimal(18, 2)) AS valor_multa,
    CAST(valor_tarifas AS decimal(18, 2)) AS valor_tarifas,
    CAST(valor_total AS decimal(18, 2)) AS valor_total,
    CAST(vencimento AS date) AS vencimento,
    CAST(timestamp_extracao AS date) AS timestamp_extracao,
    CAST(desagio AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto";  -- Usando a função 'source' para referir a tabela do banco
  );
[0m09:51:37.284831 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE VIEW "operacoes"."public"."f_titulosemaberto" AS
            ^

[0m09:51:37.285830 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m09:51:37.289845 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:51:37.407557 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE VIEW "operacoes"."public"."f_titulosemaberto" AS
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:51:37.415414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9a7a5d9-15b9-4bf9-b1bc-47e4b743212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A973C150>]}
[0m09:51:37.415414 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.24s]
[0m09:51:37.416514 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:51:37.417534 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE VIEW "operacoes"."public"."f_titulosemaberto" AS
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m09:51:37.418532 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.419562 [debug] [MainThread]: On master: BEGIN
[0m09:51:37.419562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:37.450556 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:51:37.451536 [debug] [MainThread]: On master: COMMIT
[0m09:51:37.451536 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:37.451536 [debug] [MainThread]: On master: COMMIT
[0m09:51:37.455536 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:51:37.455536 [debug] [MainThread]: On master: Close
[0m09:51:37.456539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:37.456539 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:51:37.457536 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:51:37.457536 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:51:37.457536 [info ] [MainThread]: 
[0m09:51:37.458538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m09:51:37.459536 [debug] [MainThread]: Command end result
[0m09:51:37.474049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:51:37.476051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:51:37.482056 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:51:37.483050 [info ] [MainThread]: 
[0m09:51:37.484050 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:51:37.485049 [info ] [MainThread]: 
[0m09:51:37.486050 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE VIEW "operacoes"."public"."f_titulosemaberto" AS
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:51:37.486050 [info ] [MainThread]: 
[0m09:51:37.487050 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:51:37.488049 [debug] [MainThread]: Command `dbt run` failed at 09:51:37.487050 after 1.91 seconds
[0m09:51:37.488049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A77588D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A947F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A3571390>]}
[0m09:51:37.488049 [debug] [MainThread]: Flushing usage events
[0m09:51:38.152222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:17.164745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8285290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC82D9AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC82DBD50>]}


============================== 09:53:17.167747 | 041c915a-0a2a-456e-abd2-2ed5292cd334 ==============================
[0m09:53:17.167747 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:53:17.168745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:53:17.220788 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:53:17.221772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8286550>]}
[0m09:53:17.221772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:53:17.222771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8318050>]}
[0m09:53:17.326312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC847AF90>]}
[0m09:53:17.367882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC4308650>]}
[0m09:53:17.368882 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:17.548141 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:53:17.654463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:17.655433 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:53:17.813177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m09:53:17.822540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8785210>]}
[0m09:53:17.867037 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:53:17.871051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:53:17.886037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8AECAD0>]}
[0m09:53:17.886037 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m09:53:17.887036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC82849D0>]}
[0m09:53:17.888039 [info ] [MainThread]: 
[0m09:53:17.889038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:17.889038 [info ] [MainThread]: 
[0m09:53:17.890037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:17.891038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:53:17.939594 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:53:17.939594 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:53:17.939594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:18.018810 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m09:53:18.021926 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:53:18.025823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:53:18.035664 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:18.035664 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:53:18.036609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:18.087677 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m09:53:18.088581 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:18.089672 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:53:18.097091 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m09:53:18.101109 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:53:18.108131 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:53:18.113139 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.114241 [debug] [MainThread]: On master: BEGIN
[0m09:53:18.114241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:18.165603 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m09:53:18.166628 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.167586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:18.177522 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:53:18.180522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8939DD0>]}
[0m09:53:18.181586 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:18.185913 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.187035 [debug] [MainThread]: On master: BEGIN
[0m09:53:18.195100 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:53:18.196416 [debug] [MainThread]: On master: COMMIT
[0m09:53:18.197330 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.198415 [debug] [MainThread]: On master: COMMIT
[0m09:53:18.202324 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:53:18.204321 [debug] [MainThread]: On master: Close
[0m09:53:18.209316 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:53:18.211312 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m09:53:18.212314 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:53:18.213316 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:53:18.224347 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:53:18.225346 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:53:18.253055 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:53:18.253962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:53:18.254961 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:53:18.254961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:53:18.320546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m09:53:18.322569 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:53:18.323675 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(cpf_cnpj_cedente AS bigint) AS cpf_cnpj_cedente,
    CAST(cpf_cnpj_sacado AS bigint) AS cpf_cnpj_sacado,
    cr,
    CAST(data_emissao AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(valor AS decimal(18, 2)) AS valor,
    CAST(valor_juros AS decimal(18, 2)) AS valor_juros,
    CAST(valor_multa AS decimal(18, 2)) AS valor_multa,
    CAST(valor_tarifas AS decimal(18, 2)) AS valor_tarifas,
    CAST(valor_total AS decimal(18, 2)) AS valor_total,
    CAST(vencimento AS date) AS vencimento,
    CAST(timestamp_extracao AS date) AS timestamp_extracao,
    CAST(desagio AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto";
  );
[0m09:53:18.328582 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     "operacoes"."public"."f_titulosemaberto";
                                                     ^

[0m09:53:18.329786 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m09:53:18.334710 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:53:18.342691 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 39:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:53:18.345690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041c915a-0a2a-456e-abd2-2ed5292cd334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8A17DD0>]}
[0m09:53:18.346689 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.13s]
[0m09:53:18.347693 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:53:18.347693 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 39:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m09:53:18.349689 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.350689 [debug] [MainThread]: On master: BEGIN
[0m09:53:18.350689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:18.402376 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m09:53:18.402376 [debug] [MainThread]: On master: COMMIT
[0m09:53:18.403377 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:18.403377 [debug] [MainThread]: On master: COMMIT
[0m09:53:18.407373 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:53:18.407373 [debug] [MainThread]: On master: Close
[0m09:53:18.408363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:18.408363 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:53:18.409361 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:53:18.409361 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:53:18.409361 [info ] [MainThread]: 
[0m09:53:18.410361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:53:18.411360 [debug] [MainThread]: Command end result
[0m09:53:18.425367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:53:18.429367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:53:18.433994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:53:18.434938 [info ] [MainThread]: 
[0m09:53:18.435948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:18.436930 [info ] [MainThread]: 
[0m09:53:18.437931 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 39:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:53:18.438931 [info ] [MainThread]: 
[0m09:53:18.438931 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:53:18.439931 [debug] [MainThread]: Command `dbt run` failed at 09:53:18.439931 after 1.33 seconds
[0m09:53:18.440950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC2438C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC2438CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC8286E50>]}
[0m09:53:18.440950 [debug] [MainThread]: Flushing usage events
[0m09:53:19.155326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:17.739913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D587B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D48B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D585490>]}


============================== 09:54:17.743927 | 7964ede1-2cdf-4daa-a483-c7602be7fea1 ==============================
[0m09:54:17.743927 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:54:17.743927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:17.799545 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:54:17.800549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D5B7F50>]}
[0m09:54:17.801445 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:54:17.801445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D606DD0>]}
[0m09:54:17.903582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D6EECD0>]}
[0m09:54:17.942608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D49609790>]}
[0m09:54:17.943609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:54:18.120845 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:54:18.225433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:18.225433 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:54:18.376472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m09:54:18.384484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4DC12F50>]}
[0m09:54:18.436474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:54:18.439475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:54:18.455988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4DDECA50>]}
[0m09:54:18.455988 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m09:54:18.456989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4B8D5750>]}
[0m09:54:18.457988 [info ] [MainThread]: 
[0m09:54:18.459073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:18.459989 [info ] [MainThread]: 
[0m09:54:18.459989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:18.461988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:54:18.512988 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:54:18.512988 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:54:18.512988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:18.576192 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m09:54:18.579184 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:54:18.582185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:54:18.589277 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:54:18.590277 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:54:18.590277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:18.648735 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m09:54:18.649731 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:54:18.650833 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:54:18.658918 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m09:54:18.662938 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:54:18.679824 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:54:18.691914 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:18.692832 [debug] [MainThread]: On master: BEGIN
[0m09:54:18.692832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:18.760514 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m09:54:18.761405 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:18.762515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:18.771259 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:54:18.773380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4B827C10>]}
[0m09:54:18.774258 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:18.778265 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:18.779255 [debug] [MainThread]: On master: BEGIN
[0m09:54:18.788405 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:54:18.789433 [debug] [MainThread]: On master: COMMIT
[0m09:54:18.790435 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:18.791436 [debug] [MainThread]: On master: COMMIT
[0m09:54:18.795258 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:54:18.797283 [debug] [MainThread]: On master: Close
[0m09:54:18.804271 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:54:18.805274 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m09:54:18.806275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:54:18.806275 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:54:18.812273 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:54:18.812273 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:54:18.840292 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:54:18.841308 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:54:18.841308 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:54:18.842276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:54:18.898319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m09:54:18.899315 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:54:18.900316 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(cpf_cnpj_cedente AS bigint) AS cpf_cnpj_cedente,
    CAST(cpf_cnpj_sacado AS bigint) AS cpf_cnpj_sacado,
    cr,
    CAST(data_emissao AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(valor AS decimal(18, 2)) AS valor,
    CAST(valor_juros AS decimal(18, 2)) AS valor_juros,
    CAST(valor_multa AS decimal(18, 2)) AS valor_multa,
    CAST(valor_tarifas AS decimal(18, 2)) AS valor_tarifas,
    CAST(valor_total AS decimal(18, 2)) AS valor_total,
    CAST(vencimento AS date) AS vencimento,
    CAST(timestamp_extracao AS date) AS timestamp_extracao,
    CAST(desagio AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m09:54:18.926213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m09:54:18.930229 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:54:18.931229 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:54:18.938218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:54:18.948263 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:54:18.948263 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:54:18.949264 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:54:18.965362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:54:18.970264 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:54:18.974263 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:54:18.974263 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:54:18.978281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:54:18.980264 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:54:18.982263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7964ede1-2cdf-4daa-a483-c7602be7fea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4E0BAC90>]}
[0m09:54:18.982263 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m09:54:18.983264 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:54:18.985264 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:18.985264 [debug] [MainThread]: On master: BEGIN
[0m09:54:18.985264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:19.030264 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m09:54:19.030264 [debug] [MainThread]: On master: COMMIT
[0m09:54:19.031265 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:19.031265 [debug] [MainThread]: On master: COMMIT
[0m09:54:19.035271 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:54:19.035271 [debug] [MainThread]: On master: Close
[0m09:54:19.036271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:19.036271 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:54:19.036271 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:54:19.037272 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:54:19.037272 [info ] [MainThread]: 
[0m09:54:19.037272 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m09:54:19.038271 [debug] [MainThread]: Command end result
[0m09:54:19.052779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:54:19.054779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:54:19.060778 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:54:19.060778 [info ] [MainThread]: 
[0m09:54:19.061778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:19.062780 [info ] [MainThread]: 
[0m09:54:19.062780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:54:19.064782 [debug] [MainThread]: Command `dbt run` succeeded at 09:54:19.063779 after 1.38 seconds
[0m09:54:19.064782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D39EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D4D287690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D477C8CD0>]}
[0m09:54:19.064782 [debug] [MainThread]: Flushing usage events
[0m09:54:19.775356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:25.715890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193685950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193687950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193687750>]}


============================== 09:58:25.721888 | e63b6a2a-ff8a-4941-acfe-b7ed81c0b154 ==============================
[0m09:58:25.721888 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:58:25.722890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:25.791700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:25.792701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241936DABD0>]}
[0m09:58:25.793702 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:25.793702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193714B50>]}
[0m09:58:25.919191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241937EFD10>]}
[0m09:58:25.962811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418E6E9AD0>]}
[0m09:58:25.963809 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:58:26.169824 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:58:26.303297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:26.304300 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:58:26.458347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m09:58:26.466346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193DA5950>]}
[0m09:58:26.515346 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:58:26.519347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:58:26.541857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193EECDD0>]}
[0m09:58:26.542858 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m09:58:26.542858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193DC1350>]}
[0m09:58:26.543857 [info ] [MainThread]: 
[0m09:58:26.544856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:26.544856 [info ] [MainThread]: 
[0m09:58:26.545856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:58:26.546857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:58:26.601856 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:58:26.602864 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:58:26.602864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:26.672286 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m09:58:26.675241 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:58:26.679153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:58:26.688236 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:58:26.689230 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:58:26.690177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:26.739275 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m09:58:26.740784 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:58:26.741792 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:58:26.749795 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:58:26.752800 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:58:26.757517 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:58:26.768529 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:26.769532 [debug] [MainThread]: On master: BEGIN
[0m09:58:26.770532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:26.834865 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m09:58:26.836994 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:26.837999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:58:26.846998 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m09:58:26.849887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024193E50310>]}
[0m09:58:26.850889 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:26.855893 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:26.856892 [debug] [MainThread]: On master: BEGIN
[0m09:58:26.864896 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:58:26.866896 [debug] [MainThread]: On master: COMMIT
[0m09:58:26.867912 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:26.867912 [debug] [MainThread]: On master: COMMIT
[0m09:58:26.872853 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:58:26.873909 [debug] [MainThread]: On master: Close
[0m09:58:26.879957 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:58:26.880960 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m09:58:26.881973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:58:26.881973 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:58:26.894031 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:58:26.897028 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:58:26.923122 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:58:26.924027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:26.925026 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:58:26.925026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:58:26.972152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m09:58:26.973150 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:26.974149 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(data_emissao AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(valor AS decimal(18, 2)) AS valor,
    CAST(valor_juros AS decimal(18, 2)) AS valor_juros,
    CAST(valor_multa AS decimal(18, 2)) AS valor_multa,
    CAST(valor_tarifas AS decimal(18, 2)) AS valor_tarifas,
    CAST(valor_total AS decimal(18, 2)) AS valor_total,
    CAST(vencimento AS date) AS vencimento,
    CAST(timestamp_extracao AS date) AS timestamp_extracao,
    CAST(desagio AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m09:58:26.980578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:58:26.989590 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:26.989590 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:58:26.993072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:58:26.996018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:26.996018 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:58:27.000061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:58:27.011907 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:58:27.011907 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:27.012908 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:58:27.026922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:58:27.031947 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:58:27.035947 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:58:27.035947 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:58:27.069329 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m09:58:27.071330 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:58:27.073329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63b6a2a-ff8a-4941-acfe-b7ed81c0b154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419385D010>]}
[0m09:58:27.073329 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m09:58:27.074330 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:58:27.076331 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:27.077330 [debug] [MainThread]: On master: BEGIN
[0m09:58:27.077330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:27.121648 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m09:58:27.121648 [debug] [MainThread]: On master: COMMIT
[0m09:58:27.122600 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:27.122600 [debug] [MainThread]: On master: COMMIT
[0m09:58:27.131623 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:58:27.131623 [debug] [MainThread]: On master: Close
[0m09:58:27.132605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:27.132605 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:58:27.132605 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:58:27.133628 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:58:27.133628 [info ] [MainThread]: 
[0m09:58:27.134207 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:58:27.134846 [debug] [MainThread]: Command end result
[0m09:58:27.149370 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:58:27.152363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:58:27.156398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:58:27.156398 [info ] [MainThread]: 
[0m09:58:27.157365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:27.158368 [info ] [MainThread]: 
[0m09:58:27.159364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:58:27.160365 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:27.160365 after 1.51 seconds
[0m09:58:27.160365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418D8E1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419349EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418D8C8C50>]}
[0m09:58:27.160365 [debug] [MainThread]: Flushing usage events
[0m09:58:28.237592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:49.550908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC587350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC586E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC587B10>]}


============================== 09:59:49.553881 | 68b71938-4b3f-4d31-b8f9-2bb57ad33e1b ==============================
[0m09:59:49.553881 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:59:49.554885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:49.605406 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:59:49.606408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC5DB3D0>]}
[0m09:59:49.607452 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:59:49.607452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC6EF450>]}
[0m09:59:49.718793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC6EF910>]}
[0m09:59:49.756822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CF8619C10>]}
[0m09:59:49.757836 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:49.940403 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:59:50.053519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:50.053519 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:59:50.206958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m09:59:50.216064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC0AC250>]}
[0m09:59:50.261957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:59:50.265959 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:59:50.279965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFCDECF50>]}
[0m09:59:50.280966 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m09:59:50.281963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFCC29CD0>]}
[0m09:59:50.282994 [info ] [MainThread]: 
[0m09:59:50.282994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:50.283964 [info ] [MainThread]: 
[0m09:59:50.283964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:50.284964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:59:50.334475 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:59:50.334475 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:59:50.335475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:50.366428 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m09:59:50.367430 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:59:50.368975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:59:50.373011 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:59:50.373011 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:59:50.374012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:50.431071 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m09:59:50.432143 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:59:50.433191 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:59:50.441255 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m09:59:50.444255 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:59:50.448998 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:59:50.457011 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.458015 [debug] [MainThread]: On master: BEGIN
[0m09:59:50.459017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:50.518446 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m09:59:50.519446 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.520448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:50.528395 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m09:59:50.531491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFCC0D0D0>]}
[0m09:59:50.532491 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:50.540484 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.541586 [debug] [MainThread]: On master: BEGIN
[0m09:59:50.548224 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:59:50.549210 [debug] [MainThread]: On master: COMMIT
[0m09:59:50.550210 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.550210 [debug] [MainThread]: On master: COMMIT
[0m09:59:50.554228 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:59:50.555225 [debug] [MainThread]: On master: Close
[0m09:59:50.559896 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:59:50.560908 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m09:59:50.561916 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:59:50.562954 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:59:50.569010 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:59:50.569905 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:59:50.599202 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:59:50.600301 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.601198 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:59:50.601198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:50.681130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m09:59:50.683114 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.684113 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(valor AS decimal(18, 2)) AS valor,
    CAST(valor_juros AS decimal(18, 2)) AS valor_juros,
    CAST(valor_multa AS decimal(18, 2)) AS valor_multa,
    CAST(valor_tarifas AS decimal(18, 2)) AS valor_tarifas,
    CAST(valor_total AS decimal(18, 2)) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        TO_DATE(timestamp_extracao, 'DD/MM/YYYY') AS date
    ) AS timestamp_extracao,
    CAST(desagio AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m09:59:50.691353 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:59:50.696371 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.697369 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:59:50.701351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:59:50.703353 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.703353 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:59:50.708224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:59:50.724322 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:59:50.724322 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.725231 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:59:50.743537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m09:59:50.747535 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:59:50.751535 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:59:50.751535 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:59:50.766960 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:59:50.768963 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:59:50.770961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b71938-4b3f-4d31-b8f9-2bb57ad33e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC7CEF10>]}
[0m09:59:50.771961 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:59:50.772967 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:59:50.774967 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.775967 [debug] [MainThread]: On master: BEGIN
[0m09:59:50.775967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:50.810752 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m09:59:50.810752 [debug] [MainThread]: On master: COMMIT
[0m09:59:50.811753 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:50.811753 [debug] [MainThread]: On master: COMMIT
[0m09:59:50.815752 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:59:50.815752 [debug] [MainThread]: On master: Close
[0m09:59:50.816775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:50.816775 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:59:50.816775 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:59:50.816775 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:59:50.817751 [info ] [MainThread]: 
[0m09:59:50.817751 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m09:59:50.818751 [debug] [MainThread]: Command end result
[0m09:59:50.831752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m09:59:50.833769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m09:59:50.838790 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m09:59:50.839752 [info ] [MainThread]: 
[0m09:59:50.840752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:50.840752 [info ] [MainThread]: 
[0m09:59:50.841756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:50.842242 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:50.842242 after 1.34 seconds
[0m09:59:50.843249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC5D9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFC39EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CF67C8C50>]}
[0m09:59:50.844251 [debug] [MainThread]: Flushing usage events
[0m09:59:51.553461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:52.408308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D287ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D2873D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D285310>]}


============================== 10:03:52.413325 | edb561e9-31c4-40d7-a48a-c87370336a47 ==============================
[0m10:03:52.413325 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:52.414309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:03:52.478731 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:03:52.479732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D307610>]}
[0m10:03:52.480731 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:03:52.481730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D3F2B50>]}
[0m10:03:52.597219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D285650>]}
[0m10:03:52.640826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D89409A90>]}
[0m10:03:52.641828 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:52.839170 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:03:52.954693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:52.955695 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:03:53.107256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:03:53.116324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D9987D0>]}
[0m10:03:53.162322 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:03:53.166324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:03:53.194444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8DAECC10>]}
[0m10:03:53.194444 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:03:53.195443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D9C3350>]}
[0m10:03:53.196445 [info ] [MainThread]: 
[0m10:03:53.196445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:53.197449 [info ] [MainThread]: 
[0m10:03:53.197449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:53.198869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:03:53.255224 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:03:53.255224 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:03:53.256225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:53.329796 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m10:03:53.332792 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:03:53.335791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:03:53.343889 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:03:53.343889 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:03:53.343889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:53.402944 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m10:03:53.402944 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:03:53.402944 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:53.410708 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:03:53.411551 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:03:53.415649 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:03:53.420481 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.421430 [debug] [MainThread]: On master: BEGIN
[0m10:03:53.422432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:53.469428 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m10:03:53.470414 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.471427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:53.480986 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:03:53.484023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D6F0790>]}
[0m10:03:53.485024 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:53.489558 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.490589 [debug] [MainThread]: On master: BEGIN
[0m10:03:53.497586 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:03:53.499581 [debug] [MainThread]: On master: COMMIT
[0m10:03:53.500581 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.501582 [debug] [MainThread]: On master: COMMIT
[0m10:03:53.506069 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:03:53.507002 [debug] [MainThread]: On master: Close
[0m10:03:53.515427 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:03:53.516427 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:03:53.518457 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:03:53.519426 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:03:53.526439 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:03:53.527438 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:03:53.555423 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:03:53.556424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.557424 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:03:53.557424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:03:53.609103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m10:03:53.609103 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.610106 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        TO_DATE(timestamp_extracao, 'DD/MM/YYYY') AS date
    ) AS timestamp_extracao,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:03:53.620944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:03:53.626561 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.626561 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:03:53.631450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:03:53.633452 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.634452 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:03:53.638450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:03:53.649451 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:03:53.650452 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.650452 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:03:53.667111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:03:53.672106 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:03:53.675107 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:53.676106 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:03:53.691282 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m10:03:53.694298 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:03:53.696281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb561e9-31c4-40d7-a48a-c87370336a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8D742110>]}
[0m10:03:53.696281 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:03:53.697281 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:03:53.698240 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.699245 [debug] [MainThread]: On master: BEGIN
[0m10:03:53.699245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:53.743686 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m10:03:53.743686 [debug] [MainThread]: On master: COMMIT
[0m10:03:53.744713 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:53.744713 [debug] [MainThread]: On master: COMMIT
[0m10:03:53.747687 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:03:53.748688 [debug] [MainThread]: On master: Close
[0m10:03:53.748688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:53.749687 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:03:53.749687 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:03:53.749687 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:03:53.750688 [info ] [MainThread]: 
[0m10:03:53.750688 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:03:53.751687 [debug] [MainThread]: Command end result
[0m10:03:53.764687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:03:53.767689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:03:53.773688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:03:53.774689 [info ] [MainThread]: 
[0m10:03:53.775688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:53.776688 [info ] [MainThread]: 
[0m10:03:53.778688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:03:53.779688 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:53.779688 after 1.45 seconds
[0m10:03:53.779688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8B76BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8BFB8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D87558C50>]}
[0m10:03:53.780687 [debug] [MainThread]: Flushing usage events
[0m10:03:54.495484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:02.612563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFE87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFE87B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFE879D0>]}


============================== 10:05:02.615616 | cc3d9fec-b5e8-42b9-880d-026bf13ec2e4 ==============================
[0m10:05:02.615616 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:05:02.616515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m10:05:02.667726 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:05:02.668622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFEDB490>]}
[0m10:05:02.668622 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:05:02.669723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFED8F10>]}
[0m10:05:02.772143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CE10B95D0>]}
[0m10:05:02.812755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDD009950>]}
[0m10:05:02.813738 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:03.003898 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:05:03.119740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:03.119740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:03.123741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:05:03.142736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CE1404750>]}
[0m10:05:03.189470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:05:03.193497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:05:03.207390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CE1562010>]}
[0m10:05:03.207390 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:05:03.208460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFE84F90>]}
[0m10:05:03.209458 [info ] [MainThread]: 
[0m10:05:03.210359 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:03.210359 [info ] [MainThread]: 
[0m10:05:03.211358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:03.212362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:05:03.262359 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:05:03.262359 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:05:03.263362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:03.324829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m10:05:03.326937 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:05:03.329932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:05:03.336929 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:05:03.337928 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:05:03.337928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:03.384853 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m10:05:03.385838 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:05:03.385838 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:05:03.394835 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m10:05:03.395839 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:05:03.398853 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:05:03.402096 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.403095 [debug] [MainThread]: On master: BEGIN
[0m10:05:03.403095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:03.438003 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:05:03.438994 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.438994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:03.447219 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:05:03.449219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CE17D6310>]}
[0m10:05:03.449219 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:03.453219 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.453219 [debug] [MainThread]: On master: BEGIN
[0m10:05:03.460219 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:05:03.460219 [debug] [MainThread]: On master: COMMIT
[0m10:05:03.461218 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.461218 [debug] [MainThread]: On master: COMMIT
[0m10:05:03.464958 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:05:03.464958 [debug] [MainThread]: On master: Close
[0m10:05:03.467972 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:05:03.467972 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:05:03.468988 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:05:03.468988 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:05:03.474988 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:05:03.475988 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:05:03.503499 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:05:03.504482 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.504482 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:05:03.505482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:05:03.535128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:05:03.536139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.536139 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        TO_DATE(timestamp_extracao, 'DD/MM/YYYY') AS date
    ) AS timestamp_extracao,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:05:03.544128 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:05:03.549128 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.549128 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:05:03.559128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:05:03.561128 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.562128 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:05:03.574130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:05:03.584488 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:05:03.585498 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.585498 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:05:03.666302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.080 seconds
[0m10:05:03.674316 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:05:03.678316 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:05:03.678316 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:05:03.699941 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:05:03.703070 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:05:03.705077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc3d9fec-b5e8-42b9-880d-026bf13ec2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CE190E910>]}
[0m10:05:03.705077 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:05:03.706972 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:05:03.707969 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.708970 [debug] [MainThread]: On master: BEGIN
[0m10:05:03.708970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:03.756343 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m10:05:03.756343 [debug] [MainThread]: On master: COMMIT
[0m10:05:03.757358 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:03.757358 [debug] [MainThread]: On master: COMMIT
[0m10:05:03.762463 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:05:03.763360 [debug] [MainThread]: On master: Close
[0m10:05:03.763360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:03.764359 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:05:03.764359 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:05:03.764359 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:05:03.765358 [info ] [MainThread]: 
[0m10:05:03.765358 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:05:03.766356 [debug] [MainThread]: Command end result
[0m10:05:03.782571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:05:03.784683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:05:03.789698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:05:03.789698 [info ] [MainThread]: 
[0m10:05:03.790701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:03.791684 [info ] [MainThread]: 
[0m10:05:03.792683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:05:03.793682 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:03.793682 after 1.24 seconds
[0m10:05:03.793682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB0A8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB0A8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDFEC6F50>]}
[0m10:05:03.794681 [debug] [MainThread]: Flushing usage events
[0m10:05:04.506422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:27.584927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D4F87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D4FC4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D4F86E90>]}


============================== 10:07:27.587940 | 519deec4-5f0b-4e0a-948c-c54d951693ce ==============================
[0m10:07:27.587940 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:07:27.588940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:27.640317 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:07:27.641316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D6014710>]}
[0m10:07:27.641316 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:07:27.642317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D60EDD10>]}
[0m10:07:27.748382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D4467C90>]}
[0m10:07:27.788382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D210A050>]}
[0m10:07:27.789381 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:07:27.988548 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:07:28.078143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:28.078143 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:28.082126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:07:28.101129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D64E42D0>]}
[0m10:07:28.148744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:07:28.151647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:07:28.167368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D6672450>]}
[0m10:07:28.167368 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:07:28.168374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D4F84F90>]}
[0m10:07:28.169375 [info ] [MainThread]: 
[0m10:07:28.170374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:28.170374 [info ] [MainThread]: 
[0m10:07:28.171374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:28.172373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:07:28.223882 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:07:28.224909 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:07:28.224909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:28.272228 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m10:07:28.273228 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:07:28.274228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:07:28.278320 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:07:28.279331 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:07:28.279331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:28.334169 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m10:07:28.335084 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:07:28.335084 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:07:28.342183 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:07:28.343183 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:07:28.347186 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:07:28.350183 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.350183 [debug] [MainThread]: On master: BEGIN
[0m10:07:28.351183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:28.390183 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m10:07:28.391183 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.391183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:28.403186 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m10:07:28.404186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D640D610>]}
[0m10:07:28.405186 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:28.409186 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.409186 [debug] [MainThread]: On master: BEGIN
[0m10:07:28.415726 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:07:28.415726 [debug] [MainThread]: On master: COMMIT
[0m10:07:28.416731 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.416731 [debug] [MainThread]: On master: COMMIT
[0m10:07:28.419728 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:07:28.420730 [debug] [MainThread]: On master: Close
[0m10:07:28.422730 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:07:28.422730 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:07:28.423729 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:07:28.423729 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:07:28.429729 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:07:28.430729 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:07:28.461728 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:07:28.462729 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.463731 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:07:28.463731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:07:28.491301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:07:28.492287 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.492287 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        TO_DATE(timestamp_extracao, 'DD/MM/YYYY') AS date
    ) AS timestamp_extracao,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:07:28.499327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:07:28.509314 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.509314 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:07:28.513666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:07:28.516666 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.516666 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:07:28.520666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:07:28.531665 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:07:28.532665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.532665 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:07:28.559666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m10:07:28.564666 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:07:28.568666 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:07:28.568666 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:07:28.585665 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:07:28.588665 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:07:28.589665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519deec4-5f0b-4e0a-948c-c54d951693ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D6A21C50>]}
[0m10:07:28.590665 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:07:28.590665 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:07:28.592667 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.592667 [debug] [MainThread]: On master: BEGIN
[0m10:07:28.593666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:28.638180 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m10:07:28.639180 [debug] [MainThread]: On master: COMMIT
[0m10:07:28.639180 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:28.640181 [debug] [MainThread]: On master: COMMIT
[0m10:07:28.643180 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:07:28.643180 [debug] [MainThread]: On master: Close
[0m10:07:28.644181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:28.644181 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:07:28.645181 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:07:28.645181 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:07:28.646182 [info ] [MainThread]: 
[0m10:07:28.646182 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:07:28.647184 [debug] [MainThread]: Command end result
[0m10:07:28.660180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:07:28.662182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:07:28.668180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:07:28.668180 [info ] [MainThread]: 
[0m10:07:28.669183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:28.670184 [info ] [MainThread]: 
[0m10:07:28.670184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:07:28.671184 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:28.671184 after 1.14 seconds
[0m10:07:28.672182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D01C8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D01C8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D01C9E10>]}
[0m10:07:28.673182 [debug] [MainThread]: Flushing usage events
[0m10:07:29.370528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:46.748199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081A85990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081988C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220819895D0>]}


============================== 10:08:46.752196 | 9c8b08fd-6e01-4f80-94b5-64f3c2788355 ==============================
[0m10:08:46.752196 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:08:46.753196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:46.764198 [info ] [MainThread]: dbt version: 1.9.2
[0m10:08:46.765199 [info ] [MainThread]: python version: 3.11.9
[0m10:08:46.766197 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m10:08:46.767197 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m10:08:46.816198 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\DBT
[0m10:08:46.818196 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\DBT\profiles.yml
[0m10:08:46.819213 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\DBT\dbt_project.yml
[0m10:08:46.820225 [info ] [MainThread]: adapter type: postgres
[0m10:08:46.821219 [info ] [MainThread]: adapter version: 1.9.0
[0m10:08:46.824244 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:08:46.826219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c8b08fd-6e01-4f80-94b5-64f3c2788355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081C6EF90>]}
[0m10:08:46.827218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:08:46.828220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c8b08fd-6e01-4f80-94b5-64f3c2788355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081C6DF10>]}
[0m10:08:46.894803 [info ] [MainThread]: Configuration:
[0m10:08:46.895788 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:08:46.896786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:08:46.897787 [info ] [MainThread]: Required dependencies:
[0m10:08:46.897787 [debug] [MainThread]: Executing "git --help"
[0m10:08:46.957882 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:08:46.958883 [debug] [MainThread]: STDERR: "b''"
[0m10:08:46.958883 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:08:46.959881 [info ] [MainThread]: Connection:
[0m10:08:46.959881 [info ] [MainThread]:   host: 172.16.0.239
[0m10:08:46.959881 [info ] [MainThread]:   port: 5432
[0m10:08:46.960882 [info ] [MainThread]:   user: dmx-op-user
[0m10:08:46.961883 [info ] [MainThread]:   database: operacoes
[0m10:08:46.961883 [info ] [MainThread]:   schema: public
[0m10:08:46.962882 [info ] [MainThread]:   connect_timeout: 10
[0m10:08:46.962882 [info ] [MainThread]:   role: None
[0m10:08:46.962882 [info ] [MainThread]:   search_path: None
[0m10:08:46.963881 [info ] [MainThread]:   keepalives_idle: 0
[0m10:08:46.963881 [info ] [MainThread]:   sslmode: None
[0m10:08:46.964884 [info ] [MainThread]:   sslcert: None
[0m10:08:46.964884 [info ] [MainThread]:   sslkey: None
[0m10:08:46.965881 [info ] [MainThread]:   sslrootcert: None
[0m10:08:46.965881 [info ] [MainThread]:   application_name: dbt
[0m10:08:46.966885 [info ] [MainThread]:   retries: 1
[0m10:08:46.967885 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:08:47.151310 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:08:47.191303 [debug] [MainThread]: Using postgres connection "debug"
[0m10:08:47.192315 [debug] [MainThread]: On debug: select 1 as id
[0m10:08:47.192315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:47.275735 [debug] [MainThread]: SQL status: SELECT 1 in 0.083 seconds
[0m10:08:47.276736 [debug] [MainThread]: On debug: Close
[0m10:08:47.276736 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:08:47.277734 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:08:47.278736 [debug] [MainThread]: Command `dbt debug` succeeded at 10:08:47.278736 after 0.60 seconds
[0m10:08:47.279737 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:08:47.279737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207BD31910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081A94F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022081CC2D90>]}
[0m10:08:47.279737 [debug] [MainThread]: Flushing usage events
[0m10:08:47.986746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:51.556154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699587AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216995852D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699587950>]}


============================== 10:08:51.559670 | c0ffbb31-9028-4a6a-abde-d10368c9ed72 ==============================
[0m10:08:51.559670 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:08:51.560668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:51.612669 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:08:51.613669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699607FD0>]}
[0m10:08:51.613669 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:08:51.614668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699615350>]}
[0m10:08:51.719183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216997B8990>]}
[0m10:08:51.757223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216997FD050>]}
[0m10:08:51.758759 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:08:51.945506 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:08:52.030253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:52.030253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:52.034237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:08:52.054139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699808A50>]}
[0m10:08:52.098764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:08:52.102767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:08:52.117914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699C61ED0>]}
[0m10:08:52.118890 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:08:52.118890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216995D9E50>]}
[0m10:08:52.120892 [info ] [MainThread]: 
[0m10:08:52.121175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:52.121795 [info ] [MainThread]: 
[0m10:08:52.121795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:08:52.122910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:08:52.173181 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:08:52.174181 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:08:52.174181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:52.258897 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m10:08:52.263210 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:08:52.266210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:08:52.275205 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:08:52.276208 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:08:52.276208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:52.382949 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m10:08:52.383951 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:08:52.383951 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:08:52.391369 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m10:08:52.392469 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:08:52.396901 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:08:52.399916 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.400919 [debug] [MainThread]: On master: BEGIN
[0m10:08:52.400919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:52.457550 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m10:08:52.459161 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.460203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:08:52.469565 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m10:08:52.472769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021699EE4A10>]}
[0m10:08:52.473768 [debug] [MainThread]: On master: ROLLBACK
[0m10:08:52.478658 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.479853 [debug] [MainThread]: On master: BEGIN
[0m10:08:52.486896 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:08:52.487762 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.489745 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.489745 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.493951 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:08:52.494810 [debug] [MainThread]: On master: Close
[0m10:08:52.502719 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:08:52.503733 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:08:52.505719 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:08:52.506736 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:08:52.515733 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:08:52.515733 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:08:52.544723 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:08:52.545738 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:08:52.546723 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:08:52.546723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:08:52.609353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m10:08:52.610358 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:08:52.611351 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        TO_DATE(timestamp_extracao, 'DD/MM/YYYY') AS date
    ) AS timestamp_extracao,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:08:52.617404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:08:52.623469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:08:52.623469 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:08:52.658471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m10:08:52.668979 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:08:52.669980 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:08:52.669980 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:08:52.691980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m10:08:52.696981 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:08:52.700980 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:08:52.700980 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:08:52.704981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:08:52.705985 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:08:52.707983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ffbb31-9028-4a6a-abde-d10368c9ed72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169970ADD0>]}
[0m10:08:52.708986 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m10:08:52.708986 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:08:52.710982 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.710982 [debug] [MainThread]: On master: BEGIN
[0m10:08:52.711984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:52.764495 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m10:08:52.764495 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.765495 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:52.765495 [debug] [MainThread]: On master: COMMIT
[0m10:08:52.768494 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:08:52.769495 [debug] [MainThread]: On master: Close
[0m10:08:52.769495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:52.770498 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:08:52.770498 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:08:52.770498 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:08:52.770498 [info ] [MainThread]: 
[0m10:08:52.771497 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:08:52.772499 [debug] [MainThread]: Command end result
[0m10:08:52.784494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:08:52.786495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:08:52.792530 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:08:52.793497 [info ] [MainThread]: 
[0m10:08:52.793497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:52.794500 [info ] [MainThread]: 
[0m10:08:52.795505 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:08:52.796509 [debug] [MainThread]: Command `dbt run` succeeded at 10:08:52.796509 after 1.29 seconds
[0m10:08:52.796509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169939C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216937C8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216996D8A50>]}
[0m10:08:52.797500 [debug] [MainThread]: Flushing usage events
[0m10:08:53.444356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:16.956008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680B87110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680B876D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680B87910>]}


============================== 10:10:16.961008 | 57e4b42b-2b3c-4502-b7d6-bcc03f59647a ==============================
[0m10:10:16.961008 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:10:16.962007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:17.029391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:10:17.030397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680CEEC50>]}
[0m10:10:17.031397 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:10:17.031397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680BDA810>]}
[0m10:10:17.142938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680DB2D10>]}
[0m10:10:17.185478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6FBC29450>]}
[0m10:10:17.186462 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:17.381627 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:10:17.466158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:17.467179 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:10:17.620243 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:10:17.629795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C681068AD0>]}
[0m10:10:17.678730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:10:17.682691 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:10:17.696929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6813ECED0>]}
[0m10:10:17.697928 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:10:17.697928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C680FFDFD0>]}
[0m10:10:17.698908 [info ] [MainThread]: 
[0m10:10:17.699925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:17.700908 [info ] [MainThread]: 
[0m10:10:17.700908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:17.701933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:10:17.754764 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:10:17.755808 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:10:17.755808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:17.806289 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m10:10:17.807291 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:10:17.808290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:10:17.813290 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:10:17.813290 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:10:17.813290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:17.852632 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m10:10:17.852632 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:10:17.853726 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:17.859380 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:10:17.860399 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:10:17.864932 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:10:17.867943 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:17.867943 [debug] [MainThread]: On master: BEGIN
[0m10:10:17.868945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:17.919284 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m10:10:17.920270 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:17.920270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:17.928834 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m10:10:17.929831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6812DD810>]}
[0m10:10:17.929831 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:17.933830 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:17.933830 [debug] [MainThread]: On master: BEGIN
[0m10:10:17.940000 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:10:17.940985 [debug] [MainThread]: On master: COMMIT
[0m10:10:17.940985 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:17.940985 [debug] [MainThread]: On master: COMMIT
[0m10:10:17.944005 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:10:17.944984 [debug] [MainThread]: On master: Close
[0m10:10:17.947495 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:10:17.947495 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:10:17.948495 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:10:17.948495 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:10:17.953511 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:10:17.953511 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:10:17.981090 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:10:17.983090 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:17.983090 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:10:17.983090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:18.035916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m10:10:18.036919 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:18.036919 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:10:18.042916 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:10:18.047437 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:18.047437 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:10:18.051435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:18.053436 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:18.053436 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:10:18.057942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:10:18.072199 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:10:18.073199 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:18.073199 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:10:18.092745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m10:10:18.096789 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:10:18.100789 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:10:18.100789 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:10:18.127840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m10:10:18.129841 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:10:18.131841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57e4b42b-2b3c-4502-b7d6-bcc03f59647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6817F7050>]}
[0m10:10:18.132841 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:10:18.132841 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:10:18.134843 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:18.134843 [debug] [MainThread]: On master: BEGIN
[0m10:10:18.134843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:18.168942 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m10:10:18.168942 [debug] [MainThread]: On master: COMMIT
[0m10:10:18.169928 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:18.169928 [debug] [MainThread]: On master: COMMIT
[0m10:10:18.173927 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:10:18.173927 [debug] [MainThread]: On master: Close
[0m10:10:18.173927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:18.174932 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:10:18.174932 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:10:18.174932 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:10:18.174932 [info ] [MainThread]: 
[0m10:10:18.176249 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m10:10:18.177249 [debug] [MainThread]: Command end result
[0m10:10:18.189777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:10:18.191787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:10:18.196289 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:10:18.196289 [info ] [MainThread]: 
[0m10:10:18.197290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:18.198288 [info ] [MainThread]: 
[0m10:10:18.199294 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:10:18.200289 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:18.200289 after 1.31 seconds
[0m10:10:18.200289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6FAD48CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6FAD48C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6FAD49E10>]}
[0m10:10:18.201291 [debug] [MainThread]: Flushing usage events
[0m10:10:18.897945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:18.345428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D087790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89BF89B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89BF88CD0>]}


============================== 10:12:18.348971 | 032f939d-9855-4fae-997c-f36a413b9f91 ==============================
[0m10:12:18.348971 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:12:18.349985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:12:18.404985 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:12:18.405984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D107610>]}
[0m10:12:18.406985 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:12:18.407986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D0DBD10>]}
[0m10:12:18.509069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D21E7D0>]}
[0m10:12:18.548175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C899118510>]}
[0m10:12:18.549175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:12:18.721052 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:12:18.819108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:12:18.819108 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:12:18.973125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:12:18.982124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D72EB50>]}
[0m10:12:19.028124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:12:19.032123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:12:19.046127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D8E9610>]}
[0m10:12:19.047130 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:12:19.048130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D084E50>]}
[0m10:12:19.049128 [info ] [MainThread]: 
[0m10:12:19.049128 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:12:19.050164 [info ] [MainThread]: 
[0m10:12:19.051163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:19.051163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:12:19.101267 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:12:19.101267 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:12:19.102207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:19.155441 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m10:12:19.157447 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:12:19.160442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:12:19.165539 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:12:19.166538 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:12:19.166538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:19.228334 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m10:12:19.229343 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:12:19.230346 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:12:19.237565 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:12:19.240552 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:12:19.244493 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:12:19.253279 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.253279 [debug] [MainThread]: On master: BEGIN
[0m10:12:19.254270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:19.328164 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m10:12:19.330280 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.332261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:19.341287 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:12:19.344282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D2937D0>]}
[0m10:12:19.344282 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:19.347297 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.348282 [debug] [MainThread]: On master: BEGIN
[0m10:12:19.354860 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:12:19.354860 [debug] [MainThread]: On master: COMMIT
[0m10:12:19.355843 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.355843 [debug] [MainThread]: On master: COMMIT
[0m10:12:19.359843 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:12:19.359843 [debug] [MainThread]: On master: Close
[0m10:12:19.362843 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:12:19.362843 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:12:19.364844 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:12:19.364844 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:12:19.369844 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:12:19.370845 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:12:19.398844 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:12:19.400845 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:12:19.400845 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:12:19.400845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:12:19.466689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m10:12:19.467692 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:12:19.467692 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
    CAST(
        REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS decimal(18, 2)
    )
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:12:19.488175 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CAST"
LINE 57:     CAST(
             ^

[0m10:12:19.489175 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m10:12:19.493189 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:12:19.509336 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:12:19.512333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032f939d-9855-4fae-997c-f36a413b9f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D79F2D0>]}
[0m10:12:19.512333 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.15s]
[0m10:12:19.514331 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:12:19.514331 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m10:12:19.517333 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.517333 [debug] [MainThread]: On master: BEGIN
[0m10:12:19.518384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:19.587568 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m10:12:19.588586 [debug] [MainThread]: On master: COMMIT
[0m10:12:19.588586 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:19.589668 [debug] [MainThread]: On master: COMMIT
[0m10:12:19.593100 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:12:19.594042 [debug] [MainThread]: On master: Close
[0m10:12:19.595042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:19.595042 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:12:19.595996 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:12:19.595996 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:12:19.595996 [info ] [MainThread]: 
[0m10:12:19.596991 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:12:19.597990 [debug] [MainThread]: Command end result
[0m10:12:19.613988 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:12:19.615991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:12:19.621081 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:12:19.621991 [info ] [MainThread]: 
[0m10:12:19.622990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:12:19.623990 [info ] [MainThread]: 
[0m10:12:19.624990 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:12:19.624990 [info ] [MainThread]: 
[0m10:12:19.625994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:19.627991 [debug] [MainThread]: Command `dbt run` failed at 10:12:19.626990 after 1.35 seconds
[0m10:12:19.627991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C897251390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89DC106D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89DC05C10>]}
[0m10:12:19.628989 [debug] [MainThread]: Flushing usage events
[0m10:12:20.367226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:36.549120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942A87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942978090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942AB78D0>]}


============================== 10:12:36.552137 | 8db8ff53-45b1-425f-8cf4-a5de1766314d ==============================
[0m10:12:36.552137 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:12:36.553138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:36.606120 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:12:36.607122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942ADAE10>]}
[0m10:12:36.608167 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:12:36.608167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942AD9310>]}
[0m10:12:36.706445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942CB7AD0>]}
[0m10:12:36.746617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93DAE99D0>]}
[0m10:12:36.747616 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:12:36.929166 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:12:37.028765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:12:37.028765 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:12:37.179962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m10:12:37.188962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942C39650>]}
[0m10:12:37.233965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:12:37.237965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:12:37.251470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9432ED050>]}
[0m10:12:37.252470 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:12:37.253471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93DAEB810>]}
[0m10:12:37.254470 [info ] [MainThread]: 
[0m10:12:37.254470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:12:37.255471 [info ] [MainThread]: 
[0m10:12:37.255471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:37.256473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:12:37.306471 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:12:37.307473 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:12:37.307473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:37.362117 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m10:12:37.363103 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:12:37.364101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:12:37.369120 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:12:37.369120 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:12:37.369120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:37.431284 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m10:12:37.432353 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:12:37.433290 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:12:37.442294 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:12:37.445290 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:12:37.449814 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:12:37.457060 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.457060 [debug] [MainThread]: On master: BEGIN
[0m10:12:37.458060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:37.553156 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m10:12:37.554341 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.555347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:37.565245 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m10:12:37.570348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9430EC710>]}
[0m10:12:37.571343 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:37.576663 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.577675 [debug] [MainThread]: On master: BEGIN
[0m10:12:37.585665 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:12:37.587675 [debug] [MainThread]: On master: COMMIT
[0m10:12:37.588669 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.589672 [debug] [MainThread]: On master: COMMIT
[0m10:12:37.594027 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:12:37.595045 [debug] [MainThread]: On master: Close
[0m10:12:37.603351 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:12:37.604346 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:12:37.606347 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:12:37.607347 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:12:37.619349 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:12:37.621350 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:12:37.651169 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:12:37.652234 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:12:37.653127 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:12:37.653127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:12:37.732942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m10:12:37.733841 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:12:37.733841 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
    CAST(
        REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS decimal(18, 2)
    ),
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:12:37.738882 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CAST"
LINE 57:     CAST(
             ^

[0m10:12:37.738882 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m10:12:37.743011 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:12:37.748930 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:12:37.751930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8db8ff53-45b1-425f-8cf4-a5de1766314d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9435BB6D0>]}
[0m10:12:37.752881 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.14s]
[0m10:12:37.754832 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:12:37.755830 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m10:12:37.757831 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.757831 [debug] [MainThread]: On master: BEGIN
[0m10:12:37.758923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:37.805113 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m10:12:37.806009 [debug] [MainThread]: On master: COMMIT
[0m10:12:37.806009 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:37.807040 [debug] [MainThread]: On master: COMMIT
[0m10:12:37.814008 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m10:12:37.814008 [debug] [MainThread]: On master: Close
[0m10:12:37.815010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:37.815010 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:12:37.816008 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:12:37.816008 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:12:37.816008 [info ] [MainThread]: 
[0m10:12:37.817023 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m10:12:37.818009 [debug] [MainThread]: Command end result
[0m10:12:37.833012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:12:37.835013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:12:37.840014 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:12:37.840014 [info ] [MainThread]: 
[0m10:12:37.842012 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:12:37.844012 [info ] [MainThread]: 
[0m10:12:37.845013 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CAST"
  LINE 57:     CAST(
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:12:37.846515 [info ] [MainThread]: 
[0m10:12:37.847521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:37.849520 [debug] [MainThread]: Command `dbt run` failed at 10:12:37.849520 after 1.36 seconds
[0m10:12:37.850521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93DAD4ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940EC8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F942A86E90>]}
[0m10:12:37.850521 [debug] [MainThread]: Flushing usage events
[0m10:12:38.513423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:33.778211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7287ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B72B7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B5778110>]}


============================== 10:13:33.781321 | 117f761b-3dd8-496c-bf37-3cb8c04f9f03 ==============================
[0m10:13:33.781321 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:13:33.782326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:13:33.830885 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:13:33.831869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B72D92D0>]}
[0m10:13:33.831869 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:13:33.832872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B72DBA90>]}
[0m10:13:33.936391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7284F50>]}
[0m10:13:33.975507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B34095D0>]}
[0m10:13:33.976508 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:13:34.152617 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:13:34.257130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:13:34.258133 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:13:34.411267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:13:34.419371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7959810>]}
[0m10:13:34.465266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:13:34.469273 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:13:34.483308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7AECB90>]}
[0m10:13:34.484293 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:13:34.484293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7284C50>]}
[0m10:13:34.486295 [info ] [MainThread]: 
[0m10:13:34.486295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:34.486295 [info ] [MainThread]: 
[0m10:13:34.487801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:34.488805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:13:34.538920 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:13:34.539863 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:13:34.539863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:34.613615 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m10:13:34.616714 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:13:34.619616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:13:34.629194 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:13:34.630197 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:13:34.630197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:34.685048 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m10:13:34.686047 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:13:34.687051 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:13:34.694305 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:13:34.697291 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:13:34.702267 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:13:34.710440 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:34.712335 [debug] [MainThread]: On master: BEGIN
[0m10:13:34.712335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:34.777590 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m10:13:34.778489 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:34.779492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:13:34.788633 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:13:34.793770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7E71F10>]}
[0m10:13:34.794658 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:34.799293 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:34.800493 [debug] [MainThread]: On master: BEGIN
[0m10:13:34.808542 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:13:34.809510 [debug] [MainThread]: On master: COMMIT
[0m10:13:34.811392 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:34.811392 [debug] [MainThread]: On master: COMMIT
[0m10:13:34.816541 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:13:34.817502 [debug] [MainThread]: On master: Close
[0m10:13:34.826349 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:13:34.827363 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:13:34.829348 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:13:34.830364 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:13:34.843365 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:13:34.844351 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:13:34.870363 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:13:34.871363 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:13:34.872348 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:13:34.872348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:34.947230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m10:13:34.949364 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:13:34.950354 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio,
    CAST(
        REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS decimal(18, 2)
    )
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:13:34.956322 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "valor_abatimento" does not exist
LINE 58:         REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS d...
                                ^

[0m10:13:34.957350 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m10:13:34.970359 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:13:34.977270 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  column "valor_abatimento" does not exist
  LINE 58:         REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS d...
                                  ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:13:34.979269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117f761b-3dd8-496c-bf37-3cb8c04f9f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B78E6590>]}
[0m10:13:34.980254 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.15s]
[0m10:13:34.981254 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:13:34.981254 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  column "valor_abatimento" does not exist
  LINE 58:         REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS d...
                                  ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m10:13:34.983255 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:34.984285 [debug] [MainThread]: On master: BEGIN
[0m10:13:34.984285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:35.030752 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m10:13:35.031806 [debug] [MainThread]: On master: COMMIT
[0m10:13:35.031806 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:35.032723 [debug] [MainThread]: On master: COMMIT
[0m10:13:35.036793 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:13:35.037809 [debug] [MainThread]: On master: Close
[0m10:13:35.038765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:35.039704 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:13:35.039704 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:13:35.039704 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:13:35.039704 [info ] [MainThread]: 
[0m10:13:35.041718 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:13:35.043711 [debug] [MainThread]: Command end result
[0m10:13:35.065701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:13:35.068705 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:13:35.072796 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:13:35.073703 [info ] [MainThread]: 
[0m10:13:35.074750 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:13:35.074750 [info ] [MainThread]: 
[0m10:13:35.075828 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  column "valor_abatimento" does not exist
  LINE 58:         REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS d...
                                  ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:13:35.076690 [info ] [MainThread]: 
[0m10:13:35.077697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:13:35.078696 [debug] [MainThread]: Command `dbt run` failed at 10:13:35.078696 after 1.36 seconds
[0m10:13:35.078696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B5778110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B54B13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B7401C50>]}
[0m10:13:35.079696 [debug] [MainThread]: Flushing usage events
[0m10:13:35.777511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:11.991585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542DD7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542E2AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542DD6890>]}


============================== 10:19:11.996584 | 3858fa5f-274a-4f75-97da-0f1658e82b15 ==============================
[0m10:19:11.996584 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:19:11.997584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m10:19:12.058605 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:19:12.059589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542E29B90>]}
[0m10:19:12.059589 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:19:12.060589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542E686D0>]}
[0m10:19:12.176855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542F3FE90>]}
[0m10:19:12.218924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053EEE8590>]}
[0m10:19:12.220925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:19:12.412680 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:19:12.543335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:12.543335 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:19:12.697678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m10:19:12.706561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205440B1C10>]}
[0m10:19:12.752769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:19:12.756590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:19:12.778317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205446ED410>]}
[0m10:19:12.778317 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:19:12.779317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542DD4DD0>]}
[0m10:19:12.780317 [info ] [MainThread]: 
[0m10:19:12.781317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:12.781317 [info ] [MainThread]: 
[0m10:19:12.782450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:12.783461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:19:12.844825 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:19:12.845826 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:19:12.845826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:12.901335 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m10:19:12.902333 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:19:12.904317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:19:12.908318 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:19:12.909319 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:19:12.909319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:12.937756 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m10:19:12.937756 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:19:12.937756 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:12.944758 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:19:12.946759 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:19:12.949977 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:19:12.954477 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:12.955464 [debug] [MainThread]: On master: BEGIN
[0m10:19:12.955464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:13.009788 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m10:19:13.011899 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:13.012790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:13.022435 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:19:13.025445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205440F37D0>]}
[0m10:19:13.026445 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:13.030446 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:13.031447 [debug] [MainThread]: On master: BEGIN
[0m10:19:13.039129 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:19:13.041148 [debug] [MainThread]: On master: COMMIT
[0m10:19:13.042159 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:13.043158 [debug] [MainThread]: On master: COMMIT
[0m10:19:13.047421 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:19:13.048471 [debug] [MainThread]: On master: Close
[0m10:19:13.055251 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:19:13.056341 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:19:13.058244 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:19:13.059349 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:19:13.071958 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:19:13.072957 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:19:13.097956 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:19:13.099970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:19:13.099970 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:19:13.100957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:19:13.130308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:19:13.131308 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:19:13.132311 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio,
    CAST(
        REGEXP_REPLACE(valor_abatimento, ',', '.', 'g') AS decimal(18, 2)
    ),
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:19:13.137312 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 60: FROM 
         ^

[0m10:19:13.138315 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m10:19:13.143318 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:19:13.154318 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "FROM"
  LINE 60: FROM 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:19:13.156421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3858fa5f-274a-4f75-97da-0f1658e82b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054450D490>]}
[0m10:19:13.157318 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.10s]
[0m10:19:13.158321 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:19:13.159317 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "FROM"
  LINE 60: FROM 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m10:19:13.161318 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:13.161318 [debug] [MainThread]: On master: BEGIN
[0m10:19:13.162314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:13.195130 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m10:19:13.196172 [debug] [MainThread]: On master: COMMIT
[0m10:19:13.196172 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:13.197066 [debug] [MainThread]: On master: COMMIT
[0m10:19:13.200187 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:19:13.201165 [debug] [MainThread]: On master: Close
[0m10:19:13.201165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:13.201165 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:19:13.202094 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:19:13.202094 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:19:13.202094 [info ] [MainThread]: 
[0m10:19:13.203067 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m10:19:13.204066 [debug] [MainThread]: Command end result
[0m10:19:13.218064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:19:13.220065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:19:13.226076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:19:13.226076 [info ] [MainThread]: 
[0m10:19:13.227066 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:13.229070 [info ] [MainThread]: 
[0m10:19:13.230067 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "FROM"
  LINE 60: FROM 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:19:13.231066 [info ] [MainThread]: 
[0m10:19:13.232066 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:13.234177 [debug] [MainThread]: Command `dbt run` failed at 10:19:13.233068 after 1.31 seconds
[0m10:19:13.234177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542DDD790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542CD8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542DD4990>]}
[0m10:19:13.235068 [debug] [MainThread]: Flushing usage events
[0m10:19:13.959128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:06.697376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445487250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194454DAB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194454DA650>]}


============================== 10:21:06.701375 | dd3ba805-454c-4fe5-b7ed-cb37efedfb02 ==============================
[0m10:21:06.701375 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:21:06.703356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:21:06.763359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:21:06.764359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194454E5890>]}
[0m10:21:06.765363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:21:06.765363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194454E5890>]}
[0m10:21:06.884970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445519590>]}
[0m10:21:06.927519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019441509750>]}
[0m10:21:06.928534 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:21:07.129181 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:21:07.241784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:21:07.241784 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:21:07.412648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:21:07.421381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194456028D0>]}
[0m10:21:07.469295 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:21:07.473285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:21:07.495113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445CED310>]}
[0m10:21:07.496150 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:21:07.496150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445484A50>]}
[0m10:21:07.497114 [info ] [MainThread]: 
[0m10:21:07.498113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:21:07.498113 [info ] [MainThread]: 
[0m10:21:07.499112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:07.500113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:21:07.553873 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:21:07.553873 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:21:07.554873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:07.653662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.099 seconds
[0m10:21:07.656743 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:21:07.659742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:21:07.668737 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:21:07.669735 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:21:07.669735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:07.783402 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m10:21:07.784496 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:21:07.785398 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:21:07.794382 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m10:21:07.797501 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:21:07.805517 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:21:07.815497 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:07.816400 [debug] [MainThread]: On master: BEGIN
[0m10:21:07.817504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:07.912245 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m10:21:07.914095 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:07.915166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:07.935341 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m10:21:07.938356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445F59DD0>]}
[0m10:21:07.939358 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:07.958350 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:07.959357 [debug] [MainThread]: On master: BEGIN
[0m10:21:07.984664 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m10:21:07.985565 [debug] [MainThread]: On master: COMMIT
[0m10:21:07.985565 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:07.986565 [debug] [MainThread]: On master: COMMIT
[0m10:21:07.997675 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m10:21:07.998732 [debug] [MainThread]: On master: Close
[0m10:21:08.002813 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:21:08.002813 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:21:08.003813 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:21:08.003813 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:21:08.009814 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:21:08.010814 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:21:08.037815 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:21:08.038816 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:21:08.039815 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:21:08.039815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:21:08.147476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m10:21:08.150475 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:21:08.152472 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio,
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:21:08.159142 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELECT"
LINE 56: SELECT 
         ^

[0m10:21:08.160140 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m10:21:08.171243 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:21:08.184923 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "SELECT"
  LINE 56: SELECT 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:21:08.187918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd3ba805-454c-4fe5-b7ed-cb37efedfb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944606F450>]}
[0m10:21:08.187918 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.18s]
[0m10:21:08.189917 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:21:08.190424 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "SELECT"
  LINE 56: SELECT 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m10:21:08.192430 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.192430 [debug] [MainThread]: On master: BEGIN
[0m10:21:08.193529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:08.297617 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m10:21:08.298608 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.299609 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.301605 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.309713 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m10:21:08.310602 [debug] [MainThread]: On master: Close
[0m10:21:08.310602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:08.310602 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:21:08.311599 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:21:08.311599 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:21:08.311599 [info ] [MainThread]: 
[0m10:21:08.313042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m10:21:08.315098 [debug] [MainThread]: Command end result
[0m10:21:08.335049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:21:08.337065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:21:08.343046 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:21:08.344046 [info ] [MainThread]: 
[0m10:21:08.345047 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:21:08.345047 [info ] [MainThread]: 
[0m10:21:08.346047 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "SELECT"
  LINE 56: SELECT 
           ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m10:21:08.346047 [info ] [MainThread]: 
[0m10:21:08.347047 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:21:08.349046 [debug] [MainThread]: Command `dbt run` failed at 10:21:08.349046 after 1.71 seconds
[0m10:21:08.349046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194454B65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001943F659850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019445388190>]}
[0m10:21:08.350046 [debug] [MainThread]: Flushing usage events
[0m10:21:09.469517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:31.949552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7B87C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7B87490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7B87410>]}


============================== 10:22:31.953554 | a93b7ae9-f198-40c1-9bc1-73644d250496 ==============================
[0m10:22:31.953554 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:22:31.954556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:32.014561 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:22:32.015563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7BDB3D0>]}
[0m10:22:32.016561 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:22:32.016561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7BDB3D0>]}
[0m10:22:32.138135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B7D46CD0>]}
[0m10:22:32.183134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B2C78190>]}
[0m10:22:32.184134 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:22:32.370258 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:22:32.477059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:32.478061 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:22:32.629586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:22:32.639587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B8019950>]}
[0m10:22:32.685586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:22:32.689585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:22:32.715672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B83ECA90>]}
[0m10:22:32.715672 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:22:32.716673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B823B890>]}
[0m10:22:32.717672 [info ] [MainThread]: 
[0m10:22:32.718672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:32.719674 [info ] [MainThread]: 
[0m10:22:32.719674 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:32.720671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:22:32.776209 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:22:32.777208 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:22:32.777208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:32.819212 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m10:22:32.821213 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:22:32.822213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:22:32.826240 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:22:32.826240 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:22:32.827241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:32.879240 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m10:22:32.880241 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:22:32.880241 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:22:32.887241 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:22:32.888241 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:22:32.892241 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:22:32.896240 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:32.896240 [debug] [MainThread]: On master: BEGIN
[0m10:22:32.897240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:32.948233 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m10:22:32.949220 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:32.950232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:22:32.959093 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m10:22:32.963225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B82C14D0>]}
[0m10:22:32.964222 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:32.969422 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:32.970442 [debug] [MainThread]: On master: BEGIN
[0m10:22:32.978935 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:22:32.979860 [debug] [MainThread]: On master: COMMIT
[0m10:22:32.981861 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:32.982862 [debug] [MainThread]: On master: COMMIT
[0m10:22:32.988957 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:22:32.991907 [debug] [MainThread]: On master: Close
[0m10:22:32.995664 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:22:32.996682 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:22:32.997663 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:22:32.997663 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:22:33.004679 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:22:33.004679 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:22:33.035214 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:22:33.036214 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.037245 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:22:33.037245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:22:33.089059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m10:22:33.091066 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.092161 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:22:33.099351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:22:33.109336 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.110448 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:22:33.118763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:22:33.122628 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.123628 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:22:33.128256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:22:33.142138 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:22:33.143139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.143139 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:22:33.164432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:22:33.168447 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:22:33.172430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:22:33.172430 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:22:33.188744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m10:22:33.191912 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:22:33.193813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a93b7ae9-f198-40c1-9bc1-73644d250496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B86CA750>]}
[0m10:22:33.194813 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m10:22:33.195811 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:22:33.197811 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:33.197811 [debug] [MainThread]: On master: BEGIN
[0m10:22:33.198810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:33.231729 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:22:33.233729 [debug] [MainThread]: On master: COMMIT
[0m10:22:33.233729 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:33.234761 [debug] [MainThread]: On master: COMMIT
[0m10:22:33.238729 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:22:33.239729 [debug] [MainThread]: On master: Close
[0m10:22:33.240732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:33.240732 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:22:33.241731 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:22:33.241731 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:22:33.241731 [info ] [MainThread]: 
[0m10:22:33.242731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:22:33.243731 [debug] [MainThread]: Command end result
[0m10:22:33.258754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:22:33.260728 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:22:33.266732 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:22:33.267728 [info ] [MainThread]: 
[0m10:22:33.268728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:33.269415 [info ] [MainThread]: 
[0m10:22:33.269415 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:22:33.270421 [debug] [MainThread]: Command `dbt run` succeeded at 10:22:33.270421 after 1.37 seconds
[0m10:22:33.271534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B1D98CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B1D98C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B1D99E10>]}
[0m10:22:33.272420 [debug] [MainThread]: Flushing usage events
[0m10:22:33.971832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:34.460298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8D85450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8AB0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8D874D0>]}


============================== 10:25:34.465299 | 814cf6a2-28f1-456f-bce7-da4d7802b3ce ==============================
[0m10:25:34.465299 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:34.466297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m10:25:34.527469 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:25:34.528465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8DE7B10>]}
[0m10:25:34.528465 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:25:34.529485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8DDBD10>]}
[0m10:25:34.651567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8FB3150>]}
[0m10:25:34.690596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D4E39690>]}
[0m10:25:34.693106 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:34.882082 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:35.003633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:35.004529 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m10:25:35.158500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m10:25:35.168389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115DA2C7090>]}
[0m10:25:35.214018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:25:35.219039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:25:35.240246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115DA5EC790>]}
[0m10:25:35.240246 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:25:35.241283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115DA50B5D0>]}
[0m10:25:35.242247 [info ] [MainThread]: 
[0m10:25:35.243247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:35.243247 [info ] [MainThread]: 
[0m10:25:35.244245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:35.245386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:25:35.301392 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:25:35.302373 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:25:35.302373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:35.384488 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m10:25:35.386475 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:25:35.388475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:25:35.391977 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:35.391977 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:25:35.392984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:35.585843 [debug] [ThreadPool]: SQL status: BEGIN in 0.193 seconds
[0m10:25:35.588869 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:35.589986 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:25:35.597550 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m10:25:35.599496 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:25:35.602996 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:25:35.608104 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:35.609000 [debug] [MainThread]: On master: BEGIN
[0m10:25:35.610123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:35.693655 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m10:25:35.694657 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:35.694657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:35.724908 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m10:25:35.726914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D8FF3850>]}
[0m10:25:35.727915 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:35.731924 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:35.732911 [debug] [MainThread]: On master: BEGIN
[0m10:25:35.740061 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:25:35.740061 [debug] [MainThread]: On master: COMMIT
[0m10:25:35.741074 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:35.741074 [debug] [MainThread]: On master: COMMIT
[0m10:25:35.745162 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:25:35.745162 [debug] [MainThread]: On master: Close
[0m10:25:35.750174 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:25:35.750174 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m10:25:35.751174 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:25:35.752176 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:25:35.758174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:25:35.760175 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:25:35.787220 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:25:35.789204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.789204 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:25:35.789204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:35.855978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m10:25:35.856975 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.857983 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m10:25:35.867008 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:25:35.878133 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.879114 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:25:35.884111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:35.888063 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.888063 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:25:35.907536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m10:25:35.927545 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:25:35.927545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.927545 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:25:35.965448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m10:25:35.976554 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:25:35.980658 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:25:35.980658 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:25:36.020393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.039 seconds
[0m10:25:36.028909 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:25:36.032908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814cf6a2-28f1-456f-bce7-da4d7802b3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115DA41D250>]}
[0m10:25:36.033909 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:25:36.035956 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:25:36.038906 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:36.040013 [debug] [MainThread]: On master: BEGIN
[0m10:25:36.040908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:36.109839 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m10:25:36.111840 [debug] [MainThread]: On master: COMMIT
[0m10:25:36.112839 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:36.113840 [debug] [MainThread]: On master: COMMIT
[0m10:25:36.119839 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m10:25:36.120850 [debug] [MainThread]: On master: Close
[0m10:25:36.122857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:36.123852 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:25:36.124852 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:25:36.124852 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:25:36.125838 [info ] [MainThread]: 
[0m10:25:36.127895 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m10:25:36.129899 [debug] [MainThread]: Command end result
[0m10:25:36.153910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m10:25:36.155889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m10:25:36.160888 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m10:25:36.161889 [info ] [MainThread]: 
[0m10:25:36.162888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:25:36.163896 [info ] [MainThread]: 
[0m10:25:36.164887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:25:36.165938 [debug] [MainThread]: Command `dbt run` succeeded at 10:25:36.165938 after 1.79 seconds
[0m10:25:36.165938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D3F58CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D3F58C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115D4E24E50>]}
[0m10:25:36.166888 [debug] [MainThread]: Flushing usage events
[0m10:25:36.925240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:03.997773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CB85C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CB87FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CB87BD0>]}


============================== 13:25:04.012072 | 88946871-92e9-43c7-8381-cc13c228be75 ==============================
[0m13:25:04.012072 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:25:04.014071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:25:04.290181 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:25:04.291181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CC1CE10>]}
[0m13:25:04.292181 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:25:04.293182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CCDE350>]}
[0m13:25:04.455590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8CCEECD0>]}
[0m13:25:04.493594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E87C299D0>]}
[0m13:25:04.500823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:25:04.794353 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:25:05.275587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:05.275587 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m13:25:05.437041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m13:25:05.446056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8D20CF10>]}
[0m13:25:05.492985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:25:05.497328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:25:05.653588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8D3ECAD0>]}
[0m13:25:05.653588 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:25:05.654588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8D00F0D0>]}
[0m13:25:05.655588 [info ] [MainThread]: 
[0m13:25:05.656586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:05.656586 [info ] [MainThread]: 
[0m13:25:05.657587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:05.658586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:25:06.981073 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:25:06.982076 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:25:06.983073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:07.150056 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.167 seconds
[0m13:25:07.151057 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:25:07.153056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:25:07.160056 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:25:07.160056 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:25:07.160056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:07.321289 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m13:25:07.322295 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:25:07.322295 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:25:07.360287 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.037 seconds
[0m13:25:07.362295 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:25:07.410896 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:25:07.415876 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:07.415876 [debug] [MainThread]: On master: BEGIN
[0m13:25:07.416873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:07.683415 [debug] [MainThread]: SQL status: BEGIN in 0.267 seconds
[0m13:25:07.683415 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:07.684414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:25:07.706921 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m13:25:07.707925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8D4035D0>]}
[0m13:25:07.708925 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:07.739925 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:07.739925 [debug] [MainThread]: On master: BEGIN
[0m13:25:07.772924 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m13:25:07.773925 [debug] [MainThread]: On master: COMMIT
[0m13:25:07.773925 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:07.773925 [debug] [MainThread]: On master: COMMIT
[0m13:25:07.779924 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m13:25:07.780924 [debug] [MainThread]: On master: Close
[0m13:25:07.783927 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:25:07.784925 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m13:25:07.786926 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:25:07.786926 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:25:07.791927 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:25:07.793931 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:25:07.821494 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:25:07.822493 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:07.823477 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:25:07.823477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:07.971804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m13:25:07.971804 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:07.972792 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

-- Modelo para criar a views de titulos em abertos , já com a transformação ideal do tipo de dados a ser utilizado no banco de dados , visando melhor performance dos dados

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint -- removendo caracteres especiais
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint --removendo caracteres especiais 
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    CAST(op AS integer) AS op, --conversao para tipo inteiro
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) -- removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)  -- removendo caracters especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:25:08.004981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m13:25:08.009430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:08.010429 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:25:08.038846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:25:08.041847 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:08.041847 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:25:08.070863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:25:08.083848 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:25:08.083848 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:08.084847 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:25:08.105966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m13:25:08.111559 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:25:08.115560 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:25:08.115560 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:25:08.139440 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m13:25:08.141442 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:25:08.150457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88946871-92e9-43c7-8381-cc13c228be75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8D7EDC10>]}
[0m13:25:08.150457 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m13:25:08.152443 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:25:08.153441 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:08.154442 [debug] [MainThread]: On master: BEGIN
[0m13:25:08.154442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:08.305557 [debug] [MainThread]: SQL status: BEGIN in 0.151 seconds
[0m13:25:08.306559 [debug] [MainThread]: On master: COMMIT
[0m13:25:08.306559 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:08.306559 [debug] [MainThread]: On master: COMMIT
[0m13:25:08.346018 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m13:25:08.347018 [debug] [MainThread]: On master: Close
[0m13:25:08.347018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:08.348019 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:25:08.348019 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:25:08.348019 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:25:08.348019 [info ] [MainThread]: 
[0m13:25:08.349018 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m13:25:08.350020 [debug] [MainThread]: Command end result
[0m13:25:08.363023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:25:08.366019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:25:08.371020 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m13:25:08.372024 [info ] [MainThread]: 
[0m13:25:08.374022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:08.374022 [info ] [MainThread]: 
[0m13:25:08.375021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:25:08.378027 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:08.377019 after 4.45 seconds
[0m13:25:08.379021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E86D48CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E86D48C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E87C14FD0>]}
[0m13:25:08.380023 [debug] [MainThread]: Flushing usage events
[0m13:25:09.354449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:24.057436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC4787E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC47D9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC4787390>]}


============================== 13:45:24.063438 | 05d8a87e-a6e4-4fd4-8e32-1379e6115564 ==============================
[0m13:45:24.063438 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:45:24.065420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:24.131936 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:45:24.132937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC47DB3D0>]}
[0m13:45:24.132937 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:45:24.133936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC47DBD10>]}
[0m13:45:24.288094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC495ECD0>]}
[0m13:45:24.329017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBF7D9910>]}
[0m13:45:24.331011 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:45:24.619636 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:45:24.785937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:24.786939 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m13:45:24.942376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m13:45:24.950531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC48EE390>]}
[0m13:45:24.996407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:45:25.000408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:45:25.023874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC4FECE50>]}
[0m13:45:25.024881 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:45:25.024881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC4784F50>]}
[0m13:45:25.026906 [info ] [MainThread]: 
[0m13:45:25.026906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:25.027879 [info ] [MainThread]: 
[0m13:45:25.027879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:25.029880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:45:25.095607 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:45:25.096610 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:45:25.096610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:25.292844 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.196 seconds
[0m13:45:25.294845 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:45:25.296844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:45:25.300843 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:45:25.300843 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:45:25.300843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:25.456720 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m13:45:25.457724 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:45:25.458724 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:45:25.489928 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m13:45:25.490993 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:45:25.523102 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:45:25.532198 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.533807 [debug] [MainThread]: On master: BEGIN
[0m13:45:25.533807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:25.724165 [debug] [MainThread]: SQL status: BEGIN in 0.190 seconds
[0m13:45:25.725165 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.725165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:25.758174 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m13:45:25.760174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC4E9AB10>]}
[0m13:45:25.760174 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:25.788899 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.789898 [debug] [MainThread]: On master: BEGIN
[0m13:45:25.827571 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m13:45:25.828571 [debug] [MainThread]: On master: COMMIT
[0m13:45:25.829571 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.829571 [debug] [MainThread]: On master: COMMIT
[0m13:45:25.857456 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m13:45:25.858457 [debug] [MainThread]: On master: Close
[0m13:45:25.861457 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:45:25.861457 [info ] [Thread-2 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m13:45:25.862457 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:45:25.863458 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:45:25.870457 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:45:25.873461 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:45:25.906456 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:45:25.907459 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:25.907459 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:45:25.908457 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:45:26.093674 [debug] [Thread-2 (]: SQL status: BEGIN in 0.185 seconds
[0m13:45:26.094671 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:26.096673 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

-- Modelo para criar a views de titulos em abertos , já com a transformação ideal do tipo de dados a ser utilizado no banco de dados , visando melhor performance dos dados

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g') AS bigint -- removendo caracteres especiais
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g') AS bigint --removendo caracteres especiais 
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS data_emissao,
    documento,
    etapa,
    historico,
   CAST(id_titulo AS integer) AS id_titulo, --conversao para tipo inteiro
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,      --conversao para tipo inteiro
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) -- removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)  -- removendo caracters especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:45:26.124279 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m13:45:26.135609 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:26.136599 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:45:26.157117 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m13:45:26.165359 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:26.166352 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:45:26.196579 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m13:45:26.218907 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:45:26.218907 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:26.218907 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:45:26.262135 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m13:45:26.274271 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:45:26.279268 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:45:26.279268 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:45:26.297553 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m13:45:26.301551 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:45:26.304646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05d8a87e-a6e4-4fd4-8e32-1379e6115564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC52C9E90>]}
[0m13:45:26.306099 [info ] [Thread-2 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:45:26.308175 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:45:26.310648 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:26.311781 [debug] [MainThread]: On master: BEGIN
[0m13:45:26.311781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:26.495371 [debug] [MainThread]: SQL status: BEGIN in 0.183 seconds
[0m13:45:26.496502 [debug] [MainThread]: On master: COMMIT
[0m13:45:26.498391 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:26.499450 [debug] [MainThread]: On master: COMMIT
[0m13:45:26.532820 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m13:45:26.535018 [debug] [MainThread]: On master: Close
[0m13:45:26.536910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:26.538433 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:45:26.539552 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:45:26.539552 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:45:26.540518 [info ] [MainThread]: 
[0m13:45:26.542451 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m13:45:26.544453 [debug] [MainThread]: Command end result
[0m13:45:26.567540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:45:26.574442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:45:26.581443 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m13:45:26.581443 [info ] [MainThread]: 
[0m13:45:26.582656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:26.583665 [info ] [MainThread]: 
[0m13:45:26.583665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:45:26.584671 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:26.584671 after 2.58 seconds
[0m13:45:26.585686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC47B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE911390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE8F8CD0>]}
[0m13:45:26.585686 [debug] [MainThread]: Flushing usage events
[0m13:45:27.370274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:18.366592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43B85490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43B87AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43B87CD0>]}


============================== 13:59:18.371586 | 89b627fb-08de-4c6c-b2cc-c5202f39412f ==============================
[0m13:59:18.371586 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:59:18.372569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m13:59:18.457820 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:59:18.458820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43BDB590>]}
[0m13:59:18.459819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:59:18.460819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43BDA810>]}
[0m13:59:18.639102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43BE5790>]}
[0m13:59:18.680112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A3EC49AD0>]}
[0m13:59:18.681999 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:59:18.950633 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:59:19.125561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:19.126566 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m13:59:19.294866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m13:59:19.303601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A4422D490>]}
[0m13:59:19.354003 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:59:19.358004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:59:19.392896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A443EC710>]}
[0m13:59:19.392896 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:59:19.393896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43B84CD0>]}
[0m13:59:19.394896 [info ] [MainThread]: 
[0m13:59:19.395896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:19.395896 [info ] [MainThread]: 
[0m13:59:19.396881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:19.397896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:59:19.481765 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:59:19.481765 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:59:19.482766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:19.521535 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m13:59:19.522541 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:59:19.524249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:59:19.528270 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:59:19.528270 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:59:19.529256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:19.596303 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m13:59:19.596303 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:59:19.597819 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:19.605984 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m13:59:19.609002 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:59:19.613068 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:59:19.619666 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.620666 [debug] [MainThread]: On master: BEGIN
[0m13:59:19.620666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:19.670981 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m13:59:19.670981 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.671981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:19.679981 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:59:19.680983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A443EDFD0>]}
[0m13:59:19.681981 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:19.684984 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.684984 [debug] [MainThread]: On master: BEGIN
[0m13:59:19.691985 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:59:19.691985 [debug] [MainThread]: On master: COMMIT
[0m13:59:19.692985 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.692985 [debug] [MainThread]: On master: COMMIT
[0m13:59:19.696984 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:59:19.696984 [debug] [MainThread]: On master: Close
[0m13:59:19.699078 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:59:19.700079 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m13:59:19.701078 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:59:19.701078 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:59:19.707077 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:59:19.708079 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:59:19.739078 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:59:19.741078 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:19.741078 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:59:19.742078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:19.785080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:59:19.786080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:19.786080 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    COALESCE(
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g'), '') AS bigint), 0
    ) AS cpf_cnpj_cedente,
    COALESCE(
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g'), '') AS bigint), 0
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(TO_DATE(data_emissao, 'DD/MM/YYYY') AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
        CAST(NULLIF(op, '') AS integer), 0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)) AS valor,
    CAST(REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)) AS valor_juros,
    CAST(REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)) AS valor_multa,
    CAST(REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)) AS valor_tarifas,
    CAST(REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)) AS valor_total,
    CAST(TO_DATE(vencimento, 'DD/MM/YYYY') AS date) AS vencimento,
    CAST(REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto";
  );
[0m13:59:19.790080 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 42:     "operacoes"."public"."f_titulosemaberto";
                                                     ^

[0m13:59:19.790080 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m13:59:19.794080 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:59:19.944294 [debug] [Thread-1 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 42:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m13:59:19.946294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b627fb-08de-4c6c-b2cc-c5202f39412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A446C8A10>]}
[0m13:59:19.947294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.25s]
[0m13:59:19.948293 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:59:19.948293 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 42:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m13:59:19.950293 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.950293 [debug] [MainThread]: On master: BEGIN
[0m13:59:19.951295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:19.980485 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m13:59:19.981468 [debug] [MainThread]: On master: COMMIT
[0m13:59:19.981468 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:19.982469 [debug] [MainThread]: On master: COMMIT
[0m13:59:19.985490 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:59:19.986474 [debug] [MainThread]: On master: Close
[0m13:59:19.986474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:19.987475 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:59:19.987475 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:59:19.987475 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:59:19.988475 [info ] [MainThread]: 
[0m13:59:19.988475 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m13:59:19.989474 [debug] [MainThread]: Command end result
[0m13:59:20.004162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:59:20.006162 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:59:20.013163 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m13:59:20.014163 [info ] [MainThread]: 
[0m13:59:20.015164 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:59:20.016162 [info ] [MainThread]: 
[0m13:59:20.017163 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near ";"
  LINE 42:     "operacoes"."public"."f_titulosemaberto";
                                                       ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m13:59:20.017821 [info ] [MainThread]: 
[0m13:59:20.018825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:59:20.019825 [debug] [MainThread]: Command `dbt run` failed at 13:59:20.018825 after 1.75 seconds
[0m13:59:20.019825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43067ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A3DD69810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A43D82910>]}
[0m13:59:20.019825 [debug] [MainThread]: Flushing usage events
[0m13:59:20.733563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:33.350172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9887A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9788510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9789A50>]}


============================== 13:59:33.354188 | 2b31f037-cb6e-417a-ac10-975a9107086e ==============================
[0m13:59:33.354188 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:59:33.355172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:33.408179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:59:33.408179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9886A50>]}
[0m13:59:33.409177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:59:33.410177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD98DBD10>]}
[0m13:59:33.517438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD98E5550>]}
[0m13:59:33.558739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD48B9690>]}
[0m13:59:33.559740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:59:33.744812 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:59:33.853879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:33.854880 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m13:59:34.030930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m13:59:34.039929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9A47D10>]}
[0m13:59:34.092929 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:59:34.096929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:59:34.113932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDA0ECDD0>]}
[0m13:59:34.113932 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:59:34.114952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9FC3B50>]}
[0m13:59:34.115934 [info ] [MainThread]: 
[0m13:59:34.116934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:34.117934 [info ] [MainThread]: 
[0m13:59:34.118933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:34.119952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:59:34.177953 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:59:34.177953 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:59:34.178951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:34.453010 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.274 seconds
[0m13:59:34.454009 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:59:34.456136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:59:34.460135 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:59:34.461137 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:59:34.461137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:34.687559 [debug] [ThreadPool]: SQL status: BEGIN in 0.226 seconds
[0m13:59:34.688583 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:59:34.688583 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:34.720102 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m13:59:34.721135 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:59:34.749106 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:59:34.753110 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:34.753110 [debug] [MainThread]: On master: BEGIN
[0m13:59:34.754112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:34.959268 [debug] [MainThread]: SQL status: BEGIN in 0.205 seconds
[0m13:59:34.960270 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:34.960270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:34.988727 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m13:59:34.990727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9D0F3D0>]}
[0m13:59:34.990727 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:35.018491 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:35.019489 [debug] [MainThread]: On master: BEGIN
[0m13:59:35.081153 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m13:59:35.082154 [debug] [MainThread]: On master: COMMIT
[0m13:59:35.083152 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:35.083152 [debug] [MainThread]: On master: COMMIT
[0m13:59:35.110596 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m13:59:35.111597 [debug] [MainThread]: On master: Close
[0m13:59:35.114605 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:59:35.114605 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m13:59:35.115595 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:59:35.115595 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:59:35.122105 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:59:35.123105 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:59:35.154107 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:59:35.155107 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.156108 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:59:35.156108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:35.377947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m13:59:35.377947 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.378949 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    COALESCE(
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[\.\-\/]', '', 'g'), '') AS bigint), 0
    ) AS cpf_cnpj_cedente,
    COALESCE(
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[\.\-\/]', '', 'g'), '') AS bigint), 0
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(TO_DATE(data_emissao, 'DD/MM/YYYY') AS date) AS data_emissao,
    documento,
    etapa,
    historico,
    id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
        CAST(NULLIF(op, '') AS integer), 0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(REGEXP_REPLACE(valor, ',', '.', 'g') AS decimal(18, 2)) AS valor,
    CAST(REGEXP_REPLACE(valor_juros, ',', '.', 'g') AS decimal(18, 2)) AS valor_juros,
    CAST(REGEXP_REPLACE(valor_multa, ',', '.', 'g') AS decimal(18, 2)) AS valor_multa,
    CAST(REGEXP_REPLACE(valor_tarifas, ',', '.', 'g') AS decimal(18, 2)) AS valor_tarifas,
    CAST(REGEXP_REPLACE(valor_total, ',', '.', 'g') AS decimal(18, 2)) AS valor_total,
    CAST(TO_DATE(vencimento, 'DD/MM/YYYY') AS date) AS vencimento,
    CAST(REGEXP_REPLACE(desagio, ',', '.', 'g') AS decimal(18, 2)) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:59:35.407950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m13:59:35.412953 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.412953 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:59:35.441979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:59:35.443979 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.444979 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:59:35.474980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m13:59:35.487980 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:59:35.488979 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.488979 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:59:35.534002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m13:59:35.539000 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:59:35.542984 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:59:35.542984 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:59:35.584918 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.041 seconds
[0m13:59:35.588034 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:59:35.590130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b31f037-cb6e-417a-ac10-975a9107086e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDA411C10>]}
[0m13:59:35.591033 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.47s]
[0m13:59:35.592032 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:59:35.594031 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:35.594031 [debug] [MainThread]: On master: BEGIN
[0m13:59:35.594031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:35.848777 [debug] [MainThread]: SQL status: BEGIN in 0.254 seconds
[0m13:59:35.849870 [debug] [MainThread]: On master: COMMIT
[0m13:59:35.850780 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:35.851778 [debug] [MainThread]: On master: COMMIT
[0m13:59:35.888298 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m13:59:35.889302 [debug] [MainThread]: On master: Close
[0m13:59:35.890301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:35.891299 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:59:35.892301 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:59:35.893301 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:59:35.894301 [info ] [MainThread]: 
[0m13:59:35.895300 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m13:59:35.897299 [debug] [MainThread]: Command end result
[0m13:59:35.911388 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m13:59:35.913389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m13:59:35.917388 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m13:59:35.918386 [info ] [MainThread]: 
[0m13:59:35.919385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:35.920393 [info ] [MainThread]: 
[0m13:59:35.920916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:59:35.921963 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:35.921963 after 2.63 seconds
[0m13:59:35.922965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD98B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD969F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD39D8CD0>]}
[0m13:59:35.922965 [debug] [MainThread]: Flushing usage events
[0m13:59:36.630545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:20.432999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F386E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B206D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F290510>]}


============================== 14:04:20.438001 | ccfdcd38-ff8f-4b66-a971-c6b96ac8a482 ==============================
[0m14:04:20.438001 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:20.439009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m14:04:20.510065 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:04:20.511064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F387990>]}
[0m14:04:20.512062 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:04:20.513063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F406950>]}
[0m14:04:20.670043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F3E5850>]}
[0m14:04:20.711075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F5F6050>]}
[0m14:04:20.712077 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:21.011502 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:04:21.154050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:21.155057 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m14:04:21.315640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m14:04:21.324640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F5D0410>]}
[0m14:04:21.377687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m14:04:21.381688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m14:04:21.404792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3FBECF10>]}
[0m14:04:21.404792 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m14:04:21.405791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3FB0A490>]}
[0m14:04:21.406794 [info ] [MainThread]: 
[0m14:04:21.407792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:04:21.407792 [info ] [MainThread]: 
[0m14:04:21.408792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:21.409791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:04:21.465405 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:04:21.465405 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:04:21.466404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:21.544086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.078 seconds
[0m14:04:21.546243 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:04:21.546911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:04:21.550911 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:04:21.551916 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:04:21.551916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:21.607141 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m14:04:21.607141 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:04:21.608155 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:04:21.616644 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m14:04:21.618656 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:04:21.622656 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:04:21.629656 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.629656 [debug] [MainThread]: On master: BEGIN
[0m14:04:21.629656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:21.686429 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m14:04:21.688279 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.689382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:21.699009 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m14:04:21.702008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3FBF3ED0>]}
[0m14:04:21.703010 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:21.707529 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.708528 [debug] [MainThread]: On master: BEGIN
[0m14:04:21.716526 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:04:21.717527 [debug] [MainThread]: On master: COMMIT
[0m14:04:21.717527 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.718526 [debug] [MainThread]: On master: COMMIT
[0m14:04:21.722523 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:04:21.722523 [debug] [MainThread]: On master: Close
[0m14:04:21.725526 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m14:04:21.726525 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m14:04:21.727523 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m14:04:21.727523 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m14:04:21.735522 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m14:04:21.736524 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m14:04:21.766045 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m14:04:21.767044 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.767044 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m14:04:21.768044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:21.813042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m14:04:21.814044 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.814044 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

-- Modelo para criar a views de titulos em abertos , já com a transformação ideal do tipo de dados a ser utilizado no banco de dados , visando melhor performance dos dados

SELECT 
    cedente,
    conf,
    conta,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_cedente, '\D','','g') AS bigint -- removendo caracteres especiais
    ) AS cpf_cnpj_cedente,
    CAST(
        REGEXP_REPLACE(cpf_cnpj_sacado, '\D', '', 'g') AS bigint --removendo caracteres especiais 
    ) AS cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS data_emissao,
    documento,
    etapa,
    historico,
   CAST(id_titulo AS integer) AS id_titulo, --conversao para tipo inteiro
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,      --conversao para tipo inteiro
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) -- removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)  -- removendo caracters especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m14:04:21.821043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:04:21.826042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.826042 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m14:04:21.830042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:04:21.832042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.832042 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m14:04:21.836043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:04:21.847045 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:04:21.848045 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.848045 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:04:21.873227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m14:04:21.877227 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m14:04:21.880227 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:04:21.881227 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m14:04:21.925752 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.044 seconds
[0m14:04:21.928754 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m14:04:21.930753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfdcd38-ff8f-4b66-a971-c6b96ac8a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3F5797D0>]}
[0m14:04:21.931776 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:04:21.932754 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m14:04:21.933752 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.934753 [debug] [MainThread]: On master: BEGIN
[0m14:04:21.934753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:21.985528 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m14:04:21.986528 [debug] [MainThread]: On master: COMMIT
[0m14:04:21.986528 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:21.987528 [debug] [MainThread]: On master: COMMIT
[0m14:04:21.992528 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m14:04:21.992528 [debug] [MainThread]: On master: Close
[0m14:04:21.992528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:21.993529 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:04:21.993529 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:04:21.993529 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m14:04:21.994530 [info ] [MainThread]: 
[0m14:04:21.994530 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m14:04:21.995529 [debug] [MainThread]: Command end result
[0m14:04:22.008579 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m14:04:22.010529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m14:04:22.015645 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m14:04:22.016531 [info ] [MainThread]: 
[0m14:04:22.017532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:22.017532 [info ] [MainThread]: 
[0m14:04:22.018532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:22.019529 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:22.019529 after 1.65 seconds
[0m14:04:22.020530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E39558CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E39558C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E39559E10>]}
[0m14:04:22.020530 [debug] [MainThread]: Flushing usage events
[0m14:04:23.211397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:32.772225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0587CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0488C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0489250>]}


============================== 14:11:32.789224 | e3f818b6-e557-44fd-b270-ded43b135a5d ==============================
[0m14:11:32.789224 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:11:32.792224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models titulosaberto', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:33.005646 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:33.006647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F05B7F50>]}
[0m14:11:33.006647 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:33.007647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EEA6BD10>]}
[0m14:11:33.320727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F06ED210>]}
[0m14:11:33.364533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EB6496D0>]}
[0m14:11:33.366483 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:33.651268 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:11:33.784938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:33.785940 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m14:11:33.941082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m14:11:33.949084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F05853D0>]}
[0m14:11:33.995593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m14:11:33.999592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m14:11:34.024596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0DECF90>]}
[0m14:11:34.024596 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m14:11:34.025595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0584D50>]}
[0m14:11:34.026594 [info ] [MainThread]: 
[0m14:11:34.027593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:34.027593 [info ] [MainThread]: 
[0m14:11:34.028593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:34.029595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:11:34.084658 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:11:34.085660 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:11:34.086657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:34.230594 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.144 seconds
[0m14:11:34.232595 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:11:34.235592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:11:34.241592 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:11:34.242591 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:11:34.242591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:34.297142 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m14:11:34.298159 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:11:34.299152 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:34.307140 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m14:11:34.310142 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:11:34.315291 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:11:34.324413 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.325402 [debug] [MainThread]: On master: BEGIN
[0m14:11:34.325402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:34.377613 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m14:11:34.378509 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.378509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:34.387491 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m14:11:34.387491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F0E07C90>]}
[0m14:11:34.388719 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:34.392617 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.392617 [debug] [MainThread]: On master: BEGIN
[0m14:11:34.399642 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:11:34.399642 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.399642 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.400620 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.403673 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:11:34.403673 [debug] [MainThread]: On master: Close
[0m14:11:34.407468 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m14:11:34.408471 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m14:11:34.410471 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m14:11:34.411471 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m14:11:34.420561 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m14:11:34.421623 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m14:11:34.449729 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m14:11:34.451472 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.451472 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m14:11:34.452508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:34.506555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m14:11:34.507554 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.508553 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    -- models/titulosaberto.sql

-- Modelo para criar a views de titulos em abertos , já com a transformação ideal do tipo de dados a ser utilizado no banco de dados , visando melhor performance dos dados

SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    CAST(
        TO_DATE(data_emissao, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS data_emissao,
    documento,
    etapa,
    historico,
   CAST(id_titulo AS integer) AS id_titulo, --conversao para tipo inteiro
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,      --conversao para tipo inteiro
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) -- removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)  -- removendo caracters especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS valor_total,
    CAST(
        TO_DATE(vencimento, 'DD/MM/YYYY') AS date --conversao para tipo de data
    ) AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2) --removendo caracteres especiais e convertendo o valor monetário tipo brasileiro
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m14:11:34.516551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:11:34.522551 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.522551 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m14:11:34.526552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:11:34.529571 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.529571 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m14:11:34.533568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:11:34.546552 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:11:34.547560 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.547560 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:11:34.566538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m14:11:34.573539 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m14:11:34.576539 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:11:34.577540 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m14:11:34.601144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m14:11:34.603146 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m14:11:34.604146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f818b6-e557-44fd-b270-ded43b135a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F07D2390>]}
[0m14:11:34.605146 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:11:34.606145 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m14:11:34.607144 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.608143 [debug] [MainThread]: On master: BEGIN
[0m14:11:34.608143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:34.661651 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m14:11:34.662527 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.662527 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:34.662527 [debug] [MainThread]: On master: COMMIT
[0m14:11:34.667029 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:11:34.667989 [debug] [MainThread]: On master: Close
[0m14:11:34.667989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:34.669037 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:11:34.669037 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:11:34.669037 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m14:11:34.669880 [info ] [MainThread]: 
[0m14:11:34.670879 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m14:11:34.670879 [debug] [MainThread]: Command end result
[0m14:11:34.690880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m14:11:34.693880 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m14:11:34.698879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m14:11:34.698879 [info ] [MainThread]: 
[0m14:11:34.699882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:34.700880 [info ] [MainThread]: 
[0m14:11:34.700880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:34.702144 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:34.702144 after 2.04 seconds
[0m14:11:34.703160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EA7C8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EA7C8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EA7C9D90>]}
[0m14:11:34.703160 [debug] [MainThread]: Flushing usage events
[0m14:11:35.687806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:29.456133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FAB97D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FAB97BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FAB95410>]}


============================== 15:19:29.463133 | 3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee ==============================
[0m15:19:29.463133 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:19:29.464133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models titulosaberto', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:19:29.537315 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m15:19:29.538335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FAC24090>]}
[0m15:19:29.538335 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m15:19:29.539314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FABEBD10>]}
[0m15:19:29.710058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FADC28D0>]}
[0m15:19:29.748177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F6CA96D0>]}
[0m15:19:29.750424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:29.929534 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:19:30.083371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:30.083371 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m15:19:30.237388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m15:19:30.246388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC216190>]}
[0m15:19:30.294906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m15:19:30.298908 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m15:19:30.332053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC4ECB90>]}
[0m15:19:30.332053 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:19:30.333046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC3C2A10>]}
[0m15:19:30.334045 [info ] [MainThread]: 
[0m15:19:30.335029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:30.335029 [info ] [MainThread]: 
[0m15:19:30.336028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:30.337027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m15:19:30.442161 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m15:19:30.443160 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m15:19:30.443160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:30.556484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.113 seconds
[0m15:19:30.557534 [debug] [ThreadPool]: On list_operacoes: Close
[0m15:19:30.559432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m15:19:30.567509 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:19:30.567509 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m15:19:30.568435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:30.669582 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m15:19:30.670521 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:19:30.672539 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:19:30.680465 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m15:19:30.683484 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m15:19:30.703917 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m15:19:30.714899 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:30.715904 [debug] [MainThread]: On master: BEGIN
[0m15:19:30.716904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:30.815898 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m15:19:30.816902 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:30.816902 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:30.836693 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m15:19:30.838710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC350750>]}
[0m15:19:30.839694 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:30.859454 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:30.859454 [debug] [MainThread]: On master: BEGIN
[0m15:19:30.880047 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:19:30.880047 [debug] [MainThread]: On master: COMMIT
[0m15:19:30.881049 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:30.882046 [debug] [MainThread]: On master: COMMIT
[0m15:19:30.894287 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m15:19:30.895271 [debug] [MainThread]: On master: Close
[0m15:19:30.898271 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m15:19:30.898271 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m15:19:30.899271 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m15:19:30.899271 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m15:19:30.905288 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m15:19:30.906270 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m15:19:30.936272 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m15:19:30.937285 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:30.938271 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m15:19:30.938271 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:31.101205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m15:19:31.101205 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:31.102207 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'DD/MM/YYYY')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m15:19:31.114078 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m15:19:31.120080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:31.120080 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m15:19:31.298823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.178 seconds
[0m15:19:31.301822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:31.301822 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m15:19:31.307822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:19:31.320822 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m15:19:31.320822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:31.321822 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m15:19:31.414335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.092 seconds
[0m15:19:31.418334 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m15:19:31.422335 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m15:19:31.422335 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m15:19:31.452335 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.030 seconds
[0m15:19:31.455335 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m15:19:31.457335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddc6b09-ccbc-44ef-b0fc-46a39cc8fcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC91CA50>]}
[0m15:19:31.458336 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.56s]
[0m15:19:31.459335 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m15:19:31.460335 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.461335 [debug] [MainThread]: On master: BEGIN
[0m15:19:31.461335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:31.547849 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m15:19:31.547849 [debug] [MainThread]: On master: COMMIT
[0m15:19:31.548849 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.548849 [debug] [MainThread]: On master: COMMIT
[0m15:19:31.551849 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:19:31.552849 [debug] [MainThread]: On master: Close
[0m15:19:31.552849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:31.552849 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m15:19:31.553850 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m15:19:31.553850 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m15:19:31.553850 [info ] [MainThread]: 
[0m15:19:31.554849 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m15:19:31.555849 [debug] [MainThread]: Command end result
[0m15:19:31.567849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m15:19:31.569849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m15:19:31.575910 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m15:19:31.575910 [info ] [MainThread]: 
[0m15:19:31.576908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:31.577910 [info ] [MainThread]: 
[0m15:19:31.578909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:19:31.579927 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:31.579927 after 2.20 seconds
[0m15:19:31.579927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FA07BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FA9AF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F5DC8CD0>]}
[0m15:19:31.580908 [debug] [MainThread]: Flushing usage events
[0m15:19:32.310813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:22.596000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A06864D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A049F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A06C4510>]}


============================== 17:09:22.601019 | 2c92c264-d1f0-4425-bb9a-6a9138140098 ==============================
[0m17:09:22.601019 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:09:22.602014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:22.673676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:09:22.674675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A06B7F50>]}
[0m17:09:22.674675 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:09:22.675677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A0715190>]}
[0m17:09:22.829503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A06D9F50>]}
[0m17:09:22.869520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B6EA3D0>]}
[0m17:09:22.870503 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:23.124515 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:09:23.288499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:23.289503 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m17:09:23.445539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m17:09:23.454540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A085D810>]}
[0m17:09:23.501527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:09:23.505082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:09:23.541084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A0EEC990>]}
[0m17:09:23.542084 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m17:09:23.542084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A0684F90>]}
[0m17:09:23.543083 [info ] [MainThread]: 
[0m17:09:23.544112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:23.545083 [info ] [MainThread]: 
[0m17:09:23.545083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:23.546082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m17:09:23.660113 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m17:09:23.661113 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m17:09:23.661113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:23.723504 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m17:09:23.726505 [debug] [ThreadPool]: On list_operacoes: Close
[0m17:09:23.729492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m17:09:23.738489 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:09:23.739496 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m17:09:23.740492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:23.794086 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m17:09:23.795086 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:09:23.796080 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:09:23.808332 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m17:09:23.811334 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m17:09:23.815424 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m17:09:23.824439 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:23.825451 [debug] [MainThread]: On master: BEGIN
[0m17:09:23.826458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:23.863323 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m17:09:23.865303 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:23.867298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:23.878296 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:09:23.879296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B8A30D0>]}
[0m17:09:23.880293 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:23.883350 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:23.884338 [debug] [MainThread]: On master: BEGIN
[0m17:09:23.892557 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:09:23.893575 [debug] [MainThread]: On master: COMMIT
[0m17:09:23.894554 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:23.894554 [debug] [MainThread]: On master: COMMIT
[0m17:09:23.898576 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:09:23.899570 [debug] [MainThread]: On master: Close
[0m17:09:23.903554 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m17:09:23.904577 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m17:09:23.905088 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m17:09:23.906093 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m17:09:23.911108 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m17:09:23.912092 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m17:09:23.939093 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m17:09:23.940436 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:23.940436 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m17:09:23.941444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:23.977577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m17:09:23.978576 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:23.979578 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m17:09:23.987215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:09:23.995220 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:23.995220 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m17:09:23.999219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:09:24.002220 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:24.003219 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m17:09:24.007731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:09:24.020729 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:09:24.020729 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:24.020729 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:09:24.077088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.055 seconds
[0m17:09:24.082095 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m17:09:24.086131 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:09:24.086131 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m17:09:24.106794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m17:09:24.109798 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m17:09:24.111797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c92c264-d1f0-4425-bb9a-6a9138140098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214A0CFBC50>]}
[0m17:09:24.111797 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m17:09:24.112797 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m17:09:24.114906 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:24.114906 [debug] [MainThread]: On master: BEGIN
[0m17:09:24.115893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:24.157522 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m17:09:24.157522 [debug] [MainThread]: On master: COMMIT
[0m17:09:24.157522 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:24.158522 [debug] [MainThread]: On master: COMMIT
[0m17:09:24.161522 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:09:24.162524 [debug] [MainThread]: On master: Close
[0m17:09:24.162524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:24.162524 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m17:09:24.163524 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m17:09:24.163524 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m17:09:24.163524 [info ] [MainThread]: 
[0m17:09:24.164524 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m17:09:24.164524 [debug] [MainThread]: Command end result
[0m17:09:24.177524 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:09:24.179523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:09:24.183544 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m17:09:24.183544 [info ] [MainThread]: 
[0m17:09:24.184523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:24.184523 [info ] [MainThread]: 
[0m17:09:24.185523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:24.186523 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:24.186523 after 1.65 seconds
[0m17:09:24.186523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149A8C8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149A8C8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149A8C9E10>]}
[0m17:09:24.187523 [debug] [MainThread]: Flushing usage events
[0m17:09:24.940840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:00.258190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20F87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A203E89D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20F87390>]}


============================== 17:24:00.266192 | e663fe0f-884e-445b-a09c-1132a341e0c3 ==============================
[0m17:24:00.266192 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:24:00.268190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m17:24:00.347974 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:24:00.348989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A220EEC50>]}
[0m17:24:00.350990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:24:00.351987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20FDBD10>]}
[0m17:24:00.522579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A221516D0>]}
[0m17:24:00.561477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1E1095D0>]}
[0m17:24:00.562381 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:24:00.797803 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:24:01.540038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:01.542037 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m17:24:01.713094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project.config
- seeds.my_dbt_project
[0m17:24:01.722024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A22654AD0>]}
[0m17:24:01.777780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:24:01.783796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:24:01.822683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A227EC810>]}
[0m17:24:01.823682 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m17:24:01.824682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A223FDFD0>]}
[0m17:24:01.825698 [info ] [MainThread]: 
[0m17:24:01.825698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:01.826686 [info ] [MainThread]: 
[0m17:24:01.826686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:01.828683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m17:24:01.937428 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m17:24:01.937428 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m17:24:01.937428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:02.043239 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.105 seconds
[0m17:24:02.045239 [debug] [ThreadPool]: On list_operacoes: Close
[0m17:24:02.048233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m17:24:02.053749 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:24:02.054749 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m17:24:02.054749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:02.104382 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m17:24:02.104382 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:24:02.105383 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:24:02.112195 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m17:24:02.114194 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m17:24:02.118195 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m17:24:02.126209 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.127210 [debug] [MainThread]: On master: BEGIN
[0m17:24:02.127210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:02.187373 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m17:24:02.188378 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.188378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:24:02.226014 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m17:24:02.227014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A221E4A90>]}
[0m17:24:02.228015 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:02.231013 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.232014 [debug] [MainThread]: On master: BEGIN
[0m17:24:02.243016 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:24:02.243016 [debug] [MainThread]: On master: COMMIT
[0m17:24:02.244019 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.244019 [debug] [MainThread]: On master: COMMIT
[0m17:24:02.270088 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m17:24:02.271071 [debug] [MainThread]: On master: Close
[0m17:24:02.275069 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m17:24:02.275069 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m17:24:02.276070 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m17:24:02.277071 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m17:24:02.282072 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m17:24:02.283073 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m17:24:02.311070 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m17:24:02.312070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.312070 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m17:24:02.313070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:02.388711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m17:24:02.389711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.389711 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'yyyy/MM/dd')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'yyyy/MM/dd')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m17:24:02.423717 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m17:24:02.428839 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.428839 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m17:24:02.461867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m17:24:02.466864 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.467865 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m17:24:02.472865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:24:02.487863 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:24:02.488864 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.488864 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:24:02.511292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m17:24:02.517288 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m17:24:02.520289 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:24:02.521289 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m17:24:02.563657 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.042 seconds
[0m17:24:02.565656 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m17:24:02.567657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e663fe0f-884e-445b-a09c-1132a341e0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A22BF9F50>]}
[0m17:24:02.568657 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m17:24:02.568657 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m17:24:02.569988 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.570995 [debug] [MainThread]: On master: BEGIN
[0m17:24:02.570995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:02.652684 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m17:24:02.652684 [debug] [MainThread]: On master: COMMIT
[0m17:24:02.653687 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:02.653687 [debug] [MainThread]: On master: COMMIT
[0m17:24:02.656704 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:24:02.656704 [debug] [MainThread]: On master: Close
[0m17:24:02.657690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:02.657690 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m17:24:02.658693 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m17:24:02.658693 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m17:24:02.658693 [info ] [MainThread]: 
[0m17:24:02.659688 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m17:24:02.660689 [debug] [MainThread]: Command end result
[0m17:24:02.672704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:24:02.674707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:24:02.681690 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m17:24:02.681690 [info ] [MainThread]: 
[0m17:24:02.682689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:02.682689 [info ] [MainThread]: 
[0m17:24:02.684419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:02.684862 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:02.684862 after 2.52 seconds
[0m17:24:02.685899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C168CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C168C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C169D90>]}
[0m17:24:02.685899 [debug] [MainThread]: Flushing usage events
[0m17:24:03.613953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:59.243136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE2850D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE188B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE188190>]}


============================== 17:29:59.247140 | 030a07b6-c409-4aba-8d11-c036f651b717 ==============================
[0m17:29:59.247140 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:29:59.249137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models titulosaberto', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:59.313147 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:29:59.314144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE2874D0>]}
[0m17:29:59.315142 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:29:59.316141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE3073D0>]}
[0m17:29:59.463366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE3EECD0>]}
[0m17:29:59.502322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EA309A90>]}
[0m17:29:59.503320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:29:59.761469 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:29:59.900768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:59.901766 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m17:30:00.060758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m17:30:00.068864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE4B1010>]}
[0m17:30:00.116865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:30:00.121270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:30:00.145594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EEAEC9D0>]}
[0m17:30:00.146596 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m17:30:00.146596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE284C10>]}
[0m17:30:00.148612 [info ] [MainThread]: 
[0m17:30:00.148612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:00.149595 [info ] [MainThread]: 
[0m17:30:00.149595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:00.150595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m17:30:00.214210 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m17:30:00.214210 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m17:30:00.215209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:00.290906 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.076 seconds
[0m17:30:00.291905 [debug] [ThreadPool]: On list_operacoes: Close
[0m17:30:00.293907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m17:30:00.299906 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:30:00.300906 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m17:30:00.300906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:00.358544 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m17:30:00.358544 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:30:00.359529 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:30:00.366542 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m17:30:00.367529 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m17:30:00.370543 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m17:30:00.374544 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.374544 [debug] [MainThread]: On master: BEGIN
[0m17:30:00.374544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:00.401525 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m17:30:00.401525 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.402526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:00.410530 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m17:30:00.411532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE705710>]}
[0m17:30:00.412532 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:00.415530 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.416531 [debug] [MainThread]: On master: BEGIN
[0m17:30:00.422530 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:30:00.422530 [debug] [MainThread]: On master: COMMIT
[0m17:30:00.423591 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.423591 [debug] [MainThread]: On master: COMMIT
[0m17:30:00.426587 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:30:00.426587 [debug] [MainThread]: On master: Close
[0m17:30:00.429589 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m17:30:00.429589 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m17:30:00.430604 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m17:30:00.431590 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m17:30:00.437588 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m17:30:00.438588 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m17:30:00.467693 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m17:30:00.469589 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.469589 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m17:30:00.469589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:00.520751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:30:00.521753 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.523264 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m17:30:00.530404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:30:00.540288 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.541290 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m17:30:00.545935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:30:00.548935 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.548935 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m17:30:00.553203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:30:00.566202 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:30:00.566202 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.567204 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m17:30:00.588200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m17:30:00.593202 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m17:30:00.596200 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m17:30:00.597200 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m17:30:00.615205 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m17:30:00.617206 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m17:30:00.619205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030a07b6-c409-4aba-8d11-c036f651b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1EE99FC10>]}
[0m17:30:00.620204 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m17:30:00.621208 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m17:30:00.621208 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.622715 [debug] [MainThread]: On master: BEGIN
[0m17:30:00.622715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:00.665720 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m17:30:00.665720 [debug] [MainThread]: On master: COMMIT
[0m17:30:00.666720 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:00.666720 [debug] [MainThread]: On master: COMMIT
[0m17:30:00.669720 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:30:00.670732 [debug] [MainThread]: On master: Close
[0m17:30:00.670732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:00.670732 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m17:30:00.671726 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m17:30:00.671726 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m17:30:00.671726 [info ] [MainThread]: 
[0m17:30:00.672723 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m17:30:00.673724 [debug] [MainThread]: Command end result
[0m17:30:00.686719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\DBT\target\manifest.json
[0m17:30:00.688720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\DBT\target\semantic_manifest.json
[0m17:30:00.694722 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\DBT\target\run_results.json
[0m17:30:00.695723 [info ] [MainThread]: 
[0m17:30:00.695723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:00.696723 [info ] [MainThread]: 
[0m17:30:00.696723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:00.697723 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:00.697723 after 1.52 seconds
[0m17:30:00.698721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E8451390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E8438C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E8439D90>]}
[0m17:30:00.698721 [debug] [MainThread]: Flushing usage events
[0m17:30:01.686521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:52.807616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEB84C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEB87FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEB85A10>]}


============================== 17:43:52.814614 | fad1f997-2911-4ced-9d24-9c17c0f18b61 ==============================
[0m17:43:52.814614 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:43:52.815597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\DBT\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\DBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m17:43:52.820597 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:43:52.821596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fad1f997-2911-4ced-9d24-9c17c0f18b61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEBDA150>]}
[0m17:43:52.822597 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:43:52.823599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fad1f997-2911-4ced-9d24-9c17c0f18b61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FE99F0D0>]}
[0m17:43:52.987382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fad1f997-2911-4ced-9d24-9c17c0f18b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEC76610>]}
[0m17:43:53.035921 [debug] [MainThread]: Command `dbt clean` succeeded at 17:43:53.035921 after 0.30 seconds
[0m17:43:53.036950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEBB7BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F8D69650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F8D68AD0>]}
[0m17:43:53.037924 [debug] [MainThread]: Flushing usage events
[0m17:43:53.764403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:32.222348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E088EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0882490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0883F50>]}


============================== 13:04:32.236484 | acd965d6-214c-425d-878d-640950267e66 ==============================
[0m13:04:32.236484 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:04:32.237468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models titulosaberto', 'send_anonymous_usage_stats': 'True'}
[0m13:04:32.587706 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:32.588706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E09EF810>]}
[0m13:04:32.589785 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:32.589785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E09D9C10>]}
[0m13:04:32.774528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0ABD190>]}
[0m13:04:32.810683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DB969350>]}
[0m13:04:32.817684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:04:33.105191 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:04:33.106089 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:04:33.107087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E08E4810>]}
[0m13:04:34.605954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.my_dbt_project
- seeds.my_dbt_project.config
[0m13:04:34.613575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0FB62D0>]}
[0m13:04:34.659660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:04:34.682773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:04:34.905921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0D84E10>]}
[0m13:04:34.905921 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:04:34.906890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0FCFF10>]}
[0m13:04:34.908400 [info ] [MainThread]: 
[0m13:04:34.909409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:34.909409 [info ] [MainThread]: 
[0m13:04:34.910410 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:34.911409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:04:37.455179 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:04:37.456218 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:04:37.456218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:37.605933 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.150 seconds
[0m13:04:37.606934 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:04:37.609447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:04:37.614455 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:04:37.615454 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:04:37.615454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:37.750359 [debug] [ThreadPool]: SQL status: BEGIN in 0.135 seconds
[0m13:04:37.751257 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:04:37.751257 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:04:37.787192 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.035 seconds
[0m13:04:37.788698 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:04:37.792827 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:04:37.796721 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:37.797821 [debug] [MainThread]: On master: BEGIN
[0m13:04:37.797821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:37.875600 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m13:04:37.875600 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:37.876599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:37.909924 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m13:04:37.911923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E0E81750>]}
[0m13:04:37.911923 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:37.915907 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:37.916908 [debug] [MainThread]: On master: BEGIN
[0m13:04:37.952003 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:04:37.953002 [debug] [MainThread]: On master: COMMIT
[0m13:04:37.953002 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:37.953002 [debug] [MainThread]: On master: COMMIT
[0m13:04:37.957003 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:04:37.958507 [debug] [MainThread]: On master: Close
[0m13:04:37.960511 [debug] [Thread-1 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:04:37.961529 [info ] [Thread-1 (]: 1 of 1 START sql view model public.titulosaberto ............................... [RUN]
[0m13:04:37.962511 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:04:37.962511 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:04:37.968513 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:04:37.970907 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:04:38.000929 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:04:38.002929 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.002929 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:04:38.003956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:38.171743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m13:04:38.172744 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.172744 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:04:38.206429 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m13:04:38.211922 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.212923 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:04:38.240520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:04:38.243520 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.244521 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:04:38.248522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:04:38.262291 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:04:38.263275 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.263275 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:04:38.282825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m13:04:38.288366 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:04:38.292381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:04:38.293382 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:04:38.320540 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m13:04:38.322542 [debug] [Thread-1 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:04:38.331808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acd965d6-214c-425d-878d-640950267e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E139D490>]}
[0m13:04:38.332807 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m13:04:38.334808 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:04:38.336806 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:38.336806 [debug] [MainThread]: On master: BEGIN
[0m13:04:38.336806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:38.447674 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m13:04:38.448664 [debug] [MainThread]: On master: COMMIT
[0m13:04:38.449777 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:38.449777 [debug] [MainThread]: On master: COMMIT
[0m13:04:38.452791 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:04:38.453775 [debug] [MainThread]: On master: Close
[0m13:04:38.454775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:38.454775 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:04:38.454775 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:04:38.455776 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:04:38.455776 [info ] [MainThread]: 
[0m13:04:38.456775 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m13:04:38.456775 [debug] [MainThread]: Command end result
[0m13:04:38.477310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:04:38.481823 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:04:38.491334 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:04:38.492335 [info ] [MainThread]: 
[0m13:04:38.493336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:38.494336 [info ] [MainThread]: 
[0m13:04:38.495335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:38.497338 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:38.496337 after 6.34 seconds
[0m13:04:38.498336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E069FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DAB21E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DAB08E50>]}
[0m13:04:38.498848 [debug] [MainThread]: Flushing usage events
[0m13:04:39.446181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:29.177354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001243119F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001242F113D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012431289410>]}


============================== 13:19:29.190614 | 8b052eb1-868d-4cc4-a4ca-2eef72823ad0 ==============================
[0m13:19:29.190614 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:19:29.192162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:19:29.390154 [info ] [MainThread]: dbt version: 1.9.2
[0m13:19:29.391813 [info ] [MainThread]: python version: 3.11.9
[0m13:19:29.391813 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:19:29.391813 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:19:29.716526 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:19:29.716526 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:19:29.718091 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:19:29.723122 [info ] [MainThread]: adapter type: postgres
[0m13:19:29.724684 [info ] [MainThread]: adapter version: 1.9.0
[0m13:19:29.727790 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:19:29.727790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b052eb1-868d-4cc4-a4ca-2eef72823ad0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124313D8ED0>]}
[0m13:19:29.729347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:19:29.730226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b052eb1-868d-4cc4-a4ca-2eef72823ad0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012431547C10>]}
[0m13:19:29.798647 [info ] [MainThread]: Configuration:
[0m13:19:29.798647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:19:29.800406 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:19:29.800406 [info ] [MainThread]: Required dependencies:
[0m13:19:29.802145 [debug] [MainThread]: Executing "git --help"
[0m13:19:29.845074 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:19:29.845074 [debug] [MainThread]: STDERR: "b''"
[0m13:19:29.846723 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:19:29.846723 [info ] [MainThread]: Connection:
[0m13:19:29.846723 [info ] [MainThread]:   host: 172.16.0.239
[0m13:19:29.848325 [info ] [MainThread]:   port: 5432
[0m13:19:29.848325 [info ] [MainThread]:   user: dmx-op-user
[0m13:19:29.848325 [info ] [MainThread]:   database: operacoes
[0m13:19:29.849881 [info ] [MainThread]:   schema: public
[0m13:19:29.849881 [info ] [MainThread]:   connect_timeout: 10
[0m13:19:29.849881 [info ] [MainThread]:   role: None
[0m13:19:29.849881 [info ] [MainThread]:   search_path: None
[0m13:19:29.851483 [info ] [MainThread]:   keepalives_idle: 0
[0m13:19:29.851483 [info ] [MainThread]:   sslmode: None
[0m13:19:29.851483 [info ] [MainThread]:   sslcert: None
[0m13:19:29.853042 [info ] [MainThread]:   sslkey: None
[0m13:19:29.853042 [info ] [MainThread]:   sslrootcert: None
[0m13:19:29.853042 [info ] [MainThread]:   application_name: dbt
[0m13:19:29.854680 [info ] [MainThread]:   retries: 1
[0m13:19:29.854680 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:19:30.217618 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:19:32.608152 [debug] [MainThread]: Using postgres connection "debug"
[0m13:19:32.608152 [debug] [MainThread]: On debug: select 1 as id
[0m13:19:32.609153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:32.653156 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m13:19:32.654156 [debug] [MainThread]: On debug: Close
[0m13:19:32.654156 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:19:32.655155 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:19:32.657173 [debug] [MainThread]: Command `dbt debug` succeeded at 13:19:32.656155 after 3.56 seconds
[0m13:19:32.657173 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:19:32.657173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001242B6D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001242B659950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001242B658D50>]}
[0m13:19:32.658155 [debug] [MainThread]: Flushing usage events
[0m13:19:33.747570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:39.287236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C203987D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2039D9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20379F790>]}


============================== 13:19:39.290254 | 9fa21c60-cbf3-424e-8448-30c6f2ffdbac ==============================
[0m13:19:39.290254 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:19:39.291252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:19:39.341824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:19:39.342824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fa21c60-cbf3-424e-8448-30c6f2ffdbac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C203A1C650>]}
[0m13:19:39.343826 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:19:39.344823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fa21c60-cbf3-424e-8448-30c6f2ffdbac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2039DAE50>]}
[0m13:19:39.508450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa21c60-cbf3-424e-8448-30c6f2ffdbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C203B4AF50>]}
[0m13:19:39.550965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa21c60-cbf3-424e-8448-30c6f2ffdbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1FE9E9710>]}
[0m13:19:39.552964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:19:39.760659 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:19:40.594944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:19:40.595865 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\d_cedentes.sql
[0m13:19:40.723464 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.d_cedentes' (models\d_cedentes.sql) depends on a source named 'public.d_cedentes' which was not found
[0m13:19:40.725463 [debug] [MainThread]: Command `dbt run` failed at 13:19:40.724463 after 1.49 seconds
[0m13:19:40.725463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20379F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1FDB09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1FDB81BD0>]}
[0m13:19:40.725463 [debug] [MainThread]: Flushing usage events
[0m13:19:41.378629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:53.151518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E678C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E6688AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E67C8650>]}


============================== 13:23:53.156482 | 849c353c-cf7a-4619-9905-dbe257e20879 ==============================
[0m13:23:53.156482 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:53.157481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:23:53.224612 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:23:53.225613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '849c353c-cf7a-4619-9905-dbe257e20879', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E6803A10>]}
[0m13:23:53.225613 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:23:53.226611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '849c353c-cf7a-4619-9905-dbe257e20879', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E659F990>]}
[0m13:23:53.359649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '849c353c-cf7a-4619-9905-dbe257e20879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E6802910>]}
[0m13:23:53.400638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '849c353c-cf7a-4619-9905-dbe257e20879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E1889710>]}
[0m13:23:53.401639 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:53.590524 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:23:53.683915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:23:53.684914 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\d_cedentes.sql
[0m13:23:53.814016 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.d_cedentes' (models\d_cedentes.sql) depends on a source named 'public.d_cedentes' which was not found
[0m13:23:53.814880 [debug] [MainThread]: Command `dbt run` failed at 13:23:53.814880 after 0.73 seconds
[0m13:23:53.816043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E09A9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E69B0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E0A21C10>]}
[0m13:23:53.816043 [debug] [MainThread]: Flushing usage events
[0m13:23:54.561719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:32.758684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307878E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230782EDD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307878E450>]}


============================== 13:26:32.762685 | 4cb6315b-a3e3-4cc7-8237-cf1869544ce4 ==============================
[0m13:26:32.762685 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:32.763703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:32.768683 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:26:32.769686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cb6315b-a3e3-4cc7-8237-cf1869544ce4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230787D9C90>]}
[0m13:26:32.908217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cb6315b-a3e3-4cc7-8237-cf1869544ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307887A390>]}
[0m13:26:32.940726 [debug] [MainThread]: Command `dbt clean` succeeded at 13:26:32.940726 after 0.25 seconds
[0m13:26:32.941754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307868CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023072919950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230768AFF50>]}
[0m13:26:32.941754 [debug] [MainThread]: Flushing usage events
[0m13:26:33.717412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:38.351708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E97308E050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E971E9FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E971F89D10>]}


============================== 13:26:38.355710 | 3954abb8-ace2-4357-930d-1a2d18168710 ==============================
[0m13:26:38.355710 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:38.356709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:26:38.367707 [info ] [MainThread]: dbt version: 1.9.2
[0m13:26:38.368708 [info ] [MainThread]: python version: 3.11.9
[0m13:26:38.369710 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:26:38.369710 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:26:38.435271 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:26:38.435271 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:26:38.436272 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:26:38.437272 [info ] [MainThread]: adapter type: postgres
[0m13:26:38.437272 [info ] [MainThread]: adapter version: 1.9.0
[0m13:26:38.440290 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:26:38.441271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3954abb8-ace2-4357-930d-1a2d18168710', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E973087790>]}
[0m13:26:38.503272 [info ] [MainThread]: Configuration:
[0m13:26:38.504274 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:26:38.505276 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:26:38.506277 [info ] [MainThread]: Required dependencies:
[0m13:26:38.506277 [debug] [MainThread]: Executing "git --help"
[0m13:26:38.546573 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:26:38.546573 [debug] [MainThread]: STDERR: "b''"
[0m13:26:38.547570 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:26:38.547570 [info ] [MainThread]: Connection:
[0m13:26:38.548572 [info ] [MainThread]:   host: 172.16.0.239
[0m13:26:38.549572 [info ] [MainThread]:   port: 5432
[0m13:26:38.549572 [info ] [MainThread]:   user: dmx-op-user
[0m13:26:38.550573 [info ] [MainThread]:   database: operacoes
[0m13:26:38.550573 [info ] [MainThread]:   schema: public
[0m13:26:38.551571 [info ] [MainThread]:   connect_timeout: 10
[0m13:26:38.551571 [info ] [MainThread]:   role: None
[0m13:26:38.552572 [info ] [MainThread]:   search_path: None
[0m13:26:38.552572 [info ] [MainThread]:   keepalives_idle: 0
[0m13:26:38.553572 [info ] [MainThread]:   sslmode: None
[0m13:26:38.553572 [info ] [MainThread]:   sslcert: None
[0m13:26:38.554572 [info ] [MainThread]:   sslkey: None
[0m13:26:38.554572 [info ] [MainThread]:   sslrootcert: None
[0m13:26:38.554572 [info ] [MainThread]:   application_name: dbt
[0m13:26:38.555571 [info ] [MainThread]:   retries: 1
[0m13:26:38.555571 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:38.741529 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:26:38.787528 [debug] [MainThread]: Using postgres connection "debug"
[0m13:26:38.788529 [debug] [MainThread]: On debug: select 1 as id
[0m13:26:38.788529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:38.949221 [debug] [MainThread]: SQL status: SELECT 1 in 0.160 seconds
[0m13:26:38.950225 [debug] [MainThread]: On debug: Close
[0m13:26:38.952226 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:26:38.953228 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:26:38.955245 [debug] [MainThread]: Command `dbt debug` succeeded at 13:26:38.954227 after 0.66 seconds
[0m13:26:38.955245 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:26:38.955245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9730D9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E973494090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D2E1C10>]}
[0m13:26:38.956252 [debug] [MainThread]: Flushing usage events
[0m13:26:39.602809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:49.579466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C68E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6C5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C68D7D0>]}


============================== 13:26:49.583481 | cd5202d8-1d83-4000-b657-b8328a2f4312 ==============================
[0m13:26:49.583481 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:49.584099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:49.631165 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:26:49.632165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd5202d8-1d83-4000-b657-b8328a2f4312', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6E0210>]}
[0m13:26:49.737879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5202d8-1d83-4000-b657-b8328a2f4312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6E1510>]}
[0m13:26:49.776499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5202d8-1d83-4000-b657-b8328a2f4312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA176F9850>]}
[0m13:26:49.777509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:49.975717 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:26:49.975717 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:26:49.976623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd5202d8-1d83-4000-b657-b8328a2f4312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6DB750>]}
[0m13:26:51.122452 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "public_f_titulosemaberto".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("public", "f_titulosemaberto").
  
  To fix this, change the name of one of these resources:
  - source.my_dbt_project.public.f_titulosemaberto (models\sources\sources.yml)
  - source.my_dbt_project.public.f_titulosemaberto (models\schema.yml)
[0m13:26:51.124353 [debug] [MainThread]: Command `dbt source freshness` failed at 13:26:51.124353 after 1.65 seconds
[0m13:26:51.124353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6DBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C6DA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1C681450>]}
[0m13:26:51.125353 [debug] [MainThread]: Flushing usage events
[0m13:26:51.774674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:58.921140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F18E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1DB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1DBDD0>]}


============================== 13:26:58.925135 | 7ba4527a-f81a-4374-9584-bed6bc8d5144 ==============================
[0m13:26:58.925135 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:58.926137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:58.978721 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:26:58.979723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ba4527a-f81a-4374-9584-bed6bc8d5144', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F202490>]}
[0m13:26:59.079421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ba4527a-f81a-4374-9584-bed6bc8d5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F202B90>]}
[0m13:26:59.117526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ba4527a-f81a-4374-9584-bed6bc8d5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35B309650>]}
[0m13:26:59.118422 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:59.302967 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:26:59.303968 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:26:59.304968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ba4527a-f81a-4374-9584-bed6bc8d5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F5AF850>]}
[0m13:26:59.909597 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "public_f_titulosemaberto".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("public", "f_titulosemaberto").
  
  To fix this, change the name of one of these resources:
  - source.my_dbt_project.public.f_titulosemaberto (models\sources\sources.yml)
  - source.my_dbt_project.public.f_titulosemaberto (models\schema.yml)
[0m13:26:59.911497 [debug] [MainThread]: Command `dbt run` failed at 13:26:59.911497 after 1.05 seconds
[0m13:26:59.911497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1E6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1E5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F8B4B90>]}
[0m13:26:59.912602 [debug] [MainThread]: Flushing usage events
[0m13:27:00.605363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:12.817844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE18488A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE185D9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE185DA590>]}


============================== 13:28:12.820845 | e5e6ff2d-19c0-4e39-a453-b409a8b5d71f ==============================
[0m13:28:12.820845 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:28:12.821844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:28:12.826828 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:28:12.827827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e5e6ff2d-19c0-4e39-a453-b409a8b5d71f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE185D9C90>]}
[0m13:28:12.930484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5e6ff2d-19c0-4e39-a453-b409a8b5d71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE186CBB50>]}
[0m13:28:12.952400 [debug] [MainThread]: Command `dbt clean` succeeded at 13:28:12.951401 after 0.19 seconds
[0m13:28:12.952400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE185DB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE127C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE127C8DD0>]}
[0m13:28:12.952400 [debug] [MainThread]: Flushing usage events
[0m13:28:13.699961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:19.680662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2A986350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2A889F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2A986150>]}


============================== 13:28:19.684665 | b93c4b40-6f33-474c-912a-54941f295050 ==============================
[0m13:28:19.684665 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:28:19.685664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:19.697181 [info ] [MainThread]: dbt version: 1.9.2
[0m13:28:19.698179 [info ] [MainThread]: python version: 3.11.9
[0m13:28:19.698179 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:28:19.699180 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:28:19.751196 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:28:19.752178 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:28:19.753179 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:28:19.754178 [info ] [MainThread]: adapter type: postgres
[0m13:28:19.754178 [info ] [MainThread]: adapter version: 1.9.0
[0m13:28:19.758181 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:28:19.758181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b93c4b40-6f33-474c-912a-54941f295050', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2A9D8DD0>]}
[0m13:28:19.821720 [info ] [MainThread]: Configuration:
[0m13:28:19.822720 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:28:19.823720 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:28:19.824719 [info ] [MainThread]: Required dependencies:
[0m13:28:19.825718 [debug] [MainThread]: Executing "git --help"
[0m13:28:19.863743 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:28:19.863743 [debug] [MainThread]: STDERR: "b''"
[0m13:28:19.864718 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:28:19.865717 [info ] [MainThread]: Connection:
[0m13:28:19.865717 [info ] [MainThread]:   host: 172.16.0.239
[0m13:28:19.866718 [info ] [MainThread]:   port: 5432
[0m13:28:19.866718 [info ] [MainThread]:   user: dmx-op-user
[0m13:28:19.866718 [info ] [MainThread]:   database: operacoes
[0m13:28:19.867718 [info ] [MainThread]:   schema: public
[0m13:28:19.867718 [info ] [MainThread]:   connect_timeout: 10
[0m13:28:19.867718 [info ] [MainThread]:   role: None
[0m13:28:19.868718 [info ] [MainThread]:   search_path: None
[0m13:28:19.868718 [info ] [MainThread]:   keepalives_idle: 0
[0m13:28:19.869718 [info ] [MainThread]:   sslmode: None
[0m13:28:19.869718 [info ] [MainThread]:   sslcert: None
[0m13:28:19.870719 [info ] [MainThread]:   sslkey: None
[0m13:28:19.870719 [info ] [MainThread]:   sslrootcert: None
[0m13:28:19.871720 [info ] [MainThread]:   application_name: dbt
[0m13:28:19.871720 [info ] [MainThread]:   retries: 1
[0m13:28:19.872723 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:20.048917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:28:20.093420 [debug] [MainThread]: Using postgres connection "debug"
[0m13:28:20.093420 [debug] [MainThread]: On debug: select 1 as id
[0m13:28:20.094420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:20.247391 [debug] [MainThread]: SQL status: SELECT 1 in 0.153 seconds
[0m13:28:20.248378 [debug] [MainThread]: On debug: Close
[0m13:28:20.248378 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:28:20.249376 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:28:20.251377 [debug] [MainThread]: Command `dbt debug` succeeded at 13:28:20.250374 after 0.62 seconds
[0m13:28:20.251377 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:28:20.251377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2ABC5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A24B81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A24B81C10>]}
[0m13:28:20.252376 [debug] [MainThread]: Flushing usage events
[0m13:28:20.905123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:24.772626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237060DAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237044E5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237060C8910>]}


============================== 13:28:24.776642 | 9b268288-f0be-4254-8079-874adc51a6f1 ==============================
[0m13:28:24.776642 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:28:24.777624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:24.826145 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:28:24.828145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237060F6FD0>]}
[0m13:28:24.926881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706200D10>]}
[0m13:28:24.967865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023702109890>]}
[0m13:28:24.968864 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:25.148996 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:28:25.149993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:28:25.150891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370622E9D0>]}
[0m13:28:25.836682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.my_dbt_project
[0m13:28:25.844682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370671BF90>]}
[0m13:28:25.892468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:28:25.937013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:28:25.983319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237065C0E50>]}
[0m13:28:25.984320 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:28:25.985319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706585810>]}
[0m13:28:25.986318 [info ] [MainThread]: 
[0m13:28:25.987317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:25.987317 [info ] [MainThread]: 
[0m13:28:25.988318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:25.991333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:28:26.039834 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:28:26.040832 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:28:26.041832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:26.121487 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m13:28:26.122488 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:28:26.124489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:28:26.128487 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:28:26.128487 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:28:26.129489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:26.169487 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m13:28:26.169487 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:28:26.170487 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:28:26.185490 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m13:28:26.186490 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:28:26.189490 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:28:26.194492 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:26.195492 [debug] [MainThread]: On master: BEGIN
[0m13:28:26.195492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:26.328647 [debug] [MainThread]: SQL status: BEGIN in 0.133 seconds
[0m13:28:26.331735 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:26.332736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:26.364151 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m13:28:26.367147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237066A73D0>]}
[0m13:28:26.368146 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:26.397226 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:26.398244 [debug] [MainThread]: On master: BEGIN
[0m13:28:26.462227 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m13:28:26.463226 [debug] [MainThread]: On master: COMMIT
[0m13:28:26.463226 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:26.464228 [debug] [MainThread]: On master: COMMIT
[0m13:28:26.467226 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:28:26.468244 [debug] [MainThread]: On master: Close
[0m13:28:26.470228 [debug] [Thread-1 (]: Began running node model.my_dbt_project.d_cedentes
[0m13:28:26.471228 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:28:26.472227 [info ] [Thread-1 (]: 1 of 2 START sql view model public.d_cedentes .................................. [RUN]
[0m13:28:26.473227 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.d_cedentes'
[0m13:28:26.472227 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:28:26.473227 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.d_cedentes
[0m13:28:26.474227 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:28:26.479226 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.d_cedentes"
[0m13:28:26.480227 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:28:26.482226 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:28:26.484231 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.d_cedentes
[0m13:28:26.484231 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:28:26.510455 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.d_cedentes"
[0m13:28:26.513456 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:28:26.516457 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.516457 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: BEGIN
[0m13:28:26.517454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:26.517454 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.518457 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:28:26.519455 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:26.665577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m13:28:26.665577 [debug] [Thread-2 (]: SQL status: BEGIN in 0.146 seconds
[0m13:28:26.666578 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.666578 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.667577 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */

  create view "operacoes"."public"."d_cedentes__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS NUMERIC(18,2)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS NUMERIC(18,2)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS NUMERIC(18,2)) AS limite_operacao_clean,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m13:28:26.667577 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:28:26.697579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m13:28:26.697579 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m13:28:26.702952 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.705952 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.705952 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
alter table "operacoes"."public"."d_cedentes" rename to "d_cedentes__dbt_backup"
[0m13:28:26.705952 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:28:26.732952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:28:26.732952 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:28:26.734952 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.738953 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.739952 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
alter table "operacoes"."public"."d_cedentes__dbt_tmp" rename to "d_cedentes"
[0m13:28:26.739952 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:28:26.766145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m13:28:26.766145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m13:28:26.778143 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: COMMIT
[0m13:28:26.780127 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:28:26.781068 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.781068 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.782074 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: COMMIT
[0m13:28:26.782074 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:28:26.800694 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m13:28:26.809800 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:28:26.813788 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:28:26.814793 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:28:26.833133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m13:28:26.837135 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."d_cedentes__dbt_backup"
[0m13:28:26.840133 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:28:26.840133 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
drop table if exists "operacoes"."public"."d_cedentes__dbt_backup" cascade
[0m13:28:26.866688 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m13:28:26.866688 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.052 seconds
[0m13:28:26.868687 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: Close
[0m13:28:26.870692 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:28:26.878688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706C57AD0>]}
[0m13:28:26.879688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b268288-f0be-4254-8079-874adc51a6f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237066D8CD0>]}
[0m13:28:26.879688 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.d_cedentes ............................. [[32mCREATE VIEW[0m in 0.40s]
[0m13:28:26.880687 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.d_cedentes
[0m13:28:26.880687 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.40s]
[0m13:28:26.881688 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:28:26.882969 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:26.884130 [debug] [MainThread]: On master: BEGIN
[0m13:28:26.884130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:27.006821 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m13:28:27.007816 [debug] [MainThread]: On master: COMMIT
[0m13:28:27.008819 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:27.009818 [debug] [MainThread]: On master: COMMIT
[0m13:28:27.036128 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m13:28:27.038149 [debug] [MainThread]: On master: Close
[0m13:28:27.039151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:27.040151 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:28:27.041150 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:28:27.042146 [debug] [MainThread]: Connection 'model.my_dbt_project.d_cedentes' was properly closed.
[0m13:28:27.042146 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:28:27.043148 [info ] [MainThread]: 
[0m13:28:27.045494 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m13:28:27.047440 [debug] [MainThread]: Command end result
[0m13:28:27.069433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:28:27.071450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:28:27.076432 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:28:27.076432 [info ] [MainThread]: 
[0m13:28:27.077432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:27.077432 [info ] [MainThread]: 
[0m13:28:27.078435 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:28:27.079433 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:27.079433 after 2.37 seconds
[0m13:28:27.080433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237002C1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023704ECF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023700249950>]}
[0m13:28:27.080433 [debug] [MainThread]: Flushing usage events
[0m13:28:28.298337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:21.929736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC0886D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC08D9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC08DBDD0>]}


============================== 13:31:21.935731 | 88a38230-c272-4506-85b0-dffd68715c57 ==============================
[0m13:31:21.935731 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:31:21.938737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:21.944731 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:31:21.946732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88a38230-c272-4506-85b0-dffd68715c57', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC08D9B10>]}
[0m13:31:22.100599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88a38230-c272-4506-85b0-dffd68715c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC08D9AD0>]}
[0m13:31:22.125598 [debug] [MainThread]: Command `dbt clean` succeeded at 13:31:22.125598 after 0.27 seconds
[0m13:31:22.125598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBAA49950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBAA48DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBAAC1C10>]}
[0m13:31:22.126633 [debug] [MainThread]: Flushing usage events
[0m13:31:23.476931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:27.907743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832685250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E830AE4B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8326854D0>]}


============================== 13:31:27.911742 | c4dd8330-d592-4373-bc83-4afc4659d981 ==============================
[0m13:31:27.911742 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:31:27.912742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:27.924743 [info ] [MainThread]: dbt version: 1.9.2
[0m13:31:27.925743 [info ] [MainThread]: python version: 3.11.9
[0m13:31:27.925743 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:31:27.926745 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:31:27.994778 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:31:27.995776 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:31:27.995776 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:31:27.996776 [info ] [MainThread]: adapter type: postgres
[0m13:31:27.997775 [info ] [MainThread]: adapter version: 1.9.0
[0m13:31:27.999775 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:31:28.000775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4dd8330-d592-4373-bc83-4afc4659d981', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8326D9E90>]}
[0m13:31:28.064943 [info ] [MainThread]: Configuration:
[0m13:31:28.065951 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:31:28.066949 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:31:28.067948 [info ] [MainThread]: Required dependencies:
[0m13:31:28.068948 [debug] [MainThread]: Executing "git --help"
[0m13:31:28.104949 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:31:28.105965 [debug] [MainThread]: STDERR: "b''"
[0m13:31:28.105965 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:31:28.106965 [info ] [MainThread]: Connection:
[0m13:31:28.106965 [info ] [MainThread]:   host: 172.16.0.239
[0m13:31:28.107950 [info ] [MainThread]:   port: 5432
[0m13:31:28.108952 [info ] [MainThread]:   user: dmx-op-user
[0m13:31:28.108952 [info ] [MainThread]:   database: operacoes
[0m13:31:28.109950 [info ] [MainThread]:   schema: public
[0m13:31:28.109950 [info ] [MainThread]:   connect_timeout: 10
[0m13:31:28.110949 [info ] [MainThread]:   role: None
[0m13:31:28.110949 [info ] [MainThread]:   search_path: None
[0m13:31:28.110949 [info ] [MainThread]:   keepalives_idle: 0
[0m13:31:28.111948 [info ] [MainThread]:   sslmode: None
[0m13:31:28.111948 [info ] [MainThread]:   sslcert: None
[0m13:31:28.112949 [info ] [MainThread]:   sslkey: None
[0m13:31:28.112949 [info ] [MainThread]:   sslrootcert: None
[0m13:31:28.112949 [info ] [MainThread]:   application_name: dbt
[0m13:31:28.113948 [info ] [MainThread]:   retries: 1
[0m13:31:28.113948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:28.321716 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:31:28.363722 [debug] [MainThread]: Using postgres connection "debug"
[0m13:31:28.363722 [debug] [MainThread]: On debug: select 1 as id
[0m13:31:28.365231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:28.529817 [debug] [MainThread]: SQL status: SELECT 1 in 0.164 seconds
[0m13:31:28.530825 [debug] [MainThread]: On debug: Close
[0m13:31:28.530825 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:31:28.531814 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:31:28.532850 [debug] [MainThread]: Command `dbt debug` succeeded at 13:31:28.532850 after 0.68 seconds
[0m13:31:28.533848 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:31:28.533848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832878850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832E80C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832E80450>]}
[0m13:31:28.533848 [debug] [MainThread]: Flushing usage events
[0m13:31:29.196456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:32.402152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E68E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E49F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8CAE4E10>]}


============================== 13:31:32.405169 | 228f20be-6103-4770-86f2-92d94e76f6bc ==============================
[0m13:31:32.405169 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:31:32.406173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:32.456083 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:31:32.457197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E7DD3D0>]}
[0m13:31:32.556899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E79F010>]}
[0m13:31:32.596461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8A728210>]}
[0m13:31:32.598458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:32.782530 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:31:32.783530 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:31:32.784530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E703910>]}
[0m13:31:33.491348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8ED30390>]}
[0m13:31:33.544347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:31:33.549347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:31:33.570856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8EBC3110>]}
[0m13:31:33.570856 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:31:33.571861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8EB7D690>]}
[0m13:31:33.573863 [info ] [MainThread]: 
[0m13:31:33.573863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:33.574863 [info ] [MainThread]: 
[0m13:31:33.575864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:33.578862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:31:33.631862 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:31:33.632864 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:31:33.632864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:33.854880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.222 seconds
[0m13:31:33.855882 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:31:33.857887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:31:33.861885 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:31:33.862886 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:31:33.862886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:33.915391 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m13:31:33.915391 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:31:33.916392 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:31:33.923391 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m13:31:33.924394 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:31:33.928392 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:31:33.934392 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:33.934392 [debug] [MainThread]: On master: BEGIN
[0m13:31:33.935391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:33.977928 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m13:31:33.978929 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:33.979929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:33.987927 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m13:31:33.988927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8ECF4C90>]}
[0m13:31:33.988927 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:33.991928 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:33.992927 [debug] [MainThread]: On master: BEGIN
[0m13:31:33.998928 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:31:33.999927 [debug] [MainThread]: On master: COMMIT
[0m13:31:33.999927 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:33.999927 [debug] [MainThread]: On master: COMMIT
[0m13:31:34.003927 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:31:34.003927 [debug] [MainThread]: On master: Close
[0m13:31:34.006928 [debug] [Thread-1 (]: Began running node model.my_dbt_project.d_cedentes
[0m13:31:34.006928 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:31:34.007930 [info ] [Thread-1 (]: 1 of 2 START sql view model public.d_cedentes .................................. [RUN]
[0m13:31:34.007930 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:31:34.008929 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.d_cedentes'
[0m13:31:34.008929 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:31:34.009929 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.d_cedentes
[0m13:31:34.009929 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:31:34.015946 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.d_cedentes"
[0m13:31:34.018928 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:31:34.021927 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.d_cedentes
[0m13:31:34.030930 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:31:34.050028 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.d_cedentes"
[0m13:31:34.052954 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:31:34.054929 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:31:34.054929 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: BEGIN
[0m13:31:34.055930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:31:34.055930 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.056937 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:31:34.056937 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:31:34.085442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m13:31:34.085442 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m13:31:34.086444 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */

  create view "operacoes"."public"."d_cedentes__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS NUMERIC(18,2)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS NUMERIC(18,2)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS NUMERIC(18,2)) AS limite_operacao_clean,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m13:31:34.088469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m13:31:34.088469 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.089442 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:31:34.095442 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:31:34.100441 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.101441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.d_cedentes" does not exist
LINE 41:     "operacoes"."public"."d_cedentes"
             ^

[0m13:31:34.101441 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:31:34.101441 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: ROLLBACK
[0m13:31:34.105441 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:31:34.106441 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: Close
[0m13:31:34.108441 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.110442 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:31:34.113461 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:31:34.125443 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:31:34.126443 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.126443 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:31:34.148459 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m13:31:34.153445 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:31:34.157444 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:31:34.158461 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:31:34.175013 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m13:31:34.178030 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:31:34.180039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C9020E310>]}
[0m13:31:34.181013 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:31:34.182012 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:31:34.300667 [debug] [Thread-1 (]: Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql
[0m13:31:34.301664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228f20be-6103-4770-86f2-92d94e76f6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C90146290>]}
[0m13:31:34.301664 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.d_cedentes ......................... [[31mERROR[0m in 0.29s]
[0m13:31:34.302559 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.d_cedentes
[0m13:31:34.303574 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.d_cedentes' to be skipped because of status 'error'.  Reason: Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql.
[0m13:31:34.305558 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:34.305558 [debug] [MainThread]: On master: BEGIN
[0m13:31:34.306557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:34.336604 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m13:31:34.337605 [debug] [MainThread]: On master: COMMIT
[0m13:31:34.337605 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:34.338604 [debug] [MainThread]: On master: COMMIT
[0m13:31:34.341621 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:31:34.342604 [debug] [MainThread]: On master: Close
[0m13:31:34.342604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:34.343623 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:31:34.343623 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:31:34.343623 [debug] [MainThread]: Connection 'model.my_dbt_project.d_cedentes' was properly closed.
[0m13:31:34.343623 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:31:34.344622 [info ] [MainThread]: 
[0m13:31:34.345604 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:31:34.346605 [debug] [MainThread]: Command end result
[0m13:31:34.363632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:31:34.365658 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:31:34.370632 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:31:34.371633 [info ] [MainThread]: 
[0m13:31:34.372173 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:31:34.373179 [info ] [MainThread]: 
[0m13:31:34.373179 [error] [MainThread]:   Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql
[0m13:31:34.374179 [info ] [MainThread]: 
[0m13:31:34.374179 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:31:34.375202 [debug] [MainThread]: Command `dbt run` failed at 13:31:34.375202 after 2.03 seconds
[0m13:31:34.376196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C888C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C88941C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C8E683910>]}
[0m13:31:34.376196 [debug] [MainThread]: Flushing usage events
[0m13:31:35.048753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:20.912361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D52187D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D521DAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D521DB090>]}


============================== 13:36:20.917362 | 96ae80c5-4b43-4064-824e-970747d7fe4e ==============================
[0m13:36:20.917362 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:36:20.918361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:20.922405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:36:20.923405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96ae80c5-4b43-4064-824e-970747d7fe4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D521D9150>]}
[0m13:36:21.072921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96ae80c5-4b43-4064-824e-970747d7fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D522C59D0>]}
[0m13:36:21.098921 [debug] [MainThread]: Command `dbt clean` succeeded at 13:36:21.098921 after 0.24 seconds
[0m13:36:21.099923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D50E5C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4C439950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D522C7F50>]}
[0m13:36:21.099923 [debug] [MainThread]: Flushing usage events
[0m13:36:21.876971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:25.867064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475C879D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475B89390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475CC8110>]}


============================== 13:36:25.870080 | 4ff32bbe-8471-4325-b17a-d38299e1b0a5 ==============================
[0m13:36:25.870080 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:36:25.871063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:25.882065 [info ] [MainThread]: dbt version: 1.9.2
[0m13:36:25.883088 [info ] [MainThread]: python version: 3.11.9
[0m13:36:25.884066 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:36:25.884066 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:36:25.947325 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:36:25.948324 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:36:25.948324 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:36:25.950341 [info ] [MainThread]: adapter type: postgres
[0m13:36:25.950341 [info ] [MainThread]: adapter version: 1.9.0
[0m13:36:25.953340 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:36:25.954340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ff32bbe-8471-4325-b17a-d38299e1b0a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475E6DA90>]}
[0m13:36:26.019351 [info ] [MainThread]: Configuration:
[0m13:36:26.020327 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:36:26.021326 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:26.021326 [info ] [MainThread]: Required dependencies:
[0m13:36:26.022356 [debug] [MainThread]: Executing "git --help"
[0m13:36:26.063531 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:36:26.064531 [debug] [MainThread]: STDERR: "b''"
[0m13:36:26.065530 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:36:26.066530 [info ] [MainThread]: Connection:
[0m13:36:26.066530 [info ] [MainThread]:   host: 172.16.0.239
[0m13:36:26.067555 [info ] [MainThread]:   port: 5432
[0m13:36:26.067555 [info ] [MainThread]:   user: dmx-op-user
[0m13:36:26.068529 [info ] [MainThread]:   database: operacoes
[0m13:36:26.068529 [info ] [MainThread]:   schema: public
[0m13:36:26.068529 [info ] [MainThread]:   connect_timeout: 10
[0m13:36:26.069557 [info ] [MainThread]:   role: None
[0m13:36:26.069557 [info ] [MainThread]:   search_path: None
[0m13:36:26.070534 [info ] [MainThread]:   keepalives_idle: 0
[0m13:36:26.070534 [info ] [MainThread]:   sslmode: None
[0m13:36:26.071530 [info ] [MainThread]:   sslcert: None
[0m13:36:26.071530 [info ] [MainThread]:   sslkey: None
[0m13:36:26.072531 [info ] [MainThread]:   sslrootcert: None
[0m13:36:26.073531 [info ] [MainThread]:   application_name: dbt
[0m13:36:26.073531 [info ] [MainThread]:   retries: 1
[0m13:36:26.074529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:26.328438 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:36:26.375423 [debug] [MainThread]: Using postgres connection "debug"
[0m13:36:26.375423 [debug] [MainThread]: On debug: select 1 as id
[0m13:36:26.376425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:26.538671 [debug] [MainThread]: SQL status: SELECT 1 in 0.162 seconds
[0m13:36:26.539671 [debug] [MainThread]: On debug: Close
[0m13:36:26.540671 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:36:26.541671 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:36:26.542671 [debug] [MainThread]: Command `dbt debug` succeeded at 13:36:26.542671 after 0.73 seconds
[0m13:36:26.543671 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:36:26.543671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020477097E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020470EC1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475A9F850>]}
[0m13:36:26.544671 [debug] [MainThread]: Flushing usage events
[0m13:36:27.221871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:30.149142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025118E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020251182710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202511C4650>]}


============================== 13:36:30.152240 | 8970d4a5-3fb2-41b1-9263-c7c34f940444 ==============================
[0m13:36:30.152240 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:36:30.153137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:30.202153 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:36:30.204136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202511DBFD0>]}
[0m13:36:30.312758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202512F2FD0>]}
[0m13:36:30.353382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024D209CD0>]}
[0m13:36:30.354489 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:30.537691 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:36:30.538590 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:36:30.539589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025138EE10>]}
[0m13:36:31.305938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202518C0F90>]}
[0m13:36:31.350485 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:36:31.354488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:36:31.374487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020251698650>]}
[0m13:36:31.374487 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:36:31.375486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202515FEA90>]}
[0m13:36:31.376488 [info ] [MainThread]: 
[0m13:36:31.377486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:31.377486 [info ] [MainThread]: 
[0m13:36:31.378524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:31.381634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:36:31.434240 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:36:31.434240 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:36:31.435305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:31.713528 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.278 seconds
[0m13:36:31.714630 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:36:31.716627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:36:31.721549 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:36:31.721549 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:36:31.722533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:31.902518 [debug] [ThreadPool]: SQL status: BEGIN in 0.180 seconds
[0m13:36:31.902518 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:36:31.903519 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:36:31.990573 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.087 seconds
[0m13:36:31.992575 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:36:32.108574 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:36:32.113574 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:32.113574 [debug] [MainThread]: On master: BEGIN
[0m13:36:32.114574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:32.447873 [debug] [MainThread]: SQL status: BEGIN in 0.334 seconds
[0m13:36:32.448874 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:32.449875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:36:32.461896 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m13:36:32.462876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020251980450>]}
[0m13:36:32.463875 [debug] [MainThread]: On master: ROLLBACK
[0m13:36:32.528878 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:32.529877 [debug] [MainThread]: On master: BEGIN
[0m13:36:32.978880 [debug] [MainThread]: SQL status: BEGIN in 0.449 seconds
[0m13:36:32.979878 [debug] [MainThread]: On master: COMMIT
[0m13:36:32.979878 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:32.979878 [debug] [MainThread]: On master: COMMIT
[0m13:36:33.007208 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m13:36:33.008233 [debug] [MainThread]: On master: Close
[0m13:36:33.013209 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes.
[0m13:36:33.013209 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:36:33.014208 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes. ............................... [RUN]
[0m13:36:33.015210 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes.'
[0m13:36:33.014208 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:36:33.016209 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes.
[0m13:36:33.016209 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:36:33.022215 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes."
[0m13:36:33.023217 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:36:33.026215 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:36:33.027215 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:36:33.040800 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes.
[0m13:36:33.052782 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:36:33.055798 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes."
[0m13:36:33.057802 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.058789 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes."
[0m13:36:33.058789 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:36:33.059795 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: BEGIN
[0m13:36:33.059795 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:33.059795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:33.197030 [debug] [Thread-2 (]: SQL status: BEGIN in 0.137 seconds
[0m13:36:33.198014 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.198014 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:36:33.229017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m13:36:33.230018 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes."
[0m13:36:33.230018 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes."} */

  create view "operacoes"."public"."dim_cedentes.__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS NUMERIC(18,2)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS NUMERIC(18,2)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS NUMERIC(18,2)) AS limite_operacao_clean,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m13:36:33.252524 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m13:36:33.253524 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.d_cedentes" does not exist
LINE 41:     "operacoes"."public"."d_cedentes"
             ^

[0m13:36:33.258524 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.258524 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: ROLLBACK
[0m13:36:33.259524 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:36:33.288525 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: Close
[0m13:36:33.289524 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m13:36:33.292524 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.292524 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:36:33.298544 [debug] [Thread-1 (]: Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql
[0m13:36:33.299524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020251C8B950>]}
[0m13:36:33.300523 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.dim_cedentes. ...................... [[31mERROR[0m in 0.28s]
[0m13:36:33.301526 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes.
[0m13:36:33.301526 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dim_cedentes.' to be skipped because of status 'error'.  Reason: Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql.
[0m13:36:33.335719 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m13:36:33.347735 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:36:33.347735 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.348736 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:36:33.412721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.064 seconds
[0m13:36:33.418721 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:36:33.423726 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:36:33.423726 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:36:33.482855 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.058 seconds
[0m13:36:33.488856 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:36:33.490861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8970d4a5-3fb2-41b1-9263-c7c34f940444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202517BC610>]}
[0m13:36:33.491859 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.47s]
[0m13:36:33.493856 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:36:33.496854 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:33.498857 [debug] [MainThread]: On master: BEGIN
[0m13:36:33.499856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:33.831296 [debug] [MainThread]: SQL status: BEGIN in 0.332 seconds
[0m13:36:33.832296 [debug] [MainThread]: On master: COMMIT
[0m13:36:33.832296 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:33.832296 [debug] [MainThread]: On master: COMMIT
[0m13:36:33.837906 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m13:36:33.837906 [debug] [MainThread]: On master: Close
[0m13:36:33.838908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:33.838908 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:36:33.838908 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:36:33.839907 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes.' was properly closed.
[0m13:36:33.839907 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:36:33.839907 [info ] [MainThread]: 
[0m13:36:33.840907 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m13:36:33.841907 [debug] [MainThread]: Command end result
[0m13:36:33.856950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:36:33.859908 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:36:33.864908 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:36:33.864908 [info ] [MainThread]: 
[0m13:36:33.865946 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:36:33.865946 [info ] [MainThread]: 
[0m13:36:33.866908 [error] [MainThread]:   Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql
[0m13:36:33.867907 [info ] [MainThread]: 
[0m13:36:33.867907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:36:33.869907 [debug] [MainThread]: Command `dbt run` failed at 13:36:33.869907 after 3.78 seconds
[0m13:36:33.869907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020248EF9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020248F71C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024FF9F9D0>]}
[0m13:36:33.870907 [debug] [MainThread]: Flushing usage events
[0m13:36:34.942763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:28.386412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05C8E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F057C0F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05CDA250>]}


============================== 13:39:28.391421 | b528af08-82b2-4325-a9ce-f94371449d79 ==============================
[0m13:39:28.391421 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:39:28.392419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:28.453884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:39:28.454882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b528af08-82b2-4325-a9ce-f94371449d79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05CDA390>]}
[0m13:39:28.588115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b528af08-82b2-4325-a9ce-f94371449d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05E00A50>]}
[0m13:39:28.628659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b528af08-82b2-4325-a9ce-f94371449d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F00D48090>]}
[0m13:39:28.630677 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:28.834188 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:39:28.962324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:28.963325 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m13:39:29.156117 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto' which was not found
[0m13:39:29.157020 [debug] [MainThread]: Command `dbt run` failed at 13:39:29.157020 after 0.83 seconds
[0m13:39:29.158136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F7FE59950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F7FED1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F7FED1C10>]}
[0m13:39:29.158136 [debug] [MainThread]: Flushing usage events
[0m13:39:29.968368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:57.343992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0687F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D06C8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0687A90>]}


============================== 13:40:57.347010 | 15c4136d-42b1-470a-9497-4321cdd8ae9a ==============================
[0m13:40:57.347010 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:40:57.347996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:40:57.397098 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:40:57.398082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0703190>]}
[0m13:40:57.495608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D087BB10>]}
[0m13:40:57.538038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CB718250>]}
[0m13:40:57.539037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:40:57.728228 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:40:57.828735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:40:57.829736 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m13:40:57.890840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D06D1810>]}
[0m13:40:57.933687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:40:57.938613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:40:57.964573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0AF2910>]}
[0m13:40:57.964573 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:40:57.965571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0879010>]}
[0m13:40:57.967589 [info ] [MainThread]: 
[0m13:40:57.967589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:57.968574 [info ] [MainThread]: 
[0m13:40:57.969575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:57.973587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:40:58.026208 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:40:58.026208 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:40:58.026208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:58.082617 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m13:40:58.083639 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:40:58.084618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:40:58.089619 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:40:58.089619 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:40:58.090618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:58.120095 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m13:40:58.121093 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:40:58.121093 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:58.130092 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m13:40:58.131091 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:40:58.135091 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:40:58.139107 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.140092 [debug] [MainThread]: On master: BEGIN
[0m13:40:58.140092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:58.170185 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m13:40:58.171180 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.171180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:58.181118 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m13:40:58.182170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CB71E510>]}
[0m13:40:58.183078 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:58.187077 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.187077 [debug] [MainThread]: On master: BEGIN
[0m13:40:58.194074 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:40:58.195074 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.195074 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.195074 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.198074 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:40:58.199074 [debug] [MainThread]: On master: Close
[0m13:40:58.202079 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes.
[0m13:40:58.202079 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:40:58.203079 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes. ............................... [RUN]
[0m13:40:58.204080 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes.'
[0m13:40:58.203079 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:40:58.204080 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes.
[0m13:40:58.205078 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:40:58.210077 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes."
[0m13:40:58.211077 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:40:58.213077 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:40:58.214077 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes.
[0m13:40:58.219285 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:40:58.240287 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes."
[0m13:40:58.243304 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:40:58.245287 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes."
[0m13:40:58.246288 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.246288 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: BEGIN
[0m13:40:58.246288 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:40:58.247287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:58.247287 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:40:58.308288 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m13:40:58.309290 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.309290 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:40:58.316288 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:40:58.321364 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.322363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m13:40:58.322363 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:40:58.322363 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes."
[0m13:40:58.323364 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes."} */

  create view "operacoes"."public"."dim_cedentes.__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS NUMERIC(18,2)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS NUMERIC(18,2)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS NUMERIC(18,2)) AS limite_operacao_clean,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m13:40:58.326388 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:40:58.328363 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.329363 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:40:58.329363 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.d_cedentes" does not exist
LINE 41:     "operacoes"."public"."d_cedentes"
             ^

[0m13:40:58.330365 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: ROLLBACK
[0m13:40:58.333363 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:40:58.333363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes.: Close
[0m13:40:58.344363 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:40:58.345363 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.346363 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:40:58.351364 [debug] [Thread-1 (]: Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql
[0m13:40:58.353363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0AF2E90>]}
[0m13:40:58.353363 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.dim_cedentes. ...................... [[31mERROR[0m in 0.15s]
[0m13:40:58.354381 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes.
[0m13:40:58.355365 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dim_cedentes.' to be skipped because of status 'error'.  Reason: Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql.
[0m13:40:58.367365 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m13:40:58.372366 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:40:58.376366 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:40:58.377393 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:40:58.394363 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m13:40:58.396379 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:40:58.397380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c4136d-42b1-470a-9497-4321cdd8ae9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D10E1350>]}
[0m13:40:58.397380 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:40:58.398364 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:40:58.400364 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.400364 [debug] [MainThread]: On master: BEGIN
[0m13:40:58.400364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:58.429393 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m13:40:58.430394 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.430394 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.430394 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.434394 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:40:58.435394 [debug] [MainThread]: On master: Close
[0m13:40:58.435394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:58.435394 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:40:58.436392 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:40:58.436392 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes.' was properly closed.
[0m13:40:58.436392 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:40:58.437394 [info ] [MainThread]: 
[0m13:40:58.437394 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m13:40:58.438393 [debug] [MainThread]: Command end result
[0m13:40:58.452409 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:40:58.454393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:40:58.460421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:40:58.460421 [info ] [MainThread]: 
[0m13:40:58.461395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:40:58.462393 [info ] [MainThread]: 
[0m13:40:58.463392 [error] [MainThread]:   Database Error in model dim_cedentes. (models\dim_cedentes..sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes..sql
[0m13:40:58.463392 [info ] [MainThread]: 
[0m13:40:58.464393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:40:58.465414 [debug] [MainThread]: Command `dbt run` failed at 13:40:58.465414 after 1.18 seconds
[0m13:40:58.465414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CA8C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CA941BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185D0588A10>]}
[0m13:40:58.466397 [debug] [MainThread]: Flushing usage events
[0m13:40:59.166183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:53.272197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DE87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DEDA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DEC8390>]}


============================== 13:41:53.276226 | 52cf89e7-26e5-4e87-8e13-3bc95b205fe8 ==============================
[0m13:41:53.276226 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:41:53.277196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:53.329220 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:41:53.330197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DED9350>]}
[0m13:41:53.427740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177F0BEE10>]}
[0m13:41:53.468355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DF03790>]}
[0m13:41:53.469372 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:53.647851 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:41:53.749799 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:41:53.750807 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\dim_cedentes.sql
[0m13:41:53.750807 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\dim_cedentes..sql
[0m13:41:53.909525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177F568B90>]}
[0m13:41:53.953132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:41:53.956035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:41:53.972029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177F6EC7D0>]}
[0m13:41:53.973029 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:41:53.973029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177F0A2CD0>]}
[0m13:41:53.975046 [info ] [MainThread]: 
[0m13:41:53.975046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:53.976029 [info ] [MainThread]: 
[0m13:41:53.977028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:53.980030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:41:54.028127 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:41:54.028127 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:41:54.029124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:54.168314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.139 seconds
[0m13:41:54.171416 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:41:54.175310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:41:54.182304 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:41:54.183323 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:41:54.183323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:54.285302 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m13:41:54.286401 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:41:54.287299 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:54.313731 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.025 seconds
[0m13:41:54.317678 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:41:54.342379 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:41:54.354436 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:54.355434 [debug] [MainThread]: On master: BEGIN
[0m13:41:54.356433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:54.487276 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m13:41:54.488387 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:54.489331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:54.514358 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m13:41:54.516366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177D2E51D0>]}
[0m13:41:54.517261 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:54.544197 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:54.544197 [debug] [MainThread]: On master: BEGIN
[0m13:41:54.573319 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m13:41:54.575664 [debug] [MainThread]: On master: COMMIT
[0m13:41:54.576559 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:54.578557 [debug] [MainThread]: On master: COMMIT
[0m13:41:54.600643 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m13:41:54.602663 [debug] [MainThread]: On master: Close
[0m13:41:54.609713 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes
[0m13:41:54.610707 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:41:54.611765 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes ................................ [RUN]
[0m13:41:54.614710 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes'
[0m13:41:54.612713 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:41:54.615777 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes
[0m13:41:54.617710 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:41:54.626703 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes"
[0m13:41:54.626703 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:41:54.629704 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:41:54.629704 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes
[0m13:41:54.655218 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes"
[0m13:41:54.656219 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:41:54.659219 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:41:54.660218 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes"
[0m13:41:54.661218 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.661218 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes: BEGIN
[0m13:41:54.662259 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:41:54.662259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:54.662259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:41:54.800553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m13:41:54.801554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.139 seconds
[0m13:41:54.802933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes"
[0m13:41:54.804235 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.806215 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes"} */

  create view "operacoes"."public"."dim_cedentes__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS NUMERIC(18,2)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS NUMERIC(18,2)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS NUMERIC(18,2)) AS limite_operacao_clean,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m13:41:54.807174 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:41:54.828390 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.d_cedentes" does not exist
LINE 41:     "operacoes"."public"."d_cedentes"
             ^

[0m13:41:54.828390 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:41:54.829437 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes: ROLLBACK
[0m13:41:54.839400 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.839400 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:41:54.857993 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes: Close
[0m13:41:54.859920 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m13:41:54.867914 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.869013 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:41:54.873923 [debug] [Thread-1 (]: Database Error in model dim_cedentes (models\dim_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes.sql
[0m13:41:54.874923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177F9F0F50>]}
[0m13:41:54.875905 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.dim_cedentes ....................... [[31mERROR[0m in 0.26s]
[0m13:41:54.876841 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes
[0m13:41:54.877848 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dim_cedentes' to be skipped because of status 'error'.  Reason: Database Error in model dim_cedentes (models\dim_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes.sql.
[0m13:41:54.885964 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m13:41:54.899917 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:41:54.900929 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.900929 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:41:54.918678 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m13:41:54.929781 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:41:54.934780 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:41:54.935798 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:41:54.971747 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m13:41:54.977873 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:41:54.979769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52cf89e7-26e5-4e87-8e13-3bc95b205fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177FA39550>]}
[0m13:41:54.980768 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m13:41:54.984767 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:41:54.987767 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:54.988877 [debug] [MainThread]: On master: BEGIN
[0m13:41:54.989870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:55.087567 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m13:41:55.089588 [debug] [MainThread]: On master: COMMIT
[0m13:41:55.090589 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:55.091589 [debug] [MainThread]: On master: COMMIT
[0m13:41:55.113947 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m13:41:55.116168 [debug] [MainThread]: On master: Close
[0m13:41:55.117258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:55.118263 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:41:55.119265 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:41:55.119265 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes' was properly closed.
[0m13:41:55.120163 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:41:55.121160 [info ] [MainThread]: 
[0m13:41:55.122160 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m13:41:55.123971 [debug] [MainThread]: Command end result
[0m13:41:55.137356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:41:55.140355 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:41:55.145390 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:41:55.146355 [info ] [MainThread]: 
[0m13:41:55.146355 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:41:55.147355 [info ] [MainThread]: 
[0m13:41:55.147355 [error] [MainThread]:   Database Error in model dim_cedentes (models\dim_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\dim_cedentes.sql
[0m13:41:55.148357 [info ] [MainThread]: 
[0m13:41:55.148357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:41:55.149355 [debug] [MainThread]: Command `dbt run` failed at 13:41:55.149355 after 1.94 seconds
[0m13:41:55.150377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021779059950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177DBB9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021779F24E50>]}
[0m13:41:55.150377 [debug] [MainThread]: Flushing usage events
[0m13:41:55.856197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:42.371062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298AFB7F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298AD9F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298AD9F790>]}


============================== 13:50:42.375060 | 224d426d-302a-4fcc-9441-f0ea7475c8a2 ==============================
[0m13:50:42.375060 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:42.377044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:42.549064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '224d426d-302a-4fcc-9441-f0ea7475c8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298AFE5A90>]}
[0m13:50:42.577066 [debug] [MainThread]: Command `dbt clean` succeeded at 13:50:42.577066 after 0.28 seconds
[0m13:50:42.578066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022986119950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022986118DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298AFB7F50>]}
[0m13:50:42.579066 [debug] [MainThread]: Flushing usage events
[0m13:50:43.286508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:48.270892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058E78C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058E7DAA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058E7DB2D0>]}


============================== 13:50:48.274890 | 9a3ee868-7af3-412f-9862-d702199ca492 ==============================
[0m13:50:48.274890 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:48.275893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:48.287893 [info ] [MainThread]: dbt version: 1.9.2
[0m13:50:48.288892 [info ] [MainThread]: python version: 3.11.9
[0m13:50:48.288892 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:50:48.289893 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:50:48.362352 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:50:48.362352 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:50:48.363342 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:50:48.364341 [info ] [MainThread]: adapter type: postgres
[0m13:50:48.364341 [info ] [MainThread]: adapter version: 1.9.0
[0m13:50:48.431341 [info ] [MainThread]: Configuration:
[0m13:50:48.432340 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:50:48.433341 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:50:48.433341 [info ] [MainThread]: Required dependencies:
[0m13:50:48.434367 [debug] [MainThread]: Executing "git --help"
[0m13:50:48.474858 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:50:48.474858 [debug] [MainThread]: STDERR: "b''"
[0m13:50:48.475859 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:50:48.476859 [info ] [MainThread]: Connection:
[0m13:50:48.476859 [info ] [MainThread]:   host: 172.16.0.239
[0m13:50:48.477858 [info ] [MainThread]:   port: 5432
[0m13:50:48.477858 [info ] [MainThread]:   user: dmx-op-user
[0m13:50:48.478859 [info ] [MainThread]:   database: operacoes
[0m13:50:48.478859 [info ] [MainThread]:   schema: public
[0m13:50:48.478859 [info ] [MainThread]:   connect_timeout: 10
[0m13:50:48.479858 [info ] [MainThread]:   role: None
[0m13:50:48.479858 [info ] [MainThread]:   search_path: None
[0m13:50:48.479858 [info ] [MainThread]:   keepalives_idle: 0
[0m13:50:48.480859 [info ] [MainThread]:   sslmode: None
[0m13:50:48.480859 [info ] [MainThread]:   sslcert: None
[0m13:50:48.481859 [info ] [MainThread]:   sslkey: None
[0m13:50:48.481859 [info ] [MainThread]:   sslrootcert: None
[0m13:50:48.482860 [info ] [MainThread]:   application_name: dbt
[0m13:50:48.482860 [info ] [MainThread]:   retries: 1
[0m13:50:48.483859 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:48.754292 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:50:48.799297 [debug] [MainThread]: Using postgres connection "debug"
[0m13:50:48.800296 [debug] [MainThread]: On debug: select 1 as id
[0m13:50:48.800296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:49.005428 [debug] [MainThread]: SQL status: SELECT 1 in 0.205 seconds
[0m13:50:49.007446 [debug] [MainThread]: On debug: Close
[0m13:50:49.008442 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:50:49.010434 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:50:49.012432 [debug] [MainThread]: Command `dbt debug` succeeded at 13:50:49.011429 after 0.80 seconds
[0m13:50:49.012432 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:50:49.013431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058E97A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058EF7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002058EF7CF10>]}
[0m13:50:49.013431 [debug] [MainThread]: Flushing usage events
[0m13:50:49.724175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:53.161929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8A86610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A889FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8AD9FD0>]}


============================== 13:50:53.164903 | ccf9286a-21be-4958-9f68-bc5cb3d69f92 ==============================
[0m13:50:53.164903 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:53.165886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:53.315444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccf9286a-21be-4958-9f68-bc5cb3d69f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8CB6A90>]}
[0m13:50:53.355447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccf9286a-21be-4958-9f68-bc5cb3d69f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A3B5A150>]}
[0m13:50:53.356952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:53.542530 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:50:53.543529 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:50:53.544509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ccf9286a-21be-4958-9f68-bc5cb3d69f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8CFCF90>]}
[0m13:50:54.196994 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.dim_cedentes_fidic' (models\dim_cedentes_fidic.sql) depends on a source named 'public.d_cedentes_fidc' which was not found
[0m13:50:54.198662 [debug] [MainThread]: Command `dbt run` failed at 13:50:54.198662 after 1.10 seconds
[0m13:50:54.198662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2CB9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8AE6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8AE5C10>]}
[0m13:50:54.199700 [debug] [MainThread]: Flushing usage events
[0m13:50:54.894316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:01.833887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D7D5C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D90DBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D90DA410>]}


============================== 13:53:01.838906 | d258bfda-e880-4aca-947b-affcdbf2a482 ==============================
[0m13:53:01.838906 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:53:01.839902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:01.859445 [info ] [MainThread]: dbt version: 1.9.2
[0m13:53:01.859445 [info ] [MainThread]: python version: 3.11.9
[0m13:53:01.860446 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:53:01.861447 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:53:01.921463 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:53:01.922468 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:53:01.923446 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:53:01.923446 [info ] [MainThread]: adapter type: postgres
[0m13:53:01.924445 [info ] [MainThread]: adapter version: 1.9.0
[0m13:53:01.989068 [info ] [MainThread]: Configuration:
[0m13:53:01.990052 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:53:01.991053 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:53:01.991053 [info ] [MainThread]: Required dependencies:
[0m13:53:01.992078 [debug] [MainThread]: Executing "git --help"
[0m13:53:02.031479 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:53:02.032485 [debug] [MainThread]: STDERR: "b''"
[0m13:53:02.032485 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:53:02.033484 [info ] [MainThread]: Connection:
[0m13:53:02.033484 [info ] [MainThread]:   host: 172.16.0.239
[0m13:53:02.034485 [info ] [MainThread]:   port: 5432
[0m13:53:02.034485 [info ] [MainThread]:   user: dmx-op-user
[0m13:53:02.035485 [info ] [MainThread]:   database: operacoes
[0m13:53:02.035485 [info ] [MainThread]:   schema: public
[0m13:53:02.035485 [info ] [MainThread]:   connect_timeout: 10
[0m13:53:02.036484 [info ] [MainThread]:   role: None
[0m13:53:02.036484 [info ] [MainThread]:   search_path: None
[0m13:53:02.037485 [info ] [MainThread]:   keepalives_idle: 0
[0m13:53:02.037485 [info ] [MainThread]:   sslmode: None
[0m13:53:02.038487 [info ] [MainThread]:   sslcert: None
[0m13:53:02.038487 [info ] [MainThread]:   sslkey: None
[0m13:53:02.039485 [info ] [MainThread]:   sslrootcert: None
[0m13:53:02.039485 [info ] [MainThread]:   application_name: dbt
[0m13:53:02.039485 [info ] [MainThread]:   retries: 1
[0m13:53:02.040485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:53:02.230403 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:53:02.275918 [debug] [MainThread]: Using postgres connection "debug"
[0m13:53:02.276921 [debug] [MainThread]: On debug: select 1 as id
[0m13:53:02.276921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:02.329935 [debug] [MainThread]: SQL status: SELECT 1 in 0.052 seconds
[0m13:53:02.330941 [debug] [MainThread]: On debug: Close
[0m13:53:02.330941 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:53:02.331940 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:53:02.332971 [debug] [MainThread]: Command `dbt debug` succeeded at 13:53:02.332971 after 0.56 seconds
[0m13:53:02.332971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:53:02.332971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D32D1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D32D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199D3259950>]}
[0m13:53:02.333970 [debug] [MainThread]: Flushing usage events
[0m13:53:03.039113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:06.953540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791C8E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791CDA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791CDAA50>]}


============================== 13:53:06.957044 | 53b76e4f-e0b1-4b16-be86-b2ae745d0cc6 ==============================
[0m13:53:06.957044 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:53:06.958051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:07.134609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791E74390>]}
[0m13:53:07.174387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78DD481D0>]}
[0m13:53:07.176345 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:53:07.359973 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:53:07.360954 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:53:07.361913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791CD9A90>]}
[0m13:53:08.075070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C79331D9D0>]}
[0m13:53:08.118124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:53:08.121981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:53:08.141020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C793189090>]}
[0m13:53:08.141020 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:53:08.143020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C793167D90>]}
[0m13:53:08.144020 [info ] [MainThread]: 
[0m13:53:08.144020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:08.145025 [info ] [MainThread]: 
[0m13:53:08.145025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:08.148027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:53:08.201535 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:53:08.202554 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:53:08.202554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:08.351485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.148 seconds
[0m13:53:08.355592 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:53:08.358493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:53:08.367689 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:53:08.368593 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:53:08.368593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:08.630499 [debug] [ThreadPool]: SQL status: BEGIN in 0.261 seconds
[0m13:53:08.630499 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:53:08.631499 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:53:08.650501 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.018 seconds
[0m13:53:08.651502 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:53:08.676012 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:53:08.682011 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:08.683011 [debug] [MainThread]: On master: BEGIN
[0m13:53:08.683011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:08.927660 [debug] [MainThread]: SQL status: BEGIN in 0.244 seconds
[0m13:53:08.928753 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:08.930750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:53:08.961072 [debug] [MainThread]: SQL status: SELECT 1 in 0.029 seconds
[0m13:53:08.963598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C793210890>]}
[0m13:53:08.964598 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:08.994816 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:08.995818 [debug] [MainThread]: On master: BEGIN
[0m13:53:09.028542 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m13:53:09.030583 [debug] [MainThread]: On master: COMMIT
[0m13:53:09.031584 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:09.033582 [debug] [MainThread]: On master: COMMIT
[0m13:53:09.060882 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m13:53:09.062554 [debug] [MainThread]: On master: Close
[0m13:53:09.072605 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:53:09.072605 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:53:09.074553 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:53:09.076548 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:53:09.075553 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:53:09.078549 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:53:09.078549 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:53:09.086604 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.087546 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:53:09.089546 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:53:09.090545 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:53:09.096653 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:53:09.116547 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.119546 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:53:09.121545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.122544 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:53:09.122544 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.123546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:09.123546 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:53:09.124545 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:53:09.479285 [debug] [Thread-2 (]: SQL status: BEGIN in 0.355 seconds
[0m13:53:09.480385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.357 seconds
[0m13:53:09.482382 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.484281 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.485281 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:53:09.486382 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(fator_percentual AS NUMERIC(18,2)) AS fator_percentual,
    CAST(advalorem_percentual AS NUMERIC(18,2)) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    CAST(limite_global AS NUMERIC(18,2)) AS limite_global,
    CAST(limite_boleto_especial AS NUMERIC(18,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS NUMERIC(18,2)) AS limite_comissaria,
    CAST(limite_tranche AS NUMERIC(18,2)) AS limite_tranche,
    CAST(risco_atual AS NUMERIC(18,2)) AS risco_atual,
    CAST(saldo AS NUMERIC(18,2)) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:53:09.497447 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:53:09.504444 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.505443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:53:09.505443 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:53:09.507443 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.508445 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:53:09.537054 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m13:53:09.537054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:53:09.540060 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.551434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:53:09.551434 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:53:09.552434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.552434 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:53:09.639718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m13:53:09.639718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.086 seconds
[0m13:53:09.642718 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:53:09.647724 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:53:09.648723 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.651722 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:53:09.652722 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:53:09.652722 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:53:09.672798 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m13:53:09.673798 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m13:53:09.675800 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:53:09.677798 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:53:09.679800 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:53:09.679800 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:53:09.680799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C793843290>]}
[0m13:53:09.680799 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.60s]
[0m13:53:09.681799 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:53:09.706914 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.026 seconds
[0m13:53:09.707916 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:53:09.708916 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b76e4f-e0b1-4b16-be86-b2ae745d0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C793815CD0>]}
[0m13:53:09.709915 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.63s]
[0m13:53:09.710203 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:53:09.711209 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:09.712231 [debug] [MainThread]: On master: BEGIN
[0m13:53:09.712231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:10.023042 [debug] [MainThread]: SQL status: BEGIN in 0.311 seconds
[0m13:53:10.023042 [debug] [MainThread]: On master: COMMIT
[0m13:53:10.024044 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:10.024044 [debug] [MainThread]: On master: COMMIT
[0m13:53:10.092553 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m13:53:10.092553 [debug] [MainThread]: On master: Close
[0m13:53:10.093554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:10.094553 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:53:10.094553 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:53:10.094553 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:53:10.094553 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:53:10.095555 [info ] [MainThread]: 
[0m13:53:10.095555 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m13:53:10.096553 [debug] [MainThread]: Command end result
[0m13:53:10.111554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:53:10.113577 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:53:10.117554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:53:10.118554 [info ] [MainThread]: 
[0m13:53:10.119553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:10.119553 [info ] [MainThread]: 
[0m13:53:10.120586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:53:10.121553 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:10.121553 after 3.22 seconds
[0m13:53:10.121553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791CDB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791CDB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78CEE1C10>]}
[0m13:53:10.122552 [debug] [MainThread]: Flushing usage events
[0m13:53:10.984068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:19.342568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C4CAEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C3E3A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C3A0FE50>]}


============================== 13:55:19.347086 | e1cacd6a-4748-43e4-b8a4-e510b43d6e73 ==============================
[0m13:55:19.347086 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:55:19.349085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:19.538995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C4E20A50>]}
[0m13:55:19.580507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0DB97D0>]}
[0m13:55:19.581507 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:19.790285 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:55:19.950841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:19.951841 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dim_cedentes_fidic.sql
[0m13:55:20.130913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C6412390>]}
[0m13:55:20.175427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:55:20.179427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:55:20.208429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C65EC650>]}
[0m13:55:20.209429 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:55:20.209429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C65DEE10>]}
[0m13:55:20.211539 [info ] [MainThread]: 
[0m13:55:20.212427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:20.213428 [info ] [MainThread]: 
[0m13:55:20.213428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:20.218449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:55:20.274959 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:55:20.274959 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:55:20.275962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:20.443607 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.168 seconds
[0m13:55:20.444550 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:55:20.447174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:55:20.451271 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:55:20.452279 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:55:20.452279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:20.586218 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m13:55:20.586218 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:55:20.587217 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:20.619217 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.032 seconds
[0m13:55:20.620217 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:55:20.649079 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:55:20.654041 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:20.655040 [debug] [MainThread]: On master: BEGIN
[0m13:55:20.655040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:20.826594 [debug] [MainThread]: SQL status: BEGIN in 0.171 seconds
[0m13:55:20.827596 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:20.827596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:20.858798 [debug] [MainThread]: SQL status: SELECT 2 in 0.031 seconds
[0m13:55:20.860784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C641D790>]}
[0m13:55:20.861784 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:20.892176 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:20.893180 [debug] [MainThread]: On master: BEGIN
[0m13:55:20.928003 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:55:20.929003 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.930005 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:20.930005 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.959259 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m13:55:20.959259 [debug] [MainThread]: On master: Close
[0m13:55:20.983259 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:20.984259 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:55:20.984259 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:55:20.985260 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:55:20.985260 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:55:20.986260 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:55:20.986260 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:20.987260 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:55:20.993260 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.000260 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:55:21.001260 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:21.019261 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:55:21.027261 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.031263 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:55:21.033268 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.033268 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:55:21.033268 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.034269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:21.034269 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:55:21.035268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:21.199378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m13:55:21.200386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.165 seconds
[0m13:55:21.200386 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.201397 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.201397 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(
        REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT
    ) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(fator_percentual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS fator_percentual,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(advalorem_percentual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_global,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_boleto_especial,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_comissaria,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_tranche,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(risco_atual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS risco_atual,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(saldo, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:55:21.202463 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:55:21.231392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m13:55:21.232516 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m13:55:21.241599 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.244701 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.244701 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:55:21.245615 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:55:21.262971 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m13:55:21.262971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m13:55:21.267967 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.272056 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.272056 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:55:21.272966 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:55:21.298102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m13:55:21.299156 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:55:21.317044 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:55:21.317935 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:55:21.319138 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.319617 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.320014 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:55:21.320014 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:55:21.365209 [debug] [Thread-2 (]: SQL status: COMMIT in 0.045 seconds
[0m13:55:21.366443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m13:55:21.379440 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:55:21.383436 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:55:21.392696 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:21.393696 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:21.394957 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:55:21.396032 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:55:21.432379 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m13:55:21.434616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m13:55:21.439512 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:55:21.442610 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:55:21.447508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C68EB3D0>]}
[0m13:55:21.447508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cacd6a-4748-43e4-b8a4-e510b43d6e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C6604490>]}
[0m13:55:21.449737 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.46s]
[0m13:55:21.452700 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:55:21.451641 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m13:55:21.455636 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:21.468769 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:21.469765 [debug] [MainThread]: On master: BEGIN
[0m13:55:21.471771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:21.604470 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m13:55:21.606463 [debug] [MainThread]: On master: COMMIT
[0m13:55:21.607464 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:21.608461 [debug] [MainThread]: On master: COMMIT
[0m13:55:21.636935 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m13:55:21.637830 [debug] [MainThread]: On master: Close
[0m13:55:21.638825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:21.639825 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:55:21.639825 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:55:21.639825 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:55:21.639825 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:55:21.640824 [info ] [MainThread]: 
[0m13:55:21.641822 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m13:55:21.642822 [debug] [MainThread]: Command end result
[0m13:55:21.707230 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:55:21.709233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:55:21.713258 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:55:21.714232 [info ] [MainThread]: 
[0m13:55:21.714232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:21.715231 [info ] [MainThread]: 
[0m13:55:21.715231 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:55:21.716232 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:21.716232 after 2.44 seconds
[0m13:55:21.717260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6BFED9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6BFED9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6BFED8D50>]}
[0m13:55:21.717260 [debug] [MainThread]: Flushing usage events
[0m13:55:23.070960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:34.906388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047C85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047089650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047C86E10>]}


============================== 13:55:34.911280 | 932b046f-2ede-4a44-b9d0-f1d8abcffd63 ==============================
[0m13:55:34.911280 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:55:34.911280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:34.923082 [info ] [MainThread]: dbt version: 1.9.2
[0m13:55:34.923082 [info ] [MainThread]: python version: 3.11.9
[0m13:55:34.924870 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:55:34.924870 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:55:34.975258 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:55:34.976948 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:55:34.976948 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:55:34.978611 [info ] [MainThread]: adapter type: postgres
[0m13:55:34.978611 [info ] [MainThread]: adapter version: 1.9.0
[0m13:55:35.047600 [info ] [MainThread]: Configuration:
[0m13:55:35.049138 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:55:35.049138 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:55:35.050744 [info ] [MainThread]: Required dependencies:
[0m13:55:35.050744 [debug] [MainThread]: Executing "git --help"
[0m13:55:35.096802 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:55:35.098363 [debug] [MainThread]: STDERR: "b''"
[0m13:55:35.098363 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:55:35.098363 [info ] [MainThread]: Connection:
[0m13:55:35.100023 [info ] [MainThread]:   host: 172.16.0.239
[0m13:55:35.100023 [info ] [MainThread]:   port: 5432
[0m13:55:35.100023 [info ] [MainThread]:   user: dmx-op-user
[0m13:55:35.100023 [info ] [MainThread]:   database: operacoes
[0m13:55:35.101624 [info ] [MainThread]:   schema: public
[0m13:55:35.101624 [info ] [MainThread]:   connect_timeout: 10
[0m13:55:35.101624 [info ] [MainThread]:   role: None
[0m13:55:35.101624 [info ] [MainThread]:   search_path: None
[0m13:55:35.103181 [info ] [MainThread]:   keepalives_idle: 0
[0m13:55:35.103181 [info ] [MainThread]:   sslmode: None
[0m13:55:35.103181 [info ] [MainThread]:   sslcert: None
[0m13:55:35.103181 [info ] [MainThread]:   sslkey: None
[0m13:55:35.104725 [info ] [MainThread]:   sslrootcert: None
[0m13:55:35.104725 [info ] [MainThread]:   application_name: dbt
[0m13:55:35.104725 [info ] [MainThread]:   retries: 1
[0m13:55:35.106319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:35.290149 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:55:35.331107 [debug] [MainThread]: Using postgres connection "debug"
[0m13:55:35.332800 [debug] [MainThread]: On debug: select 1 as id
[0m13:55:35.332800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:35.421482 [debug] [MainThread]: SQL status: SELECT 1 in 0.088 seconds
[0m13:55:35.421482 [debug] [MainThread]: On debug: Close
[0m13:55:35.423234 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:55:35.423234 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:55:35.424994 [debug] [MainThread]: Command `dbt debug` succeeded at 13:55:35.424994 after 0.58 seconds
[0m13:55:35.424994 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:55:35.424994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0490E4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047F195D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A042F11C10>]}
[0m13:55:35.426569 [debug] [MainThread]: Flushing usage events
[0m13:55:36.119630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:38.952883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD698E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6982710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD698E990>]}


============================== 13:55:38.956084 | f61bdb42-ed87-467c-bb52-dd832f778a7e ==============================
[0m13:55:38.956084 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:55:38.957774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:39.136253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6B74690>]}
[0m13:55:39.180164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD1A4A050>]}
[0m13:55:39.181193 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:39.367709 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:55:39.477773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:39.477773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:39.500569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6F05490>]}
[0m13:55:39.550211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:55:39.553626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:55:39.573346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD7049D90>]}
[0m13:55:39.573346 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m13:55:39.574965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD69E4550>]}
[0m13:55:39.576690 [info ] [MainThread]: 
[0m13:55:39.576690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:39.578379 [info ] [MainThread]: 
[0m13:55:39.578379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:39.581667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:55:39.635436 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:55:39.635436 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:55:39.637147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:39.690982 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m13:55:39.690982 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:55:39.693911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:55:39.699793 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:55:39.699793 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:55:39.699793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:39.756240 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m13:55:39.756240 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:55:39.756240 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:39.764287 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m13:55:39.765881 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:55:39.769175 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:55:39.774114 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:39.774114 [debug] [MainThread]: On master: BEGIN
[0m13:55:39.774114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:39.805151 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m13:55:39.806729 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:39.806729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:39.815174 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m13:55:39.816726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6E69090>]}
[0m13:55:39.816726 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:39.821515 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:39.821944 [debug] [MainThread]: On master: BEGIN
[0m13:55:39.827955 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:55:39.829605 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.829605 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:39.829605 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.832915 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:55:39.834495 [debug] [MainThread]: On master: Close
[0m13:55:39.836024 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:39.836024 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:55:39.836024 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:55:39.837569 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m13:55:39.837569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:55:39.839262 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:55:39.839262 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:39.839262 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:55:39.845502 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.847100 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:55:39.848710 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:39.876191 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.877765 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:55:39.881138 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:55:39.882145 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.882651 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:55:39.882651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:39.882651 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.884327 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:55:39.884327 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:39.915391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m13:55:39.915391 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.917048 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m13:55:39.922010 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:55:39.928344 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.928344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:55:39.928344 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:55:39.929942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.929942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(
        REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT
    ) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(fator_percentual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS fator_percentual,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(advalorem_percentual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS advalorem_percentual,
    CAST(data_cadastro AS DATE) AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    CAST(primeira_operacao AS DATE) AS primeira_operacao,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_global,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_boleto_especial,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_comissaria,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS limite_tranche,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(risco_atual, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS risco_atual,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(saldo, '\.', '', 'g'), ',', '.', 'g') AS NUMERIC(18,2)
    ) AS saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:55:39.933112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:55:39.936532 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.936532 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:55:39.936532 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:55:39.939722 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.941374 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:55:39.944582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:55:39.944582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:55:39.955997 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:55:39.957679 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.957679 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.959325 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:55:39.959325 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:55:39.962482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:55:39.964149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:55:39.964149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.964149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:55:39.980393 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m13:55:39.986296 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:55:39.991294 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:55:39.991294 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:55:39.992902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m13:55:39.996184 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:55:39.997953 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:55:39.997953 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:55:40.005020 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.013 seconds
[0m13:55:40.006626 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:55:40.008346 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6DF1090>]}
[0m13:55:40.010070 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:55:40.011778 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:55:40.018344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m13:55:40.018344 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:55:40.020013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61bdb42-ed87-467c-bb52-dd832f778a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD7523A50>]}
[0m13:55:40.020013 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:55:40.021729 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:55:40.023320 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:40.023320 [debug] [MainThread]: On master: BEGIN
[0m13:55:40.025260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:40.054066 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m13:55:40.054066 [debug] [MainThread]: On master: COMMIT
[0m13:55:40.054066 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:40.055741 [debug] [MainThread]: On master: COMMIT
[0m13:55:40.059092 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:55:40.059092 [debug] [MainThread]: On master: Close
[0m13:55:40.059092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:40.059092 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:55:40.060765 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:55:40.060765 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:55:40.060765 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:55:40.060765 [info ] [MainThread]: 
[0m13:55:40.062304 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:55:40.062304 [debug] [MainThread]: Command end result
[0m13:55:40.076740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:55:40.078332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:55:40.083118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:55:40.083118 [info ] [MainThread]: 
[0m13:55:40.084719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:40.084719 [info ] [MainThread]: 
[0m13:55:40.084719 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:55:40.086273 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:40.086273 after 1.19 seconds
[0m13:55:40.086273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD0C81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD0C09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD0C08D50>]}
[0m13:55:40.086273 [debug] [MainThread]: Flushing usage events
[0m13:55:40.753790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:19.233707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021622387D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216223D9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216223DA6D0>]}


============================== 14:00:19.237674 | cff7e176-9886-4f49-87ab-e19c15f263f8 ==============================
[0m14:00:19.237674 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:00:19.238672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:00:19.398173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff7e176-9886-4f49-87ab-e19c15f263f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216224C6750>]}
[0m14:00:19.423158 [debug] [MainThread]: Command `dbt clean` succeeded at 14:00:19.422155 after 0.27 seconds
[0m14:00:19.423158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161C559A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002162228BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161C5D1C10>]}
[0m14:00:19.424159 [debug] [MainThread]: Flushing usage events
[0m14:00:20.178289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:32.047090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A93B6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AD189510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AD09FF90>]}


============================== 14:00:32.050086 | e59ec9d7-ed93-49b4-8f2f-4b5aff7c84ca ==============================
[0m14:00:32.050086 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:00:32.051104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:32.064095 [info ] [MainThread]: dbt version: 1.9.2
[0m14:00:32.065095 [info ] [MainThread]: python version: 3.11.9
[0m14:00:32.066095 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m14:00:32.066095 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:00:32.131609 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m14:00:32.132609 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m14:00:32.132609 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m14:00:32.133609 [info ] [MainThread]: adapter type: postgres
[0m14:00:32.134610 [info ] [MainThread]: adapter version: 1.9.0
[0m14:00:32.199154 [info ] [MainThread]: Configuration:
[0m14:00:32.200136 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:00:32.201138 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:00:32.202137 [info ] [MainThread]: Required dependencies:
[0m14:00:32.202137 [debug] [MainThread]: Executing "git --help"
[0m14:00:32.242138 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:00:32.242138 [debug] [MainThread]: STDERR: "b''"
[0m14:00:32.243140 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:00:32.243140 [info ] [MainThread]: Connection:
[0m14:00:32.244136 [info ] [MainThread]:   host: 172.16.0.239
[0m14:00:32.244136 [info ] [MainThread]:   port: 5432
[0m14:00:32.245137 [info ] [MainThread]:   user: dmx-op-user
[0m14:00:32.245137 [info ] [MainThread]:   database: operacoes
[0m14:00:32.245137 [info ] [MainThread]:   schema: public
[0m14:00:32.246136 [info ] [MainThread]:   connect_timeout: 10
[0m14:00:32.246136 [info ] [MainThread]:   role: None
[0m14:00:32.247136 [info ] [MainThread]:   search_path: None
[0m14:00:32.247136 [info ] [MainThread]:   keepalives_idle: 0
[0m14:00:32.247136 [info ] [MainThread]:   sslmode: None
[0m14:00:32.248136 [info ] [MainThread]:   sslcert: None
[0m14:00:32.248136 [info ] [MainThread]:   sslkey: None
[0m14:00:32.249137 [info ] [MainThread]:   sslrootcert: None
[0m14:00:32.249137 [info ] [MainThread]:   application_name: dbt
[0m14:00:32.250139 [info ] [MainThread]:   retries: 1
[0m14:00:32.250139 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:32.540015 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:00:32.589042 [debug] [MainThread]: Using postgres connection "debug"
[0m14:00:32.590044 [debug] [MainThread]: On debug: select 1 as id
[0m14:00:32.590044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:32.791196 [debug] [MainThread]: SQL status: SELECT 1 in 0.201 seconds
[0m14:00:32.792214 [debug] [MainThread]: On debug: Close
[0m14:00:32.793215 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:00:32.793215 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:00:32.795227 [debug] [MainThread]: Command `dbt debug` succeeded at 14:00:32.795227 after 0.80 seconds
[0m14:00:32.795227 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:00:32.795227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AD69B810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AD4BC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A7559A50>]}
[0m14:00:32.796213 [debug] [MainThread]: Flushing usage events
[0m14:00:33.455617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:37.163798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E38E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E3D9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E3DB490>]}


============================== 14:00:37.166797 | d6db19d9-9df5-4c2e-971c-1e4aa27dbdac ==============================
[0m14:00:37.166797 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:00:37.167798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:00:37.315819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E403BD0>]}
[0m14:00:37.356819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24A509590>]}
[0m14:00:37.357820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:37.540720 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:00:37.541721 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:00:37.542705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E5009D0>]}
[0m14:00:38.283102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E019C90>]}
[0m14:00:38.328996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:00:38.332480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:00:38.350626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E8A2AD0>]}
[0m14:00:38.351627 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m14:00:38.352625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E7FE610>]}
[0m14:00:38.353627 [info ] [MainThread]: 
[0m14:00:38.353627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:38.354625 [info ] [MainThread]: 
[0m14:00:38.355625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:38.358626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:00:38.415366 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:00:38.415366 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:00:38.415366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:38.466371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m14:00:38.468375 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:00:38.469376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:00:38.474372 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:00:38.475372 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:00:38.475372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:38.527903 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m14:00:38.528882 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:00:38.528882 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:00:38.537881 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m14:00:38.538885 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:00:38.543883 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:00:38.548884 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.549883 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.549883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:38.590823 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m14:00:38.590823 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.591824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:38.599840 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m14:00:38.601828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E9ED010>]}
[0m14:00:38.602827 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:38.605897 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.605897 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.612910 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:00:38.613911 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.614914 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.614914 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.617912 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:00:38.618910 [debug] [MainThread]: On master: Close
[0m14:00:38.622909 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m14:00:38.623930 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m14:00:38.624910 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m14:00:38.624910 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m14:00:38.626934 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m14:00:38.626934 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m14:00:38.627908 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m14:00:38.628909 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m14:00:38.634909 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.636930 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m14:00:38.639908 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m14:00:38.664914 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.665914 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m14:00:38.669008 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m14:00:38.670915 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.671915 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m14:00:38.671915 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.671915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:38.672930 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m14:00:38.672930 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:00:38.705973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m14:00:38.707000 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.708064 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m14:00:38.717341 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:00:38.726438 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.726438 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m14:00:38.730700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:00:38.735813 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.736812 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m14:00:38.738751 [debug] [Thread-2 (]: SQL status: BEGIN in 0.065 seconds
[0m14:00:38.739711 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.739711 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m14:00:38.744762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:00:38.761709 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:00:38.761709 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m14:00:38.762706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.766713 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.766713 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:00:38.767714 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m14:00:38.772854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:00:38.774860 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.775860 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m14:00:38.779986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:00:38.781010 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:00:38.781010 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.781988 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m14:00:38.788988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m14:00:38.796987 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m14:00:38.799985 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:00:38.800985 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m14:00:38.808995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m14:00:38.810998 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m14:00:38.810998 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m14:00:38.811998 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m14:00:38.820000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m14:00:38.822006 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m14:00:38.824007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E87C690>]}
[0m14:00:38.825007 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:00:38.826006 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m14:00:38.834312 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m14:00:38.835311 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m14:00:38.836311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6db19d9-9df5-4c2e-971c-1e4aa27dbdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24EF21B90>]}
[0m14:00:38.837311 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:00:38.838312 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m14:00:38.839313 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.839313 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.840312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:38.883276 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m14:00:38.883276 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.884171 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.884171 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.887282 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:00:38.888257 [debug] [MainThread]: On master: Close
[0m14:00:38.889292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:38.889292 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:00:38.889292 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:00:38.890277 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m14:00:38.890277 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m14:00:38.890277 [info ] [MainThread]: 
[0m14:00:38.891171 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m14:00:38.892171 [debug] [MainThread]: Command end result
[0m14:00:38.905170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:00:38.908188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:00:38.912186 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m14:00:38.913169 [info ] [MainThread]: 
[0m14:00:38.913169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:38.914170 [info ] [MainThread]: 
[0m14:00:38.915170 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:00:38.916198 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:38.916198 after 1.81 seconds
[0m14:00:38.916198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24E0B9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2486D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E248658D50>]}
[0m14:00:38.917170 [debug] [MainThread]: Flushing usage events
[0m14:00:39.612963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:13:15.141408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A553F90350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5533E6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A553FDBDD0>]}


============================== 08:13:15.156450 | ea0fcbec-8262-4c98-aa29-2fb3a60e898b ==============================
[0m08:13:15.156450 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:13:15.158434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:13:15.354599 [info ] [MainThread]: dbt version: 1.9.2
[0m08:13:15.355592 [info ] [MainThread]: python version: 3.11.9
[0m08:13:15.356522 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:13:15.357477 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:13:15.669392 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:13:15.670401 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:13:15.671436 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:13:15.679417 [info ] [MainThread]: adapter type: postgres
[0m08:13:15.680418 [info ] [MainThread]: adapter version: 1.9.0
[0m08:13:15.763405 [info ] [MainThread]: Configuration:
[0m08:13:15.764404 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:13:15.765407 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:13:15.765407 [info ] [MainThread]: Required dependencies:
[0m08:13:15.766412 [debug] [MainThread]: Executing "git --help"
[0m08:13:15.816948 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:13:15.817973 [debug] [MainThread]: STDERR: "b''"
[0m08:13:15.819950 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:13:15.820947 [info ] [MainThread]: Connection:
[0m08:13:15.821948 [info ] [MainThread]:   host: 172.16.0.239
[0m08:13:15.822948 [info ] [MainThread]:   port: 5432
[0m08:13:15.822948 [info ] [MainThread]:   user: dmx-op-user
[0m08:13:15.823948 [info ] [MainThread]:   database: operacoes
[0m08:13:15.824947 [info ] [MainThread]:   schema: public
[0m08:13:15.824947 [info ] [MainThread]:   connect_timeout: 10
[0m08:13:15.825947 [info ] [MainThread]:   role: None
[0m08:13:15.826948 [info ] [MainThread]:   search_path: None
[0m08:13:15.827949 [info ] [MainThread]:   keepalives_idle: 0
[0m08:13:15.827949 [info ] [MainThread]:   sslmode: None
[0m08:13:15.828948 [info ] [MainThread]:   sslcert: None
[0m08:13:15.829949 [info ] [MainThread]:   sslkey: None
[0m08:13:15.829949 [info ] [MainThread]:   sslrootcert: None
[0m08:13:15.830949 [info ] [MainThread]:   application_name: dbt
[0m08:13:15.830949 [info ] [MainThread]:   retries: 1
[0m08:13:15.831948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:13:16.146731 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:13:18.400944 [debug] [MainThread]: Using postgres connection "debug"
[0m08:13:18.400944 [debug] [MainThread]: On debug: select 1 as id
[0m08:13:18.401943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:18.448942 [debug] [MainThread]: SQL status: SELECT 1 in 0.047 seconds
[0m08:13:18.449940 [debug] [MainThread]: On debug: Close
[0m08:13:18.450940 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:13:18.450940 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:13:18.452963 [debug] [MainThread]: Command `dbt debug` succeeded at 08:13:18.452963 after 3.37 seconds
[0m08:13:18.452963 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:13:18.452963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A553E8C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F1D1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F1D1C10>]}
[0m08:13:18.453940 [debug] [MainThread]: Flushing usage events
[0m08:13:19.165184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:13:22.907487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF36F8DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF36FDA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF36F8E350>]}


============================== 08:13:22.911485 | c9d23462-5fdf-4f68-9ed3-f967834e28ef ==============================
[0m08:13:22.911485 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:13:22.912485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:13:23.132227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38100C90>]}
[0m08:13:23.174270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF34109850>]}
[0m08:13:23.175250 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:13:23.397369 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:13:24.461120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:13:24.462124 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\d_Cedentes.sql
[0m08:13:24.463134 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m08:13:24.707713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3873E550>]}
[0m08:13:24.752608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:13:24.774253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:13:24.822348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF388F1590>]}
[0m08:13:24.823349 [info ] [MainThread]: Found 3 models, 3 sources, 433 macros
[0m08:13:24.824349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38805E10>]}
[0m08:13:24.827374 [info ] [MainThread]: 
[0m08:13:24.828358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:24.829349 [info ] [MainThread]: 
[0m08:13:24.829349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:13:24.833366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:13:24.889896 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:13:24.890897 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:13:24.890897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:24.943679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m08:13:24.944679 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:13:24.946679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:13:24.950679 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:13:24.950679 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:13:24.950679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:25.004073 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m08:13:25.005073 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:13:25.005073 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:13:25.013073 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m08:13:25.014073 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:13:25.017073 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:13:25.022073 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.022073 [debug] [MainThread]: On master: BEGIN
[0m08:13:25.023074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:25.083096 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m08:13:25.084096 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.084096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:13:25.092096 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m08:13:25.093097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38C5E690>]}
[0m08:13:25.094096 [debug] [MainThread]: On master: ROLLBACK
[0m08:13:25.098097 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.098097 [debug] [MainThread]: On master: BEGIN
[0m08:13:25.104106 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:13:25.105097 [debug] [MainThread]: On master: COMMIT
[0m08:13:25.105097 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.105097 [debug] [MainThread]: On master: COMMIT
[0m08:13:25.109097 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:13:25.109097 [debug] [MainThread]: On master: Close
[0m08:13:25.113097 [debug] [Thread-1 (]: Began running node model.my_dbt_project.d_Cedentes
[0m08:13:25.113097 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:13:25.113097 [debug] [Thread-3 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:13:25.114098 [info ] [Thread-1 (]: 1 of 3 START sql view model public.d_Cedentes .................................. [RUN]
[0m08:13:25.115098 [info ] [Thread-2 (]: 2 of 3 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:13:25.116097 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.d_Cedentes'
[0m08:13:25.115098 [info ] [Thread-3 (]: 3 of 3 START sql view model public.titulosaberto ............................... [RUN]
[0m08:13:25.116097 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:13:25.117100 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.d_Cedentes
[0m08:13:25.117100 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:13:25.118098 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:13:25.123097 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.d_Cedentes"
[0m08:13:25.124099 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:13:25.126097 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.129097 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:13:25.131098 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.d_Cedentes
[0m08:13:25.131098 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:13:25.153119 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:13:25.163099 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.211468 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:13:25.212367 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.213366 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:13:25.213366 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.213366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:13:25.214469 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:13:25.215367 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:13:25.248366 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m08:13:25.248366 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.249365 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m08:13:25.256365 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:13:25.261367 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.262365 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:13:25.265476 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:13:25.268373 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.269371 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:13:25.269371 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m08:13:25.270371 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.270371 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:13:25.273371 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:13:25.284687 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:13:25.285686 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m08:13:25.285686 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.287689 [debug] [Thread-1 (]: Compilation Error in model d_Cedentes (models\d_Cedentes.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "operacoes"."public"."d_cedentes", or rename it to be less ambiguous.
  Searched for: "operacoes"."public"."d_Cedentes"
  Found: "operacoes"."public"."d_cedentes"
  
  > in macro load_cached_relation (macros\adapters\relation.sql)
  > called by macro materialization_view_default (macros\materializations\models\view.sql)
  > called by model d_Cedentes (models\d_Cedentes.sql)
[0m08:13:25.289688 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.290704 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:13:25.291705 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:13:25.296687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:13:25.299688 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.299688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38627310>]}
[0m08:13:25.300688 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:13:25.301687 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.d_Cedentes ......................... [[31mERROR[0m in 0.18s]
[0m08:13:25.302688 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.d_Cedentes
[0m08:13:25.303687 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.d_Cedentes' to be skipped because of status 'error'.  Reason: Compilation Error in model d_Cedentes (models\d_Cedentes.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "operacoes"."public"."d_cedentes", or rename it to be less ambiguous.
  Searched for: "operacoes"."public"."d_Cedentes"
  Found: "operacoes"."public"."d_cedentes"
  
  > in macro load_cached_relation (macros\adapters\relation.sql)
  > called by macro materialization_view_default (macros\materializations\models\view.sql)
  > called by model d_Cedentes (models\d_Cedentes.sql).
[0m08:13:25.314686 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m08:13:25.315688 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:13:25.316689 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.316689 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:13:25.317689 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m08:13:25.322692 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:13:25.327688 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:13:25.327688 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:13:25.346686 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m08:13:25.346686 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m08:13:25.348686 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:13:25.350703 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:13:25.351704 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:13:25.351704 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:13:25.352687 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3871F410>]}
[0m08:13:25.353686 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m08:13:25.353686 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:13:25.375689 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m08:13:25.376690 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:13:25.378195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d23462-5fdf-4f68-9ed3-f967834e28ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38544950>]}
[0m08:13:25.379207 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.26s]
[0m08:13:25.380199 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:13:25.381199 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.382202 [debug] [MainThread]: On master: BEGIN
[0m08:13:25.382202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:13:25.423981 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m08:13:25.424966 [debug] [MainThread]: On master: COMMIT
[0m08:13:25.425981 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:25.425981 [debug] [MainThread]: On master: COMMIT
[0m08:13:25.429978 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:13:25.429978 [debug] [MainThread]: On master: Close
[0m08:13:25.430964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:25.430964 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:13:25.430964 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:13:25.431965 [debug] [MainThread]: Connection 'model.my_dbt_project.d_Cedentes' was properly closed.
[0m08:13:25.431965 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:13:25.432964 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:13:25.433981 [info ] [MainThread]: 
[0m08:13:25.434965 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m08:13:25.435964 [debug] [MainThread]: Command end result
[0m08:13:25.450966 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:13:25.452966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:13:25.458966 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:13:25.458966 [info ] [MainThread]: 
[0m08:13:25.459965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:13:25.460966 [info ] [MainThread]: 
[0m08:13:25.460966 [error] [MainThread]:   Compilation Error in model d_Cedentes (models\d_Cedentes.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "operacoes"."public"."d_cedentes", or rename it to be less ambiguous.
  Searched for: "operacoes"."public"."d_Cedentes"
  Found: "operacoes"."public"."d_cedentes"
  
  > in macro load_cached_relation (macros\adapters\relation.sql)
  > called by macro materialization_view_default (macros\materializations\models\view.sql)
  > called by model d_Cedentes (models\d_Cedentes.sql)
[0m08:13:25.461965 [info ] [MainThread]: 
[0m08:13:25.461965 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:13:25.462967 [debug] [MainThread]: Command `dbt run` failed at 08:13:25.462967 after 2.62 seconds
[0m08:13:25.463973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF32159950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF321D1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF38791F10>]}
[0m08:13:25.463973 [debug] [MainThread]: Flushing usage events
[0m08:13:26.103335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:26.930565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F585D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F5D8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F5D9FD0>]}


============================== 08:17:26.933554 | 70472b83-bd2f-45da-9b7d-4fd502fb9b33 ==============================
[0m08:17:26.933554 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:17:26.934556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:17:26.945555 [info ] [MainThread]: dbt version: 1.9.2
[0m08:17:26.946555 [info ] [MainThread]: python version: 3.11.9
[0m08:17:26.947596 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:17:26.947596 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:17:27.001824 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:17:27.002718 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:17:27.002718 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:17:27.003825 [info ] [MainThread]: adapter type: postgres
[0m08:17:27.004717 [info ] [MainThread]: adapter version: 1.9.0
[0m08:17:27.075339 [info ] [MainThread]: Configuration:
[0m08:17:27.075339 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:17:27.076272 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:17:27.076272 [info ] [MainThread]: Required dependencies:
[0m08:17:27.077302 [debug] [MainThread]: Executing "git --help"
[0m08:17:27.117252 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:17:27.117252 [debug] [MainThread]: STDERR: "b''"
[0m08:17:27.118228 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:17:27.118228 [info ] [MainThread]: Connection:
[0m08:17:27.119229 [info ] [MainThread]:   host: 172.16.0.239
[0m08:17:27.119229 [info ] [MainThread]:   port: 5432
[0m08:17:27.120230 [info ] [MainThread]:   user: dmx-op-user
[0m08:17:27.120230 [info ] [MainThread]:   database: operacoes
[0m08:17:27.121230 [info ] [MainThread]:   schema: public
[0m08:17:27.121230 [info ] [MainThread]:   connect_timeout: 10
[0m08:17:27.122228 [info ] [MainThread]:   role: None
[0m08:17:27.122228 [info ] [MainThread]:   search_path: None
[0m08:17:27.123230 [info ] [MainThread]:   keepalives_idle: 0
[0m08:17:27.123230 [info ] [MainThread]:   sslmode: None
[0m08:17:27.124236 [info ] [MainThread]:   sslcert: None
[0m08:17:27.125229 [info ] [MainThread]:   sslkey: None
[0m08:17:27.125229 [info ] [MainThread]:   sslrootcert: None
[0m08:17:27.126229 [info ] [MainThread]:   application_name: dbt
[0m08:17:27.126229 [info ] [MainThread]:   retries: 1
[0m08:17:27.126229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:17:27.314507 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:17:27.356534 [debug] [MainThread]: Using postgres connection "debug"
[0m08:17:27.357580 [debug] [MainThread]: On debug: select 1 as id
[0m08:17:27.357580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:17:27.408784 [debug] [MainThread]: SQL status: SELECT 1 in 0.051 seconds
[0m08:17:27.409799 [debug] [MainThread]: On debug: Close
[0m08:17:27.409799 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:17:27.410783 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:17:27.411784 [debug] [MainThread]: Command `dbt debug` succeeded at 08:17:27.411784 after 0.54 seconds
[0m08:17:27.411784 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:17:27.412800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E59841C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F7BCBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E597C9950>]}
[0m08:17:27.412800 [debug] [MainThread]: Flushing usage events
[0m08:17:28.135541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:32.583692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA018E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA01DAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA01DB050>]}


============================== 08:17:32.587693 | ea7176cd-e344-4d2f-b8e1-adc1f8a8661c ==============================
[0m08:17:32.587693 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:17:32.588693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:17:32.736847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0300A50>]}
[0m08:17:32.776950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9C309AD0>]}
[0m08:17:32.778848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:17:32.955979 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:17:33.052152 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m08:17:33.053154 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\d_cedentes.sql
[0m08:17:33.053154 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\d_Cedentes.sql
[0m08:17:33.217603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0816AD0>]}
[0m08:17:33.260132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:17:33.264134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:17:33.278147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA09FAB90>]}
[0m08:17:33.279134 [info ] [MainThread]: Found 3 models, 3 sources, 433 macros
[0m08:17:33.280133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA07E3ED0>]}
[0m08:17:33.281135 [info ] [MainThread]: 
[0m08:17:33.282133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:17:33.282133 [info ] [MainThread]: 
[0m08:17:33.283133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:17:33.287137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:17:33.340596 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:17:33.341594 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:17:33.342594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:33.391797 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m08:17:33.394815 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:17:33.397718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:17:33.405242 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:17:33.405242 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:17:33.406244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:33.460728 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m08:17:33.461813 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:17:33.462813 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:17:33.470874 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m08:17:33.473807 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:17:33.477811 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:17:33.488203 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.489192 [debug] [MainThread]: On master: BEGIN
[0m08:17:33.489192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:17:33.551752 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m08:17:33.553645 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.554644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:17:33.577192 [debug] [MainThread]: SQL status: SELECT 2 in 0.022 seconds
[0m08:17:33.582192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0817B10>]}
[0m08:17:33.583204 [debug] [MainThread]: On master: ROLLBACK
[0m08:17:33.588625 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.589716 [debug] [MainThread]: On master: BEGIN
[0m08:17:33.597582 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:17:33.598789 [debug] [MainThread]: On master: COMMIT
[0m08:17:33.599405 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.600434 [debug] [MainThread]: On master: COMMIT
[0m08:17:33.605422 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m08:17:33.606427 [debug] [MainThread]: On master: Close
[0m08:17:33.614093 [debug] [Thread-1 (]: Began running node model.my_dbt_project.d_cedentes
[0m08:17:33.615113 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:17:33.615113 [debug] [Thread-3 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:17:33.616591 [info ] [Thread-1 (]: 1 of 3 START sql view model public.d_cedentes .................................. [RUN]
[0m08:17:33.617635 [info ] [Thread-2 (]: 2 of 3 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:17:33.619617 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.d_cedentes'
[0m08:17:33.618619 [info ] [Thread-3 (]: 3 of 3 START sql view model public.titulosaberto ............................... [RUN]
[0m08:17:33.621616 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:17:33.622616 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.d_cedentes
[0m08:17:33.623615 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:17:33.623615 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:17:33.631610 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.d_cedentes"
[0m08:17:33.632611 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:17:33.635610 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.639715 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:17:33.639715 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.d_cedentes
[0m08:17:33.640613 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:17:33.664610 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.d_cedentes"
[0m08:17:33.667609 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.667609 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:17:33.670609 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:17:33.671610 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.671610 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.672610 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: BEGIN
[0m08:17:33.672610 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:17:33.672610 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.673611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:17:33.673611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:17:33.674611 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:17:33.675612 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:17:33.711137 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m08:17:33.711137 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.712121 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:17:33.717118 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m08:17:33.717118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m08:17:33.717118 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.718121 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.718121 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:17:33.719119 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m08:17:33.719119 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */

  create view "operacoes"."public"."d_cedentes__dbt_tmp"
    
    
  as (
    SELECT 
    CAST(nome AS VARCHAR(8000)) AS nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    CAST(endereco AS VARCHAR(8000)) AS endereco,
    CAST(cep AS VARCHAR(8000)) AS cep,
    CAST(cidade AS VARCHAR(8000)) AS cidade,
    CAST(uf AS VARCHAR(8000)) AS uf,
    CAST(email AS VARCHAR(8000)) AS email,
    CAST(telefone AS VARCHAR(8000)) AS telefone,
    CAST(gerente AS VARCHAR(8000)) AS gerente,
    CAST(operador AS VARCHAR(8000)) AS operador,
    CAST(captador AS VARCHAR(8000)) AS captador,
    CAST(controlador AS VARCHAR(8000)) AS controlador,
    CAST(fator_percentual AS VARCHAR(8000)) AS fator_percentual,
    CAST(advalorem_percentual AS VARCHAR(8000)) AS advalorem_percentual,
    CAST(data_cadastro AS VARCHAR(8000)) AS data_cadastro,
    CAST(fonte_captacao AS VARCHAR(8000)) AS fonte_captacao,
    CAST(setor AS VARCHAR(8000)) AS setor,
    CAST(grupo_economico AS VARCHAR(8000)) AS grupo_economico,
    CAST(bloqueado AS VARCHAR(8000)) AS bloqueado,
    CAST(primeira_operacao AS VARCHAR(8000)) AS primeira_operacao,
    CAST(limite_global AS DECIMAL(10,2)) AS limite_global,
    CAST(limite_boleto_especial AS DECIMAL(10,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS DECIMAL(10,2)) AS limite_comissaria,
    CAST(limite_tranche AS DECIMAL(10,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS VARCHAR(8000)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS VARCHAR(8000)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS VARCHAR(8000)) AS limite_operacao_clean,
    CAST(risco_atual AS DECIMAL(10,2)) AS risco_atual,
    CAST(saldo AS DECIMAL(10,2)) AS saldo,
    CAST(vencimento_contrato AS VARCHAR(8000)) AS vencimento_contrato,
    CAST(id_cedente AS INT) AS id_cedente,
    CAST(timestamp_extracao AS VARCHAR(8000)) AS timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m08:17:33.724121 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.725120 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:17:33.728136 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:17:33.730122 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.730122 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:17:33.731121 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:17:33.731121 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m08:17:33.733121 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.735119 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.735119 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m08:17:33.736119 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
alter table "operacoes"."public"."d_cedentes" rename to "d_cedentes__dbt_backup"
[0m08:17:33.736119 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:17:33.747119 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:17:33.748118 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.749121 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:17:33.751118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:17:33.751118 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:17:33.753121 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.756120 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.756120 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
alter table "operacoes"."public"."d_cedentes__dbt_tmp" rename to "d_cedentes"
[0m08:17:33.757121 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:17:33.762119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m08:17:33.762119 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m08:17:33.764121 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: COMMIT
[0m08:17:33.765120 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:17:33.765120 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.766121 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.767120 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: COMMIT
[0m08:17:33.767120 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:17:33.779119 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m08:17:33.783121 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:17:33.787127 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:17:33.787127 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:17:33.794127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m08:17:33.794127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m08:17:33.796125 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:17:33.798125 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."d_cedentes__dbt_backup"
[0m08:17:33.798125 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:17:33.834940 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.047 seconds
[0m08:17:33.836957 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:17:33.836957 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:17:33.838958 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:17:33.839693 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */
drop table if exists "operacoes"."public"."d_cedentes__dbt_backup" cascade
[0m08:17:33.840710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0ED7ED0>]}
[0m08:17:33.841710 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.22s]
[0m08:17:33.842695 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:17:33.868723 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.029 seconds
[0m08:17:33.869787 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:17:33.870790 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0F17E10>]}
[0m08:17:33.871785 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m08:17:33.872078 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:17:33.889517 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m08:17:33.892625 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: Close
[0m08:17:33.893527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7176cd-e344-4d2f-b8e1-adc1f8a8661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEA0F018D0>]}
[0m08:17:33.893527 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.d_cedentes ............................. [[32mCREATE VIEW[0m in 0.27s]
[0m08:17:33.894558 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.d_cedentes
[0m08:17:33.896524 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.896524 [debug] [MainThread]: On master: BEGIN
[0m08:17:33.896524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:17:33.935134 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m08:17:33.936135 [debug] [MainThread]: On master: COMMIT
[0m08:17:33.936135 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:33.937138 [debug] [MainThread]: On master: COMMIT
[0m08:17:33.940134 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:17:33.941150 [debug] [MainThread]: On master: Close
[0m08:17:33.942137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:33.942137 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:17:33.943134 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:17:33.943134 [debug] [MainThread]: Connection 'model.my_dbt_project.d_cedentes' was properly closed.
[0m08:17:33.944135 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:17:33.944135 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:17:33.945134 [info ] [MainThread]: 
[0m08:17:33.946134 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m08:17:33.947135 [debug] [MainThread]: Command end result
[0m08:17:33.962133 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:17:33.964135 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:17:33.970133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:17:33.970133 [info ] [MainThread]: 
[0m08:17:33.971133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:17:33.971133 [info ] [MainThread]: 
[0m08:17:33.972134 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:17:33.973133 [debug] [MainThread]: Command `dbt run` succeeded at 08:17:33.973133 after 1.44 seconds
[0m08:17:33.974135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9A4B1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9A4B1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9A438D50>]}
[0m08:17:33.974135 [debug] [MainThread]: Flushing usage events
[0m08:17:34.608791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:26.310319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB008E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACAEBC80D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACACD33C10>]}


============================== 08:43:26.315320 | 33cfc4fe-294e-4e9b-9df4-49805207abd9 ==============================
[0m08:43:26.315320 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:43:26.316320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:43:26.458892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33cfc4fe-294e-4e9b-9df4-49805207abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB01070D0>]}
[0m08:43:26.493822 [debug] [MainThread]: Command `dbt clean` succeeded at 08:43:26.493822 after 0.26 seconds
[0m08:43:26.494823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACB00B7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACAA209950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACAA208DD0>]}
[0m08:43:26.494823 [debug] [MainThread]: Flushing usage events
[0m08:43:27.199921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:32.311146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BD9C80D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BD987F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BD987090>]}


============================== 08:43:32.314662 | fdbad593-4aa0-49c7-bcdd-975d9a0e82cb ==============================
[0m08:43:32.314662 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:43:32.314662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:43:32.326661 [info ] [MainThread]: dbt version: 1.9.2
[0m08:43:32.327664 [info ] [MainThread]: python version: 3.11.9
[0m08:43:32.327664 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:43:32.328686 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:43:32.399669 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:43:32.400670 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:43:32.401670 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:43:32.402670 [info ] [MainThread]: adapter type: postgres
[0m08:43:32.403671 [info ] [MainThread]: adapter version: 1.9.0
[0m08:43:32.472183 [info ] [MainThread]: Configuration:
[0m08:43:32.473184 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:43:32.474182 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:43:32.475183 [info ] [MainThread]: Required dependencies:
[0m08:43:32.475183 [debug] [MainThread]: Executing "git --help"
[0m08:43:32.517740 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:43:32.518729 [debug] [MainThread]: STDERR: "b''"
[0m08:43:32.519728 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:43:32.519728 [info ] [MainThread]: Connection:
[0m08:43:32.520771 [info ] [MainThread]:   host: 172.16.0.239
[0m08:43:32.520771 [info ] [MainThread]:   port: 5432
[0m08:43:32.520771 [info ] [MainThread]:   user: dmx-op-user
[0m08:43:32.521731 [info ] [MainThread]:   database: operacoes
[0m08:43:32.522744 [info ] [MainThread]:   schema: public
[0m08:43:32.522744 [info ] [MainThread]:   connect_timeout: 10
[0m08:43:32.523734 [info ] [MainThread]:   role: None
[0m08:43:32.523734 [info ] [MainThread]:   search_path: None
[0m08:43:32.524756 [info ] [MainThread]:   keepalives_idle: 0
[0m08:43:32.525744 [info ] [MainThread]:   sslmode: None
[0m08:43:32.525744 [info ] [MainThread]:   sslcert: None
[0m08:43:32.526731 [info ] [MainThread]:   sslkey: None
[0m08:43:32.526731 [info ] [MainThread]:   sslrootcert: None
[0m08:43:32.527731 [info ] [MainThread]:   application_name: dbt
[0m08:43:32.527731 [info ] [MainThread]:   retries: 1
[0m08:43:32.528729 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:43:32.720990 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:43:32.767035 [debug] [MainThread]: Using postgres connection "debug"
[0m08:43:32.767992 [debug] [MainThread]: On debug: select 1 as id
[0m08:43:32.767992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:43:32.824908 [debug] [MainThread]: SQL status: SELECT 1 in 0.057 seconds
[0m08:43:32.826911 [debug] [MainThread]: On debug: Close
[0m08:43:32.826911 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:43:32.827910 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:43:32.830021 [debug] [MainThread]: Command `dbt debug` succeeded at 08:43:32.829032 after 0.61 seconds
[0m08:43:32.830021 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:43:32.830021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BD889450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BDB78510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BD9C84D0>]}
[0m08:43:32.830910 [debug] [MainThread]: Flushing usage events
[0m08:43:33.472060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:37.497549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E185750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4CEB9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E185710>]}


============================== 08:43:37.500581 | cbabdf48-98d4-400d-9fe0-5e6b87c1b773 ==============================
[0m08:43:37.500581 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:43:37.501550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:43:37.648666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E2F3210>]}
[0m08:43:37.688626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4A309450>]}
[0m08:43:37.689626 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:43:37.869464 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:43:37.870462 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:43:37.871349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E5F1C10>]}
[0m08:43:38.583936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E914D90>]}
[0m08:43:38.628351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:43:38.632969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:43:38.651665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E64A050>]}
[0m08:43:38.652669 [info ] [MainThread]: Found 3 models, 3 sources, 433 macros
[0m08:43:38.653664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E8748D0>]}
[0m08:43:38.654773 [info ] [MainThread]: 
[0m08:43:38.655583 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:43:38.656242 [info ] [MainThread]: 
[0m08:43:38.657248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:43:38.660657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:43:38.711697 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:43:38.712697 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:43:38.712697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:38.775475 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m08:43:38.778501 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:43:38.781448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:43:38.790396 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:43:38.791430 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:43:38.791430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:38.838898 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m08:43:38.839897 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:43:38.839897 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:43:38.846915 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m08:43:38.848898 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:43:38.851897 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:43:38.856900 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:38.856900 [debug] [MainThread]: On master: BEGIN
[0m08:43:38.857902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:43:38.902920 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m08:43:38.902920 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:38.902920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:43:38.912900 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m08:43:38.914904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E7D8410>]}
[0m08:43:38.914904 [debug] [MainThread]: On master: ROLLBACK
[0m08:43:38.918900 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:38.918900 [debug] [MainThread]: On master: BEGIN
[0m08:43:38.925932 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:43:38.925932 [debug] [MainThread]: On master: COMMIT
[0m08:43:38.925932 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:38.926933 [debug] [MainThread]: On master: COMMIT
[0m08:43:38.929931 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:43:38.929931 [debug] [MainThread]: On master: Close
[0m08:43:38.932932 [debug] [Thread-1 (]: Began running node model.my_dbt_project.d_cedentes
[0m08:43:38.932932 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:43:38.932932 [debug] [Thread-3 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:43:38.933932 [info ] [Thread-1 (]: 1 of 3 START sql view model public.d_cedentes .................................. [RUN]
[0m08:43:38.933932 [info ] [Thread-2 (]: 2 of 3 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:43:38.934932 [info ] [Thread-3 (]: 3 of 3 START sql view model public.titulosaberto ............................... [RUN]
[0m08:43:38.935933 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.d_cedentes'
[0m08:43:38.935933 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:43:38.936933 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:43:38.936933 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.d_cedentes
[0m08:43:38.936933 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:43:38.937932 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:43:38.942933 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.d_cedentes"
[0m08:43:38.948934 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:38.955934 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:43:38.960935 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:43:38.960935 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:43:38.961937 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.d_cedentes
[0m08:43:38.990949 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:38.993949 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:43:38.997949 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.d_cedentes"
[0m08:43:38.999933 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:38.999933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:43:39.000933 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:43:39.000933 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.000933 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: BEGIN
[0m08:43:39.001933 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:43:39.001933 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:43:39.002967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:43:39.002967 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:43:39.034929 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m08:43:39.035929 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m08:43:39.035929 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.036929 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:39.036929 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m08:43:39.037930 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:43:39.045009 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:43:39.045009 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m08:43:39.053128 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:39.053128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m08:43:39.057020 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.058020 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:43:39.058020 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.d_cedentes"
[0m08:43:39.059022 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:43:39.060019 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.d_cedentes"} */

  create view "operacoes"."public"."d_cedentes__dbt_tmp"
    
    
  as (
    SELECT 
    CAST(nome AS VARCHAR(8000)) AS nome,
    CAST(cpf_cnpj AS BIGINT) AS cpf_cnpj,
    CAST(endereco AS VARCHAR(8000)) AS endereco,
    CAST(cep AS VARCHAR(8000)) AS cep,
    CAST(cidade AS VARCHAR(8000)) AS cidade,
    CAST(uf AS VARCHAR(8000)) AS uf,
    CAST(email AS VARCHAR(8000)) AS email,
    CAST(telefone AS VARCHAR(8000)) AS telefone,
    CAST(gerente AS VARCHAR(8000)) AS gerente,
    CAST(operador AS VARCHAR(8000)) AS operador,
    CAST(captador AS VARCHAR(8000)) AS captador,
    CAST(controlador AS VARCHAR(8000)) AS controlador,
    CAST(fator_percentual AS VARCHAR(8000)) AS fator_percentual,
    CAST(advalorem_percentual AS VARCHAR(8000)) AS advalorem_percentual,
    CAST(data_cadastro AS VARCHAR(8000)) AS data_cadastro,
    CAST(fonte_captacao AS VARCHAR(8000)) AS fonte_captacao,
    CAST(setor AS VARCHAR(8000)) AS setor,
    CAST(grupo_economico AS VARCHAR(8000)) AS grupo_economico,
    CAST(bloqueado AS VARCHAR(8000)) AS bloqueado,
    CAST(primeira_operacao AS VARCHAR(8000)) AS primeira_operacao,
    CAST(limite_global AS DECIMAL(10,2)) AS limite_global,
    CAST(limite_boleto_especial AS DECIMAL(10,2)) AS limite_boleto_especial,
    CAST(limite_comissaria AS DECIMAL(10,2)) AS limite_comissaria,
    CAST(limite_tranche AS DECIMAL(10,2)) AS limite_tranche,
    CAST(limite_boleto_especial_tranche AS VARCHAR(8000)) AS limite_boleto_especial_tranche,
    CAST(limite_boleto_garantido AS VARCHAR(8000)) AS limite_boleto_garantido,
    CAST(limite_operacao_clean AS VARCHAR(8000)) AS limite_operacao_clean,
    CAST(risco_atual AS DECIMAL(10,2)) AS risco_atual,
    CAST(saldo AS DECIMAL(10,2)) AS saldo,
    CAST(vencimento_contrato AS VARCHAR(8000)) AS vencimento_contrato,
    CAST(id_cedente AS INT) AS id_cedente,
    CAST(timestamp_extracao AS VARCHAR(8000)) AS timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes"
  );
[0m08:43:39.063691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:43:39.064714 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m08:43:39.064714 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.d_cedentes" does not exist
LINE 41:     "operacoes"."public"."d_cedentes"
             ^

[0m08:43:39.067727 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.071065 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:39.072090 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: ROLLBACK
[0m08:43:39.072764 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:43:39.073773 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:43:39.076899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:43:39.077845 [debug] [Thread-1 (]: On model.my_dbt_project.d_cedentes: Close
[0m08:43:39.077845 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:43:39.095877 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:43:39.097818 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:43:39.098771 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:39.098771 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.098771 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:43:39.099888 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:43:39.120504 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m08:43:39.125616 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:43:39.128617 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:43:39.129617 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:43:39.134616 [debug] [Thread-3 (]: SQL status: COMMIT in 0.034 seconds
[0m08:43:39.135617 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:43:39.136617 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:43:39.136617 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:43:39.145149 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m08:43:39.147159 [debug] [Thread-2 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:43:39.149160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E928A10>]}
[0m08:43:39.149160 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m08:43:39.150159 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:43:39.152492 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m08:43:39.153499 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:43:39.154499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4ED3F8D0>]}
[0m08:43:39.155500 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m08:43:39.155500 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:43:39.179521 [debug] [Thread-1 (]: Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql
[0m08:43:39.180501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbabdf48-98d4-400d-9fe0-5e6b87c1b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4EBE1250>]}
[0m08:43:39.181501 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.d_cedentes ......................... [[31mERROR[0m in 0.25s]
[0m08:43:39.182501 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.d_cedentes
[0m08:43:39.183504 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.d_cedentes' to be skipped because of status 'error'.  Reason: Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql.
[0m08:43:39.184715 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:39.185725 [debug] [MainThread]: On master: BEGIN
[0m08:43:39.185725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:43:39.216226 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m08:43:39.217226 [debug] [MainThread]: On master: COMMIT
[0m08:43:39.217226 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:39.218227 [debug] [MainThread]: On master: COMMIT
[0m08:43:39.221225 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:43:39.221225 [debug] [MainThread]: On master: Close
[0m08:43:39.221225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:43:39.222731 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:43:39.222731 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:43:39.222731 [debug] [MainThread]: Connection 'model.my_dbt_project.d_cedentes' was properly closed.
[0m08:43:39.223753 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:43:39.223753 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:43:39.224738 [info ] [MainThread]: 
[0m08:43:39.224738 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:43:39.226738 [debug] [MainThread]: Command end result
[0m08:43:39.240737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:43:39.243736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:43:39.248738 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:43:39.249737 [info ] [MainThread]: 
[0m08:43:39.250737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:43:39.250737 [info ] [MainThread]: 
[0m08:43:39.251671 [error] [MainThread]:   Database Error in model d_cedentes (models\d_cedentes.sql)
  relation "public.d_cedentes" does not exist
  LINE 41:     "operacoes"."public"."d_cedentes"
               ^
  compiled code at target\run\my_dbt_project\models\d_cedentes.sql
[0m08:43:39.252362 [info ] [MainThread]: 
[0m08:43:39.252362 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:43:39.253367 [debug] [MainThread]: Command `dbt run` failed at 08:43:39.253367 after 1.81 seconds
[0m08:43:39.254369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B4E1DB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B48439950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B484B1C10>]}
[0m08:43:39.255367 [debug] [MainThread]: Flushing usage events
[0m08:43:39.905204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:35.563287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020195B85890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020195BD9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020195BDAC10>]}


============================== 08:46:35.566289 | 2514d3ca-3213-46c8-8a70-83e28b605e4d ==============================
[0m08:46:35.566289 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:46:35.567290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:46:35.669826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2514d3ca-3213-46c8-8a70-83e28b605e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020195C05850>]}
[0m08:46:35.685826 [debug] [MainThread]: Command `dbt clean` succeeded at 08:46:35.685826 after 0.18 seconds
[0m08:46:35.686842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018FD59950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018FD58DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018FDD1C10>]}
[0m08:46:35.686842 [debug] [MainThread]: Flushing usage events
[0m08:46:36.741156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:41.046087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025368887E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253688D8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253688877D0>]}


============================== 08:46:41.049096 | eda2f2cd-7388-431b-b555-758a1c5f3cf4 ==============================
[0m08:46:41.049096 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:46:41.050069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m08:46:41.061086 [info ] [MainThread]: dbt version: 1.9.2
[0m08:46:41.061086 [info ] [MainThread]: python version: 3.11.9
[0m08:46:41.062071 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:46:41.063070 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:46:41.116114 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:46:41.117098 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:46:41.118096 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:46:41.119097 [info ] [MainThread]: adapter type: postgres
[0m08:46:41.119097 [info ] [MainThread]: adapter version: 1.9.0
[0m08:46:41.186417 [info ] [MainThread]: Configuration:
[0m08:46:41.187416 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:46:41.188416 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:46:41.189416 [info ] [MainThread]: Required dependencies:
[0m08:46:41.189416 [debug] [MainThread]: Executing "git --help"
[0m08:46:41.228429 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:46:41.228429 [debug] [MainThread]: STDERR: "b''"
[0m08:46:41.229424 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:46:41.230424 [info ] [MainThread]: Connection:
[0m08:46:41.231450 [info ] [MainThread]:   host: 172.16.0.239
[0m08:46:41.231450 [info ] [MainThread]:   port: 5432
[0m08:46:41.231450 [info ] [MainThread]:   user: dmx-op-user
[0m08:46:41.232451 [info ] [MainThread]:   database: operacoes
[0m08:46:41.232451 [info ] [MainThread]:   schema: public
[0m08:46:41.233450 [info ] [MainThread]:   connect_timeout: 10
[0m08:46:41.233450 [info ] [MainThread]:   role: None
[0m08:46:41.233450 [info ] [MainThread]:   search_path: None
[0m08:46:41.234448 [info ] [MainThread]:   keepalives_idle: 0
[0m08:46:41.234448 [info ] [MainThread]:   sslmode: None
[0m08:46:41.234448 [info ] [MainThread]:   sslcert: None
[0m08:46:41.235449 [info ] [MainThread]:   sslkey: None
[0m08:46:41.236452 [info ] [MainThread]:   sslrootcert: None
[0m08:46:41.236452 [info ] [MainThread]:   application_name: dbt
[0m08:46:41.237450 [info ] [MainThread]:   retries: 1
[0m08:46:41.237450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:46:41.416876 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:46:41.457418 [debug] [MainThread]: Using postgres connection "debug"
[0m08:46:41.458421 [debug] [MainThread]: On debug: select 1 as id
[0m08:46:41.458421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:41.515253 [debug] [MainThread]: SQL status: SELECT 1 in 0.057 seconds
[0m08:46:41.517261 [debug] [MainThread]: On debug: Close
[0m08:46:41.517261 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:46:41.518262 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:46:41.519259 [debug] [MainThread]: Command `dbt debug` succeeded at 08:46:41.519259 after 0.53 seconds
[0m08:46:41.520267 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:46:41.520267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253688B7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025368B149D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025362AD1C10>]}
[0m08:46:41.521259 [debug] [MainThread]: Flushing usage events
[0m08:46:42.164043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:45.545009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCA8E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCAC8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCA85990>]}


============================== 08:46:45.548023 | 339ca43a-da92-4228-9bf8-ff6bc3ad310f ==============================
[0m08:46:45.548023 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:46:45.549006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:46:45.706602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCC6DAD0>]}
[0m08:46:45.746113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD7B491D0>]}
[0m08:46:45.747114 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:46:45.929148 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:46:45.929148 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:46:45.930147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCEAF950>]}
[0m08:46:46.616100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDD0DA950>]}
[0m08:46:46.658919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:46:46.663533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:46:46.678547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCF849D0>]}
[0m08:46:46.678547 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m08:46:46.679503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCF7FF50>]}
[0m08:46:46.680569 [info ] [MainThread]: 
[0m08:46:46.681541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:46:46.681541 [info ] [MainThread]: 
[0m08:46:46.682531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:46:46.687530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:46:46.739536 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:46:46.740541 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:46:46.740541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:46.777588 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m08:46:46.779492 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:46:46.782300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:46:46.787396 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:46:46.788389 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:46:46.788389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:46.821580 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m08:46:46.822691 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:46:46.822691 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:46:46.831005 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m08:46:46.833019 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:46:46.837168 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:46:46.846840 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:46.846840 [debug] [MainThread]: On master: BEGIN
[0m08:46:46.847833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:46.898391 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m08:46:46.899392 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:46.900394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:46:46.908390 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m08:46:46.909393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDCF06A50>]}
[0m08:46:46.910392 [debug] [MainThread]: On master: ROLLBACK
[0m08:46:46.913391 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:46.913391 [debug] [MainThread]: On master: BEGIN
[0m08:46:46.921408 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:46:46.922392 [debug] [MainThread]: On master: COMMIT
[0m08:46:46.922392 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:46.923392 [debug] [MainThread]: On master: COMMIT
[0m08:46:46.926729 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:46:46.926729 [debug] [MainThread]: On master: Close
[0m08:46:46.928758 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:46:46.928758 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:46:46.929779 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:46:46.929779 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:46:46.930762 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:46:46.931761 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:46:46.931761 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:46:46.931761 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:46:46.937781 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:46.939778 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:46:46.941762 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:46:46.941762 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:46:46.972298 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:46:46.973299 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:46.975102 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:46.976113 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:46:46.976113 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:46.976113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:46:46.977216 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:46:46.977674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:46:47.006997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m08:46:47.007998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m08:46:47.009014 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:47.009995 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:47.011010 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente,
    conf,
    conta,
    cpf_cnpj_cedente,
    cpf_cnpj_sacado,
    cr,
    TO_DATE(data_emissao, 'dd/MM/yyyy')::date AS data_emissao,
    documento,
    etapa,
    historico,
    CAST(id_titulo AS integer) AS id_titulo,
    id_titulo_original,
    m,
    motivo,
    nosso_numero,
    COALESCE(
         CAST(NULLIF(op,'') AS integer),0
    ) AS op,
    original,
    sacado,
    situacao,
    tipo,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_juros, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_juros,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_multa, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_multa,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_tarifas, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_tarifas,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(valor_total, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS valor_total,
    TO_DATE(vencimento, 'dd/MM/yyyy')::date AS vencimento,
    CAST(
        REGEXP_REPLACE(REGEXP_REPLACE(desagio, '\.', '', 'g'), ',', '.', 'g') AS decimal(18, 2)
    ) AS desagio
FROM 
    "operacoes"."public"."f_titulosemaberto"
  );
[0m08:46:47.011995 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:46:47.019030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:46:47.020052 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m08:46:47.030206 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:47.033931 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:47.034326 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:46:47.035159 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:46:47.039335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:47.040182 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:47.044792 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:47.048806 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:47.049855 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:46:47.050804 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:46:47.055344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:47.055344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:47.071887 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:46:47.072924 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:46:47.074982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:47.075510 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:47.075510 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:46:47.075510 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:46:47.097058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m08:46:47.106054 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:46:47.107054 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m08:46:47.110054 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:46:47.112053 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:46:47.113051 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:46:47.113051 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:46:47.114112 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:46:47.131971 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m08:46:47.133973 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:46:47.134973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDD0CBF50>]}
[0m08:46:47.135872 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:46:47.136871 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:46:47.146906 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m08:46:47.147905 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:46:47.148890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339ca43a-da92-4228-9bf8-ff6bc3ad310f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDD630C10>]}
[0m08:46:47.148890 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.22s]
[0m08:46:47.150892 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:46:47.152898 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:47.153891 [debug] [MainThread]: On master: BEGIN
[0m08:46:47.153891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:46:47.218260 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m08:46:47.219282 [debug] [MainThread]: On master: COMMIT
[0m08:46:47.219282 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:47.220262 [debug] [MainThread]: On master: COMMIT
[0m08:46:47.223278 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:46:47.223278 [debug] [MainThread]: On master: Close
[0m08:46:47.224260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:47.224260 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:46:47.224260 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:46:47.225260 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:46:47.225260 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:46:47.225260 [info ] [MainThread]: 
[0m08:46:47.226260 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m08:46:47.227260 [debug] [MainThread]: Command end result
[0m08:46:47.239313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:46:47.241297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:46:47.245855 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:46:47.245855 [info ] [MainThread]: 
[0m08:46:47.246855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:46:47.246855 [info ] [MainThread]: 
[0m08:46:47.247856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:46:47.249452 [debug] [MainThread]: Command `dbt run` succeeded at 08:46:47.249452 after 1.76 seconds
[0m08:46:47.249452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD6D31BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD6D31C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD6CB8D50>]}
[0m08:46:47.250448 [debug] [MainThread]: Flushing usage events
[0m08:46:47.890489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:49:36.468937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7C8C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7D9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7D9150>]}


============================== 08:49:36.473937 | 60742e96-85ef-48b7-a66c-620c56e3015c ==============================
[0m08:49:36.473937 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:49:36.474937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:49:36.614104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60742e96-85ef-48b7-a66c-620c56e3015c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C8077D0>]}
[0m08:49:36.637102 [debug] [MainThread]: Command `dbt clean` succeeded at 08:49:36.637102 after 0.23 seconds
[0m08:49:36.637102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7D9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7D8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81C7B7F50>]}
[0m08:49:36.638103 [debug] [MainThread]: Flushing usage events
[0m08:49:37.916684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:49:41.537453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D37FC4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D37FDA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D37FDA2D0>]}


============================== 08:49:41.541436 | c54455c2-a282-419a-bd2f-1a7072a45d08 ==============================
[0m08:49:41.541436 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:49:41.542437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:49:41.553451 [info ] [MainThread]: dbt version: 1.9.2
[0m08:49:41.554471 [info ] [MainThread]: python version: 3.11.9
[0m08:49:41.555435 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:49:41.555435 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:49:41.623802 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:49:41.624803 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:49:41.624803 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:49:41.627802 [info ] [MainThread]: adapter type: postgres
[0m08:49:41.628802 [info ] [MainThread]: adapter version: 1.9.0
[0m08:49:41.699905 [info ] [MainThread]: Configuration:
[0m08:49:41.700809 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:49:41.700809 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:49:41.701968 [info ] [MainThread]: Required dependencies:
[0m08:49:41.701968 [debug] [MainThread]: Executing "git --help"
[0m08:49:41.742968 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:49:41.743968 [debug] [MainThread]: STDERR: "b''"
[0m08:49:41.744969 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:49:41.745968 [info ] [MainThread]: Connection:
[0m08:49:41.746968 [info ] [MainThread]:   host: 172.16.0.239
[0m08:49:41.746968 [info ] [MainThread]:   port: 5432
[0m08:49:41.747967 [info ] [MainThread]:   user: dmx-op-user
[0m08:49:41.747967 [info ] [MainThread]:   database: operacoes
[0m08:49:41.748984 [info ] [MainThread]:   schema: public
[0m08:49:41.749967 [info ] [MainThread]:   connect_timeout: 10
[0m08:49:41.749967 [info ] [MainThread]:   role: None
[0m08:49:41.750969 [info ] [MainThread]:   search_path: None
[0m08:49:41.750969 [info ] [MainThread]:   keepalives_idle: 0
[0m08:49:41.751969 [info ] [MainThread]:   sslmode: None
[0m08:49:41.751969 [info ] [MainThread]:   sslcert: None
[0m08:49:41.752966 [info ] [MainThread]:   sslkey: None
[0m08:49:41.752966 [info ] [MainThread]:   sslrootcert: None
[0m08:49:41.753967 [info ] [MainThread]:   application_name: dbt
[0m08:49:41.753967 [info ] [MainThread]:   retries: 1
[0m08:49:41.754973 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:49:41.945281 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:49:41.990286 [debug] [MainThread]: Using postgres connection "debug"
[0m08:49:41.991287 [debug] [MainThread]: On debug: select 1 as id
[0m08:49:41.991287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:49:42.182331 [debug] [MainThread]: SQL status: SELECT 1 in 0.190 seconds
[0m08:49:42.186335 [debug] [MainThread]: On debug: Close
[0m08:49:42.187456 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:49:42.188436 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:49:42.189441 [debug] [MainThread]: Command `dbt debug` succeeded at 08:49:42.189441 after 0.71 seconds
[0m08:49:42.189441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:49:42.190442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D330F1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D37D9F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D371B1D50>]}
[0m08:49:42.190442 [debug] [MainThread]: Flushing usage events
[0m08:49:42.882956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:49:45.752967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1785F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C17DB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C17DBDD0>]}


============================== 08:49:45.755985 | cf00f69c-cb49-4c96-9ebb-98b9dd18efd2 ==============================
[0m08:49:45.755985 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:49:45.756967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:49:45.914996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf00f69c-cb49-4c96-9ebb-98b9dd18efd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C196C7D0>]}
[0m08:49:45.955999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf00f69c-cb49-4c96-9ebb-98b9dd18efd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BC828CD0>]}
[0m08:49:45.956999 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:49:46.137428 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:49:46.138451 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:49:46.138451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf00f69c-cb49-4c96-9ebb-98b9dd18efd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1BAFB90>]}
[0m08:49:46.807813 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto_fidc' which was not found
[0m08:49:46.809709 [debug] [MainThread]: Command `dbt run` failed at 08:49:46.809709 after 1.11 seconds
[0m08:49:46.810710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C17E6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB979A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1C83410>]}
[0m08:49:46.810710 [debug] [MainThread]: Flushing usage events
[0m08:49:47.456429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:50:13.880135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3AA8E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3A89FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3A988910>]}


============================== 08:50:13.884156 | 2e97a001-fb9e-40c4-8d4e-949731af112b ==============================
[0m08:50:13.884156 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:50:13.885135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:14.030483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e97a001-fb9e-40c4-8d4e-949731af112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3ACB5D90>]}
[0m08:50:14.068484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e97a001-fb9e-40c4-8d4e-949731af112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB35B69650>]}
[0m08:50:14.069496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:50:14.251816 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:50:14.252820 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:50:14.253720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e97a001-fb9e-40c4-8d4e-949731af112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3AC97150>]}
[0m08:50:14.848694 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.titulosaberto' (models\titulosaberto.sql) depends on a source named 'public.f_titulosemaberto_fidc' which was not found
[0m08:50:14.850395 [debug] [MainThread]: Command `dbt run` failed at 08:50:14.850395 after 1.02 seconds
[0m08:50:14.850395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3AAE5AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3AFAA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB3AA8E4D0>]}
[0m08:50:14.850395 [debug] [MainThread]: Flushing usage events
[0m08:50:15.507825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:24.751783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B4487F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B44DABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B44D9F50>]}


============================== 08:51:24.756024 | b3c4899f-b71b-471d-b4ad-51f17c29364f ==============================
[0m08:51:24.756024 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:24.757026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m08:51:24.870743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3c4899f-b71b-471d-b4ad-51f17c29364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B4575C90>]}
[0m08:51:24.887292 [debug] [MainThread]: Command `dbt clean` succeeded at 08:51:24.887292 after 0.19 seconds
[0m08:51:24.888307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AE659950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AE658DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AE6D1C10>]}
[0m08:51:24.888307 [debug] [MainThread]: Flushing usage events
[0m08:51:25.755122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:29.457267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A1585850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A15D9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A15DA6D0>]}


============================== 08:51:29.460285 | bc9490ff-3395-463f-9c1b-b60c3ede85b9 ==============================
[0m08:51:29.460285 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:29.461284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:51:29.472912 [info ] [MainThread]: dbt version: 1.9.2
[0m08:51:29.473915 [info ] [MainThread]: python version: 3.11.9
[0m08:51:29.473915 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:51:29.474918 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:51:29.524826 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:51:29.525809 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:51:29.526809 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:51:29.526809 [info ] [MainThread]: adapter type: postgres
[0m08:51:29.527809 [info ] [MainThread]: adapter version: 1.9.0
[0m08:51:29.598384 [info ] [MainThread]: Configuration:
[0m08:51:29.598384 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:51:29.599390 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:51:29.600384 [info ] [MainThread]: Required dependencies:
[0m08:51:29.600384 [debug] [MainThread]: Executing "git --help"
[0m08:51:29.643586 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:51:29.644614 [debug] [MainThread]: STDERR: "b''"
[0m08:51:29.644614 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:51:29.645587 [info ] [MainThread]: Connection:
[0m08:51:29.646588 [info ] [MainThread]:   host: 172.16.0.239
[0m08:51:29.646588 [info ] [MainThread]:   port: 5432
[0m08:51:29.647586 [info ] [MainThread]:   user: dmx-op-user
[0m08:51:29.647586 [info ] [MainThread]:   database: operacoes
[0m08:51:29.647586 [info ] [MainThread]:   schema: public
[0m08:51:29.648587 [info ] [MainThread]:   connect_timeout: 10
[0m08:51:29.648587 [info ] [MainThread]:   role: None
[0m08:51:29.649586 [info ] [MainThread]:   search_path: None
[0m08:51:29.649586 [info ] [MainThread]:   keepalives_idle: 0
[0m08:51:29.650586 [info ] [MainThread]:   sslmode: None
[0m08:51:29.650586 [info ] [MainThread]:   sslcert: None
[0m08:51:29.650586 [info ] [MainThread]:   sslkey: None
[0m08:51:29.651585 [info ] [MainThread]:   sslrootcert: None
[0m08:51:29.651585 [info ] [MainThread]:   application_name: dbt
[0m08:51:29.652586 [info ] [MainThread]:   retries: 1
[0m08:51:29.652586 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:51:29.840671 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:51:29.882453 [debug] [MainThread]: Using postgres connection "debug"
[0m08:51:29.882453 [debug] [MainThread]: On debug: select 1 as id
[0m08:51:29.883460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:29.940380 [debug] [MainThread]: SQL status: SELECT 1 in 0.057 seconds
[0m08:51:29.941537 [debug] [MainThread]: On debug: Close
[0m08:51:29.941537 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:51:29.941537 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:51:29.943044 [debug] [MainThread]: Command `dbt debug` succeeded at 08:51:29.943044 after 0.54 seconds
[0m08:51:29.944050 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:51:29.944050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059B841C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A17BC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A1749390>]}
[0m08:51:29.945057 [debug] [MainThread]: Flushing usage events
[0m08:51:30.564038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:34.102509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A724859D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A70133ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A724DAA50>]}


============================== 08:51:34.105935 | b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08 ==============================
[0m08:51:34.105935 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:34.106935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:51:34.255017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A726B6690>]}
[0m08:51:34.297357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6E509950>]}
[0m08:51:34.298338 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:51:34.469764 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:51:34.469764 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:51:34.471077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A726009D0>]}
[0m08:51:35.189799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A72BC1950>]}
[0m08:51:35.231042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:51:35.235250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:51:35.252392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A729A9510>]}
[0m08:51:35.253399 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m08:51:35.253399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A72929D90>]}
[0m08:51:35.254905 [info ] [MainThread]: 
[0m08:51:35.255836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:35.255836 [info ] [MainThread]: 
[0m08:51:35.257142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:51:35.260150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:51:35.313217 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:51:35.314234 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:51:35.314234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:35.365579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m08:51:35.367594 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:51:35.371579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:51:35.378838 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:51:35.378838 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:51:35.379840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:35.430826 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m08:51:35.431823 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:51:35.434137 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:51:35.441284 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m08:51:35.444940 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:51:35.449353 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:51:35.459687 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.460687 [debug] [MainThread]: On master: BEGIN
[0m08:51:35.460687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:35.511402 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m08:51:35.511402 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.512403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:51:35.520637 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m08:51:35.521654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A726FCA10>]}
[0m08:51:35.522669 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:35.525729 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.526725 [debug] [MainThread]: On master: BEGIN
[0m08:51:35.533888 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:51:35.534903 [debug] [MainThread]: On master: COMMIT
[0m08:51:35.534903 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.535890 [debug] [MainThread]: On master: COMMIT
[0m08:51:35.539903 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:51:35.540892 [debug] [MainThread]: On master: Close
[0m08:51:35.549641 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:51:35.550642 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:51:35.552656 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:51:35.555743 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:51:35.553197 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:51:35.556742 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:51:35.557740 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:51:35.565300 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.566284 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:51:35.568302 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:51:35.570285 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:51:35.571286 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:51:35.596503 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.599679 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:51:35.601658 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.601658 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:51:35.602658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:51:35.602658 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:51:35.603699 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:51:35.603699 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:51:35.668572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m08:51:35.669545 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m08:51:35.671509 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.672540 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:51:35.673903 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:51:35.675904 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    CREATE OR REPLACE VIEW public.titulosemaberto AS 
SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    cpf_cnpj_cedente::BIGINT AS cpf_cnpj_cedente,
    cpf_cnpj_sacado::BIGINT AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    cpf_cnpj_cedente::BIGINT AS cpf_cnpj_cedente,
    cpf_cnpj_sacado::BIGINT AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:51:35.682714 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE OR REPLACE VIEW public.titulosemaberto AS 
            ^

[0m08:51:35.683734 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m08:51:35.684748 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m08:51:35.695541 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.695541 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:51:35.696450 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:51:35.701705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:51:35.704220 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.705225 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:51:35.707224 [debug] [Thread-2 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW public.titulosemaberto AS 
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m08:51:35.709224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:51:35.719743 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:51:35.719743 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.719743 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:51:35.720743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A72AE9C10>]}
[0m08:51:35.721743 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.15s]
[0m08:51:35.722744 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:51:35.722744 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW public.titulosemaberto AS 
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m08:51:35.745439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m08:51:35.751478 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:51:35.756529 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:51:35.756529 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:51:35.783199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.026 seconds
[0m08:51:35.785199 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:51:35.786219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c19b8a-f0d7-4ba1-8438-5bcd6fe4af08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A72FA5710>]}
[0m08:51:35.787202 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.23s]
[0m08:51:35.788201 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:51:35.789200 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.789200 [debug] [MainThread]: On master: BEGIN
[0m08:51:35.790200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:35.823439 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m08:51:35.823439 [debug] [MainThread]: On master: COMMIT
[0m08:51:35.824440 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:35.824440 [debug] [MainThread]: On master: COMMIT
[0m08:51:35.828444 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:51:35.828444 [debug] [MainThread]: On master: Close
[0m08:51:35.828444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:35.829446 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:51:35.829446 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:51:35.829446 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:51:35.829446 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:51:35.830447 [info ] [MainThread]: 
[0m08:51:35.831446 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:51:35.831446 [debug] [MainThread]: Command end result
[0m08:51:35.845472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:51:35.846474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:51:35.852476 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:51:35.852983 [info ] [MainThread]: 
[0m08:51:35.853989 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:51:35.853989 [info ] [MainThread]: 
[0m08:51:35.855495 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW public.titulosemaberto AS 
              ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m08:51:35.856506 [info ] [MainThread]: 
[0m08:51:35.857503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:51:35.858611 [debug] [MainThread]: Command `dbt run` failed at 08:51:35.857503 after 1.81 seconds
[0m08:51:35.858611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6C659950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A726013D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6E4F5010>]}
[0m08:51:35.858611 [debug] [MainThread]: Flushing usage events
[0m08:51:36.490157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:44.654263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0C487A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0C4D8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0C4D9890>]}


============================== 08:52:44.657265 | 73f0af72-5bac-4054-8262-b9b783225ea0 ==============================
[0m08:52:44.657265 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:44.658265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:44.760856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f0af72-5bac-4054-8262-b9b783225ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0C5CFED0>]}
[0m08:52:44.776856 [debug] [MainThread]: Command `dbt clean` succeeded at 08:52:44.776856 after 0.18 seconds
[0m08:52:44.777878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D06659950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D06658DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D066D1C10>]}
[0m08:52:44.777878 [debug] [MainThread]: Flushing usage events
[0m08:52:45.494115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:48.600331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D88C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D8DBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D8DA050>]}


============================== 08:52:48.603324 | 0cd214b5-0f5f-47f4-ab8d-8a52624c300d ==============================
[0m08:52:48.603324 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:48.604300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:48.614326 [info ] [MainThread]: dbt version: 1.9.2
[0m08:52:48.615223 [info ] [MainThread]: python version: 3.11.9
[0m08:52:48.615223 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:52:48.616721 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:52:48.670252 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:52:48.671254 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:52:48.672253 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:52:48.673254 [info ] [MainThread]: adapter type: postgres
[0m08:52:48.673254 [info ] [MainThread]: adapter version: 1.9.0
[0m08:52:48.743374 [info ] [MainThread]: Configuration:
[0m08:52:48.744372 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:52:48.745371 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:52:48.745371 [info ] [MainThread]: Required dependencies:
[0m08:52:48.746370 [debug] [MainThread]: Executing "git --help"
[0m08:52:48.786880 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:52:48.786880 [debug] [MainThread]: STDERR: "b''"
[0m08:52:48.787880 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:52:48.788880 [info ] [MainThread]: Connection:
[0m08:52:48.788880 [info ] [MainThread]:   host: 172.16.0.239
[0m08:52:48.789880 [info ] [MainThread]:   port: 5432
[0m08:52:48.789880 [info ] [MainThread]:   user: dmx-op-user
[0m08:52:48.791915 [info ] [MainThread]:   database: operacoes
[0m08:52:48.792879 [info ] [MainThread]:   schema: public
[0m08:52:48.792879 [info ] [MainThread]:   connect_timeout: 10
[0m08:52:48.793880 [info ] [MainThread]:   role: None
[0m08:52:48.793880 [info ] [MainThread]:   search_path: None
[0m08:52:48.793880 [info ] [MainThread]:   keepalives_idle: 0
[0m08:52:48.794881 [info ] [MainThread]:   sslmode: None
[0m08:52:48.794881 [info ] [MainThread]:   sslcert: None
[0m08:52:48.795881 [info ] [MainThread]:   sslkey: None
[0m08:52:48.795881 [info ] [MainThread]:   sslrootcert: None
[0m08:52:48.796880 [info ] [MainThread]:   application_name: dbt
[0m08:52:48.797881 [info ] [MainThread]:   retries: 1
[0m08:52:48.798879 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:52:48.979121 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:52:49.017137 [debug] [MainThread]: Using postgres connection "debug"
[0m08:52:49.017137 [debug] [MainThread]: On debug: select 1 as id
[0m08:52:49.018136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:49.068613 [debug] [MainThread]: SQL status: SELECT 1 in 0.051 seconds
[0m08:52:49.070616 [debug] [MainThread]: On debug: Close
[0m08:52:49.070616 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:52:49.071615 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:52:49.072617 [debug] [MainThread]: Command `dbt debug` succeeded at 08:52:49.072617 after 0.52 seconds
[0m08:52:49.072617 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:52:49.072617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D5C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059DAEC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597A51C10>]}
[0m08:52:49.073614 [debug] [MainThread]: Flushing usage events
[0m08:52:49.703871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:52.944013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F788C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F769FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F788E0D0>]}


============================== 08:52:52.947030 | 47e875ee-0eaa-46c3-928c-4dd4d5b0b53f ==============================
[0m08:52:52.947030 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:52.948014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:53.094321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F78DBFD0>]}
[0m08:52:53.133307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F2949BD0>]}
[0m08:52:53.134308 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:52:53.311096 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:53.312102 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:52:53.312983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F78F7BD0>]}
[0m08:52:53.993379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7FE8F50>]}
[0m08:52:54.036282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:52:54.041323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:52:54.055344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7DC3450>]}
[0m08:52:54.056344 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m08:52:54.056344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7FB9710>]}
[0m08:52:54.058344 [info ] [MainThread]: 
[0m08:52:54.059342 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:54.059591 [info ] [MainThread]: 
[0m08:52:54.060157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:54.063414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:52:54.114988 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:52:54.115988 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:52:54.115988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:54.164071 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m08:52:54.166067 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:52:54.168597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:52:54.175689 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:52:54.175689 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:52:54.176592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:54.229795 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m08:52:54.231645 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:52:54.232642 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:52:54.239785 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m08:52:54.243763 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:52:54.247886 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:52:54.257987 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.259091 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.260092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:54.334235 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m08:52:54.335236 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.336235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:54.349234 [debug] [MainThread]: SQL status: SELECT 2 in 0.012 seconds
[0m08:52:54.350234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7FF4150>]}
[0m08:52:54.351234 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:54.355440 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.355440 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.361586 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:52:54.362485 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.362485 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.362485 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.366371 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:52:54.366371 [debug] [MainThread]: On master: Close
[0m08:52:54.368880 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:52:54.368880 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:52:54.369880 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:52:54.370881 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:52:54.369880 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:52:54.370881 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:52:54.371881 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:52:54.376881 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.377300 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:52:54.379872 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:52:54.381770 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:52:54.410873 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:52:54.411769 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:52:54.413865 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.415767 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.416767 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.416767 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:52:54.416767 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:52:54.417904 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:52:54.417904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:54.444307 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m08:52:54.447315 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.447315 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    cpf_cnpj_cedente::BIGINT AS cpf_cnpj_cedente,
    cpf_cnpj_sacado::BIGINT AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    cpf_cnpj_cedente::BIGINT AS cpf_cnpj_cedente,
    cpf_cnpj_sacado::BIGINT AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:52:54.455527 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m08:52:54.461428 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.461428 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:52:54.465320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:52:54.466382 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.467888 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:52:54.468347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m08:52:54.468347 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.468347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:52:54.471552 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:52:54.481411 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:52:54.481411 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.481411 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:52:54.482412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m08:52:54.484511 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.484511 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:52:54.489024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:52:54.491132 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.491132 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:52:54.495873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:52:54.496875 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:52:54.496875 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.497978 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:52:54.522068 [debug] [Thread-2 (]: SQL status: COMMIT in 0.040 seconds
[0m08:52:54.534175 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:52:54.538175 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:52:54.538175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m08:52:54.538175 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:52:54.540443 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:52:54.541344 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:52:54.541344 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:52:54.561964 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m08:52:54.566982 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:52:54.570505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7E06F50>]}
[0m08:52:54.571508 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:52:54.572291 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:52:54.575557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m08:52:54.577356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:52:54.577356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e875ee-0eaa-46c3-928c-4dd4d5b0b53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F83643D0>]}
[0m08:52:54.578354 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m08:52:54.579353 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:52:54.582353 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.583354 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.583354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:54.645707 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m08:52:54.646727 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.647727 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.649708 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.653993 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:52:54.655028 [debug] [MainThread]: On master: Close
[0m08:52:54.656303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:54.657330 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:52:54.658330 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:52:54.659343 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:52:54.660333 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:52:54.660333 [info ] [MainThread]: 
[0m08:52:54.662332 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m08:52:54.664334 [debug] [MainThread]: Command end result
[0m08:52:54.679888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:52:54.681888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:52:54.687888 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:52:54.687888 [info ] [MainThread]: 
[0m08:52:54.688889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:54.689889 [info ] [MainThread]: 
[0m08:52:54.689889 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:52:54.691887 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:54.691887 after 1.80 seconds
[0m08:52:54.691887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F78D9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F1B81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F7587D90>]}
[0m08:52:54.692891 [debug] [MainThread]: Flushing usage events
[0m08:52:55.338863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:49.855294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026372087010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263720B73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263720DBDD0>]}


============================== 08:54:49.859312 | c4b6a4d4-9bdd-4417-9aac-4f267efab7fa ==============================
[0m08:54:49.859312 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:54:49.860295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:54:49.962815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b6a4d4-9bdd-4417-9aac-4f267efab7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026372087190>]}
[0m08:54:49.978814 [debug] [MainThread]: Command `dbt clean` succeeded at 08:54:49.978814 after 0.18 seconds
[0m08:54:49.978814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263720C8A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636C229950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263721C7F50>]}
[0m08:54:49.979833 [debug] [MainThread]: Flushing usage events
[0m08:54:50.676731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:54.306040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388B685ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388B6D9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388B6D8D90>]}


============================== 08:54:54.310035 | 3aacd930-82f3-4f94-a945-2af60423c0a9 ==============================
[0m08:54:54.310035 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:54:54.311037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:54:54.321550 [info ] [MainThread]: dbt version: 1.9.2
[0m08:54:54.322552 [info ] [MainThread]: python version: 3.11.9
[0m08:54:54.323553 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:54:54.324550 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:54:54.378549 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:54:54.380555 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:54:54.380555 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:54:54.381548 [info ] [MainThread]: adapter type: postgres
[0m08:54:54.382549 [info ] [MainThread]: adapter version: 1.9.0
[0m08:54:54.449079 [info ] [MainThread]: Configuration:
[0m08:54:54.451062 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:54:54.452063 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:54:54.452063 [info ] [MainThread]: Required dependencies:
[0m08:54:54.453062 [debug] [MainThread]: Executing "git --help"
[0m08:54:54.489063 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:54:54.490064 [debug] [MainThread]: STDERR: "b''"
[0m08:54:54.491062 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:54:54.492062 [info ] [MainThread]: Connection:
[0m08:54:54.492062 [info ] [MainThread]:   host: 172.16.0.239
[0m08:54:54.492062 [info ] [MainThread]:   port: 5432
[0m08:54:54.493062 [info ] [MainThread]:   user: dmx-op-user
[0m08:54:54.493062 [info ] [MainThread]:   database: operacoes
[0m08:54:54.494063 [info ] [MainThread]:   schema: public
[0m08:54:54.494063 [info ] [MainThread]:   connect_timeout: 10
[0m08:54:54.495061 [info ] [MainThread]:   role: None
[0m08:54:54.495061 [info ] [MainThread]:   search_path: None
[0m08:54:54.495061 [info ] [MainThread]:   keepalives_idle: 0
[0m08:54:54.496062 [info ] [MainThread]:   sslmode: None
[0m08:54:54.497064 [info ] [MainThread]:   sslcert: None
[0m08:54:54.497064 [info ] [MainThread]:   sslkey: None
[0m08:54:54.498064 [info ] [MainThread]:   sslrootcert: None
[0m08:54:54.499063 [info ] [MainThread]:   application_name: dbt
[0m08:54:54.499063 [info ] [MainThread]:   retries: 1
[0m08:54:54.499063 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:54:54.686319 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:54:54.724978 [debug] [MainThread]: Using postgres connection "debug"
[0m08:54:54.726023 [debug] [MainThread]: On debug: select 1 as id
[0m08:54:54.726023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:54.760160 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m08:54:54.761176 [debug] [MainThread]: On debug: Close
[0m08:54:54.761176 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:54:54.762161 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:54:54.763180 [debug] [MainThread]: Command `dbt debug` succeeded at 08:54:54.763180 after 0.51 seconds
[0m08:54:54.763180 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:54:54.763180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013885941C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388B8EC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388B49FC10>]}
[0m08:54:54.764161 [debug] [MainThread]: Flushing usage events
[0m08:54:55.403574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:58.850268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1C85550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1CD90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1CD95D0>]}


============================== 08:54:58.854269 | 43ecbadb-d652-4dfa-82f5-62a5810c9819 ==============================
[0m08:54:58.854269 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:54:58.855268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:54:58.999071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1E00B10>]}
[0m08:54:59.037076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1EFD050>]}
[0m08:54:59.038578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:54:59.214616 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:54:59.215667 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:54:59.215667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B30AFB90>]}
[0m08:54:59.897508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139ADC3FBD0>]}
[0m08:54:59.940022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:54:59.944023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:54:59.958039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B317E450>]}
[0m08:54:59.958039 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m08:54:59.959023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B3131410>]}
[0m08:54:59.960023 [info ] [MainThread]: 
[0m08:54:59.961015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:54:59.961015 [info ] [MainThread]: 
[0m08:54:59.962100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:54:59.965113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:55:00.016221 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:55:00.016221 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:55:00.016221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:00.066743 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m08:55:00.068850 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:55:00.071845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:55:00.076842 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:55:00.077848 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:55:00.077848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:00.130846 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m08:55:00.131976 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:55:00.133869 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:55:00.141427 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m08:55:00.145286 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:55:00.161516 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:55:00.173712 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.174699 [debug] [MainThread]: On master: BEGIN
[0m08:55:00.174699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:00.239689 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m08:55:00.240811 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.241787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:55:00.250444 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m08:55:00.254561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B1EAC1D0>]}
[0m08:55:00.255561 [debug] [MainThread]: On master: ROLLBACK
[0m08:55:00.260554 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.261679 [debug] [MainThread]: On master: BEGIN
[0m08:55:00.269575 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:55:00.270675 [debug] [MainThread]: On master: COMMIT
[0m08:55:00.271576 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.272689 [debug] [MainThread]: On master: COMMIT
[0m08:55:00.276903 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:55:00.277921 [debug] [MainThread]: On master: Close
[0m08:55:00.283918 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:55:00.283918 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:55:00.284926 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:55:00.286914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:55:00.285910 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:55:00.287913 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:55:00.288913 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:55:00.299914 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.300914 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:55:00.304913 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:55:00.306912 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:55:00.306912 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:55:00.332915 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.336023 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:55:00.339527 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.340532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.340532 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:55:00.340532 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:55:00.341574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:55:00.341574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:55:00.369299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m08:55:00.370289 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m08:55:00.370289 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.371286 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.371286 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:55:00.372284 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    data_emissao::DATE AS data_emissao,
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:55:00.378283 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:55:00.383287 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.383287 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m08:55:00.384324 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:55:00.387001 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.387926 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:55:00.391370 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:55:00.391370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:55:00.394455 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.396436 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.396436 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:55:00.397452 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:55:00.401452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:55:00.402453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:55:00.413452 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:55:00.416453 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:55:00.416725 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.417155 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.417603 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:55:00.418023 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:55:00.436103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m08:55:00.447837 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:55:00.452841 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:55:00.453824 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m08:55:00.454466 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:55:00.456158 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:55:00.457181 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:55:00.458155 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:55:00.471916 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m08:55:00.474004 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:55:00.476008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B36F8290>]}
[0m08:55:00.476008 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m08:55:00.477009 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:55:00.482035 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.023 seconds
[0m08:55:00.482922 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:55:00.483915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ecbadb-d652-4dfa-82f5-62a5810c9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139B31017D0>]}
[0m08:55:00.484912 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:55:00.485920 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:55:00.488912 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.488912 [debug] [MainThread]: On master: BEGIN
[0m08:55:00.489911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:55:00.523141 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m08:55:00.524063 [debug] [MainThread]: On master: COMMIT
[0m08:55:00.524063 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:00.525095 [debug] [MainThread]: On master: COMMIT
[0m08:55:00.528094 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:55:00.529088 [debug] [MainThread]: On master: Close
[0m08:55:00.530077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:00.531071 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:55:00.531071 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:55:00.531071 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:55:00.531071 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:55:00.532083 [info ] [MainThread]: 
[0m08:55:00.532083 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:55:00.533072 [debug] [MainThread]: Command end result
[0m08:55:00.547585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:55:00.550586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:55:00.555584 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:55:00.555584 [info ] [MainThread]: 
[0m08:55:00.556585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:00.557585 [info ] [MainThread]: 
[0m08:55:00.557839 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:55:00.558906 [debug] [MainThread]: Command `dbt run` succeeded at 08:55:00.558906 after 1.76 seconds
[0m08:55:00.558906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139ACED1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139ACE59950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139ACE58DD0>]}
[0m08:55:00.559889 [debug] [MainThread]: Flushing usage events
[0m08:55:01.214086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:39.553140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DFF785F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DFF7B4BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DFF7B7D50>]}


============================== 08:57:39.558139 | 1ecdd203-3bbb-4dcd-8cb8-f1dd31d09070 ==============================
[0m08:57:39.558139 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:57:39.559139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m08:57:39.697763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ecdd203-3bbb-4dcd-8cb8-f1dd31d09070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DFF678990>]}
[0m08:57:39.720762 [debug] [MainThread]: Command `dbt clean` succeeded at 08:57:39.720762 after 0.22 seconds
[0m08:57:39.720762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF9909950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF9908DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF9981C10>]}
[0m08:57:39.721763 [debug] [MainThread]: Flushing usage events
[0m08:57:40.488987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:46.441017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBA6893D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB8320890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC2822D0>]}


============================== 08:57:46.444522 | a1a7fe90-b417-49e5-a0a9-57820525f166 ==============================
[0m08:57:46.444522 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:57:46.445526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:57:46.458043 [info ] [MainThread]: dbt version: 1.9.2
[0m08:57:46.460042 [info ] [MainThread]: python version: 3.11.9
[0m08:57:46.461043 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:57:46.462044 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:57:46.534359 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:57:46.535365 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:57:46.536364 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:57:46.537365 [info ] [MainThread]: adapter type: postgres
[0m08:57:46.537365 [info ] [MainThread]: adapter version: 1.9.0
[0m08:57:46.613134 [info ] [MainThread]: Configuration:
[0m08:57:46.614387 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:57:46.615387 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:57:46.615387 [info ] [MainThread]: Required dependencies:
[0m08:57:46.616387 [debug] [MainThread]: Executing "git --help"
[0m08:57:46.660147 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:57:46.661147 [debug] [MainThread]: STDERR: "b''"
[0m08:57:46.662148 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:57:46.663148 [info ] [MainThread]: Connection:
[0m08:57:46.663148 [info ] [MainThread]:   host: 172.16.0.239
[0m08:57:46.664260 [info ] [MainThread]:   port: 5432
[0m08:57:46.664260 [info ] [MainThread]:   user: dmx-op-user
[0m08:57:46.665260 [info ] [MainThread]:   database: operacoes
[0m08:57:46.665260 [info ] [MainThread]:   schema: public
[0m08:57:46.666261 [info ] [MainThread]:   connect_timeout: 10
[0m08:57:46.666261 [info ] [MainThread]:   role: None
[0m08:57:46.667260 [info ] [MainThread]:   search_path: None
[0m08:57:46.667260 [info ] [MainThread]:   keepalives_idle: 0
[0m08:57:46.667260 [info ] [MainThread]:   sslmode: None
[0m08:57:46.668259 [info ] [MainThread]:   sslcert: None
[0m08:57:46.668259 [info ] [MainThread]:   sslkey: None
[0m08:57:46.669261 [info ] [MainThread]:   sslrootcert: None
[0m08:57:46.669261 [info ] [MainThread]:   application_name: dbt
[0m08:57:46.670262 [info ] [MainThread]:   retries: 1
[0m08:57:46.671260 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:57:46.872105 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:57:46.921585 [debug] [MainThread]: Using postgres connection "debug"
[0m08:57:46.921585 [debug] [MainThread]: On debug: select 1 as id
[0m08:57:46.921585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:46.984491 [debug] [MainThread]: SQL status: SELECT 1 in 0.062 seconds
[0m08:57:46.985498 [debug] [MainThread]: On debug: Close
[0m08:57:46.985498 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:57:46.986498 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:57:46.987498 [debug] [MainThread]: Command `dbt debug` succeeded at 08:57:46.987498 after 0.60 seconds
[0m08:57:46.987498 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:57:46.988499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC6E44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC4F07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBAF87D90>]}
[0m08:57:46.988499 [debug] [MainThread]: Flushing usage events
[0m08:57:47.628066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:51.638155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03668A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0367D9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0367D9890>]}


============================== 08:57:51.641155 | bc66d83c-9d16-43f5-a027-2ce392eb8fa4 ==============================
[0m08:57:51.641155 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:57:51.642171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:57:51.799585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0369190D0>]}
[0m08:57:51.841174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F031829B10>]}
[0m08:57:51.842173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:57:52.026420 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:57:52.027420 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:57:52.028466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036BF6C50>]}
[0m08:57:52.784838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036EB8610>]}
[0m08:57:52.837407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:57:52.841404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:57:52.862943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036CEED90>]}
[0m08:57:52.863950 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m08:57:52.864948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036D58310>]}
[0m08:57:52.866947 [info ] [MainThread]: 
[0m08:57:52.866947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:52.867949 [info ] [MainThread]: 
[0m08:57:52.867949 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:57:52.871949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:57:52.925755 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:57:52.926754 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:57:52.926754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:53.075200 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.148 seconds
[0m08:57:53.078206 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:57:53.080203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:57:53.086717 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:57:53.087717 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:57:53.088717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:53.221987 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m08:57:53.223135 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:57:53.224155 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:57:53.248571 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.023 seconds
[0m08:57:53.253323 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:57:53.272078 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:57:53.287087 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.288090 [debug] [MainThread]: On master: BEGIN
[0m08:57:53.288090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:53.405436 [debug] [MainThread]: SQL status: BEGIN in 0.117 seconds
[0m08:57:53.406437 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.406437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:57:53.415152 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m08:57:53.418196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F038279810>]}
[0m08:57:53.419169 [debug] [MainThread]: On master: ROLLBACK
[0m08:57:53.438985 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.439984 [debug] [MainThread]: On master: BEGIN
[0m08:57:53.450171 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:57:53.451193 [debug] [MainThread]: On master: COMMIT
[0m08:57:53.452283 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.453827 [debug] [MainThread]: On master: COMMIT
[0m08:57:53.457982 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m08:57:53.458985 [debug] [MainThread]: On master: Close
[0m08:57:53.466152 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:57:53.466152 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:57:53.467153 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:57:53.469150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:57:53.468149 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:57:53.470151 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:57:53.471149 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:57:53.480466 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.480466 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:57:53.483970 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:57:53.485975 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:57:53.508515 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:57:53.516131 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:57:53.519154 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.520869 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.521874 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:57:53.521874 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.521874 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:57:53.522874 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:57:53.522874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:57:53.605575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m08:57:53.607578 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.608667 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:57:53.632918 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m08:57:53.633427 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m08:57:53.633427 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.638532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.639522 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
     TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:57:53.640433 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:57:53.652950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m08:57:53.654054 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m08:57:53.659048 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.663156 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.664778 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:57:53.665788 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:57:53.688874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m08:57:53.688874 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m08:57:53.706029 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:57:53.708932 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.708932 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.708932 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:57:53.709937 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:57:53.727097 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m08:57:53.730113 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:57:53.730113 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.731224 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:57:53.750397 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m08:57:53.751422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m08:57:53.764810 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:57:53.767809 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:57:53.773310 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:57:53.774314 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:57:53.774314 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:57:53.775316 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:57:53.793056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m08:57:53.794674 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:57:53.796564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F036D107D0>]}
[0m08:57:53.796564 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m08:57:53.797565 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:57:53.824648 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.049 seconds
[0m08:57:53.825655 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:57:53.826654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc66d83c-9d16-43f5-a027-2ce392eb8fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03828DE50>]}
[0m08:57:53.827653 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m08:57:53.828653 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:57:53.829652 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.830656 [debug] [MainThread]: On master: BEGIN
[0m08:57:53.830656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:57:53.910371 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m08:57:53.910371 [debug] [MainThread]: On master: COMMIT
[0m08:57:53.911374 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:53.911374 [debug] [MainThread]: On master: COMMIT
[0m08:57:53.944195 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m08:57:53.945197 [debug] [MainThread]: On master: Close
[0m08:57:53.946196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:53.946196 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:57:53.946196 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:57:53.946196 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:57:53.947196 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:57:53.947196 [info ] [MainThread]: 
[0m08:57:53.948195 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m08:57:53.948195 [debug] [MainThread]: Command end result
[0m08:57:53.961705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:57:53.964217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:57:53.970217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:57:53.971216 [info ] [MainThread]: 
[0m08:57:53.972217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:53.972217 [info ] [MainThread]: 
[0m08:57:53.973218 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:57:53.973218 [debug] [MainThread]: Command `dbt run` succeeded at 08:57:53.973218 after 2.39 seconds
[0m08:57:53.974490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0364C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0309F1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F030978D50>]}
[0m08:57:53.974490 [debug] [MainThread]: Flushing usage events
[0m08:57:54.682893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:44.795560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3068E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2BC94590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30588E10>]}


============================== 08:59:44.799577 | 9a4c3e63-1f15-4bc7-b793-c3e7ece669c2 ==============================
[0m08:59:44.799577 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:59:44.800587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:59:44.959121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30800B10>]}
[0m08:59:44.999124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2B6C80D0>]}
[0m08:59:45.000124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:59:45.179278 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:59:45.279218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:45.279218 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m08:59:45.438585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30AF0950>]}
[0m08:59:45.484585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:59:45.488587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:59:45.503614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30EF0ED0>]}
[0m08:59:45.504615 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m08:59:45.504615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30B16950>]}
[0m08:59:45.506612 [info ] [MainThread]: 
[0m08:59:45.507156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:59:45.507695 [info ] [MainThread]: 
[0m08:59:45.508705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:59:45.511569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:59:45.560225 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:59:45.561222 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:59:45.561222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:45.621237 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m08:59:45.622238 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:59:45.624237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:59:45.628237 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:59:45.629237 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:59:45.629237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:45.656237 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m08:59:45.656237 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:59:45.656237 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:59:45.663237 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m08:59:45.664238 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:59:45.668237 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:59:45.672237 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:45.673236 [debug] [MainThread]: On master: BEGIN
[0m08:59:45.673236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:45.737343 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m08:59:45.737343 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:45.738341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:59:45.748341 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m08:59:45.749362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30CF8810>]}
[0m08:59:45.750342 [debug] [MainThread]: On master: ROLLBACK
[0m08:59:45.753424 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:45.753424 [debug] [MainThread]: On master: BEGIN
[0m08:59:45.759720 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:59:45.760720 [debug] [MainThread]: On master: COMMIT
[0m08:59:45.760720 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:45.761719 [debug] [MainThread]: On master: COMMIT
[0m08:59:45.764719 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:59:45.764719 [debug] [MainThread]: On master: Close
[0m08:59:45.767718 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:59:45.767718 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m08:59:45.768719 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:59:45.768719 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m08:59:45.769717 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:59:45.770718 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m08:59:45.770718 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:59:45.770718 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m08:59:45.775719 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.779717 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m08:59:45.780719 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:59:45.792720 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m08:59:45.806723 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.810723 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m08:59:45.812723 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.812723 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.813724 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m08:59:45.813724 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:59:45.814723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:59:45.814723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:59:45.843392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m08:59:45.844394 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.844394 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:59:45.850394 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:59:45.856398 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.857393 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:59:45.860620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:59:45.862550 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.862550 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:59:45.863550 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m08:59:45.864548 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.864548 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
     TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:59:45.866657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:59:45.877548 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:59:45.878548 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m08:59:45.878548 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.881209 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.881209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:59:45.882212 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m08:59:45.886209 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:59:45.888311 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.888311 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m08:59:45.892234 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:59:45.893284 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:59:45.894346 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.894346 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m08:59:45.930684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m08:59:45.931685 [debug] [Thread-2 (]: SQL status: COMMIT in 0.037 seconds
[0m08:59:45.935685 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:59:45.937686 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m08:59:45.941545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:59:45.941545 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m08:59:45.942544 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:59:45.942544 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m08:59:45.969580 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m08:59:45.971580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:59:45.973581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B30B17190>]}
[0m08:59:45.974581 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:59:45.974581 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:59:46.010556 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.068 seconds
[0m08:59:46.011632 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m08:59:46.012616 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a4c3e63-1f15-4bc7-b793-c3e7ece669c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B32228690>]}
[0m08:59:46.013630 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m08:59:46.014518 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m08:59:46.015515 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:46.015515 [debug] [MainThread]: On master: BEGIN
[0m08:59:46.016515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:46.089835 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m08:59:46.090731 [debug] [MainThread]: On master: COMMIT
[0m08:59:46.090731 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:46.090731 [debug] [MainThread]: On master: COMMIT
[0m08:59:46.094863 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:59:46.095732 [debug] [MainThread]: On master: Close
[0m08:59:46.095732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:46.096732 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:59:46.096732 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:59:46.096732 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:59:46.096732 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m08:59:46.097733 [info ] [MainThread]: 
[0m08:59:46.098731 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:59:46.099731 [debug] [MainThread]: Command end result
[0m08:59:46.173387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:59:46.175287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:59:46.179286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:59:46.179286 [info ] [MainThread]: 
[0m08:59:46.180324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:46.181285 [info ] [MainThread]: 
[0m08:59:46.181285 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:59:46.182285 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:46.182285 after 1.44 seconds
[0m08:59:46.183286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2A8C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2A8C8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2A8C8D50>]}
[0m08:59:46.183286 [debug] [MainThread]: Flushing usage events
[0m08:59:47.015983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:03:17.208554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D58E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D5C9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D5C8490>]}


============================== 09:03:17.213571 | 0d4b7896-1616-4014-b6b4-22b0022c2457 ==============================
[0m09:03:17.213571 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:03:17.214554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:03:17.483429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D700FD0>]}
[0m09:03:17.520434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2286689D0>]}
[0m09:03:17.522435 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:03:17.701839 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:03:17.836196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:03:17.836196 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:03:17.993532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DBC2F50>]}
[0m09:03:18.036531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:03:18.039547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:03:18.069742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DDED650>]}
[0m09:03:18.069742 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:03:18.070741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DCDD910>]}
[0m09:03:18.071764 [info ] [MainThread]: 
[0m09:03:18.072309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:03:18.072309 [info ] [MainThread]: 
[0m09:03:18.073314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:03:18.078333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:03:18.137370 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:03:18.138377 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:03:18.138377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:18.210695 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m09:03:18.211582 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:03:18.223580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:03:18.231582 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:03:18.231582 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:03:18.232581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:18.285671 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m09:03:18.286620 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:03:18.286620 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:03:18.298622 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.011 seconds
[0m09:03:18.301620 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:03:18.305625 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:03:18.313637 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.313637 [debug] [MainThread]: On master: BEGIN
[0m09:03:18.314635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:03:18.378480 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m09:03:18.380504 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.381554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:03:18.391357 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m09:03:18.395472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DCBF9D0>]}
[0m09:03:18.396489 [debug] [MainThread]: On master: ROLLBACK
[0m09:03:18.400534 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.401488 [debug] [MainThread]: On master: BEGIN
[0m09:03:18.409944 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:03:18.411023 [debug] [MainThread]: On master: COMMIT
[0m09:03:18.411023 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.412058 [debug] [MainThread]: On master: COMMIT
[0m09:03:18.415660 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:03:18.416677 [debug] [MainThread]: On master: Close
[0m09:03:18.424101 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:18.424101 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:03:18.425102 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:03:18.427105 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:03:18.426102 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:03:18.428102 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:18.429104 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:03:18.438102 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.438102 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:03:18.441211 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:03:18.442102 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:18.469237 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.470331 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:03:18.474884 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:03:18.474884 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.475839 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:03:18.475839 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:03:18.475839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:03:18.476840 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:03:18.476840 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:03:18.506925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:03:18.507927 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.507927 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:03:18.522925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:03:18.528927 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.529925 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:03:18.539925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m09:03:18.540926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:03:18.540926 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:03:18.542964 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.544036 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado
    cr::VARCHAR(8000) AS cr,
     TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:03:18.545020 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:03:18.548899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:03:18.548899 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "cr"
LINE 13:     cr::VARCHAR(8000) AS cr,
             ^

[0m09:03:18.559997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:03:18.559997 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m09:03:18.560997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.560997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:03:18.564957 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:03:18.570972 [debug] [Thread-2 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:03:18.572003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D9F1090>]}
[0m09:03:18.573525 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.14s]
[0m09:03:18.574538 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:03:18.575553 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m09:03:18.655483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.093 seconds
[0m09:03:18.667429 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:03:18.671428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:18.671428 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:03:18.710965 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.039 seconds
[0m09:03:18.717861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:03:18.719868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4b7896-1616-4014-b6b4-22b0022c2457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22F158210>]}
[0m09:03:18.720864 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:03:18.723233 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:18.725230 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.726334 [debug] [MainThread]: On master: BEGIN
[0m09:03:18.726334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:18.763278 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m09:03:18.764280 [debug] [MainThread]: On master: COMMIT
[0m09:03:18.764280 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:18.765278 [debug] [MainThread]: On master: COMMIT
[0m09:03:18.769457 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:03:18.769457 [debug] [MainThread]: On master: Close
[0m09:03:18.770458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:18.770458 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:03:18.770458 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:03:18.771458 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:03:18.771458 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:03:18.772458 [info ] [MainThread]: 
[0m09:03:18.773461 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m09:03:18.774764 [debug] [MainThread]: Command end result
[0m09:03:18.789747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:03:18.791746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:03:18.796746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:03:18.797750 [info ] [MainThread]: 
[0m09:03:18.798747 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:03:18.798747 [info ] [MainThread]: 
[0m09:03:18.799748 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:03:18.800746 [info ] [MainThread]: 
[0m09:03:18.801747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m09:03:18.802748 [debug] [MainThread]: Command `dbt run` failed at 09:03:18.802748 after 1.67 seconds
[0m09:03:18.802748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2277C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B227841BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B227841C10>]}
[0m09:03:18.803748 [debug] [MainThread]: Flushing usage events
[0m09:03:19.524466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:03:53.045330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CB86B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CB87150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CB85C10>]}


============================== 09:03:53.048338 | b9091bb3-67d3-4623-8082-61a7287a2a15 ==============================
[0m09:03:53.048338 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:03:53.049337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:03:53.191776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CCDB0D0>]}
[0m09:03:53.229776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020557C499D0>]}
[0m09:03:53.230778 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:03:53.408958 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:03:53.507069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:03:53.507069 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:03:53.665273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D040A50>]}
[0m09:03:53.708270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:03:53.712165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:03:53.726164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D20ED50>]}
[0m09:03:53.727166 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:03:53.727166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D20AC10>]}
[0m09:03:53.729166 [info ] [MainThread]: 
[0m09:03:53.729166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:03:53.730165 [info ] [MainThread]: 
[0m09:03:53.730812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:03:53.734048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:03:53.781701 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:03:53.781701 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:03:53.782662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:53.827711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m09:03:53.829707 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:03:53.832709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:03:53.838706 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:03:53.839706 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:03:53.839706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:53.873931 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m09:03:53.875968 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:03:53.876958 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:03:53.884970 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:03:53.888959 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:03:53.893920 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:03:53.904473 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:53.905485 [debug] [MainThread]: On master: BEGIN
[0m09:03:53.905485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:03:53.943387 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m09:03:53.944407 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:53.946405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:03:53.955412 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:03:53.957420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D6645D0>]}
[0m09:03:53.958420 [debug] [MainThread]: On master: ROLLBACK
[0m09:03:53.961729 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:53.962944 [debug] [MainThread]: On master: BEGIN
[0m09:03:53.970944 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:03:53.971945 [debug] [MainThread]: On master: COMMIT
[0m09:03:53.971945 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:53.972944 [debug] [MainThread]: On master: COMMIT
[0m09:03:53.977020 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:03:53.977945 [debug] [MainThread]: On master: Close
[0m09:03:53.982638 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:53.982638 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:03:53.983638 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:03:53.984637 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:03:53.984637 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:03:53.985733 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:53.986638 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:03:53.991635 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:53.992636 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:03:53.994734 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:03:53.995682 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:03:53.996635 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:54.021681 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:03:54.024635 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.026636 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:03:54.026636 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.027636 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:03:54.027636 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:03:54.027636 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:03:54.028635 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:03:54.058817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m09:03:54.058817 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.059815 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:03:54.065656 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:03:54.071640 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.071640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:03:54.076229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:03:54.076229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m09:03:54.078292 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.079225 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:03:54.079700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:03:54.079700 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado
    cr::VARCHAR(8000) AS cr,
     TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:03:54.083874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:03:54.083874 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "cr"
LINE 13:     cr::VARCHAR(8000) AS cr,
             ^

[0m09:03:54.093706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:03:54.094706 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: ROLLBACK
[0m09:03:54.094706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.095754 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:03:54.099770 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:03:54.102871 [debug] [Thread-2 (]: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:03:54.103830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D758E10>]}
[0m09:03:54.104934 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.titulosaberto ...................... [[31mERROR[0m in 0.12s]
[0m09:03:54.105830 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:03:54.105830 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.titulosaberto' to be skipped because of status 'error'.  Reason: Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql.
[0m09:03:54.114991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:03:54.120829 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:03:54.124948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:03:54.125932 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:03:54.145381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:03:54.149378 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:03:54.149378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9091bb3-67d3-4623-8082-61a7287a2a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055D3EEF50>]}
[0m09:03:54.150376 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:03:54.151376 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:03:54.153375 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:54.153375 [debug] [MainThread]: On master: BEGIN
[0m09:03:54.153375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:54.206952 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m09:03:54.207936 [debug] [MainThread]: On master: COMMIT
[0m09:03:54.207936 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:54.208937 [debug] [MainThread]: On master: COMMIT
[0m09:03:54.211936 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:03:54.211936 [debug] [MainThread]: On master: Close
[0m09:03:54.211936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:54.212939 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:03:54.212939 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:03:54.212939 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:03:54.212939 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:03:54.213938 [info ] [MainThread]: 
[0m09:03:54.213938 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m09:03:54.214938 [debug] [MainThread]: Command end result
[0m09:03:54.226936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:03:54.228938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:03:54.234937 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:03:54.234937 [info ] [MainThread]: 
[0m09:03:54.235938 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:03:54.236937 [info ] [MainThread]: 
[0m09:03:54.236937 [error] [MainThread]:   Database Error in model titulosaberto (models\titulosaberto.sql)
  syntax error at or near "cr"
  LINE 13:     cr::VARCHAR(8000) AS cr,
               ^
  compiled code at target\run\my_dbt_project\models\titulosaberto.sql
[0m09:03:54.237937 [info ] [MainThread]: 
[0m09:03:54.238936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m09:03:54.239486 [debug] [MainThread]: Command `dbt run` failed at 09:03:54.239486 after 1.25 seconds
[0m09:03:54.240492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020556D69950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055C99D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020556DE1C10>]}
[0m09:03:54.240492 [debug] [MainThread]: Flushing usage events
[0m09:03:54.876412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:04:29.023029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AB78E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A9B8DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AB7C8650>]}


============================== 09:04:29.025995 | 1008263e-6028-4c52-b1ac-73f9d764ddc2 ==============================
[0m09:04:29.025995 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:04:29.026993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:04:29.183026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AB901350>]}
[0m09:04:29.224028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A68291D0>]}
[0m09:04:29.225028 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:04:29.404094 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:04:29.501672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:29.502674 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\titulosaberto.sql
[0m09:04:29.665211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ABE88C10>]}
[0m09:04:29.709720 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:04:29.713720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:04:29.728721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ABFF0910>]}
[0m09:04:29.728721 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:04:29.729722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ABF11210>]}
[0m09:04:29.730722 [info ] [MainThread]: 
[0m09:04:29.731721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:04:29.731721 [info ] [MainThread]: 
[0m09:04:29.732723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:04:29.735720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:04:29.793290 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:04:29.793290 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:04:29.794256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:29.855362 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m09:04:29.858381 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:04:29.860906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:04:29.870144 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:04:29.871133 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:04:29.872039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:29.908453 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m09:04:29.909402 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:04:29.911306 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:04:29.918514 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:04:29.922408 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:04:29.927295 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:04:29.939390 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:29.940292 [debug] [MainThread]: On master: BEGIN
[0m09:04:29.941309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:04:29.989396 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m09:04:29.990394 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:29.991393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:04:29.999295 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m09:04:30.003413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ABE0D510>]}
[0m09:04:30.004335 [debug] [MainThread]: On master: ROLLBACK
[0m09:04:30.009025 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:30.010044 [debug] [MainThread]: On master: BEGIN
[0m09:04:30.019044 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:04:30.020047 [debug] [MainThread]: On master: COMMIT
[0m09:04:30.021041 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:30.022037 [debug] [MainThread]: On master: COMMIT
[0m09:04:30.025041 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:04:30.026039 [debug] [MainThread]: On master: Close
[0m09:04:30.030037 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:04:30.030037 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:04:30.031037 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:04:30.032036 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:04:30.032036 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:04:30.033036 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:04:30.033036 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:04:30.039034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.039034 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:04:30.042037 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:04:30.042037 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:04:30.067048 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.068048 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:04:30.074047 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:04:30.075046 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.075046 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:04:30.076047 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.076047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:04:30.076047 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:04:30.077047 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:04:30.105552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m09:04:30.105552 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.106553 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:04:30.114552 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:04:30.118552 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.119552 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:04:30.123552 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:04:30.125552 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.125552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m09:04:30.126553 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:04:30.126553 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.127553 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:04:30.132554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:04:30.133552 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:04:30.143552 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:04:30.146555 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.146555 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.147553 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:04:30.147553 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:04:30.151552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:04:30.153552 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.153552 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:04:30.157551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:04:30.158552 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:04:30.158552 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.159556 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:04:30.168555 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m09:04:30.172555 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:04:30.176555 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:04:30.176555 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:04:30.176555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m09:04:30.178556 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:04:30.179555 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:04:30.179555 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:04:30.194601 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:04:30.197585 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:04:30.198586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AC43F390>]}
[0m09:04:30.199586 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:04:30.200584 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:04:30.206584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.026 seconds
[0m09:04:30.207587 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:04:30.208587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008263e-6028-4c52-b1ac-73f9d764ddc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AC360610>]}
[0m09:04:30.209587 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m09:04:30.210587 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:04:30.212586 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:30.214585 [debug] [MainThread]: On master: BEGIN
[0m09:04:30.214585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:04:30.247712 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:04:30.248712 [debug] [MainThread]: On master: COMMIT
[0m09:04:30.248712 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:30.249715 [debug] [MainThread]: On master: COMMIT
[0m09:04:30.252712 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:04:30.253714 [debug] [MainThread]: On master: Close
[0m09:04:30.253714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:30.253714 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:04:30.254713 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:04:30.254713 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:04:30.254713 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:04:30.255714 [info ] [MainThread]: 
[0m09:04:30.255714 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:04:30.257715 [debug] [MainThread]: Command end result
[0m09:04:30.326236 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:04:30.328224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:04:30.332255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:04:30.332255 [info ] [MainThread]: 
[0m09:04:30.333225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:04:30.333225 [info ] [MainThread]: 
[0m09:04:30.334224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:04:30.335252 [debug] [MainThread]: Command `dbt run` succeeded at 09:04:30.334224 after 1.36 seconds
[0m09:04:30.335252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A5979950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A5979E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A6811190>]}
[0m09:04:30.335252 [debug] [MainThread]: Flushing usage events
[0m09:04:31.046582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:06.514483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C3B85F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C399FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C399FF50>]}


============================== 09:05:06.517482 | 22e905ef-7bd3-4e3e-942f-819434d54779 ==============================
[0m09:05:06.517482 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:05:06.518482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:05:06.625010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22e905ef-7bd3-4e3e-942f-819434d54779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C3C05850>]}
[0m09:05:06.640731 [debug] [MainThread]: Command `dbt clean` succeeded at 09:05:06.640731 after 0.18 seconds
[0m09:05:06.640731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C3C54890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237BDD99950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237BDD98DD0>]}
[0m09:05:06.641835 [debug] [MainThread]: Flushing usage events
[0m09:05:07.274344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:10.506517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509ACA3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509ACFA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509ACF9150>]}


============================== 09:05:10.509501 | d8ed6d74-f8c5-4232-ac08-79835245f19b ==============================
[0m09:05:10.509501 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:05:10.510502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:05:10.522516 [info ] [MainThread]: dbt version: 1.9.2
[0m09:05:10.523500 [info ] [MainThread]: python version: 3.11.9
[0m09:05:10.523500 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:05:10.524530 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:05:10.577046 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:05:10.578030 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:05:10.579012 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:05:10.580011 [info ] [MainThread]: adapter type: postgres
[0m09:05:10.581034 [info ] [MainThread]: adapter version: 1.9.0
[0m09:05:10.649596 [info ] [MainThread]: Configuration:
[0m09:05:10.650613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:05:10.651597 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:05:10.652597 [info ] [MainThread]: Required dependencies:
[0m09:05:10.652597 [debug] [MainThread]: Executing "git --help"
[0m09:05:10.693597 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:05:10.693597 [debug] [MainThread]: STDERR: "b''"
[0m09:05:10.694596 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:05:10.694596 [info ] [MainThread]: Connection:
[0m09:05:10.695597 [info ] [MainThread]:   host: 172.16.0.239
[0m09:05:10.695597 [info ] [MainThread]:   port: 5432
[0m09:05:10.696598 [info ] [MainThread]:   user: dmx-op-user
[0m09:05:10.696598 [info ] [MainThread]:   database: operacoes
[0m09:05:10.697600 [info ] [MainThread]:   schema: public
[0m09:05:10.697600 [info ] [MainThread]:   connect_timeout: 10
[0m09:05:10.698597 [info ] [MainThread]:   role: None
[0m09:05:10.698597 [info ] [MainThread]:   search_path: None
[0m09:05:10.698597 [info ] [MainThread]:   keepalives_idle: 0
[0m09:05:10.699597 [info ] [MainThread]:   sslmode: None
[0m09:05:10.699597 [info ] [MainThread]:   sslcert: None
[0m09:05:10.700597 [info ] [MainThread]:   sslkey: None
[0m09:05:10.700597 [info ] [MainThread]:   sslrootcert: None
[0m09:05:10.701597 [info ] [MainThread]:   application_name: dbt
[0m09:05:10.701597 [info ] [MainThread]:   retries: 1
[0m09:05:10.702597 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:05:10.883159 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:05:10.923285 [debug] [MainThread]: Using postgres connection "debug"
[0m09:05:10.923285 [debug] [MainThread]: On debug: select 1 as id
[0m09:05:10.924262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:05:10.967827 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m09:05:10.968770 [debug] [MainThread]: On debug: Close
[0m09:05:10.969809 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:05:10.970769 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:05:10.971768 [debug] [MainThread]: Command `dbt debug` succeeded at 09:05:10.971768 after 0.52 seconds
[0m09:05:10.971768 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:05:10.972768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509AABF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015095F51C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001509A19C9D0>]}
[0m09:05:10.972768 [debug] [MainThread]: Flushing usage events
[0m09:05:11.630986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:15.266847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCF8E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCD9FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCFC8650>]}


============================== 09:05:15.270843 | 04cfea5b-c6e4-4f9b-bd69-e9137482389b ==============================
[0m09:05:15.270843 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:05:15.271844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:05:15.418463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DE0F3010>]}
[0m09:05:15.455579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DA00A110>]}
[0m09:05:15.456583 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:05:15.636941 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:05:15.637834 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:05:15.638833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCFE4390>]}
[0m09:05:16.327871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCEB4690>]}
[0m09:05:16.370445 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:05:16.373463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:05:16.388448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DE4C5E10>]}
[0m09:05:16.388448 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:05:16.389447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DE507210>]}
[0m09:05:16.390448 [info ] [MainThread]: 
[0m09:05:16.391446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:16.391446 [info ] [MainThread]: 
[0m09:05:16.392447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:05:16.395401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:05:16.450533 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:05:16.450533 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:05:16.451533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:16.484105 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m09:05:16.486228 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:05:16.489230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:05:16.499229 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:05:16.500225 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:05:16.501126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:16.558726 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m09:05:16.559829 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:05:16.559829 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:05:16.568900 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.008 seconds
[0m09:05:16.572995 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:05:16.577101 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:05:16.587895 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.588995 [debug] [MainThread]: On master: BEGIN
[0m09:05:16.589892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:05:16.652969 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m09:05:16.654070 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.656068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:05:16.664362 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:05:16.670214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DEA7E650>]}
[0m09:05:16.671213 [debug] [MainThread]: On master: ROLLBACK
[0m09:05:16.675329 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.676345 [debug] [MainThread]: On master: BEGIN
[0m09:05:16.683390 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:05:16.684407 [debug] [MainThread]: On master: COMMIT
[0m09:05:16.685423 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.685423 [debug] [MainThread]: On master: COMMIT
[0m09:05:16.689894 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:05:16.689894 [debug] [MainThread]: On master: Close
[0m09:05:16.694957 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:05:16.697954 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:05:16.696956 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:05:16.698955 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:05:16.698955 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:05:16.699954 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:05:16.699954 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:05:16.706055 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.707078 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:05:16.709631 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:05:16.710631 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:05:16.737652 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.738647 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:05:16.741647 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:05:16.743630 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.743630 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:05:16.744632 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.744632 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:05:16.744632 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:05:16.745824 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:05:16.803558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m09:05:16.803558 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.804557 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:05:16.811558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:05:16.815575 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.816665 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:05:16.819557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:05:16.821665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.822559 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:05:16.823557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m09:05:16.823557 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.823557 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    id_titulo::INT AS id_titulo,
    id_titulo_original::INT AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:05:16.826667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:05:16.837657 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:05:16.837657 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:05:16.838603 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.841007 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.841671 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:05:16.841671 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:05:16.846569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:05:16.848676 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.848676 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:05:16.853577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:05:16.854617 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:05:16.855673 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.855673 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:05:16.862667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:05:16.873786 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:05:16.877773 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:05:16.878788 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:05:16.879728 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m09:05:16.880787 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:05:16.881681 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:05:16.881681 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:05:16.894039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:05:16.897311 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:05:16.900307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DCFDA490>]}
[0m09:05:16.902254 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m09:05:16.903206 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:05:16.906680 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:05:16.908795 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:05:16.909800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04cfea5b-c6e4-4f9b-bd69-e9137482389b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231DE5F5050>]}
[0m09:05:16.910791 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:05:16.912694 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:05:16.914690 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.914690 [debug] [MainThread]: On master: BEGIN
[0m09:05:16.915693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:05:16.954699 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m09:05:16.955700 [debug] [MainThread]: On master: COMMIT
[0m09:05:16.955700 [debug] [MainThread]: Using postgres connection "master"
[0m09:05:16.956724 [debug] [MainThread]: On master: COMMIT
[0m09:05:16.960700 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:05:16.960700 [debug] [MainThread]: On master: Close
[0m09:05:16.961700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:16.961700 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:05:16.962700 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:05:16.963207 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:05:16.963207 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:05:16.964218 [info ] [MainThread]: 
[0m09:05:16.965215 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:05:16.965599 [debug] [MainThread]: Command end result
[0m09:05:16.982019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:05:16.984021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:05:16.991020 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:05:16.992023 [info ] [MainThread]: 
[0m09:05:16.993020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:16.994023 [info ] [MainThread]: 
[0m09:05:16.994023 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:05:16.996020 [debug] [MainThread]: Command `dbt run` succeeded at 09:05:16.996020 after 1.78 seconds
[0m09:05:16.996020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D8171C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D80F9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D80F8DD0>]}
[0m09:05:16.997020 [debug] [MainThread]: Flushing usage events
[0m09:05:17.612869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:38.461874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F97983C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F979DA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F979D9150>]}


============================== 09:13:38.467388 | 3b59146f-50df-499b-9daa-ae4705d56be9 ==============================
[0m09:13:38.467388 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:13:38.468388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:13:38.608627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b59146f-50df-499b-9daa-ae4705d56be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F97A5F2D0>]}
[0m09:13:38.633517 [debug] [MainThread]: Command `dbt clean` succeeded at 09:13:38.633517 after 0.23 seconds
[0m09:13:38.633517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F979E5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F979E7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F91C09950>]}
[0m09:13:38.634533 [debug] [MainThread]: Flushing usage events
[0m09:13:39.728390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:44.470904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23D9DAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23D9DBA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23D9DB2D0>]}


============================== 09:13:44.473921 | 6cad62cc-e0c2-4d84-b037-bc027ac98c74 ==============================
[0m09:13:44.473921 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:13:44.474918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:13:44.486921 [info ] [MainThread]: dbt version: 1.9.2
[0m09:13:44.488263 [info ] [MainThread]: python version: 3.11.9
[0m09:13:44.489265 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:13:44.490260 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:13:44.559711 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:13:44.560696 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:13:44.561694 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:13:44.561694 [info ] [MainThread]: adapter type: postgres
[0m09:13:44.562712 [info ] [MainThread]: adapter version: 1.9.0
[0m09:13:44.628275 [info ] [MainThread]: Configuration:
[0m09:13:44.629261 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:13:44.630258 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:13:44.631258 [info ] [MainThread]: Required dependencies:
[0m09:13:44.631258 [debug] [MainThread]: Executing "git --help"
[0m09:13:44.668259 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:13:44.668259 [debug] [MainThread]: STDERR: "b''"
[0m09:13:44.669257 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:13:44.670265 [info ] [MainThread]: Connection:
[0m09:13:44.670265 [info ] [MainThread]:   host: 172.16.0.239
[0m09:13:44.671264 [info ] [MainThread]:   port: 5432
[0m09:13:44.672259 [info ] [MainThread]:   user: dmx-op-user
[0m09:13:44.673263 [info ] [MainThread]:   database: operacoes
[0m09:13:44.673263 [info ] [MainThread]:   schema: public
[0m09:13:44.674274 [info ] [MainThread]:   connect_timeout: 10
[0m09:13:44.674274 [info ] [MainThread]:   role: None
[0m09:13:44.674274 [info ] [MainThread]:   search_path: None
[0m09:13:44.675264 [info ] [MainThread]:   keepalives_idle: 0
[0m09:13:44.675264 [info ] [MainThread]:   sslmode: None
[0m09:13:44.676281 [info ] [MainThread]:   sslcert: None
[0m09:13:44.676281 [info ] [MainThread]:   sslkey: None
[0m09:13:44.677263 [info ] [MainThread]:   sslrootcert: None
[0m09:13:44.677263 [info ] [MainThread]:   application_name: dbt
[0m09:13:44.677263 [info ] [MainThread]:   retries: 1
[0m09:13:44.678264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:13:44.870643 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:13:44.914803 [debug] [MainThread]: Using postgres connection "debug"
[0m09:13:44.914803 [debug] [MainThread]: On debug: select 1 as id
[0m09:13:44.915805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:13:44.971673 [debug] [MainThread]: SQL status: SELECT 1 in 0.056 seconds
[0m09:13:44.972674 [debug] [MainThread]: On debug: Close
[0m09:13:44.973680 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:13:44.974679 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:13:44.975678 [debug] [MainThread]: Command `dbt debug` succeeded at 09:13:44.975678 after 0.56 seconds
[0m09:13:44.975678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:13:44.976694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E237C81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23DBEC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E237C09A90>]}
[0m09:13:44.976694 [debug] [MainThread]: Flushing usage events
[0m09:13:45.636537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:48.408748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3B8E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3BDB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3BD9890>]}


============================== 09:13:48.411727 | 8708bb3d-effc-4ac5-ba08-e38d741d6b9c ==============================
[0m09:13:48.411727 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:13:48.412733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:13:48.556272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3CF2A50>]}
[0m09:13:48.595373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3DFD050>]}
[0m09:13:48.596376 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:13:48.772078 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:13:48.773972 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:13:48.774971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA3D60050>]}
[0m09:13:49.480866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA42D3F10>]}
[0m09:13:49.522143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:13:49.525328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:13:49.546460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA40A2DD0>]}
[0m09:13:49.547360 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:13:49.547360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA4087910>]}
[0m09:13:49.549375 [info ] [MainThread]: 
[0m09:13:49.549375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:49.550358 [info ] [MainThread]: 
[0m09:13:49.550358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:13:49.553359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:13:49.609992 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:13:49.610886 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:13:49.610886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:49.676259 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m09:13:49.678323 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:13:49.680088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:13:49.686936 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:13:49.687937 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:13:49.687937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:49.748933 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m09:13:49.751151 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:13:49.752044 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:13:49.760428 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:13:49.764633 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:13:49.768909 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:13:49.781002 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:49.782018 [debug] [MainThread]: On master: BEGIN
[0m09:13:49.783004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:13:49.842191 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m09:13:49.842191 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:49.843193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:13:49.852323 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:13:49.856289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA41C7410>]}
[0m09:13:49.857292 [debug] [MainThread]: On master: ROLLBACK
[0m09:13:49.861939 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:49.863123 [debug] [MainThread]: On master: BEGIN
[0m09:13:49.875464 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:13:49.875464 [debug] [MainThread]: On master: COMMIT
[0m09:13:49.876487 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:49.877387 [debug] [MainThread]: On master: COMMIT
[0m09:13:49.881512 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:13:49.882497 [debug] [MainThread]: On master: Close
[0m09:13:49.890698 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:13:49.890698 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:13:49.892693 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:13:49.895692 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:13:49.893693 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:13:49.896693 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:13:49.897693 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:13:49.911267 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:49.912269 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:13:49.916268 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:13:49.918268 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:13:49.919266 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:13:49.942267 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:13:49.946267 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:49.948266 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:49.949266 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:13:49.949266 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:49.949266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:13:49.950267 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:13:49.951266 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:13:50.004330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:13:50.005222 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m09:13:50.005222 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:50.006267 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:50.006267 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:13:50.007278 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op:: INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    op::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:13:50.015700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:13:50.020700 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:50.020700 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:13:50.021700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:13:50.023702 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:50.024705 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:13:50.027701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:13:50.028701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:13:50.030702 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:50.032702 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:50.033702 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:13:50.033702 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:13:50.037700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:13:50.038701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:13:50.049701 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:13:50.052700 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:13:50.052700 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:50.053699 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:50.053699 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:13:50.053699 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:13:50.076701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m09:13:50.081702 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:13:50.086700 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:13:50.087704 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:13:50.088702 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m09:13:50.091700 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:13:50.092705 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:13:50.092705 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:13:50.101257 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m09:13:50.103257 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:13:50.105256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA468DFD0>]}
[0m09:13:50.106257 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:13:50.107257 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:13:50.111767 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:13:50.112767 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:13:50.113770 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8708bb3d-effc-4ac5-ba08-e38d741d6b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA4601B10>]}
[0m09:13:50.114769 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m09:13:50.115768 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:13:50.117768 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:50.118766 [debug] [MainThread]: On master: BEGIN
[0m09:13:50.119768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:13:50.156763 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m09:13:50.156763 [debug] [MainThread]: On master: COMMIT
[0m09:13:50.157748 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:50.157748 [debug] [MainThread]: On master: COMMIT
[0m09:13:50.161093 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:13:50.161975 [debug] [MainThread]: On master: Close
[0m09:13:50.161975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:50.162973 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:13:50.162973 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:13:50.162973 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:13:50.162973 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:13:50.164051 [info ] [MainThread]: 
[0m09:13:50.164051 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:13:50.165044 [debug] [MainThread]: Command end result
[0m09:13:50.179025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:13:50.180032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:13:50.185036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:13:50.185036 [info ] [MainThread]: 
[0m09:13:50.185036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:50.186037 [info ] [MainThread]: 
[0m09:13:50.186953 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:13:50.188041 [debug] [MainThread]: Command `dbt run` succeeded at 09:13:50.188041 after 1.83 seconds
[0m09:13:50.188041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B9DDF1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B9DD79950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B9DD78DD0>]}
[0m09:13:50.188972 [debug] [MainThread]: Flushing usage events
[0m09:13:50.824047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:29.996538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6DA5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6DE8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6DFA650>]}


============================== 09:15:29.999538 | c6f80690-b3a0-4c23-a117-54caca573b82 ==============================
[0m09:15:29.999538 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:15:30.000538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:30.102087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6f80690-b3a0-4c23-a117-54caca573b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6EE7E90>]}
[0m09:15:30.118141 [debug] [MainThread]: Command `dbt clean` succeeded at 09:15:30.118141 after 0.18 seconds
[0m09:15:30.119158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6DF9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E2051BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E6EE7F50>]}
[0m09:15:30.119158 [debug] [MainThread]: Flushing usage events
[0m09:15:31.431691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:34.667165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8EAC700D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F0689590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F068A410>]}


============================== 09:15:34.670165 | 7bd91837-6bb0-429f-a139-29fe0fd09bc0 ==============================
[0m09:15:34.670165 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:15:34.671168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:34.681176 [info ] [MainThread]: dbt version: 1.9.2
[0m09:15:34.682179 [info ] [MainThread]: python version: 3.11.9
[0m09:15:34.683166 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:15:34.684165 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:15:34.737206 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:15:34.737749 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:15:34.738754 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:15:34.739764 [info ] [MainThread]: adapter type: postgres
[0m09:15:34.740753 [info ] [MainThread]: adapter version: 1.9.0
[0m09:15:34.807871 [info ] [MainThread]: Configuration:
[0m09:15:34.808756 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:15:34.809754 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:15:34.810756 [info ] [MainThread]: Required dependencies:
[0m09:15:34.811754 [debug] [MainThread]: Executing "git --help"
[0m09:15:34.851305 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:15:34.852408 [debug] [MainThread]: STDERR: "b''"
[0m09:15:34.852408 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:15:34.853307 [info ] [MainThread]: Connection:
[0m09:15:34.854305 [info ] [MainThread]:   host: 172.16.0.239
[0m09:15:34.855304 [info ] [MainThread]:   port: 5432
[0m09:15:34.856306 [info ] [MainThread]:   user: dmx-op-user
[0m09:15:34.857305 [info ] [MainThread]:   database: operacoes
[0m09:15:34.858306 [info ] [MainThread]:   schema: public
[0m09:15:34.859307 [info ] [MainThread]:   connect_timeout: 10
[0m09:15:34.859307 [info ] [MainThread]:   role: None
[0m09:15:34.860306 [info ] [MainThread]:   search_path: None
[0m09:15:34.860306 [info ] [MainThread]:   keepalives_idle: 0
[0m09:15:34.861307 [info ] [MainThread]:   sslmode: None
[0m09:15:34.861307 [info ] [MainThread]:   sslcert: None
[0m09:15:34.862306 [info ] [MainThread]:   sslkey: None
[0m09:15:34.862306 [info ] [MainThread]:   sslrootcert: None
[0m09:15:34.862306 [info ] [MainThread]:   application_name: dbt
[0m09:15:34.863304 [info ] [MainThread]:   retries: 1
[0m09:15:34.863304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:35.044324 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:15:35.085328 [debug] [MainThread]: Using postgres connection "debug"
[0m09:15:35.085328 [debug] [MainThread]: On debug: select 1 as id
[0m09:15:35.085328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:35.131896 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m09:15:35.132896 [debug] [MainThread]: On debug: Close
[0m09:15:35.133896 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:15:35.134896 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:15:35.135899 [debug] [MainThread]: Command `dbt debug` succeeded at 09:15:35.135899 after 0.52 seconds
[0m09:15:35.137406 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:15:35.138420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F07DB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F097A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F08C8790>]}
[0m09:15:35.139417 [debug] [MainThread]: Flushing usage events
[0m09:15:35.783526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:39.269142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EA8E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EADB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EA8E250>]}


============================== 09:15:39.272142 | d33b226b-7e31-4410-a984-953f75380ae2 ==============================
[0m09:15:39.272142 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:15:39.273160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:15:39.422695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40E98BC10>]}
[0m09:15:39.460314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A409AC9BD0>]}
[0m09:15:39.461313 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:39.641942 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:15:39.642942 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:15:39.642942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EAE4710>]}
[0m09:15:40.342976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40F1C0F10>]}
[0m09:15:40.387537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:15:40.391776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:15:40.406868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EFEC350>]}
[0m09:15:40.406868 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:15:40.408002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40F20E610>]}
[0m09:15:40.409011 [info ] [MainThread]: 
[0m09:15:40.410011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:15:40.411009 [info ] [MainThread]: 
[0m09:15:40.411009 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:15:40.415011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:15:40.469594 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:15:40.469594 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:15:40.469594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:40.537314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m09:15:40.539314 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:15:40.542370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:15:40.547959 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:15:40.549057 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:15:40.549057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:40.604445 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m09:15:40.605442 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:15:40.606352 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:15:40.613439 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:15:40.614337 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:15:40.618441 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:15:40.623337 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.623337 [debug] [MainThread]: On master: BEGIN
[0m09:15:40.623337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:40.668917 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:15:40.670002 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.671033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:15:40.680036 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:15:40.684027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A409ACE5D0>]}
[0m09:15:40.685040 [debug] [MainThread]: On master: ROLLBACK
[0m09:15:40.689926 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.690926 [debug] [MainThread]: On master: BEGIN
[0m09:15:40.698061 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:15:40.699062 [debug] [MainThread]: On master: COMMIT
[0m09:15:40.699062 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.700046 [debug] [MainThread]: On master: COMMIT
[0m09:15:40.703047 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:15:40.704061 [debug] [MainThread]: On master: Close
[0m09:15:40.708045 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:15:40.708045 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:15:40.709060 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:15:40.710048 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:15:40.711046 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:15:40.711584 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:15:40.712595 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:15:40.713121 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:15:40.718147 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.722131 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:15:40.724132 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:15:40.724132 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:15:40.750646 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:15:40.753645 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.754646 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.755647 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.755647 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:15:40.756646 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:15:40.756646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:15:40.756646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:15:40.823645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m09:15:40.824661 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.824661 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:15:40.846649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m09:15:40.851780 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.851780 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:15:40.856777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.100 seconds
[0m09:15:40.856777 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.856777 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    valor::DECIMAL(10,2) AS valor,
    valor_juros::DECIMAL(10,2) AS valor_juros,
    valor_multa::DECIMAL(10,2) AS valor_multa,
    valor_tarifas::DECIMAL(10,2) AS valor_tarifas,
    valor_total::DECIMAL(10,2) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    desagio::DECIMAL(10,2) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:15:40.857778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:15:40.859778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.860778 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:15:40.863778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:15:40.874777 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:15:40.874777 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:15:40.877780 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.877780 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.877780 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:15:40.878779 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:15:40.882777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:15:40.884777 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.884777 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:15:40.888797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:15:40.889850 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:15:40.889850 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.889850 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:15:40.901561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m09:15:40.907695 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:15:40.910677 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:15:40.910677 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:15:40.914734 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m09:15:40.916670 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:15:40.916670 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:15:40.916670 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:15:40.919450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m09:15:40.920899 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:15:40.923008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40F56AB50>]}
[0m09:15:40.923008 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:15:40.924003 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:15:40.933154 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:15:40.935175 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:15:40.935175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd33b226b-7e31-4410-a984-953f75380ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40F6277D0>]}
[0m09:15:40.936169 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m09:15:40.937078 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:15:40.940074 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.940074 [debug] [MainThread]: On master: BEGIN
[0m09:15:40.941075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:40.994027 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m09:15:40.994929 [debug] [MainThread]: On master: COMMIT
[0m09:15:40.994929 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:40.995929 [debug] [MainThread]: On master: COMMIT
[0m09:15:40.999929 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:15:40.999929 [debug] [MainThread]: On master: Close
[0m09:15:41.000927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:41.000927 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:15:41.001927 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:15:41.001927 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:15:41.001927 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:15:41.002929 [info ] [MainThread]: 
[0m09:15:41.003929 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:15:41.003929 [debug] [MainThread]: Command end result
[0m09:15:41.018051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:15:41.020928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:15:41.026020 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:15:41.026927 [info ] [MainThread]: 
[0m09:15:41.027927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:41.027927 [info ] [MainThread]: 
[0m09:15:41.028925 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:15:41.029926 [debug] [MainThread]: Command `dbt run` succeeded at 09:15:41.029926 after 1.83 seconds
[0m09:15:41.029926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40EAD9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A408C81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A408C09950>]}
[0m09:15:41.030928 [debug] [MainThread]: Flushing usage events
[0m09:15:41.668353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:48.690993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB3985790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB39DABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB39DA410>]}


============================== 09:18:48.694991 | 4ed49904-f069-419e-ae20-27092740bedb ==============================
[0m09:18:48.694991 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:18:48.695992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:18:48.850675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ed49904-f069-419e-ae20-27092740bedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB3ACCF90>]}
[0m09:18:48.880699 [debug] [MainThread]: Command `dbt clean` succeeded at 09:18:48.879676 after 0.25 seconds
[0m09:18:48.880699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DADC81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB379FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DADC09A90>]}
[0m09:18:48.881677 [debug] [MainThread]: Flushing usage events
[0m09:18:49.970603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:54.331340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A19F08E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A19DFA46D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A19F0B7F90>]}


============================== 09:18:54.334340 | 8f3f6ec6-fec8-40ea-9667-f465b06fc8ee ==============================
[0m09:18:54.334340 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:18:54.335341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:18:54.345341 [info ] [MainThread]: dbt version: 1.9.2
[0m09:18:54.346340 [info ] [MainThread]: python version: 3.11.9
[0m09:18:54.347341 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:18:54.347341 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:18:54.416456 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:18:54.417350 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:18:54.417350 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:18:54.418353 [info ] [MainThread]: adapter type: postgres
[0m09:18:54.419349 [info ] [MainThread]: adapter version: 1.9.0
[0m09:18:54.486879 [info ] [MainThread]: Configuration:
[0m09:18:54.487863 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:18:54.487863 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:18:54.488863 [info ] [MainThread]: Required dependencies:
[0m09:18:54.488863 [debug] [MainThread]: Executing "git --help"
[0m09:18:54.528343 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:18:54.529363 [debug] [MainThread]: STDERR: "b''"
[0m09:18:54.530346 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:18:54.531349 [info ] [MainThread]: Connection:
[0m09:18:54.531349 [info ] [MainThread]:   host: 172.16.0.239
[0m09:18:54.532343 [info ] [MainThread]:   port: 5432
[0m09:18:54.532343 [info ] [MainThread]:   user: dmx-op-user
[0m09:18:54.533344 [info ] [MainThread]:   database: operacoes
[0m09:18:54.533344 [info ] [MainThread]:   schema: public
[0m09:18:54.533344 [info ] [MainThread]:   connect_timeout: 10
[0m09:18:54.534344 [info ] [MainThread]:   role: None
[0m09:18:54.534344 [info ] [MainThread]:   search_path: None
[0m09:18:54.535344 [info ] [MainThread]:   keepalives_idle: 0
[0m09:18:54.535344 [info ] [MainThread]:   sslmode: None
[0m09:18:54.535344 [info ] [MainThread]:   sslcert: None
[0m09:18:54.536344 [info ] [MainThread]:   sslkey: None
[0m09:18:54.536344 [info ] [MainThread]:   sslrootcert: None
[0m09:18:54.537345 [info ] [MainThread]:   application_name: dbt
[0m09:18:54.538351 [info ] [MainThread]:   retries: 1
[0m09:18:54.540350 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:18:54.738397 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:18:54.781397 [debug] [MainThread]: Using postgres connection "debug"
[0m09:18:54.782398 [debug] [MainThread]: On debug: select 1 as id
[0m09:18:54.782398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:54.839234 [debug] [MainThread]: SQL status: SELECT 1 in 0.057 seconds
[0m09:18:54.841218 [debug] [MainThread]: On debug: Close
[0m09:18:54.841218 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:18:54.842220 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:18:54.843218 [debug] [MainThread]: Command `dbt debug` succeeded at 09:18:54.843218 after 0.62 seconds
[0m09:18:54.843218 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:18:54.844219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A19DDB9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1992D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A199259950>]}
[0m09:18:54.844219 [debug] [MainThread]: Flushing usage events
[0m09:18:55.458878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:59.806107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA08E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA08E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA08E4D0>]}


============================== 09:18:59.810105 | 172a4798-483e-437f-b98c-2124e2336d8e ==============================
[0m09:18:59.810105 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:18:59.811106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:18:59.964267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA103890>]}
[0m09:19:00.007263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F6209790>]}
[0m09:19:00.008266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:00.190160 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:19:00.191058 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:00.191058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA2FCF50>]}
[0m09:19:00.952389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F44A4210>]}
[0m09:19:00.997435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:19:01.002941 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:19:01.021477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA308890>]}
[0m09:19:01.022482 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:19:01.023483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA18F6D0>]}
[0m09:19:01.024485 [info ] [MainThread]: 
[0m09:19:01.025482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:01.025482 [info ] [MainThread]: 
[0m09:19:01.026483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:01.029483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:19:01.084825 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:19:01.085824 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:19:01.085824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:01.134050 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m09:19:01.136049 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:19:01.137049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:19:01.141553 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:19:01.141553 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:19:01.142563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:01.191798 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m09:19:01.191798 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:19:01.192805 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:19:01.199920 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:19:01.201426 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:19:01.204533 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:19:01.209433 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.210431 [debug] [MainThread]: On master: BEGIN
[0m09:19:01.210431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:01.259853 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m09:19:01.259853 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.259853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:01.268458 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:19:01.270465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA832CD0>]}
[0m09:19:01.271368 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:01.274604 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.274604 [debug] [MainThread]: On master: BEGIN
[0m09:19:01.282662 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:19:01.283662 [debug] [MainThread]: On master: COMMIT
[0m09:19:01.283662 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.284566 [debug] [MainThread]: On master: COMMIT
[0m09:19:01.288760 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:19:01.289940 [debug] [MainThread]: On master: Close
[0m09:19:01.296589 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:19:01.297591 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:19:01.298589 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:19:01.300591 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:19:01.299590 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:19:01.302102 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:19:01.303116 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:19:01.314153 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.315152 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:19:01.319151 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:19:01.320151 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:19:01.320151 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:19:01.346687 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.349687 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:19:01.352208 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.353218 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:19:01.354230 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.355225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:19:01.355225 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:19:01.356223 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:19:01.477341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m09:19:01.478341 [debug] [Thread-2 (]: SQL status: BEGIN in 0.122 seconds
[0m09:19:01.478341 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.479341 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.479341 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:19:01.480341 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    vencimento::DATE AS vencimento,
    timestamp_extracao::VARCHAR(8000) AS timestamp_extracao,
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:19:01.486849 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:19:01.491351 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.492356 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:19:01.492356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:19:01.495357 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.496356 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:19:01.499374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:19:01.499374 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:19:01.501863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.503890 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.504884 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:19:01.504884 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:19:01.509185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:19:01.509185 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:19:01.520796 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:19:01.523443 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:19:01.523443 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.524347 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.524347 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:19:01.524347 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:19:01.550757 [debug] [Thread-2 (]: SQL status: COMMIT in 0.026 seconds
[0m09:19:01.551686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m09:19:01.558209 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:19:01.560210 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:19:01.565741 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:19:01.566736 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:19:01.566736 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:19:01.567735 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:19:01.588642 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:19:01.591642 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:19:01.594284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA822A50>]}
[0m09:19:01.594284 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:19:01.595285 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:19:01.603893 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m09:19:01.605882 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:19:01.606882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172a4798-483e-437f-b98c-2124e2336d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FA790350>]}
[0m09:19:01.607883 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:19:01.609881 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:19:01.611388 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.612946 [debug] [MainThread]: On master: BEGIN
[0m09:19:01.613954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:01.646024 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:19:01.647039 [debug] [MainThread]: On master: COMMIT
[0m09:19:01.648059 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:01.649050 [debug] [MainThread]: On master: COMMIT
[0m09:19:01.652554 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:19:01.653552 [debug] [MainThread]: On master: Close
[0m09:19:01.654556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:01.654556 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:19:01.655553 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:19:01.655553 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:19:01.655553 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:19:01.655553 [info ] [MainThread]: 
[0m09:19:01.656556 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m09:19:01.657554 [debug] [MainThread]: Command end result
[0m09:19:01.672873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:19:01.674871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:19:01.678873 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:19:01.679874 [info ] [MainThread]: 
[0m09:19:01.679874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:01.681533 [info ] [MainThread]: 
[0m09:19:01.681533 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:19:01.682539 [debug] [MainThread]: Command `dbt run` succeeded at 09:19:01.682539 after 1.93 seconds
[0m09:19:01.682539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F8FA4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F4311C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F4298D50>]}
[0m09:19:01.683540 [debug] [MainThread]: Flushing usage events
[0m09:19:02.327636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:27.034840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03E87A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03ED9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03ED9F50>]}


============================== 09:20:27.039840 | 68ae6cf4-d45d-428f-8246-3b6d13af5870 ==============================
[0m09:20:27.039840 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:27.040839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:20:27.167909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68ae6cf4-d45d-428f-8246-3b6d13af5870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03F4D850>]}
[0m09:20:27.189919 [debug] [MainThread]: Command `dbt clean` succeeded at 09:20:27.189919 after 0.22 seconds
[0m09:20:27.190918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDFF029950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDFF028DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03EB7F50>]}
[0m09:20:27.190918 [debug] [MainThread]: Flushing usage events
[0m09:20:27.906440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:35.515173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1DA8C210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1D89F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1D89F590>]}


============================== 09:20:35.518189 | 335fef5c-99be-4f3d-90fa-64bcd7e9f832 ==============================
[0m09:20:35.518189 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:35.519171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:20:35.530174 [info ] [MainThread]: dbt version: 1.9.2
[0m09:20:35.531251 [info ] [MainThread]: python version: 3.11.9
[0m09:20:35.531251 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:20:35.532301 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:20:35.603188 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:20:35.604185 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:20:35.605185 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:20:35.606216 [info ] [MainThread]: adapter type: postgres
[0m09:20:35.606216 [info ] [MainThread]: adapter version: 1.9.0
[0m09:20:35.671870 [info ] [MainThread]: Configuration:
[0m09:20:35.673774 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:20:35.673774 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:20:35.674775 [info ] [MainThread]: Required dependencies:
[0m09:20:35.674775 [debug] [MainThread]: Executing "git --help"
[0m09:20:35.713774 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:20:35.713774 [debug] [MainThread]: STDERR: "b''"
[0m09:20:35.714775 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:20:35.715774 [info ] [MainThread]: Connection:
[0m09:20:35.716776 [info ] [MainThread]:   host: 172.16.0.239
[0m09:20:35.716776 [info ] [MainThread]:   port: 5432
[0m09:20:35.717783 [info ] [MainThread]:   user: dmx-op-user
[0m09:20:35.718773 [info ] [MainThread]:   database: operacoes
[0m09:20:35.718773 [info ] [MainThread]:   schema: public
[0m09:20:35.719775 [info ] [MainThread]:   connect_timeout: 10
[0m09:20:35.719775 [info ] [MainThread]:   role: None
[0m09:20:35.720775 [info ] [MainThread]:   search_path: None
[0m09:20:35.721775 [info ] [MainThread]:   keepalives_idle: 0
[0m09:20:35.721775 [info ] [MainThread]:   sslmode: None
[0m09:20:35.722775 [info ] [MainThread]:   sslcert: None
[0m09:20:35.722775 [info ] [MainThread]:   sslkey: None
[0m09:20:35.723774 [info ] [MainThread]:   sslrootcert: None
[0m09:20:35.723774 [info ] [MainThread]:   application_name: dbt
[0m09:20:35.724774 [info ] [MainThread]:   retries: 1
[0m09:20:35.724774 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:35.921279 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:20:35.965835 [debug] [MainThread]: Using postgres connection "debug"
[0m09:20:35.965835 [debug] [MainThread]: On debug: select 1 as id
[0m09:20:35.966835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:36.024363 [debug] [MainThread]: SQL status: SELECT 1 in 0.058 seconds
[0m09:20:36.025367 [debug] [MainThread]: On debug: Close
[0m09:20:36.025367 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:20:36.026366 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:20:36.027365 [debug] [MainThread]: Command `dbt debug` succeeded at 09:20:36.027365 after 0.57 seconds
[0m09:20:36.029375 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:20:36.029375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1D89D690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA17C81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1DCBC890>]}
[0m09:20:36.030366 [debug] [MainThread]: Flushing usage events
[0m09:20:36.637081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:40.619333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB18E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB089290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB18E2D0>]}


============================== 09:20:40.622351 | 0b3d0f20-db38-42bf-be43-abe123af6214 ==============================
[0m09:20:40.622351 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:40.623351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:20:40.770951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB2F2650>]}
[0m09:20:40.810951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E7209710>]}
[0m09:20:40.811952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:40.984779 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:20:40.985778 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:20:40.986680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB1D9950>]}
[0m09:20:41.689786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB866E10>]}
[0m09:20:41.732683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:20:41.735915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:20:41.752683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB3ACF90>]}
[0m09:20:41.753688 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:20:41.754688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB872890>]}
[0m09:20:41.755788 [info ] [MainThread]: 
[0m09:20:41.756688 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:41.756688 [info ] [MainThread]: 
[0m09:20:41.757688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:41.761688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:20:41.816206 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:20:41.816206 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:20:41.817208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:41.881557 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m09:20:41.883561 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:20:41.884559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:20:41.888560 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:20:41.889560 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:20:41.889560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:41.941557 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m09:20:41.941557 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:20:41.942560 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:20:41.948557 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m09:20:41.949560 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:20:41.954567 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:20:41.959566 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:41.959566 [debug] [MainThread]: On master: BEGIN
[0m09:20:41.960567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:42.009073 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m09:20:42.010075 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:42.010075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:42.018767 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:20:42.019750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB8D3BD0>]}
[0m09:20:42.020766 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:42.023765 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:42.024766 [debug] [MainThread]: On master: BEGIN
[0m09:20:42.030767 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:20:42.030767 [debug] [MainThread]: On master: COMMIT
[0m09:20:42.031769 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:42.031769 [debug] [MainThread]: On master: COMMIT
[0m09:20:42.036340 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:20:42.036340 [debug] [MainThread]: On master: Close
[0m09:20:42.042200 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:42.043201 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:20:42.043201 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:20:42.045203 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:20:42.045203 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:20:42.046213 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:20:42.047197 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:42.047197 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:20:42.052198 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.054234 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:20:42.056203 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:42.073732 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:20:42.083730 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.086731 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:20:42.088730 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.089731 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.089731 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:20:42.089731 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:20:42.090732 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:20:42.090732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:20:42.153328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m09:20:42.154419 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.156320 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    vencimento::DATE AS vencimento,
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    vencimento::DATE AS vencimento,
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:20:42.157430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m09:20:42.158421 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.159418 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:20:42.165026 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:20:42.166048 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:20:42.173573 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.176570 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.176925 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:20:42.176925 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:20:42.181095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:42.183940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.184938 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:20:42.184938 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:20:42.186939 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.187939 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:20:42.191095 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:42.191985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:42.203041 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:20:42.205037 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:20:42.205940 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.205940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.205940 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:20:42.206942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:20:42.228218 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m09:20:42.234214 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:20:42.238215 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:20:42.238215 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:20:42.239214 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m09:20:42.241213 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:20:42.241213 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:42.242212 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:20:42.260669 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:20:42.262674 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:20:42.264671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EBD4C510>]}
[0m09:20:42.265670 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m09:20:42.266759 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:20:42.273921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.031 seconds
[0m09:20:42.275913 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:20:42.276913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3d0f20-db38-42bf-be43-abe123af6214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141EB796950>]}
[0m09:20:42.277912 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.23s]
[0m09:20:42.278930 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:42.281907 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:42.282907 [debug] [MainThread]: On master: BEGIN
[0m09:20:42.282907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:42.339509 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m09:20:42.339509 [debug] [MainThread]: On master: COMMIT
[0m09:20:42.340443 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:42.340443 [debug] [MainThread]: On master: COMMIT
[0m09:20:42.343493 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:20:42.343493 [debug] [MainThread]: On master: Close
[0m09:20:42.344498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:42.344498 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:20:42.344498 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:20:42.345472 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:20:42.345472 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:20:42.346391 [info ] [MainThread]: 
[0m09:20:42.346391 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:20:42.347390 [debug] [MainThread]: Command end result
[0m09:20:42.362455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:20:42.364499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:20:42.369984 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:20:42.369984 [info ] [MainThread]: 
[0m09:20:42.370972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:42.371973 [info ] [MainThread]: 
[0m09:20:42.371973 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:20:42.372973 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:42.372973 after 1.81 seconds
[0m09:20:42.374070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E2F81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E2F81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E2F08D50>]}
[0m09:20:42.374070 [debug] [MainThread]: Flushing usage events
[0m09:20:43.073233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:51.177608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024735887F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247358DAC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247358D9FD0>]}


============================== 09:23:51.181609 | 7f278a23-4a24-41f3-87d8-f00755b99f29 ==============================
[0m09:23:51.181609 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:23:51.182609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:23:51.318180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f278a23-4a24-41f3-87d8-f00755b99f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247358D9CD0>]}
[0m09:23:51.343692 [debug] [MainThread]: Command `dbt clean` succeeded at 09:23:51.343692 after 0.22 seconds
[0m09:23:51.343692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002472FA49950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002472FA48DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002472FAC1C10>]}
[0m09:23:51.344692 [debug] [MainThread]: Flushing usage events
[0m09:23:52.053384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:56.821224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E899DBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E899D9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E899D9290>]}


============================== 09:23:56.825221 | 0a3bef1d-c161-4b3c-a899-d6c32ea6ca55 ==============================
[0m09:23:56.825221 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:23:56.826222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:56.838225 [info ] [MainThread]: dbt version: 1.9.2
[0m09:23:56.838225 [info ] [MainThread]: python version: 3.11.9
[0m09:23:56.839223 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:23:56.839223 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:23:56.907741 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:23:56.909742 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:23:56.909742 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:23:56.910741 [info ] [MainThread]: adapter type: postgres
[0m09:23:56.911743 [info ] [MainThread]: adapter version: 1.9.0
[0m09:23:56.975272 [info ] [MainThread]: Configuration:
[0m09:23:56.976272 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:23:56.977258 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:23:56.978256 [info ] [MainThread]: Required dependencies:
[0m09:23:56.978256 [debug] [MainThread]: Executing "git --help"
[0m09:23:57.019257 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:23:57.019257 [debug] [MainThread]: STDERR: "b''"
[0m09:23:57.020272 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:23:57.021256 [info ] [MainThread]: Connection:
[0m09:23:57.021256 [info ] [MainThread]:   host: 172.16.0.239
[0m09:23:57.022256 [info ] [MainThread]:   port: 5432
[0m09:23:57.022256 [info ] [MainThread]:   user: dmx-op-user
[0m09:23:57.023255 [info ] [MainThread]:   database: operacoes
[0m09:23:57.023255 [info ] [MainThread]:   schema: public
[0m09:23:57.023255 [info ] [MainThread]:   connect_timeout: 10
[0m09:23:57.024256 [info ] [MainThread]:   role: None
[0m09:23:57.024256 [info ] [MainThread]:   search_path: None
[0m09:23:57.025255 [info ] [MainThread]:   keepalives_idle: 0
[0m09:23:57.025255 [info ] [MainThread]:   sslmode: None
[0m09:23:57.025255 [info ] [MainThread]:   sslcert: None
[0m09:23:57.026255 [info ] [MainThread]:   sslkey: None
[0m09:23:57.026255 [info ] [MainThread]:   sslrootcert: None
[0m09:23:57.027256 [info ] [MainThread]:   application_name: dbt
[0m09:23:57.027256 [info ] [MainThread]:   retries: 1
[0m09:23:57.028257 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:57.209316 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:23:57.251323 [debug] [MainThread]: Using postgres connection "debug"
[0m09:23:57.251323 [debug] [MainThread]: On debug: select 1 as id
[0m09:23:57.251323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:57.304501 [debug] [MainThread]: SQL status: SELECT 1 in 0.053 seconds
[0m09:23:57.305501 [debug] [MainThread]: On debug: Close
[0m09:23:57.306485 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:23:57.306485 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:23:57.307483 [debug] [MainThread]: Command `dbt debug` succeeded at 09:23:57.307483 after 0.54 seconds
[0m09:23:57.308484 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:23:57.308484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E896B9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E83B81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E89888B10>]}
[0m09:23:57.309514 [debug] [MainThread]: Flushing usage events
[0m09:23:57.927051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:01.420639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFD98E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFD9C89D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFD79F890>]}


============================== 09:24:01.423641 | 2f34bffa-c0c1-46bb-9fa6-aefb0781aec6 ==============================
[0m09:24:01.423641 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:24:01.425640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:24:01.569753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFDBB7510>]}
[0m09:24:01.607737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF89B9310>]}
[0m09:24:01.608736 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:01.788948 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:24:01.789846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:24:01.790845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFDDAFB90>]}
[0m09:24:02.488579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFE120510>]}
[0m09:24:02.534578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:02.539579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:02.556587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFDEAA6D0>]}
[0m09:24:02.556587 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:24:02.557584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFE120350>]}
[0m09:24:02.558584 [info ] [MainThread]: 
[0m09:24:02.559582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:02.559582 [info ] [MainThread]: 
[0m09:24:02.560584 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:02.563585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:24:02.616088 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:24:02.617088 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:24:02.618088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:02.649683 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m09:24:02.650698 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:24:02.652684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:24:02.657721 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:02.658707 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:24:02.658707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:02.692549 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m09:24:02.693539 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:02.694544 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:24:02.704343 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.008 seconds
[0m09:24:02.708444 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:24:02.713016 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:24:02.723327 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:02.724302 [debug] [MainThread]: On master: BEGIN
[0m09:24:02.724302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:02.805705 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m09:24:02.806684 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:02.806684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:02.817102 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m09:24:02.818349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFDE47D50>]}
[0m09:24:02.818349 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:02.822552 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:02.822552 [debug] [MainThread]: On master: BEGIN
[0m09:24:02.829759 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:24:02.830586 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.830586 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:02.830586 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.834728 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:24:02.834728 [debug] [MainThread]: On master: Close
[0m09:24:02.838585 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:02.838585 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:24:02.839585 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:24:02.840584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:24:02.839585 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:24:02.840584 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:02.841587 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:24:02.846684 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.847586 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:24:02.850687 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:24:02.851585 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:24:02.870210 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:02.879213 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:24:02.882212 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.884920 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:02.885920 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.885920 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:24:02.886918 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:24:02.886918 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:24:02.886918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:02.923861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m09:24:02.924975 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.925973 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:24:02.933979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:24:02.941972 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.942969 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:24:02.942969 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m09:24:02.943870 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:02.943870 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    TO_DATE(vencimento, 'DD/MM/YY') AS vencimento, --conversao para data correta
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(REPLACE(valor, ',', '.') AS DECIMAL(10,2)) AS valor,
    CAST(REPLACE(valor_juros, ',', '.') AS DECIMAL(10,2)) AS valor_juros,
    CAST(REPLACE(valor_multa, ',', '.') AS DECIMAL(10,2)) AS valor_multa,
    CAST(REPLACE(valor_tarifas, ',', '.') AS DECIMAL(10,2)) AS valor_tarifas,
    CAST(REPLACE(valor_total, ',', '.') AS DECIMAL(10,2)) AS valor_total,
    TO_DATE(vencimento, 'DD/MM/YY') AS vencimento, --conversao para data correta
    CAST(REPLACE(desagio, ',', '.') AS DECIMAL(10,2)) AS desagio
FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:24:02.946103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:02.950104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.950104 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:24:02.953359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:24:02.964467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:02.965452 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m09:24:02.965452 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.967443 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:02.968437 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:02.968961 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:24:02.973511 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:02.975368 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:02.975368 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:24:02.980406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:02.981368 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:24:02.981368 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:02.981368 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:24:02.988900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:24:02.993907 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:24:02.999384 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:02.999384 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:24:03.007387 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m09:24:03.010383 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:24:03.010383 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:24:03.011385 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:24:03.019659 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:24:03.021644 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:24:03.023643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFDF91A50>]}
[0m09:24:03.023643 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m09:24:03.024641 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:03.033637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:24:03.034649 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:24:03.035659 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f34bffa-c0c1-46bb-9fa6-aefb0781aec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFE45A490>]}
[0m09:24:03.035659 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m09:24:03.036717 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:24:03.039722 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:03.039722 [debug] [MainThread]: On master: BEGIN
[0m09:24:03.040724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:03.071394 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:24:03.072365 [debug] [MainThread]: On master: COMMIT
[0m09:24:03.072365 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:03.072365 [debug] [MainThread]: On master: COMMIT
[0m09:24:03.076365 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:24:03.076365 [debug] [MainThread]: On master: Close
[0m09:24:03.077365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:03.077365 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:24:03.078366 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:24:03.078366 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:24:03.078366 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:24:03.079365 [info ] [MainThread]: 
[0m09:24:03.079365 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:24:03.080365 [debug] [MainThread]: Command end result
[0m09:24:03.093380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:03.095365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:03.100364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:24:03.101367 [info ] [MainThread]: 
[0m09:24:03.102365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:03.103367 [info ] [MainThread]: 
[0m09:24:03.103367 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:24:03.104484 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:03.104484 after 1.74 seconds
[0m09:24:03.105531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7B81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7B81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7B08D50>]}
[0m09:24:03.105531 [debug] [MainThread]: Flushing usage events
[0m09:24:03.735562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:25.111054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D823B85FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D823BC8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D823BDBB90>]}


============================== 09:25:25.116071 | b35c9902-9a58-4132-b605-7c63b0db25a6 ==============================
[0m09:25:25.116071 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:25:25.117055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:25:25.250663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35c9902-9a58-4132-b605-7c63b0db25a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D823CCA750>]}
[0m09:25:25.275675 [debug] [MainThread]: Command `dbt clean` succeeded at 09:25:25.275675 after 0.22 seconds
[0m09:25:25.275675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81DD09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D82399F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81DD81BD0>]}
[0m09:25:25.276644 [debug] [MainThread]: Flushing usage events
[0m09:25:25.978255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:38.971640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D25985750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D259B4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D259DA650>]}


============================== 09:25:38.974637 | d5b04bdd-cd2d-4667-baeb-3bbab1633c03 ==============================
[0m09:25:38.974637 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:25:38.975641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:25:38.988155 [info ] [MainThread]: dbt version: 1.9.2
[0m09:25:38.988155 [info ] [MainThread]: python version: 3.11.9
[0m09:25:38.989155 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:25:38.990156 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:25:39.052156 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:25:39.053168 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:25:39.053168 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:25:39.054156 [info ] [MainThread]: adapter type: postgres
[0m09:25:39.055160 [info ] [MainThread]: adapter version: 1.9.0
[0m09:25:39.121695 [info ] [MainThread]: Configuration:
[0m09:25:39.122695 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:25:39.123740 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:25:39.124747 [info ] [MainThread]: Required dependencies:
[0m09:25:39.124747 [debug] [MainThread]: Executing "git --help"
[0m09:25:39.167697 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:25:39.168697 [debug] [MainThread]: STDERR: "b''"
[0m09:25:39.169703 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:25:39.170696 [info ] [MainThread]: Connection:
[0m09:25:39.171697 [info ] [MainThread]:   host: 172.16.0.239
[0m09:25:39.171697 [info ] [MainThread]:   port: 5432
[0m09:25:39.172696 [info ] [MainThread]:   user: dmx-op-user
[0m09:25:39.172696 [info ] [MainThread]:   database: operacoes
[0m09:25:39.173698 [info ] [MainThread]:   schema: public
[0m09:25:39.173698 [info ] [MainThread]:   connect_timeout: 10
[0m09:25:39.174696 [info ] [MainThread]:   role: None
[0m09:25:39.174696 [info ] [MainThread]:   search_path: None
[0m09:25:39.174696 [info ] [MainThread]:   keepalives_idle: 0
[0m09:25:39.175696 [info ] [MainThread]:   sslmode: None
[0m09:25:39.175696 [info ] [MainThread]:   sslcert: None
[0m09:25:39.176697 [info ] [MainThread]:   sslkey: None
[0m09:25:39.176697 [info ] [MainThread]:   sslrootcert: None
[0m09:25:39.177697 [info ] [MainThread]:   application_name: dbt
[0m09:25:39.177697 [info ] [MainThread]:   retries: 1
[0m09:25:39.178698 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:25:39.372817 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:25:39.415270 [debug] [MainThread]: Using postgres connection "debug"
[0m09:25:39.416254 [debug] [MainThread]: On debug: select 1 as id
[0m09:25:39.416254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:39.478048 [debug] [MainThread]: SQL status: SELECT 1 in 0.062 seconds
[0m09:25:39.479045 [debug] [MainThread]: On debug: Close
[0m09:25:39.479045 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:25:39.480568 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:25:39.481574 [debug] [MainThread]: Command `dbt debug` succeeded at 09:25:39.481574 after 0.57 seconds
[0m09:25:39.482678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:25:39.482678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D1FC81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D1FC81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D1FC09950>]}
[0m09:25:39.482678 [debug] [MainThread]: Flushing usage events
[0m09:25:40.108184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:43.106291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41986F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41888850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E419D9290>]}


============================== 09:25:43.109396 | d248b3af-725f-44f0-a8ab-533eeee6e416 ==============================
[0m09:25:43.109396 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:25:43.111290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:25:43.260800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41B4C0D0>]}
[0m09:25:43.300312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3C9B9810>]}
[0m09:25:43.301313 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:25:43.476239 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:25:43.477241 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:25:43.478241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41BF9990>]}
[0m09:25:44.165577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4201FB90>]}
[0m09:25:44.207722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:25:44.210995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:25:44.227239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41DF53D0>]}
[0m09:25:44.228238 [info ] [MainThread]: Found 2 models, 3 sources, 433 macros
[0m09:25:44.229237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41F1C850>]}
[0m09:25:44.230281 [info ] [MainThread]: 
[0m09:25:44.230869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:44.230869 [info ] [MainThread]: 
[0m09:25:44.231877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:25:44.234944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:25:44.288954 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:25:44.288954 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:25:44.288954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:44.346915 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m09:25:44.348919 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:25:44.349916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:25:44.354917 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:25:44.354917 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:25:44.354917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:44.382918 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m09:25:44.382918 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:25:44.383920 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:25:44.391426 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m09:25:44.392430 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:25:44.395426 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:25:44.400426 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.400426 [debug] [MainThread]: On master: BEGIN
[0m09:25:44.400426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:44.446426 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:25:44.446426 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.447432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:25:44.455426 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m09:25:44.456427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E42102350>]}
[0m09:25:44.457426 [debug] [MainThread]: On master: ROLLBACK
[0m09:25:44.460426 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.461429 [debug] [MainThread]: On master: BEGIN
[0m09:25:44.467426 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:25:44.467426 [debug] [MainThread]: On master: COMMIT
[0m09:25:44.468452 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.468452 [debug] [MainThread]: On master: COMMIT
[0m09:25:44.472425 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:25:44.472425 [debug] [MainThread]: On master: Close
[0m09:25:44.475431 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:25:44.475431 [debug] [Thread-2 (]: Began running node model.my_dbt_project.titulosaberto
[0m09:25:44.476431 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:25:44.477432 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:25:44.476431 [info ] [Thread-2 (]: 2 of 2 START sql view model public.titulosaberto ............................... [RUN]
[0m09:25:44.477432 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:25:44.478431 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m09:25:44.483431 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.484430 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m09:25:44.487430 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m09:25:44.488430 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:25:44.497944 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.titulosaberto
[0m09:25:44.516945 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.520040 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m09:25:44.521945 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.522947 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m09:25:44.523951 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.524948 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:25:44.524948 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:25:44.526061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:25:44.569460 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m09:25:44.570468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m09:25:44.570468 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.571466 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.571466 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:25:44.572466 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:25:44.578472 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:25:44.583570 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.583570 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:25:44.584472 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:25:44.586471 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.587516 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m09:25:44.590981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:25:44.590981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:25:44.593085 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.594982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.596023 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m09:25:44.596023 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:25:44.600076 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:25:44.600982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:25:44.610980 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:25:44.613077 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:25:44.614090 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.614090 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.614983 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m09:25:44.614983 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:25:44.636470 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m09:25:44.641466 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m09:25:44.644459 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m09:25:44.645463 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m09:25:44.658783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m09:25:44.660783 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:25:44.661783 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:25:44.661783 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:25:44.672730 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:25:44.674636 [debug] [Thread-2 (]: On model.my_dbt_project.titulosaberto: Close
[0m09:25:44.675645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E41F989D0>]}
[0m09:25:44.676642 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m09:25:44.677641 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.titulosaberto
[0m09:25:44.690144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:25:44.691152 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:25:44.692152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd248b3af-725f-44f0-a8ab-533eeee6e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4250FB90>]}
[0m09:25:44.693155 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:25:44.694183 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:25:44.695151 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.696151 [debug] [MainThread]: On master: BEGIN
[0m09:25:44.696151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:44.739149 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m09:25:44.739149 [debug] [MainThread]: On master: COMMIT
[0m09:25:44.740149 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:44.740149 [debug] [MainThread]: On master: COMMIT
[0m09:25:44.743168 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:25:44.744152 [debug] [MainThread]: On master: Close
[0m09:25:44.744152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:44.745150 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:25:44.745150 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:25:44.745150 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:25:44.745150 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m09:25:44.746152 [info ] [MainThread]: 
[0m09:25:44.747151 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m09:25:44.747151 [debug] [MainThread]: Command end result
[0m09:25:44.762148 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:25:44.764151 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:25:44.770150 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:25:44.770150 [info ] [MainThread]: 
[0m09:25:44.771150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:44.772149 [info ] [MainThread]: 
[0m09:25:44.772149 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:25:44.773150 [debug] [MainThread]: Command `dbt run` succeeded at 09:25:44.773150 after 1.72 seconds
[0m09:25:44.773150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E417CF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3BB81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3BB09950>]}
[0m09:25:44.774151 [debug] [MainThread]: Flushing usage events
[0m09:25:45.424882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:26.169401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023241283DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232412DBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232412D9490>]}


============================== 10:01:26.174418 | 71e631d1-b1a9-41d5-9745-ac5eb422bf3c ==============================
[0m10:01:26.174418 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:01:26.175416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:01:26.310946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e631d1-b1a9-41d5-9745-ac5eb422bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323FE4A3D0>]}
[0m10:01:26.339933 [debug] [MainThread]: Command `dbt clean` succeeded at 10:01:26.339933 after 0.23 seconds
[0m10:01:26.339933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324109FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323B5D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232412B7F50>]}
[0m10:01:26.340932 [debug] [MainThread]: Flushing usage events
[0m10:01:27.104220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:31.552669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E585950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E585A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E587B90>]}


============================== 10:01:31.555687 | 78f323a7-1e0f-4cc9-bec3-64cd24cdf282 ==============================
[0m10:01:31.555687 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:01:31.556671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:01:31.570246 [info ] [MainThread]: dbt version: 1.9.2
[0m10:01:31.571250 [info ] [MainThread]: python version: 3.11.9
[0m10:01:31.572234 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m10:01:31.573232 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m10:01:31.831426 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m10:01:31.832406 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m10:01:31.833405 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m10:01:31.837714 [info ] [MainThread]: adapter type: postgres
[0m10:01:31.837714 [info ] [MainThread]: adapter version: 1.9.0
[0m10:01:31.905607 [info ] [MainThread]: Configuration:
[0m10:01:31.906509 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:01:31.907507 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:01:31.908508 [info ] [MainThread]: Required dependencies:
[0m10:01:31.908508 [debug] [MainThread]: Executing "git --help"
[0m10:01:31.956640 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:01:31.956640 [debug] [MainThread]: STDERR: "b''"
[0m10:01:31.957640 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:01:31.957640 [info ] [MainThread]: Connection:
[0m10:01:31.958643 [info ] [MainThread]:   host: 172.16.0.239
[0m10:01:31.959642 [info ] [MainThread]:   port: 5432
[0m10:01:31.959642 [info ] [MainThread]:   user: dmx-op-user
[0m10:01:31.960640 [info ] [MainThread]:   database: operacoes
[0m10:01:31.960640 [info ] [MainThread]:   schema: public
[0m10:01:31.961640 [info ] [MainThread]:   connect_timeout: 10
[0m10:01:31.961640 [info ] [MainThread]:   role: None
[0m10:01:31.962643 [info ] [MainThread]:   search_path: None
[0m10:01:31.966286 [info ] [MainThread]:   keepalives_idle: 0
[0m10:01:31.967302 [info ] [MainThread]:   sslmode: None
[0m10:01:31.967302 [info ] [MainThread]:   sslcert: None
[0m10:01:31.967302 [info ] [MainThread]:   sslkey: None
[0m10:01:31.968301 [info ] [MainThread]:   sslrootcert: None
[0m10:01:31.971302 [info ] [MainThread]:   application_name: dbt
[0m10:01:31.971302 [info ] [MainThread]:   retries: 1
[0m10:01:31.972302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:01:32.184785 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:01:32.412808 [debug] [MainThread]: Using postgres connection "debug"
[0m10:01:32.412808 [debug] [MainThread]: On debug: select 1 as id
[0m10:01:32.412808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:32.537438 [debug] [MainThread]: SQL status: SELECT 1 in 0.124 seconds
[0m10:01:32.539377 [debug] [MainThread]: On debug: Close
[0m10:01:32.541478 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:01:32.543203 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:01:32.546292 [debug] [MainThread]: Command `dbt debug` succeeded at 10:01:32.546292 after 1.05 seconds
[0m10:01:32.547205 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:01:32.548206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E5B7C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768841BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768841C10>]}
[0m10:01:32.549202 [debug] [MainThread]: Flushing usage events
[0m10:01:33.267389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:37.000554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4FD87F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4F189610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4F0E0A10>]}


============================== 10:01:37.003439 | c5eb088f-33ee-4315-b38a-f3287afe5d5c ==============================
[0m10:01:37.003439 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:01:37.004439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:01:37.151028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5eb088f-33ee-4315-b38a-f3287afe5d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4FDE7090>]}
[0m10:01:37.190541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5eb088f-33ee-4315-b38a-f3287afe5d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4BE19C10>]}
[0m10:01:37.191541 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:01:37.369655 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:01:37.370655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:01:37.371655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5eb088f-33ee-4315-b38a-f3287afe5d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4FED9AD0>]}
[0m10:01:38.000549 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "public_d_sacados_fidc".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("public", "d_sacados_fidc").
  
  To fix this, change the name of one of these resources:
  - source.my_dbt_project.public.d_sacados_fidc (models\schema.yml)
  - source.my_dbt_project.public.d_sacados_fidc (models\schema.yml)
[0m10:01:38.002787 [debug] [MainThread]: Command `dbt run` failed at 10:01:38.001781 after 1.05 seconds
[0m10:01:38.002787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4FDE7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C512C1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C4FDB7F50>]}
[0m10:01:38.002787 [debug] [MainThread]: Flushing usage events
[0m10:01:38.656702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:04.792837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703858E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027038585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027038587E90>]}


============================== 10:03:04.796857 | 3059661a-f0d3-4d7f-8a2d-90c1f713cc65 ==============================
[0m10:03:04.796857 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:04.797838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:04.899458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3059661a-f0d3-4d7f-8a2d-90c1f713cc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703865F2D0>]}
[0m10:03:04.915459 [debug] [MainThread]: Command `dbt clean` succeeded at 10:03:04.914501 after 0.17 seconds
[0m10:03:04.915459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270327C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270327C8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027032841C10>]}
[0m10:03:04.915459 [debug] [MainThread]: Flushing usage events
[0m10:03:06.096126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:09.337588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EED0B85950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EED0BD9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EED0BDA610>]}


============================== 10:03:09.341589 | 17dc575a-a177-4f38-b7e9-438a177f3978 ==============================
[0m10:03:09.341589 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:09.342588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:03:09.354697 [info ] [MainThread]: dbt version: 1.9.2
[0m10:03:09.355591 [info ] [MainThread]: python version: 3.11.9
[0m10:03:09.355591 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m10:03:09.356590 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m10:03:09.409143 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m10:03:09.409143 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m10:03:09.410156 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m10:03:09.411143 [info ] [MainThread]: adapter type: postgres
[0m10:03:09.412144 [info ] [MainThread]: adapter version: 1.9.0
[0m10:03:09.479159 [info ] [MainThread]: Configuration:
[0m10:03:09.479159 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:03:09.480144 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:03:09.481144 [info ] [MainThread]: Required dependencies:
[0m10:03:09.482145 [debug] [MainThread]: Executing "git --help"
[0m10:03:09.522669 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:03:09.523667 [debug] [MainThread]: STDERR: "b''"
[0m10:03:09.524665 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:03:09.524665 [info ] [MainThread]: Connection:
[0m10:03:09.525666 [info ] [MainThread]:   host: 172.16.0.239
[0m10:03:09.525666 [info ] [MainThread]:   port: 5432
[0m10:03:09.525666 [info ] [MainThread]:   user: dmx-op-user
[0m10:03:09.526666 [info ] [MainThread]:   database: operacoes
[0m10:03:09.526666 [info ] [MainThread]:   schema: public
[0m10:03:09.527666 [info ] [MainThread]:   connect_timeout: 10
[0m10:03:09.527666 [info ] [MainThread]:   role: None
[0m10:03:09.528668 [info ] [MainThread]:   search_path: None
[0m10:03:09.528668 [info ] [MainThread]:   keepalives_idle: 0
[0m10:03:09.529667 [info ] [MainThread]:   sslmode: None
[0m10:03:09.529667 [info ] [MainThread]:   sslcert: None
[0m10:03:09.530674 [info ] [MainThread]:   sslkey: None
[0m10:03:09.531667 [info ] [MainThread]:   sslrootcert: None
[0m10:03:09.531667 [info ] [MainThread]:   application_name: dbt
[0m10:03:09.531667 [info ] [MainThread]:   retries: 1
[0m10:03:09.532667 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:09.712775 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:03:09.758792 [debug] [MainThread]: Using postgres connection "debug"
[0m10:03:09.758792 [debug] [MainThread]: On debug: select 1 as id
[0m10:03:09.758792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:09.908650 [debug] [MainThread]: SQL status: SELECT 1 in 0.149 seconds
[0m10:03:09.912641 [debug] [MainThread]: On debug: Close
[0m10:03:09.914641 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:03:09.916629 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:03:09.918641 [debug] [MainThread]: Command `dbt debug` succeeded at 10:03:09.918641 after 0.64 seconds
[0m10:03:09.919644 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:03:09.920627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EED137C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EED137C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECADF1C10>]}
[0m10:03:09.921640 [debug] [MainThread]: Flushing usage events
[0m10:03:10.585348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:12.808191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF648E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF648E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF63895D0>]}


============================== 10:03:12.812191 | 3cd277a1-3398-46e3-a0a2-637dc62ba59b ==============================
[0m10:03:12.812191 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:12.813190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:12.961232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF666E110>]}
[0m10:03:13.001242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF2509C50>]}
[0m10:03:13.002242 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:13.176090 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:03:13.177088 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:03:13.178107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF670BB90>]}
[0m10:03:13.862434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF2F78350>]}
[0m10:03:13.904750 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:03:13.908584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:03:13.926166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6B81710>]}
[0m10:03:13.926166 [info ] [MainThread]: Found 3 models, 5 sources, 433 macros
[0m10:03:13.927166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6C23A50>]}
[0m10:03:13.928166 [info ] [MainThread]: 
[0m10:03:13.929182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:13.929182 [info ] [MainThread]: 
[0m10:03:13.930166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:13.933165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:03:13.987302 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:03:13.988236 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:03:13.988236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:14.176583 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.188 seconds
[0m10:03:14.181686 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:03:14.185685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:03:14.194680 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:03:14.194680 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:03:14.195682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:14.317297 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m10:03:14.319337 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:03:14.320336 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:14.351523 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.029 seconds
[0m10:03:14.352904 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:03:14.381758 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:03:14.387747 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:14.387747 [debug] [MainThread]: On master: BEGIN
[0m10:03:14.387747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:14.536880 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m10:03:14.536880 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:14.537880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:14.569879 [debug] [MainThread]: SQL status: SELECT 3 in 0.032 seconds
[0m10:03:14.571879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF654CD10>]}
[0m10:03:14.572879 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:14.575878 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:14.576879 [debug] [MainThread]: On master: BEGIN
[0m10:03:14.609879 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:03:14.609879 [debug] [MainThread]: On master: COMMIT
[0m10:03:14.610879 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:14.610879 [debug] [MainThread]: On master: COMMIT
[0m10:03:14.613883 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:03:14.614885 [debug] [MainThread]: On master: Close
[0m10:03:14.617883 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:03:14.617883 [debug] [Thread-2 (]: Began running node model.my_dbt_project.sacados
[0m10:03:14.618884 [debug] [Thread-3 (]: Began running node model.my_dbt_project.titulosaberto
[0m10:03:14.618884 [info ] [Thread-1 (]: 1 of 3 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:03:14.619884 [info ] [Thread-2 (]: 2 of 3 START sql view model public.sacados ..................................... [RUN]
[0m10:03:14.619884 [info ] [Thread-3 (]: 3 of 3 START sql view model public.titulosaberto ............................... [RUN]
[0m10:03:14.620884 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:03:14.621885 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m10:03:14.621885 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m10:03:14.621885 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:03:14.622884 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.sacados
[0m10:03:14.622884 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m10:03:14.628393 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.631392 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m10:03:14.633391 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m10:03:14.636393 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:03:14.636393 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.titulosaberto
[0m10:03:14.649393 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.sacados
[0m10:03:14.666392 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.669391 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m10:03:14.672391 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.sacados"
[0m10:03:14.674395 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.675393 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.675393 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m10:03:14.676393 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:03:14.676393 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m10:03:14.677396 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: BEGIN
[0m10:03:14.678393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:03:14.678393 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:03:14.679406 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:03:14.811707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.133 seconds
[0m10:03:14.812708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.134 seconds
[0m10:03:14.812708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.134 seconds
[0m10:03:14.813707 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m10:03:14.813707 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.814708 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.814708 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */

  create view "operacoes"."public"."sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:03:14.815708 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:03:14.815708 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:03:14.844931 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m10:03:14.846955 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:03:14.847953 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:03:14.859945 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m10:03:14.862945 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.866943 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.866943 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados__dbt_tmp" rename to "sacados"
[0m10:03:14.867945 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:03:14.868943 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m10:03:14.880946 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:03:14.881944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:03:14.881944 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:03:14.891943 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: COMMIT
[0m10:03:14.894048 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.895946 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.896944 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m10:03:14.896944 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:03:14.897944 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m10:03:14.897944 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: COMMIT
[0m10:03:14.912086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:03:14.912086 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:03:14.915107 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:03:14.916090 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:03:14.917089 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.917089 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.917089 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:03:14.918090 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m10:03:14.942314 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m10:03:14.942314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m10:03:14.943317 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m10:03:14.947331 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m10:03:14.949318 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:03:14.951418 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."sacados__dbt_backup"
[0m10:03:14.955426 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m10:03:14.955426 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:03:14.956318 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m10:03:14.957363 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m10:03:14.957363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:03:14.958318 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
drop view if exists "operacoes"."public"."sacados__dbt_backup" cascade
[0m10:03:14.979474 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:03:14.981474 [debug] [Thread-2 (]: On model.my_dbt_project.sacados: Close
[0m10:03:14.983506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6F91BD0>]}
[0m10:03:14.983506 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.sacados ................................ [[32mCREATE VIEW[0m in 0.36s]
[0m10:03:14.984509 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.sacados
[0m10:03:15.012900 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.054 seconds
[0m10:03:15.014991 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:03:15.014991 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.057 seconds
[0m10:03:15.015990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF69C3850>]}
[0m10:03:15.017000 [debug] [Thread-3 (]: On model.my_dbt_project.titulosaberto: Close
[0m10:03:15.017937 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.40s]
[0m10:03:15.018897 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd277a1-3398-46e3-a0a2-637dc62ba59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF8041490>]}
[0m10:03:15.019940 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:03:15.019940 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.40s]
[0m10:03:15.021907 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.titulosaberto
[0m10:03:15.024965 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:15.024965 [debug] [MainThread]: On master: BEGIN
[0m10:03:15.025966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:15.164852 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m10:03:15.165853 [debug] [MainThread]: On master: COMMIT
[0m10:03:15.165853 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:15.165853 [debug] [MainThread]: On master: COMMIT
[0m10:03:15.198880 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m10:03:15.198880 [debug] [MainThread]: On master: Close
[0m10:03:15.199854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:15.199854 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:03:15.199854 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:03:15.200854 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m10:03:15.200854 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m10:03:15.200854 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m10:03:15.201856 [info ] [MainThread]: 
[0m10:03:15.201856 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m10:03:15.202855 [debug] [MainThread]: Command end result
[0m10:03:15.217972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:03:15.219971 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:03:15.225972 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:03:15.225972 [info ] [MainThread]: 
[0m10:03:15.226971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:15.227987 [info ] [MainThread]: 
[0m10:03:15.228972 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:03:15.231489 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:15.231489 after 2.48 seconds
[0m10:03:15.232487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF61BD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6187D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF629F9D0>]}
[0m10:03:15.232487 [debug] [MainThread]: Flushing usage events
[0m10:03:15.964890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:08.600695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136BA892450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136BA8DAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136BA8DB490>]}


============================== 13:21:08.617693 | 85da66bd-ceeb-452e-bb27-68d82ffee4d8 ==============================
[0m13:21:08.617693 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:08.618710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:08.792477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85da66bd-ceeb-452e-bb27-68d82ffee4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136BA9CFE90>]}
[0m13:21:08.927684 [debug] [MainThread]: Command `dbt clean` succeeded at 13:21:08.926685 after 0.40 seconds
[0m13:21:08.927684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136BA5BD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136B4B81BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136B4B09910>]}
[0m13:21:08.927684 [debug] [MainThread]: Flushing usage events
[0m13:21:09.653112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:14.088047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017392C85ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017392B89490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017392CD9890>]}


============================== 13:21:14.091022 | c3ca4464-c2d0-4b61-aee4-506c92af6186 ==============================
[0m13:21:14.091022 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:14.092022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:14.114022 [info ] [MainThread]: dbt version: 1.9.2
[0m13:21:14.115130 [info ] [MainThread]: python version: 3.11.9
[0m13:21:14.116021 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:21:14.117021 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:21:14.392651 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:21:14.393652 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:21:14.394753 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:21:14.396750 [info ] [MainThread]: adapter type: postgres
[0m13:21:14.397652 [info ] [MainThread]: adapter version: 1.9.0
[0m13:21:14.471702 [info ] [MainThread]: Configuration:
[0m13:21:14.472701 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:21:14.472701 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:21:14.473699 [info ] [MainThread]: Required dependencies:
[0m13:21:14.473699 [debug] [MainThread]: Executing "git --help"
[0m13:21:14.520702 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:21:14.521707 [debug] [MainThread]: STDERR: "b''"
[0m13:21:14.522704 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:21:14.523704 [info ] [MainThread]: Connection:
[0m13:21:14.523704 [info ] [MainThread]:   host: 172.16.0.239
[0m13:21:14.524705 [info ] [MainThread]:   port: 5432
[0m13:21:14.525701 [info ] [MainThread]:   user: dmx-op-user
[0m13:21:14.525701 [info ] [MainThread]:   database: operacoes
[0m13:21:14.526703 [info ] [MainThread]:   schema: public
[0m13:21:14.526703 [info ] [MainThread]:   connect_timeout: 10
[0m13:21:14.527703 [info ] [MainThread]:   role: None
[0m13:21:14.527703 [info ] [MainThread]:   search_path: None
[0m13:21:14.528713 [info ] [MainThread]:   keepalives_idle: 0
[0m13:21:14.529712 [info ] [MainThread]:   sslmode: None
[0m13:21:14.529712 [info ] [MainThread]:   sslcert: None
[0m13:21:14.530709 [info ] [MainThread]:   sslkey: None
[0m13:21:14.531714 [info ] [MainThread]:   sslrootcert: None
[0m13:21:14.531714 [info ] [MainThread]:   application_name: dbt
[0m13:21:14.532715 [info ] [MainThread]:   retries: 1
[0m13:21:14.532715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:14.872361 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:21:16.257009 [debug] [MainThread]: Using postgres connection "debug"
[0m13:21:16.257009 [debug] [MainThread]: On debug: select 1 as id
[0m13:21:16.258013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:16.390542 [debug] [MainThread]: SQL status: SELECT 1 in 0.133 seconds
[0m13:21:16.391544 [debug] [MainThread]: On debug: Close
[0m13:21:16.391544 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:21:16.392525 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:21:16.393528 [debug] [MainThread]: Command `dbt debug` succeeded at 13:21:16.393528 after 2.36 seconds
[0m13:21:16.394546 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:21:16.394546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017392B8BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001739309B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017392038210>]}
[0m13:21:16.395526 [debug] [MainThread]: Flushing usage events
[0m13:21:17.066502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:21.738807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026429485910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642929FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264294DA6D0>]}


============================== 13:21:21.742809 | 701a78eb-2c97-4ed6-b8c9-8ee15b69b873 ==============================
[0m13:21:21.742809 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:21.743807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:21.889150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026429660FD0>]}
[0m13:21:21.929255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026425508150>]}
[0m13:21:21.930228 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:22.133909 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:21:22.134910 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:21:22.135909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264298F1C10>]}
[0m13:21:23.459762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026429B66350>]}
[0m13:21:23.505761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:21:23.510785 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:21:23.555278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642995EB10>]}
[0m13:21:23.556279 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m13:21:23.557278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026429906350>]}
[0m13:21:23.558305 [info ] [MainThread]: 
[0m13:21:23.559297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:23.560302 [info ] [MainThread]: 
[0m13:21:23.561278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:23.564296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:21:23.617278 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:21:23.617278 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:21:23.618279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:23.674111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m13:21:23.676213 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:21:23.678111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:21:23.682217 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:21:23.683209 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:21:23.683209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:23.734109 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m13:21:23.734109 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:21:23.735111 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:21:23.742112 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.007 seconds
[0m13:21:23.743113 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:21:23.746112 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:21:23.751114 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.751114 [debug] [MainThread]: On master: BEGIN
[0m13:21:23.752115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:23.798135 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m13:21:23.799137 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.799137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:23.807135 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m13:21:23.809135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026429A3F8D0>]}
[0m13:21:23.809135 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:23.813135 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.813135 [debug] [MainThread]: On master: BEGIN
[0m13:21:23.820135 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:21:23.820135 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.821135 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.821135 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.824135 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:21:23.825135 [debug] [MainThread]: On master: Close
[0m13:21:23.827137 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:21:23.828136 [debug] [Thread-2 (]: Began running node model.my_dbt_project.f_operacoes
[0m13:21:23.828136 [debug] [Thread-3 (]: Began running node model.my_dbt_project.sacados
[0m13:21:23.829137 [debug] [Thread-4 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:21:23.829137 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:21:23.830137 [info ] [Thread-2 (]: 2 of 4 START sql view model public.f_operacoes ................................. [RUN]
[0m13:21:23.830137 [info ] [Thread-3 (]: 3 of 4 START sql view model public.sacados ..................................... [RUN]
[0m13:21:23.831137 [info ] [Thread-4 (]: 4 of 4 START sql view model public.titulosaberto ............................... [RUN]
[0m13:21:23.831137 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:21:23.832136 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.f_operacoes'
[0m13:21:23.832136 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m13:21:23.833137 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:21:23.833137 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:21:23.834138 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.f_operacoes
[0m13:21:23.834138 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.sacados
[0m13:21:23.834138 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:21:23.840143 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:23.842141 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.f_operacoes"
[0m13:21:23.844143 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m13:21:23.846142 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:21:23.848142 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:21:23.849145 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:21:23.877353 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:23.877353 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.sacados
[0m13:21:23.881352 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:21:23.882338 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.f_operacoes
[0m13:21:23.886354 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.sacados"
[0m13:21:23.889353 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.f_operacoes"
[0m13:21:23.891871 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:23.891871 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:23.892877 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:23.892877 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: BEGIN
[0m13:21:23.893879 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:23.893879 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:21:23.893879 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: BEGIN
[0m13:21:23.894878 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:23.894878 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:21:23.894878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:23.895875 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:23.895875 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:23.956257 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m13:21:23.957257 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m13:21:23.958258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m13:21:23.959256 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:23.961261 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:23.962371 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:23.963259 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m13:21:23.965269 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */

  create view "operacoes"."public"."f_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m13:21:23.966363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:21:23.976816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:21:23.977747 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:21:23.978849 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:21:23.987845 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:23.992834 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:23.997835 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:23.998746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:21:24.000743 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */
alter table "operacoes"."public"."f_operacoes" rename to "f_operacoes__dbt_backup"
[0m13:21:24.001803 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:21:24.005860 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:21:24.006744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:21:24.007743 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:21:24.011831 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:24.016822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:24.021819 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:24.022726 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:21:24.023618 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:21:24.024683 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */
alter table "operacoes"."public"."f_operacoes__dbt_tmp" rename to "f_operacoes"
[0m13:21:24.029921 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:21:24.030986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:21:24.031924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:21:24.048027 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:21:24.049919 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:21:24.050922 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: COMMIT
[0m13:21:24.051921 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:24.051921 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:24.052921 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:24.052921 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:21:24.052921 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:21:24.054429 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: COMMIT
[0m13:21:24.083625 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m13:21:24.089625 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:21:24.093625 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:21:24.093625 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:21:24.096609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m13:21:24.096609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.041 seconds
[0m13:21:24.098610 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:21:24.100649 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."f_operacoes__dbt_backup"
[0m13:21:24.101626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:21:24.103609 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:21:24.104608 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:21:24.104608 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */
drop table if exists "operacoes"."public"."f_operacoes__dbt_backup" cascade
[0m13:21:24.109399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.015 seconds
[0m13:21:24.111474 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:21:24.118444 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264298F1090>]}
[0m13:21:24.119442 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m13:21:24.120443 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:21:24.139185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m13:21:24.139185 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.034 seconds
[0m13:21:24.140191 [debug] [Thread-3 (]: SQL status: BEGIN in 0.245 seconds
[0m13:21:24.141191 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:21:24.143193 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: Close
[0m13:21:24.143193 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:24.144191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642B06AA10>]}
[0m13:21:24.144191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642B07E990>]}
[0m13:21:24.145193 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */

  create view "operacoes"."public"."sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m13:21:24.145193 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:21:24.146206 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.f_operacoes ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m13:21:24.147192 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:21:24.147192 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.f_operacoes
[0m13:21:24.152854 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:21:24.155445 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:24.155445 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados" rename to "sacados__dbt_backup"
[0m13:21:24.160445 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:21:24.162459 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:24.163463 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados__dbt_tmp" rename to "sacados"
[0m13:21:24.167446 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:21:24.169464 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:21:24.169464 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:24.169464 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:21:24.195536 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m13:21:24.198536 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."sacados__dbt_backup"
[0m13:21:24.199555 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:21:24.199555 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
drop view if exists "operacoes"."public"."sacados__dbt_backup" cascade
[0m13:21:24.212173 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m13:21:24.213172 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: Close
[0m13:21:24.214189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701a78eb-2c97-4ed6-b8c9-8ee15b69b873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642B07EC90>]}
[0m13:21:24.214189 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.sacados ................................ [[32mCREATE VIEW[0m in 0.38s]
[0m13:21:24.215173 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.sacados
[0m13:21:24.217173 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:24.217173 [debug] [MainThread]: On master: BEGIN
[0m13:21:24.217173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:24.281428 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m13:21:24.282388 [debug] [MainThread]: On master: COMMIT
[0m13:21:24.282388 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:24.283425 [debug] [MainThread]: On master: COMMIT
[0m13:21:24.286424 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:21:24.287410 [debug] [MainThread]: On master: Close
[0m13:21:24.287410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:24.288410 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:21:24.288410 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:21:24.288410 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:21:24.288410 [debug] [MainThread]: Connection 'model.my_dbt_project.f_operacoes' was properly closed.
[0m13:21:24.289409 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m13:21:24.289409 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:21:24.289409 [info ] [MainThread]: 
[0m13:21:24.290410 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m13:21:24.291410 [debug] [MainThread]: Command end result
[0m13:21:24.307410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:21:24.310413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:21:24.315410 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:21:24.316410 [info ] [MainThread]: 
[0m13:21:24.317411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:24.317411 [info ] [MainThread]: 
[0m13:21:24.318411 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:21:24.319410 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:24.319410 after 2.64 seconds
[0m13:21:24.319410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264236D1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264236D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026423659950>]}
[0m13:21:24.320410 [debug] [MainThread]: Flushing usage events
[0m13:21:24.944213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:12.378235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0A89490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0B85590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0B86090>]}


============================== 13:23:12.383233 | b3a773a6-9480-432e-9408-2068fad1acc8 ==============================
[0m13:23:12.383233 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:12.384233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:23:12.526560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3a773a6-9480-432e-9408-2068fad1acc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E0CCD250>]}
[0m13:23:12.552560 [debug] [MainThread]: Command `dbt clean` succeeded at 13:23:12.552560 after 0.24 seconds
[0m13:23:12.553561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E08BD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DAD29950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8DAD28DD0>]}
[0m13:23:12.553561 [debug] [MainThread]: Flushing usage events
[0m13:23:13.259854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:17.157954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF787C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF7DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF7D9F50>]}


============================== 13:23:17.160952 | af9cdb4b-0d2d-4e45-a39a-c91ee9ac7ff2 ==============================
[0m13:23:17.160952 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:17.161951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:17.173956 [info ] [MainThread]: dbt version: 1.9.2
[0m13:23:17.174954 [info ] [MainThread]: python version: 3.11.9
[0m13:23:17.174954 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:23:17.175954 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:23:17.243480 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:23:17.244480 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:23:17.245477 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:23:17.246481 [info ] [MainThread]: adapter type: postgres
[0m13:23:17.246481 [info ] [MainThread]: adapter version: 1.9.0
[0m13:23:17.319006 [info ] [MainThread]: Configuration:
[0m13:23:17.320042 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:23:17.321007 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:23:17.321007 [info ] [MainThread]: Required dependencies:
[0m13:23:17.322010 [debug] [MainThread]: Executing "git --help"
[0m13:23:17.375006 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:23:17.376006 [debug] [MainThread]: STDERR: "b''"
[0m13:23:17.377005 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:23:17.377005 [info ] [MainThread]: Connection:
[0m13:23:17.378005 [info ] [MainThread]:   host: 172.16.0.239
[0m13:23:17.378005 [info ] [MainThread]:   port: 5432
[0m13:23:17.379006 [info ] [MainThread]:   user: dmx-op-user
[0m13:23:17.379006 [info ] [MainThread]:   database: operacoes
[0m13:23:17.380005 [info ] [MainThread]:   schema: public
[0m13:23:17.380005 [info ] [MainThread]:   connect_timeout: 10
[0m13:23:17.381006 [info ] [MainThread]:   role: None
[0m13:23:17.381006 [info ] [MainThread]:   search_path: None
[0m13:23:17.382006 [info ] [MainThread]:   keepalives_idle: 0
[0m13:23:17.383007 [info ] [MainThread]:   sslmode: None
[0m13:23:17.383007 [info ] [MainThread]:   sslcert: None
[0m13:23:17.384005 [info ] [MainThread]:   sslkey: None
[0m13:23:17.384005 [info ] [MainThread]:   sslrootcert: None
[0m13:23:17.386006 [info ] [MainThread]:   application_name: dbt
[0m13:23:17.387009 [info ] [MainThread]:   retries: 1
[0m13:23:17.389010 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:17.591048 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:23:17.637544 [debug] [MainThread]: Using postgres connection "debug"
[0m13:23:17.638545 [debug] [MainThread]: On debug: select 1 as id
[0m13:23:17.638545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:17.731319 [debug] [MainThread]: SQL status: SELECT 1 in 0.092 seconds
[0m13:23:17.732306 [debug] [MainThread]: On debug: Close
[0m13:23:17.732306 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:23:17.733304 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:23:17.734304 [debug] [MainThread]: Command `dbt debug` succeeded at 13:23:17.734304 after 0.64 seconds
[0m13:23:17.735302 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:23:17.735302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF4C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF59F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AF794890>]}
[0m13:23:17.735302 [debug] [MainThread]: Flushing usage events
[0m13:23:18.373716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:21.339968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684D86FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684C89390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684DC8810>]}


============================== 13:23:21.343989 | 2ff0dedb-0071-4664-b16d-d6d5b6024ca6 ==============================
[0m13:23:21.343989 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:21.344966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:21.497485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684F5F190>]}
[0m13:23:21.538041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684FFD050>]}
[0m13:23:21.539024 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:21.717357 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:23:21.718401 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:23:21.719285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684DCA090>]}
[0m13:23:22.492054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002768498E550>]}
[0m13:23:22.539107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:23:22.543109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:23:22.563109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027686255090>]}
[0m13:23:22.564140 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m13:23:22.564140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027686218190>]}
[0m13:23:22.566126 [info ] [MainThread]: 
[0m13:23:22.567107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:22.567107 [info ] [MainThread]: 
[0m13:23:22.568109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:23:22.572109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:23:22.629644 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:23:22.630644 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:23:22.630644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:22.679865 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m13:23:22.680865 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:23:22.683005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:23:22.688969 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:23:22.688969 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:23:22.689970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:23.139264 [debug] [ThreadPool]: SQL status: BEGIN in 0.450 seconds
[0m13:23:23.140265 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:23:23.140265 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:23:23.148264 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m13:23:23.149265 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:23:23.153264 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:23:23.157265 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.158282 [debug] [MainThread]: On master: BEGIN
[0m13:23:23.158282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:23.186743 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m13:23:23.186743 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.187742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:23:23.195742 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m13:23:23.197743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276862C2790>]}
[0m13:23:23.198743 [debug] [MainThread]: On master: ROLLBACK
[0m13:23:23.202775 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.202775 [debug] [MainThread]: On master: BEGIN
[0m13:23:23.209774 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:23:23.210776 [debug] [MainThread]: On master: COMMIT
[0m13:23:23.210776 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.210776 [debug] [MainThread]: On master: COMMIT
[0m13:23:23.214774 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:23:23.214774 [debug] [MainThread]: On master: Close
[0m13:23:23.218284 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:23.219284 [debug] [Thread-2 (]: Began running node model.my_dbt_project.f_operacoes_view
[0m13:23:23.219284 [debug] [Thread-3 (]: Began running node model.my_dbt_project.sacados
[0m13:23:23.220285 [debug] [Thread-4 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:23:23.220285 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:23:23.221285 [info ] [Thread-2 (]: 2 of 4 START sql view model public.f_operacoes_view ............................ [RUN]
[0m13:23:23.222286 [info ] [Thread-3 (]: 3 of 4 START sql view model public.sacados ..................................... [RUN]
[0m13:23:23.222286 [info ] [Thread-4 (]: 4 of 4 START sql view model public.titulosaberto ............................... [RUN]
[0m13:23:23.223284 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:23:23.223284 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.f_operacoes_view'
[0m13:23:23.224284 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m13:23:23.224284 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:23:23.225284 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:23.225284 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.f_operacoes_view
[0m13:23:23.226284 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.sacados
[0m13:23:23.226284 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:23:23.232286 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.235284 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.f_operacoes_view"
[0m13:23:23.237284 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m13:23:23.240283 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:23:23.243290 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.sacados
[0m13:23:23.244285 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:23.245284 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:23:23.275284 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.sacados"
[0m13:23:23.275284 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.f_operacoes_view
[0m13:23:23.280286 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.285289 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:23:23.289285 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.f_operacoes_view"
[0m13:23:23.291284 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.292286 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:23:23.292286 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.293285 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes_view"
[0m13:23:23.294285 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.294285 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:23.295284 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: BEGIN
[0m13:23:23.295284 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes_view: BEGIN
[0m13:23:23.296285 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:23:23.296285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:23.297286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:23.297286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:23.353404 [debug] [Thread-4 (]: SQL status: BEGIN in 0.059 seconds
[0m13:23:23.354403 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m13:23:23.354403 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.355404 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.356404 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m13:23:23.356404 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */

  create view "operacoes"."public"."sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m13:23:23.365403 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:23:23.370403 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.370403 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados" rename to "sacados__dbt_backup"
[0m13:23:23.371404 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:23:23.374404 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.375404 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:23:23.375404 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m13:23:23.376404 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:23:23.376404 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes_view"
[0m13:23:23.378404 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.379404 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:23:23.379404 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes_view"} */

  create view "operacoes"."public"."f_operacoes_view__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m13:23:23.380406 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados__dbt_tmp" rename to "sacados"
[0m13:23:23.382405 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.383404 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:23:23.387405 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:23:23.387405 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:23:23.388404 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.f_operacoes" does not exist
LINE 27: FROM "operacoes"."public"."f_operacoes"
              ^

[0m13:23:23.400406 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:23:23.401405 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:23:23.402410 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes_view: ROLLBACK
[0m13:23:23.403410 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.403410 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.404411 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:23:23.404411 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:23:23.407410 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes_view: Close
[0m13:23:23.427455 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m13:23:23.433454 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."sacados__dbt_backup"
[0m13:23:23.437453 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:23.437453 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m13:23:23.438454 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
drop view if exists "operacoes"."public"."sacados__dbt_backup" cascade
[0m13:23:23.441454 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:23:23.442454 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:23.442454 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:23:23.459453 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m13:23:23.461457 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: Close
[0m13:23:23.463481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027686873250>]}
[0m13:23:23.464455 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.sacados ................................ [[32mCREATE VIEW[0m in 0.24s]
[0m13:23:23.465453 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.sacados
[0m13:23:23.473453 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.030 seconds
[0m13:23:23.474453 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:23:23.475453 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027686869A10>]}
[0m13:23:23.476454 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m13:23:23.477455 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:23:23.492453 [debug] [Thread-2 (]: Database Error in model f_operacoes_view (models\f_operacoes_view.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes_view.sql
[0m13:23:23.493454 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002768696B010>]}
[0m13:23:23.495455 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.f_operacoes_view ................... [[31mERROR[0m in 0.27s]
[0m13:23:23.496458 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.f_operacoes_view
[0m13:23:23.497455 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.f_operacoes_view' to be skipped because of status 'error'.  Reason: Database Error in model f_operacoes_view (models\f_operacoes_view.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes_view.sql.
[0m13:23:23.536984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m13:23:23.537984 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.537984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:23:23.543984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:23:23.546982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.546982 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:23:23.550982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:23:23.552982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.553981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:23:23.558981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:23:23.561981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:23:23.561981 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.562983 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:23:23.581982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m13:23:23.583984 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:23:23.584984 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:23.585984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:23:23.604984 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m13:23:23.606985 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:23:23.606985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ff0dedb-0071-4664-b16d-d6d5b6024ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027686A76550>]}
[0m13:23:23.607985 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.38s]
[0m13:23:23.608985 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:23.610985 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.610985 [debug] [MainThread]: On master: BEGIN
[0m13:23:23.610985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:23.658552 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m13:23:23.658552 [debug] [MainThread]: On master: COMMIT
[0m13:23:23.659538 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:23.659538 [debug] [MainThread]: On master: COMMIT
[0m13:23:23.663537 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:23:23.663537 [debug] [MainThread]: On master: Close
[0m13:23:23.663537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:23.664556 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:23:23.664556 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:23:23.664556 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:23:23.665537 [debug] [MainThread]: Connection 'model.my_dbt_project.f_operacoes_view' was properly closed.
[0m13:23:23.665537 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m13:23:23.665537 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:23:23.666536 [info ] [MainThread]: 
[0m13:23:23.666536 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m13:23:23.668555 [debug] [MainThread]: Command end result
[0m13:23:23.683669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:23:23.686666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:23:23.691665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:23:23.691665 [info ] [MainThread]: 
[0m13:23:23.692666 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:23:23.693668 [info ] [MainThread]: 
[0m13:23:23.695669 [error] [MainThread]:   Database Error in model f_operacoes_view (models\f_operacoes_view.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes_view.sql
[0m13:23:23.696668 [info ] [MainThread]: 
[0m13:23:23.697668 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:23:23.698668 [debug] [MainThread]: Command `dbt run` failed at 13:23:23.698668 after 2.41 seconds
[0m13:23:23.698668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027680029950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684DE6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027684DE6410>]}
[0m13:23:23.699669 [debug] [MainThread]: Flushing usage events
[0m13:23:24.334960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:45.146740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7689550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D759FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D77D9490>]}


============================== 13:23:45.149805 | 0c8d62dc-f8eb-411a-89e3-ee77def6e765 ==============================
[0m13:23:45.149805 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:45.150750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:45.161705 [info ] [MainThread]: dbt version: 1.9.2
[0m13:23:45.162705 [info ] [MainThread]: python version: 3.11.9
[0m13:23:45.163705 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:23:45.164705 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:23:45.226218 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:23:45.227235 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:23:45.228220 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:23:45.229219 [info ] [MainThread]: adapter type: postgres
[0m13:23:45.230219 [info ] [MainThread]: adapter version: 1.9.0
[0m13:23:45.306280 [info ] [MainThread]: Configuration:
[0m13:23:45.307281 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:23:45.308265 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:23:45.309264 [info ] [MainThread]: Required dependencies:
[0m13:23:45.309264 [debug] [MainThread]: Executing "git --help"
[0m13:23:45.360295 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:23:45.360295 [debug] [MainThread]: STDERR: "b''"
[0m13:23:45.361271 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:23:45.362269 [info ] [MainThread]: Connection:
[0m13:23:45.362269 [info ] [MainThread]:   host: 172.16.0.239
[0m13:23:45.362269 [info ] [MainThread]:   port: 5432
[0m13:23:45.364268 [info ] [MainThread]:   user: dmx-op-user
[0m13:23:45.364268 [info ] [MainThread]:   database: operacoes
[0m13:23:45.365271 [info ] [MainThread]:   schema: public
[0m13:23:45.366268 [info ] [MainThread]:   connect_timeout: 10
[0m13:23:45.366268 [info ] [MainThread]:   role: None
[0m13:23:45.367305 [info ] [MainThread]:   search_path: None
[0m13:23:45.368271 [info ] [MainThread]:   keepalives_idle: 0
[0m13:23:45.368271 [info ] [MainThread]:   sslmode: None
[0m13:23:45.368271 [info ] [MainThread]:   sslcert: None
[0m13:23:45.369474 [info ] [MainThread]:   sslkey: None
[0m13:23:45.369474 [info ] [MainThread]:   sslrootcert: None
[0m13:23:45.370473 [info ] [MainThread]:   application_name: dbt
[0m13:23:45.370473 [info ] [MainThread]:   retries: 1
[0m13:23:45.371472 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:45.563033 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:23:45.603539 [debug] [MainThread]: Using postgres connection "debug"
[0m13:23:45.603539 [debug] [MainThread]: On debug: select 1 as id
[0m13:23:45.604522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:45.820353 [debug] [MainThread]: SQL status: SELECT 1 in 0.216 seconds
[0m13:23:45.821353 [debug] [MainThread]: On debug: Close
[0m13:23:45.822352 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:23:45.822352 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:23:45.823337 [debug] [MainThread]: Command `dbt debug` succeeded at 13:23:45.823337 after 0.75 seconds
[0m13:23:45.824368 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:23:45.824368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D75B0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D79D49D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D1941C10>]}
[0m13:23:45.825347 [debug] [MainThread]: Flushing usage events
[0m13:23:46.499829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:49.484908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5A91F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5ADBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5ADBDD0>]}


============================== 13:23:49.487893 | cf12a661-7e89-4eb3-ae93-aa963315b1db ==============================
[0m13:23:49.487893 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:49.488896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:23:49.634422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5BF3190>]}
[0m13:23:49.674866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE0B59A10>]}
[0m13:23:49.675874 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:49.852517 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:23:49.955193 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:23:49.956202 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\f_operacoes.sql
[0m13:23:49.956202 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\f_operacoes_view.sql
[0m13:23:50.125728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE6011010>]}
[0m13:23:50.169874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:23:50.173774 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:23:50.188258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE621B350>]}
[0m13:23:50.189257 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m13:23:50.190258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE61E0BD0>]}
[0m13:23:50.191259 [info ] [MainThread]: 
[0m13:23:50.192256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:50.193319 [info ] [MainThread]: 
[0m13:23:50.194259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:23:50.198258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:23:50.253256 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:23:50.254256 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:23:50.254256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:50.302149 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m13:23:50.303149 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:23:50.305150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:23:50.309151 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:23:50.309151 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:23:50.309151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:50.422480 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m13:23:50.423467 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:23:50.423467 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:23:50.430572 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m13:23:50.432465 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:23:50.440506 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:23:50.445562 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:50.445562 [debug] [MainThread]: On master: BEGIN
[0m13:23:50.446467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:50.622210 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m13:23:50.623211 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:50.623211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:23:50.631209 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m13:23:50.633210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE667B310>]}
[0m13:23:50.633210 [debug] [MainThread]: On master: ROLLBACK
[0m13:23:50.637273 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:50.637273 [debug] [MainThread]: On master: BEGIN
[0m13:23:50.643876 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:23:50.644860 [debug] [MainThread]: On master: COMMIT
[0m13:23:50.644860 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:50.644860 [debug] [MainThread]: On master: COMMIT
[0m13:23:50.648857 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:23:50.648857 [debug] [MainThread]: On master: Close
[0m13:23:50.650859 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:50.651860 [debug] [Thread-2 (]: Began running node model.my_dbt_project.f_operacoes
[0m13:23:50.651860 [debug] [Thread-3 (]: Began running node model.my_dbt_project.sacados
[0m13:23:50.651860 [debug] [Thread-4 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:23:50.652859 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:23:50.652859 [info ] [Thread-2 (]: 2 of 4 START sql view model public.f_operacoes ................................. [RUN]
[0m13:23:50.653859 [info ] [Thread-3 (]: 3 of 4 START sql view model public.sacados ..................................... [RUN]
[0m13:23:50.654860 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:23:50.654860 [info ] [Thread-4 (]: 4 of 4 START sql view model public.titulosaberto ............................... [RUN]
[0m13:23:50.655860 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.f_operacoes'
[0m13:23:50.655860 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m13:23:50.656857 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:50.656857 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:23:50.657885 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.f_operacoes
[0m13:23:50.657885 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.sacados
[0m13:23:50.663864 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:50.663864 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:23:50.666863 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.f_operacoes"
[0m13:23:50.670865 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m13:23:50.675865 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:23:50.675865 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:50.694944 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.f_operacoes
[0m13:23:50.700924 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:50.702132 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.sacados
[0m13:23:50.704151 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.f_operacoes"
[0m13:23:50.705246 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:23:50.708150 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.sacados"
[0m13:23:50.708734 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:50.710841 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:23:50.711790 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:23:50.711790 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:23:50.712749 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:50.713748 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: BEGIN
[0m13:23:50.713748 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:50.713748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:50.714748 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: BEGIN
[0m13:23:50.714748 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:50.715787 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:23:50.715787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:50.716750 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:50.844859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.130 seconds
[0m13:23:50.845858 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:50.847861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:23:50.852609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.135 seconds
[0m13:23:50.853609 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:50.854604 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m13:23:50.855607 [debug] [Thread-2 (]: SQL status: BEGIN in 0.140 seconds
[0m13:23:50.856668 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:23:50.857658 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:23:50.863818 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:50.864721 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */

  create view "operacoes"."public"."f_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m13:23:50.865721 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:23:51.076052 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.218 seconds
[0m13:23:51.077147 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.f_operacoes" does not exist
LINE 27: FROM "operacoes"."public"."f_operacoes"
              ^

[0m13:23:51.078149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.212 seconds
[0m13:23:51.084672 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:51.085674 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: ROLLBACK
[0m13:23:51.090684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:51.091686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.375 seconds
[0m13:23:51.092674 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:23:51.093675 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:23:51.094674 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:51.096672 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */

  create view "operacoes"."public"."sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m13:23:51.097695 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: Close
[0m13:23:51.104670 [debug] [Thread-2 (]: Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql
[0m13:23:51.107791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE65FE110>]}
[0m13:23:51.108672 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.f_operacoes ........................ [[31mERROR[0m in 0.45s]
[0m13:23:51.109672 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.f_operacoes
[0m13:23:51.110671 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.f_operacoes' to be skipped because of status 'error'.  Reason: Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql.
[0m13:23:51.133889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m13:23:51.135889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m13:23:51.136893 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m13:23:51.141886 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:51.155886 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:23:51.198519 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:51.199518 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:23:51.199518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:51.200517 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados" rename to "sacados__dbt_backup"
[0m13:23:51.200517 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:23:51.206519 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:23:51.206519 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:23:51.207623 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:23:51.209620 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:51.210617 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:51.210617 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados__dbt_tmp" rename to "sacados"
[0m13:23:51.211635 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:23:51.219837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m13:23:51.224853 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:23:51.224853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:23:51.228852 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:23:51.229885 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:23:51.230852 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:23:51.230852 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:51.231852 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:23:51.233628 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m13:23:51.235750 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:23:51.235750 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:23:51.236747 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:23:51.250656 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m13:23:51.254649 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."sacados__dbt_backup"
[0m13:23:51.255650 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:23:51.256767 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
drop view if exists "operacoes"."public"."sacados__dbt_backup" cascade
[0m13:23:51.264666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m13:23:51.265684 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.029 seconds
[0m13:23:51.269677 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:23:51.271783 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:23:51.272745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE6227E10>]}
[0m13:23:51.273681 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5F66210>]}
[0m13:23:51.274678 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.62s]
[0m13:23:51.276677 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:23:51.276677 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.62s]
[0m13:23:51.277721 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:23:51.284209 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.027 seconds
[0m13:23:51.286322 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: Close
[0m13:23:51.287220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf12a661-7e89-4eb3-ae93-aa963315b1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE6780150>]}
[0m13:23:51.288220 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.sacados ................................ [[32mCREATE VIEW[0m in 0.63s]
[0m13:23:51.289220 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.sacados
[0m13:23:51.292266 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:51.292266 [debug] [MainThread]: On master: BEGIN
[0m13:23:51.293220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:51.373716 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m13:23:51.373716 [debug] [MainThread]: On master: COMMIT
[0m13:23:51.373716 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:51.374694 [debug] [MainThread]: On master: COMMIT
[0m13:23:51.378714 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:23:51.379222 [debug] [MainThread]: On master: Close
[0m13:23:51.379222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:51.380228 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:23:51.380228 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:23:51.380228 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:23:51.380228 [debug] [MainThread]: Connection 'model.my_dbt_project.f_operacoes' was properly closed.
[0m13:23:51.381228 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m13:23:51.381228 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:23:51.381228 [info ] [MainThread]: 
[0m13:23:51.382228 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m13:23:51.383228 [debug] [MainThread]: Command end result
[0m13:23:51.399229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:23:51.401261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:23:51.405292 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:23:51.405292 [info ] [MainThread]: 
[0m13:23:51.406229 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:23:51.407228 [info ] [MainThread]: 
[0m13:23:51.408228 [error] [MainThread]:   Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql
[0m13:23:51.409227 [info ] [MainThread]: 
[0m13:23:51.409227 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:23:51.415836 [debug] [MainThread]: Command `dbt run` failed at 13:23:51.415836 after 1.99 seconds
[0m13:23:51.416835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDFCB9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DE5604790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DDFD31C10>]}
[0m13:23:51.416835 [debug] [MainThread]: Flushing usage events
[0m13:23:52.098113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:44.885861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BDBE5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BDBE5A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BDBE7FD0>]}


============================== 13:26:44.890826 | 937edc98-622c-43ad-975f-c801da6e1482 ==============================
[0m13:26:44.890826 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:44.891824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:45.048011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '937edc98-622c-43ad-975f-c801da6e1482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BDCDBC10>]}
[0m13:26:45.078014 [debug] [MainThread]: Command `dbt clean` succeeded at 13:26:45.078014 after 0.26 seconds
[0m13:26:45.078014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B8E49950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B8E48DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B8EC1C10>]}
[0m13:26:45.079052 [debug] [MainThread]: Flushing usage events
[0m13:26:46.211002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:50.687362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E38E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E087ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E087E90>]}


============================== 13:26:50.691365 | 17f4fd80-abcc-4acc-a526-525dc01274d3 ==============================
[0m13:26:50.691365 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:50.692363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:50.703878 [info ] [MainThread]: dbt version: 1.9.2
[0m13:26:50.704881 [info ] [MainThread]: python version: 3.11.9
[0m13:26:50.706881 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m13:26:50.707878 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:26:50.782895 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m13:26:50.783877 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m13:26:50.784884 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m13:26:50.785884 [info ] [MainThread]: adapter type: postgres
[0m13:26:50.786883 [info ] [MainThread]: adapter version: 1.9.0
[0m13:26:50.851472 [info ] [MainThread]: Configuration:
[0m13:26:50.852459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:26:50.853414 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:26:50.853414 [info ] [MainThread]: Required dependencies:
[0m13:26:50.854415 [debug] [MainThread]: Executing "git --help"
[0m13:26:50.900933 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:26:50.901936 [debug] [MainThread]: STDERR: "b''"
[0m13:26:50.901936 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:26:50.902935 [info ] [MainThread]: Connection:
[0m13:26:50.902935 [info ] [MainThread]:   host: 172.16.0.239
[0m13:26:50.903934 [info ] [MainThread]:   port: 5432
[0m13:26:50.903934 [info ] [MainThread]:   user: dmx-op-user
[0m13:26:50.904934 [info ] [MainThread]:   database: operacoes
[0m13:26:50.904934 [info ] [MainThread]:   schema: public
[0m13:26:50.905935 [info ] [MainThread]:   connect_timeout: 10
[0m13:26:50.905935 [info ] [MainThread]:   role: None
[0m13:26:50.905935 [info ] [MainThread]:   search_path: None
[0m13:26:50.906934 [info ] [MainThread]:   keepalives_idle: 0
[0m13:26:50.906934 [info ] [MainThread]:   sslmode: None
[0m13:26:50.907934 [info ] [MainThread]:   sslcert: None
[0m13:26:50.907934 [info ] [MainThread]:   sslkey: None
[0m13:26:50.908935 [info ] [MainThread]:   sslrootcert: None
[0m13:26:50.908935 [info ] [MainThread]:   application_name: dbt
[0m13:26:50.909935 [info ] [MainThread]:   retries: 1
[0m13:26:50.909935 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:51.174568 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:26:51.235118 [debug] [MainThread]: Using postgres connection "debug"
[0m13:26:51.236135 [debug] [MainThread]: On debug: select 1 as id
[0m13:26:51.236135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:51.284070 [debug] [MainThread]: SQL status: SELECT 1 in 0.048 seconds
[0m13:26:51.285076 [debug] [MainThread]: On debug: Close
[0m13:26:51.285076 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:26:51.286073 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:26:51.287074 [debug] [MainThread]: Command `dbt debug` succeeded at 13:26:51.287074 after 0.69 seconds
[0m13:26:51.288073 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:26:51.288073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E3DBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E3DA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4E3DA490>]}
[0m13:26:51.288073 [debug] [MainThread]: Flushing usage events
[0m13:26:52.041451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:55.686920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB068E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB06C8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB06C85D0>]}


============================== 13:26:55.689937 | de1e23f2-8564-4b18-8415-d8a01f9ed919 ==============================
[0m13:26:55.689937 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:55.690919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:55.837970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0860FD0>]}
[0m13:26:55.876059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB799C10>]}
[0m13:26:55.877054 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:56.059079 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:26:56.060079 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:26:56.061075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0893A90>]}
[0m13:26:56.770056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB885950>]}
[0m13:26:56.814639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:26:56.818653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:26:56.838586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0AF4250>]}
[0m13:26:56.838586 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m13:26:56.839587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0E35FD0>]}
[0m13:26:56.840588 [info ] [MainThread]: 
[0m13:26:56.841589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:56.841589 [info ] [MainThread]: 
[0m13:26:56.842587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:26:56.847586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:26:56.901587 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:26:56.902587 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:26:56.902587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:56.962758 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m13:26:56.966858 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:26:56.969775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:26:56.979751 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:26:56.980754 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:26:56.980754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:57.107363 [debug] [ThreadPool]: SQL status: BEGIN in 0.126 seconds
[0m13:26:57.110508 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:26:57.112516 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:26:57.120624 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m13:26:57.121522 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:26:57.125934 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:26:57.132407 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.133493 [debug] [MainThread]: On master: BEGIN
[0m13:26:57.133493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:57.193281 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m13:26:57.194263 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.196165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:26:57.206591 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m13:26:57.211687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0CE4810>]}
[0m13:26:57.212683 [debug] [MainThread]: On master: ROLLBACK
[0m13:26:57.217394 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.218413 [debug] [MainThread]: On master: BEGIN
[0m13:26:57.225203 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:26:57.227053 [debug] [MainThread]: On master: COMMIT
[0m13:26:57.227053 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.228567 [debug] [MainThread]: On master: COMMIT
[0m13:26:57.232669 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:26:57.233585 [debug] [MainThread]: On master: Close
[0m13:26:57.240617 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:26:57.240617 [debug] [Thread-2 (]: Began running node model.my_dbt_project.f_operacoes
[0m13:26:57.241618 [debug] [Thread-3 (]: Began running node model.my_dbt_project.sacados
[0m13:26:57.242369 [debug] [Thread-4 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:26:57.242369 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m13:26:57.243780 [info ] [Thread-2 (]: 2 of 4 START sql view model public.f_operacoes ................................. [RUN]
[0m13:26:57.243780 [info ] [Thread-3 (]: 3 of 4 START sql view model public.sacados ..................................... [RUN]
[0m13:26:57.245788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:26:57.244789 [info ] [Thread-4 (]: 4 of 4 START sql view model public.titulosaberto ............................... [RUN]
[0m13:26:57.246788 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.f_operacoes'
[0m13:26:57.246788 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m13:26:57.247789 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:26:57.247789 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:26:57.248786 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.f_operacoes
[0m13:26:57.248786 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.sacados
[0m13:26:57.255893 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.256858 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:26:57.259889 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.f_operacoes"
[0m13:26:57.261894 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m13:26:57.266145 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:26:57.268888 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:26:57.269894 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.f_operacoes
[0m13:26:57.280909 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:26:57.294892 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.295911 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.sacados
[0m13:26:57.300911 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.f_operacoes"
[0m13:26:57.304893 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.titulosaberto"
[0m13:26:57.307893 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.sacados"
[0m13:26:57.309923 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.309923 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.309923 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m13:26:57.310929 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.310929 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:26:57.311929 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: BEGIN
[0m13:26:57.311929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:57.312929 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: BEGIN
[0m13:26:57.312929 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: BEGIN
[0m13:26:57.312929 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:26:57.313933 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:57.313933 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:26:57.440481 [debug] [Thread-4 (]: SQL status: BEGIN in 0.127 seconds
[0m13:26:57.440481 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.441483 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */

  create view "operacoes"."public"."titulosaberto__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m13:26:57.443481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m13:26:57.443481 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.444482 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m13:26:57.450729 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:26:57.450729 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:26:57.455733 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.458734 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.458734 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto" rename to "titulosaberto__dbt_backup"
[0m13:26:57.459733 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m13:26:57.461894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:26:57.462894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.148 seconds
[0m13:26:57.462894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:26:57.464894 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.465894 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.f_operacoes"
[0m13:26:57.467895 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.467895 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m13:26:57.468896 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.f_operacoes"} */

  create view "operacoes"."public"."f_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m13:26:57.468896 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
alter table "operacoes"."public"."titulosaberto__dbt_tmp" rename to "titulosaberto"
[0m13:26:57.475895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:26:57.475895 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:26:57.475895 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.f_operacoes" does not exist
LINE 27: FROM "operacoes"."public"."f_operacoes"
              ^

[0m13:26:57.487893 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:26:57.488896 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:26:57.488896 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: ROLLBACK
[0m13:26:57.489894 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.490254 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.491081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m13:26:57.491081 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: COMMIT
[0m13:26:57.493410 [debug] [Thread-2 (]: On model.my_dbt_project.f_operacoes: Close
[0m13:26:57.500408 [debug] [Thread-2 (]: Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql
[0m13:26:57.502390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0BE1DD0>]}
[0m13:26:57.502390 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.f_operacoes ........................ [[31mERROR[0m in 0.25s]
[0m13:26:57.503389 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.f_operacoes
[0m13:26:57.504391 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.f_operacoes' to be skipped because of status 'error'.  Reason: Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql.
[0m13:26:57.511830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m13:26:57.516835 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m13:26:57.519835 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m13:26:57.520836 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m13:26:57.523836 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m13:26:57.526837 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."titulosaberto__dbt_backup"
[0m13:26:57.527837 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.titulosaberto"
[0m13:26:57.527837 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.titulosaberto"} */
drop view if exists "operacoes"."public"."titulosaberto__dbt_backup" cascade
[0m13:26:57.535128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.014 seconds
[0m13:26:57.537128 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m13:26:57.538127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB0BA1710>]}
[0m13:26:57.539127 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m13:26:57.539127 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:26:57.545127 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m13:26:57.547130 [debug] [Thread-4 (]: On model.my_dbt_project.titulosaberto: Close
[0m13:26:57.548132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB2379490>]}
[0m13:26:57.548132 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.titulosaberto .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m13:26:57.550131 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:26:57.555128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.241 seconds
[0m13:26:57.556129 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.557128 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */

  create view "operacoes"."public"."sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m13:26:57.563128 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:26:57.567127 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.568127 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados" rename to "sacados__dbt_backup"
[0m13:26:57.580280 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:26:57.585279 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.585279 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
alter table "operacoes"."public"."sacados__dbt_tmp" rename to "sacados"
[0m13:26:57.589278 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:26:57.591279 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:26:57.591279 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.591279 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: COMMIT
[0m13:26:57.613752 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m13:26:57.616758 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."sacados__dbt_backup"
[0m13:26:57.616758 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.sacados"
[0m13:26:57.617758 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sacados"} */
drop view if exists "operacoes"."public"."sacados__dbt_backup" cascade
[0m13:26:57.649492 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.031 seconds
[0m13:26:57.650469 [debug] [Thread-3 (]: On model.my_dbt_project.sacados: Close
[0m13:26:57.651469 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e23f2-8564-4b18-8415-d8a01f9ed919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB2404F10>]}
[0m13:26:57.651469 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.sacados ................................ [[32mCREATE VIEW[0m in 0.40s]
[0m13:26:57.652469 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.sacados
[0m13:26:57.654468 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.654468 [debug] [MainThread]: On master: BEGIN
[0m13:26:57.654468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:57.714251 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m13:26:57.714251 [debug] [MainThread]: On master: COMMIT
[0m13:26:57.715254 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:57.715254 [debug] [MainThread]: On master: COMMIT
[0m13:26:57.718807 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:26:57.718807 [debug] [MainThread]: On master: Close
[0m13:26:57.718807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:57.719896 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:26:57.719896 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:26:57.719896 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:26:57.720864 [debug] [MainThread]: Connection 'model.my_dbt_project.f_operacoes' was properly closed.
[0m13:26:57.720864 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m13:26:57.720864 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:26:57.721863 [info ] [MainThread]: 
[0m13:26:57.721863 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m13:26:57.722863 [debug] [MainThread]: Command end result
[0m13:26:57.739380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:26:57.741406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:26:57.746399 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:26:57.747381 [info ] [MainThread]: 
[0m13:26:57.748378 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:26:57.748378 [info ] [MainThread]: 
[0m13:26:57.749380 [error] [MainThread]:   Database Error in model f_operacoes (models\f_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\f_operacoes.sql
[0m13:26:57.749380 [info ] [MainThread]: 
[0m13:26:57.750381 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:26:57.751381 [debug] [MainThread]: Command `dbt run` failed at 13:26:57.751381 after 2.12 seconds
[0m13:26:57.752379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAA8C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB06D9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAA941C10>]}
[0m13:26:57.752379 [debug] [MainThread]: Flushing usage events
[0m13:26:58.380792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:48.983394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB28E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB2C8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB28E7D0>]}


============================== 13:29:48.988393 | 8d91364e-7eeb-402d-8cdc-e811412bf50f ==============================
[0m13:29:48.988393 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:29:48.989392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:49.199506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB4B8650>]}
[0m13:29:49.238615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC7409750>]}
[0m13:29:49.240617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:29:49.463552 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:29:49.592974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:49.592974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:49.614974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB2F6210>]}
[0m13:29:49.660245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:29:49.664052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:29:49.689628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB954590>]}
[0m13:29:49.689628 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m13:29:49.690629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB8D5A10>]}
[0m13:29:49.692645 [info ] [MainThread]: 
[0m13:29:49.692645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:49.693628 [info ] [MainThread]: 
[0m13:29:49.693628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:49.698628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:29:49.757651 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:29:49.757651 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:29:49.758663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:49.942619 [debug] [ThreadPool]: SQL status: BEGIN in 0.184 seconds
[0m13:29:49.943634 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:29:49.944618 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:29:49.952159 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m13:29:49.955157 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:29:49.983294 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:29:49.994387 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:49.994387 [debug] [MainThread]: On master: BEGIN
[0m13:29:49.995384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:50.127997 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m13:29:50.129000 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:50.129000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:50.158096 [debug] [MainThread]: SQL status: SELECT 5 in 0.028 seconds
[0m13:29:50.161141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d91364e-7eeb-402d-8cdc-e811412bf50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB6F3610>]}
[0m13:29:50.161141 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:50.192542 [debug] [MainThread]: On master: Close
[0m13:29:50.198542 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m13:29:50.198542 [debug] [Thread-2 (]: Began running node model.my_dbt_project.f_operacoes
[0m13:29:50.199543 [debug] [Thread-3 (]: Began running node model.my_dbt_project.sacados
[0m13:29:50.199543 [debug] [Thread-4 (]: Began running node model.my_dbt_project.titulosaberto
[0m13:29:50.200543 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m13:29:50.200543 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.f_operacoes'
[0m13:29:50.201542 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.sacados'
[0m13:29:50.201542 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.titulosaberto'
[0m13:29:50.202542 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m13:29:50.202542 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.f_operacoes
[0m13:29:50.202542 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.sacados
[0m13:29:50.203543 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.titulosaberto
[0m13:29:50.208541 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m13:29:50.212544 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.f_operacoes"
[0m13:29:50.215542 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.sacados"
[0m13:29:50.218541 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.titulosaberto"
[0m13:29:50.219541 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m13:29:50.220556 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.f_operacoes
[0m13:29:50.221543 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m13:29:50.221543 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.sacados
[0m13:29:50.222543 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.titulosaberto
[0m13:29:50.222543 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.f_operacoes
[0m13:29:50.223542 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.sacados
[0m13:29:50.224543 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.titulosaberto
[0m13:29:50.226542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:50.226542 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:29:50.227543 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m13:29:50.227543 [debug] [MainThread]: Connection 'model.my_dbt_project.f_operacoes' was properly closed.
[0m13:29:50.227543 [debug] [MainThread]: Connection 'model.my_dbt_project.sacados' was properly closed.
[0m13:29:50.228542 [debug] [MainThread]: Connection 'model.my_dbt_project.titulosaberto' was properly closed.
[0m13:29:50.229542 [debug] [MainThread]: Command end result
[0m13:29:50.243541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:29:50.245541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:29:50.249541 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:29:50.250541 [debug] [MainThread]: Command `dbt compile` succeeded at 13:29:50.250541 after 1.33 seconds
[0m13:29:50.251541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC55D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC5559950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC5558D50>]}
[0m13:29:50.251541 [debug] [MainThread]: Flushing usage events
[0m13:29:51.466354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:15.534793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22A85890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22AD9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22ADBB50>]}


============================== 14:33:15.540840 | 9563080a-5eba-48c2-bb69-968185413661 ==============================
[0m14:33:15.540840 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:33:15.541795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:15.710258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9563080a-5eba-48c2-bb69-968185413661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22B07C10>]}
[0m14:33:15.740215 [debug] [MainThread]: Command `dbt clean` succeeded at 14:33:15.740215 after 0.28 seconds
[0m14:33:15.741215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C227C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22AD9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C22ADB850>]}
[0m14:33:15.742216 [debug] [MainThread]: Flushing usage events
[0m14:33:17.199134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:15.622955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014924787F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001492468D290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014924787A90>]}


============================== 14:50:15.627971 | 60e8ec35-cf1f-45c2-a19e-a0121787077b ==============================
[0m14:50:15.627971 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:50:15.628973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:15.851761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014924958FD0>]}
[0m14:50:15.892286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001491F869890>]}
[0m14:50:15.894290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:50:16.079402 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:50:16.080408 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:16.081412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149248F3B90>]}
[0m14:50:16.788613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014924E34490>]}
[0m14:50:16.831719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:50:16.835769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:50:16.868600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149249EAFD0>]}
[0m14:50:16.868600 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m14:50:16.869619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001491FA10810>]}
[0m14:50:16.870600 [info ] [MainThread]: 
[0m14:50:16.871616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:16.871616 [info ] [MainThread]: 
[0m14:50:16.872600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:16.875617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:50:16.975100 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:50:16.976102 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:50:16.976102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:17.021881 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m14:50:17.022884 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:50:17.024881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:50:17.029979 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:50:17.029979 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:50:17.029979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:17.087934 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m14:50:17.087934 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:50:17.088932 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:17.094933 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.006 seconds
[0m14:50:17.096939 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:50:17.099933 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:50:17.104935 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.104935 [debug] [MainThread]: On master: BEGIN
[0m14:50:17.104935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:17.149932 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m14:50:17.150933 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.150933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:17.158932 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m14:50:17.160932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014924ECA690>]}
[0m14:50:17.160932 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:17.164935 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.164935 [debug] [MainThread]: On master: BEGIN
[0m14:50:17.171936 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:50:17.171936 [debug] [MainThread]: On master: COMMIT
[0m14:50:17.172936 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.172936 [debug] [MainThread]: On master: COMMIT
[0m14:50:17.178973 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:50:17.178973 [debug] [MainThread]: On master: Close
[0m14:50:17.181972 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m14:50:17.181972 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m14:50:17.181972 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m14:50:17.182975 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m14:50:17.182975 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m14:50:17.183977 [info ] [Thread-2 (]: 2 of 4 START sql view model public.dim_sacados ................................. [RUN]
[0m14:50:17.183977 [info ] [Thread-3 (]: 3 of 4 START sql view model public.fato_operacoes .............................. [RUN]
[0m14:50:17.184974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m14:50:17.184974 [info ] [Thread-4 (]: 4 of 4 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m14:50:17.185974 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m14:50:17.185974 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m14:50:17.186973 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m14:50:17.186973 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_titulosabertos'
[0m14:50:17.186973 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m14:50:17.187975 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m14:50:17.192972 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.193972 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m14:50:17.195973 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m14:50:17.197975 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m14:50:17.200973 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.201974 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m14:50:17.201974 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m14:50:17.227974 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.227974 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m14:50:17.232973 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m14:50:17.232973 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m14:50:17.235973 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.238973 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m14:50:17.239981 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.240981 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.241980 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m14:50:17.241980 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:50:17.242977 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:50:17.242977 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m14:50:17.242977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:17.243977 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m14:50:17.243977 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m14:50:17.244977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:17.244977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:17.245978 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:17.298041 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m14:50:17.299052 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:50:17.300050 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m14:50:17.308048 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.f_operacoes" does not exist
LINE 27: FROM "operacoes"."public"."f_operacoes"
              ^

[0m14:50:17.309071 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: ROLLBACK
[0m14:50:17.312557 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m14:50:17.317555 [debug] [Thread-4 (]: SQL status: BEGIN in 0.073 seconds
[0m14:50:17.318555 [debug] [Thread-2 (]: SQL status: BEGIN in 0.073 seconds
[0m14:50:17.318555 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.319557 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:50:17.319557 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m14:50:17.320556 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m14:50:17.322578 [debug] [Thread-3 (]: Database Error in model fato_operacoes (models\fato_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\fato_operacoes.sql
[0m14:50:17.323576 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014926307010>]}
[0m14:50:17.324556 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model public.fato_operacoes ..................... [[31mERROR[0m in 0.14s]
[0m14:50:17.325557 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m14:50:17.325557 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.fato_operacoes' to be skipped because of status 'error'.  Reason: Database Error in model fato_operacoes (models\fato_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\fato_operacoes.sql.
[0m14:50:17.328556 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:50:17.329556 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:50:17.334556 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.337556 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:50:17.338556 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m14:50:17.339556 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m14:50:17.345558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:50:17.346558 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:50:17.356573 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:50:17.358558 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:50:17.358558 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:50:17.359555 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.359555 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:50:17.360556 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:50:17.385070 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m14:50:17.391069 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m14:50:17.395070 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:50:17.396070 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m14:50:17.396070 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m14:50:17.398070 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m14:50:17.399098 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:50:17.400071 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m14:50:17.402070 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:50:17.404071 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m14:50:17.405072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014926266C10>]}
[0m14:50:17.406070 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:50:17.405072 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m14:50:17.407070 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m14:50:17.407070 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m14:50:17.408071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014926250FD0>]}
[0m14:50:17.409070 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:50:17.410070 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m14:50:17.484099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m14:50:17.484099 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.485254 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m14:50:17.491904 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:50:17.496905 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.496905 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m14:50:17.500905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:50:17.504905 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.505905 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m14:50:17.509936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:50:17.513942 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:50:17.514941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.515943 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:50:17.543637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m14:50:17.546636 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m14:50:17.547637 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:50:17.547637 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m14:50:17.567403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m14:50:17.568407 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m14:50:17.569407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e8ec35-cf1f-45c2-a19e-a0121787077b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014926337090>]}
[0m14:50:17.570404 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.38s]
[0m14:50:17.571405 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m14:50:17.572404 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.572404 [debug] [MainThread]: On master: BEGIN
[0m14:50:17.573404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:17.601943 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:50:17.602943 [debug] [MainThread]: On master: COMMIT
[0m14:50:17.602943 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:17.602943 [debug] [MainThread]: On master: COMMIT
[0m14:50:17.606943 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:50:17.606943 [debug] [MainThread]: On master: Close
[0m14:50:17.607943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:17.607943 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:50:17.608947 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:50:17.608947 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m14:50:17.608947 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m14:50:17.609943 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m14:50:17.609943 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m14:50:17.609943 [info ] [MainThread]: 
[0m14:50:17.610943 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m14:50:17.611943 [debug] [MainThread]: Command end result
[0m14:50:17.627944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:50:17.630948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:50:17.636943 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m14:50:17.636943 [info ] [MainThread]: 
[0m14:50:17.637943 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:50:17.638944 [info ] [MainThread]: 
[0m14:50:17.638944 [error] [MainThread]:   Database Error in model fato_operacoes (models\fato_operacoes.sql)
  relation "public.f_operacoes" does not exist
  LINE 27: FROM "operacoes"."public"."f_operacoes"
                ^
  compiled code at target\run\my_dbt_project\models\fato_operacoes.sql
[0m14:50:17.639944 [info ] [MainThread]: 
[0m14:50:17.640944 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:50:17.643943 [debug] [MainThread]: Command `dbt run` failed at 14:50:17.643943 after 2.09 seconds
[0m14:50:17.644943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001491E989950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001491EA01BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001491EA01C10>]}
[0m14:50:17.644943 [debug] [MainThread]: Flushing usage events
[0m14:50:18.578536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:52.147699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A385F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A3DBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A3DB090>]}


============================== 14:51:52.151702 | 4611b57d-69e0-4ff1-87ae-ffda81114408 ==============================
[0m14:51:52.151702 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:51:52.152694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:52.256215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4611b57d-69e0-4ff1-87ae-ffda81114408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A3B7C90>]}
[0m14:51:52.274216 [debug] [MainThread]: Command `dbt clean` succeeded at 14:51:52.274216 after 0.21 seconds
[0m14:51:52.275215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020574559950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020574558DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205745D1C10>]}
[0m14:51:52.275215 [debug] [MainThread]: Flushing usage events
[0m14:51:52.967319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:58.034285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B069487D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06720FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B069388D90>]}


============================== 14:51:58.038288 | 52e16b02-2ef7-4354-b61a-3f372f206401 ==============================
[0m14:51:58.038288 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:51:58.039285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:51:58.050287 [info ] [MainThread]: dbt version: 1.9.2
[0m14:51:58.051287 [info ] [MainThread]: python version: 3.11.9
[0m14:51:58.051287 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m14:51:58.052876 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:51:58.102306 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m14:51:58.102306 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m14:51:58.103290 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m14:51:58.104290 [info ] [MainThread]: adapter type: postgres
[0m14:51:58.104290 [info ] [MainThread]: adapter version: 1.9.0
[0m14:51:58.174904 [info ] [MainThread]: Configuration:
[0m14:51:58.175890 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:51:58.176804 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:51:58.176804 [info ] [MainThread]: Required dependencies:
[0m14:51:58.177801 [debug] [MainThread]: Executing "git --help"
[0m14:51:58.215318 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:51:58.215318 [debug] [MainThread]: STDERR: "b''"
[0m14:51:58.216318 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:51:58.216318 [info ] [MainThread]: Connection:
[0m14:51:58.217318 [info ] [MainThread]:   host: 172.16.0.239
[0m14:51:58.218318 [info ] [MainThread]:   port: 5432
[0m14:51:58.218318 [info ] [MainThread]:   user: dmx-op-user
[0m14:51:58.219318 [info ] [MainThread]:   database: operacoes
[0m14:51:58.219318 [info ] [MainThread]:   schema: public
[0m14:51:58.220317 [info ] [MainThread]:   connect_timeout: 10
[0m14:51:58.220317 [info ] [MainThread]:   role: None
[0m14:51:58.220317 [info ] [MainThread]:   search_path: None
[0m14:51:58.221319 [info ] [MainThread]:   keepalives_idle: 0
[0m14:51:58.221319 [info ] [MainThread]:   sslmode: None
[0m14:51:58.222318 [info ] [MainThread]:   sslcert: None
[0m14:51:58.222318 [info ] [MainThread]:   sslkey: None
[0m14:51:58.222318 [info ] [MainThread]:   sslrootcert: None
[0m14:51:58.223319 [info ] [MainThread]:   application_name: dbt
[0m14:51:58.223319 [info ] [MainThread]:   retries: 1
[0m14:51:58.224319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:58.415374 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:51:58.457373 [debug] [MainThread]: Using postgres connection "debug"
[0m14:51:58.457373 [debug] [MainThread]: On debug: select 1 as id
[0m14:51:58.457373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:58.527293 [debug] [MainThread]: SQL status: SELECT 1 in 0.070 seconds
[0m14:51:58.528304 [debug] [MainThread]: On debug: Close
[0m14:51:58.529303 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:51:58.530301 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:51:58.531302 [debug] [MainThread]: Command `dbt debug` succeeded at 14:51:58.531302 after 0.56 seconds
[0m14:51:58.532310 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:51:58.533305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0691C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B069586710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B069681250>]}
[0m14:51:58.533305 [debug] [MainThread]: Flushing usage events
[0m14:51:59.159136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:02.829252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154ABDA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154A8B8E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154ABC80D0>]}


============================== 14:52:02.833394 | 8a486e52-a938-44fa-b201-24bc5bc512e2 ==============================
[0m14:52:02.833394 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:52:02.834253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:02.984929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154AD6F450>]}
[0m14:52:03.024451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154ADFD050>]}
[0m14:52:03.025452 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:52:03.205324 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:52:03.206323 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:52:03.207323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154ADFE7D0>]}
[0m14:52:03.894834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B2AA350>]}
[0m14:52:03.937563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:52:03.941565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:52:03.956564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B0592D0>]}
[0m14:52:03.957565 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m14:52:03.957565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154AE08710>]}
[0m14:52:03.959683 [info ] [MainThread]: 
[0m14:52:03.959683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:03.960567 [info ] [MainThread]: 
[0m14:52:03.960567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:03.964054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:52:04.016365 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:52:04.017352 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:52:04.017352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:04.070658 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m14:52:04.072688 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:52:04.074668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:52:04.081593 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:52:04.082687 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:52:04.082687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:04.200196 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m14:52:04.201301 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:52:04.201301 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:04.208883 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.007 seconds
[0m14:52:04.210870 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:52:04.214929 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:52:04.223775 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.224776 [debug] [MainThread]: On master: BEGIN
[0m14:52:04.224776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:04.353390 [debug] [MainThread]: SQL status: BEGIN in 0.129 seconds
[0m14:52:04.354290 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.354290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:04.385872 [debug] [MainThread]: SQL status: SELECT 9 in 0.031 seconds
[0m14:52:04.390871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B685150>]}
[0m14:52:04.391870 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:04.396499 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.396499 [debug] [MainThread]: On master: BEGIN
[0m14:52:04.404785 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:52:04.405582 [debug] [MainThread]: On master: COMMIT
[0m14:52:04.406580 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.407579 [debug] [MainThread]: On master: COMMIT
[0m14:52:04.411941 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m14:52:04.412749 [debug] [MainThread]: On master: Close
[0m14:52:04.419593 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m14:52:04.420590 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m14:52:04.420590 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m14:52:04.422588 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m14:52:04.421695 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m14:52:04.423588 [info ] [Thread-2 (]: 2 of 4 START sql view model public.dim_sacados ................................. [RUN]
[0m14:52:04.424589 [info ] [Thread-3 (]: 3 of 4 START sql view model public.fato_operacoes .............................. [RUN]
[0m14:52:04.425589 [info ] [Thread-4 (]: 4 of 4 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m14:52:04.426210 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m14:52:04.427248 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m14:52:04.428304 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m14:52:04.429218 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_titulosabertos'
[0m14:52:04.429218 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m14:52:04.430235 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m14:52:04.431222 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m14:52:04.431222 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m14:52:04.441215 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.443215 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m14:52:04.446313 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m14:52:04.448316 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.451396 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m14:52:04.476396 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.476396 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m14:52:04.477396 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m14:52:04.477396 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m14:52:04.482502 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m14:52:04.485396 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m14:52:04.485396 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.488397 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.489395 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m14:52:04.490420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:04.491396 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:52:04.491396 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.492396 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.492396 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m14:52:04.493397 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m14:52:04.493397 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m14:52:04.494395 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:04.494395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:04.495396 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:52:04.567013 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m14:52:04.568015 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.568015 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m14:52:04.575007 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:52:04.580109 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.581127 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m14:52:04.611754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m14:52:04.618774 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.619776 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m14:52:04.620777 [debug] [Thread-3 (]: SQL status: BEGIN in 0.126 seconds
[0m14:52:04.621773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.131 seconds
[0m14:52:04.622772 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:52:04.622772 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.623772 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(valor_desagio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(prazo_medio, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_bruto, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(valor_liquido, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(cred_cedente, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(valor_saldo, '[^0-9,.]', '', 'g'), ',') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m14:52:04.624772 [debug] [Thread-4 (]: SQL status: BEGIN in 0.129 seconds
[0m14:52:04.625079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:52:04.625592 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m14:52:04.626168 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.636174 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:52:04.637174 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:52:04.638175 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m14:52:04.638175 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.641174 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:52:04.641174 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:52:04.642172 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m14:52:04.666276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m14:52:04.666276 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m14:52:04.666276 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m14:52:04.667276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m14:52:04.669275 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.672378 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.676382 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m14:52:04.677277 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:52:04.678327 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m14:52:04.678327 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m14:52:04.681379 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:52:04.682378 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:52:04.683276 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m14:52:04.683276 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:52:04.707337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m14:52:04.708323 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m14:52:04.708323 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m14:52:04.711323 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.715345 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m14:52:04.719332 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.719978 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m14:52:04.720813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m14:52:04.721886 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:52:04.722917 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m14:52:04.726591 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m14:52:04.727612 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m14:52:04.730638 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B77DE90>]}
[0m14:52:04.731602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:52:04.734153 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:52:04.732084 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.30s]
[0m14:52:04.734153 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:52:04.735155 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.735908 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:52:04.735908 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m14:52:04.738015 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:52:04.738916 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:52:04.739917 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m14:52:04.740916 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.741958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B2F3AD0>]}
[0m14:52:04.742959 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:52:04.742959 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m14:52:04.743916 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m14:52:04.761195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m14:52:04.765193 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m14:52:04.766227 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:52:04.767193 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m14:52:04.774279 [debug] [Thread-4 (]: SQL status: COMMIT in 0.030 seconds
[0m14:52:04.776194 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m14:52:04.777284 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:52:04.778195 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m14:52:04.791484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m14:52:04.793484 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m14:52:04.794591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B6A14D0>]}
[0m14:52:04.795579 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.37s]
[0m14:52:04.796484 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m14:52:04.806779 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.028 seconds
[0m14:52:04.808781 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m14:52:04.809779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a486e52-a938-44fa-b201-24bc5bc512e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154B677D90>]}
[0m14:52:04.810779 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.38s]
[0m14:52:04.811798 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m14:52:04.813812 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.814814 [debug] [MainThread]: On master: BEGIN
[0m14:52:04.814814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:04.901654 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m14:52:04.904656 [debug] [MainThread]: On master: COMMIT
[0m14:52:04.905650 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:04.907653 [debug] [MainThread]: On master: COMMIT
[0m14:52:04.916621 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m14:52:04.918575 [debug] [MainThread]: On master: Close
[0m14:52:04.920459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:04.921555 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:52:04.922561 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:52:04.923545 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m14:52:04.923545 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m14:52:04.924552 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m14:52:04.925557 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m14:52:04.925557 [info ] [MainThread]: 
[0m14:52:04.928191 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m14:52:04.930286 [debug] [MainThread]: Command end result
[0m14:52:04.955184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:52:04.958187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:52:04.963184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m14:52:04.964187 [info ] [MainThread]: 
[0m14:52:04.965184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:04.966183 [info ] [MainThread]: 
[0m14:52:04.968183 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:52:04.969183 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:04.969183 after 2.20 seconds
[0m14:52:04.969183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021544E01BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021544E01C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021544D89950>]}
[0m14:52:04.970185 [debug] [MainThread]: Flushing usage events
[0m14:52:05.653447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:10.739064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD4081A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD40DAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD40D9B50>]}


============================== 14:55:10.744065 | af2fdafd-3824-41ec-849a-be52d5ccbca0 ==============================
[0m14:55:10.744065 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:55:10.745064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:10.935591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD42B5410>]}
[0m14:55:10.976538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD0209910>]}
[0m14:55:10.977539 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:11.174162 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:55:11.306711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:11.306711 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m14:55:11.474082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD4778C10>]}
[0m14:55:11.517694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:55:11.521823 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:55:11.548971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD488E410>]}
[0m14:55:11.549972 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m14:55:11.549972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD473C9D0>]}
[0m14:55:11.552078 [info ] [MainThread]: 
[0m14:55:11.552971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:11.552971 [info ] [MainThread]: 
[0m14:55:11.553971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:11.556973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:55:11.615509 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:55:11.616510 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:55:11.616510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:11.693225 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.076 seconds
[0m14:55:11.696222 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:55:11.699219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:55:11.705226 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:55:11.706224 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:55:11.706224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:11.759727 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m14:55:11.759727 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:55:11.760727 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:55:11.766727 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.006 seconds
[0m14:55:11.767727 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:55:11.772727 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:55:11.777727 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:11.777727 [debug] [MainThread]: On master: BEGIN
[0m14:55:11.778729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:11.813731 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:55:11.814731 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:11.814731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:11.823237 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m14:55:11.825236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD47C7ED0>]}
[0m14:55:11.826236 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:11.829236 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:11.830238 [debug] [MainThread]: On master: BEGIN
[0m14:55:11.836236 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:55:11.837236 [debug] [MainThread]: On master: COMMIT
[0m14:55:11.837236 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:11.838240 [debug] [MainThread]: On master: COMMIT
[0m14:55:11.841236 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:55:11.842238 [debug] [MainThread]: On master: Close
[0m14:55:11.844239 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m14:55:11.845239 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m14:55:11.845239 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m14:55:11.845239 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m14:55:11.846238 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m14:55:11.847238 [info ] [Thread-2 (]: 2 of 4 START sql view model public.dim_sacados ................................. [RUN]
[0m14:55:11.847238 [info ] [Thread-3 (]: 3 of 4 START sql view model public.fato_operacoes .............................. [RUN]
[0m14:55:11.848239 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m14:55:11.848239 [info ] [Thread-4 (]: 4 of 4 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m14:55:11.849240 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m14:55:11.850239 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m14:55:11.850239 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m14:55:11.850239 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_titulosabertos'
[0m14:55:11.851240 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m14:55:11.851240 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m14:55:11.857236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.857236 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m14:55:11.859236 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m14:55:11.863240 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m14:55:11.867238 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m14:55:11.868241 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m14:55:11.870244 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m14:55:11.893253 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m14:55:11.897239 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.900254 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m14:55:11.901254 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m14:55:11.904244 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m14:55:11.906249 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.910262 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m14:55:11.910262 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:11.911244 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m14:55:11.912244 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:11.912244 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m14:55:11.912244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:11.913244 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:11.913244 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m14:55:11.914244 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:11.914244 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m14:55:11.915244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:11.915244 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:11.942791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m14:55:11.942791 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.943792 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m14:55:11.948860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:55:11.953861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.954861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m14:55:11.958011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:55:11.959860 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.960860 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m14:55:11.964896 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m14:55:11.964896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m14:55:11.965894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:55:11.965894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m14:55:11.965894 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:11.966861 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:11.977996 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:55:11.979016 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:11.980004 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m14:55:11.980004 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m14:55:11.980949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:11.980949 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'YYYY-MM-DD') AS DATA,
    TO_DATE(finalizacao, 'YYYY-MM-DD') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'YYYY-MM-DD') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'YYYY-MM-DD HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'YYYY-MM-DD HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m14:55:11.981861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:55:11.987894 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:55:11.990891 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:11.991896 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m14:55:11.991896 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:55:11.992886 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:55:11.995861 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:11.995861 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:55:12.047482 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:12.047482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m14:55:12.048483 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m14:55:12.051481 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:12.051481 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m14:55:12.056482 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m14:55:12.057480 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m14:55:12.061480 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:55:12.062480 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:55:12.062480 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:55:12.063482 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m14:55:12.066480 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:12.066480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:55:12.069480 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:12.070480 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m14:55:12.072481 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:55:12.072481 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m14:55:12.074482 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:12.075484 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:55:12.077481 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:55:12.078479 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:55:12.078479 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:12.079481 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:55:12.079481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:55:12.081483 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:55:12.082482 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:12.082482 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:55:12.090480 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m14:55:12.092480 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m14:55:12.094482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD457EF90>]}
[0m14:55:12.095480 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:55:12.095480 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m14:55:12.103606 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m14:55:12.103606 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m14:55:12.104612 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m14:55:12.106614 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m14:55:12.108647 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m14:55:12.109612 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m14:55:12.110614 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:55:12.111613 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:55:12.112614 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:55:12.113616 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m14:55:12.113616 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m14:55:12.114615 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m14:55:12.126217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m14:55:12.127217 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m14:55:12.128255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD4C69F10>]}
[0m14:55:12.129250 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m14:55:12.130237 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m14:55:12.133062 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m14:55:12.133062 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m14:55:12.134063 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m14:55:12.135102 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m14:55:12.136060 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD456D550>]}
[0m14:55:12.137061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2fdafd-3824-41ec-849a-be52d5ccbca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD48F9B90>]}
[0m14:55:12.136060 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:55:12.137061 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:55:12.138063 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m14:55:12.138063 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m14:55:12.141068 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:12.141068 [debug] [MainThread]: On master: BEGIN
[0m14:55:12.142063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:12.181392 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m14:55:12.181392 [debug] [MainThread]: On master: COMMIT
[0m14:55:12.182410 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:12.182410 [debug] [MainThread]: On master: COMMIT
[0m14:55:12.186408 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:55:12.186408 [debug] [MainThread]: On master: Close
[0m14:55:12.187408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:12.187408 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:55:12.187408 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:55:12.188407 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m14:55:12.188407 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m14:55:12.188407 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m14:55:12.189407 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m14:55:12.189407 [info ] [MainThread]: 
[0m14:55:12.190429 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m14:55:12.191406 [debug] [MainThread]: Command end result
[0m14:55:12.207412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:55:12.210413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:55:12.216410 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m14:55:12.216410 [info ] [MainThread]: 
[0m14:55:12.217414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:12.217414 [info ] [MainThread]: 
[0m14:55:12.218919 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:55:12.219929 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:12.219929 after 1.54 seconds
[0m14:55:12.220924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD2ECF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDCE2D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDCE2D1BD0>]}
[0m14:55:12.220924 [debug] [MainThread]: Flushing usage events
[0m14:55:13.175539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:24.465550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F92F8ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F92FDAA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F92F82510>]}


============================== 14:59:24.470565 | 8d7a9254-26f1-4d44-8082-43c2a1d17d80 ==============================
[0m14:59:24.470565 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:59:24.471586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:24.703396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F941B4F10>]}
[0m14:59:24.751395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F901095D0>]}
[0m14:59:24.752396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:59:24.983988 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:59:25.094049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:25.094049 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m14:59:25.290115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F946008D0>]}
[0m14:59:25.342112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:59:25.347004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:59:25.369029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9470B910>]}
[0m14:59:25.370030 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m14:59:25.370030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F94784E10>]}
[0m14:59:25.372052 [info ] [MainThread]: 
[0m14:59:25.372052 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:25.373029 [info ] [MainThread]: 
[0m14:59:25.373029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:25.377054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m14:59:25.435107 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m14:59:25.436107 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m14:59:25.436107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:25.524898 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.088 seconds
[0m14:59:25.527892 [debug] [ThreadPool]: On list_operacoes: Close
[0m14:59:25.531832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m14:59:25.542890 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:59:25.543887 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m14:59:25.544891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:25.586113 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m14:59:25.586113 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m14:59:25.587116 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:25.594114 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.007 seconds
[0m14:59:25.596121 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m14:59:25.623070 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m14:59:25.628956 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:25.628956 [debug] [MainThread]: On master: BEGIN
[0m14:59:25.629956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:25.697183 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m14:59:25.699181 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:25.701193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:59:25.710277 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m14:59:25.716175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9462C710>]}
[0m14:59:25.717272 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:25.724171 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:25.725279 [debug] [MainThread]: On master: BEGIN
[0m14:59:25.732220 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:59:25.732220 [debug] [MainThread]: On master: COMMIT
[0m14:59:25.733171 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:25.733171 [debug] [MainThread]: On master: COMMIT
[0m14:59:25.737278 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:59:25.737278 [debug] [MainThread]: On master: Close
[0m14:59:25.741170 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m14:59:25.742170 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m14:59:25.742170 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m14:59:25.742170 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m14:59:25.743169 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m14:59:25.744169 [info ] [Thread-2 (]: 2 of 4 START sql view model public.dim_sacados ................................. [RUN]
[0m14:59:25.744169 [info ] [Thread-3 (]: 3 of 4 START sql view model public.fato_operacoes .............................. [RUN]
[0m14:59:25.745170 [info ] [Thread-4 (]: 4 of 4 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m14:59:25.746170 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m14:59:25.746170 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m14:59:25.747169 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m14:59:25.747169 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_titulosabertos'
[0m14:59:25.748169 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m14:59:25.748169 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m14:59:25.748169 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m14:59:25.749169 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m14:59:25.754168 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.756168 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m14:59:25.759170 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m14:59:25.761170 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.762170 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m14:59:25.763170 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m14:59:25.779172 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m14:59:25.792684 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.793683 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m14:59:25.798682 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m14:59:25.801683 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m14:59:25.804683 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.804683 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.805682 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.806683 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.806683 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m14:59:25.807682 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.807682 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m14:59:25.807682 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m14:59:25.808682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:25.808682 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m14:59:25.809682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:25.809682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:25.810683 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:59:25.839681 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m14:59:25.839681 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.840682 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'DD-MM-YYYY HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'DD-MM-YYYY HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    TO_TIMESTAMP(inicio, 'DD-MM-YYYY HH24:MI:SS.US') AS INICIO,
    TO_TIMESTAMP(timestamp_extracao, 'DD-MM-YYYY HH24:MI:SS.US') AS TIMESTAMP_EXTRACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m14:59:25.842707 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m14:59:25.842707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m14:59:25.843682 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.843682 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.843682 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m14:59:25.844683 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m14:59:25.850682 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:59:25.851682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m14:59:25.851682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:59:25.856683 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:59:25.858682 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.859683 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.862684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.865681 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.865681 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m14:59:25.866682 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m14:59:25.866682 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m14:59:25.867687 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m14:59:25.872687 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:59:25.873686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:59:25.873686 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:59:25.875687 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.876686 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:59:25.879688 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.928196 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.929196 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m14:59:25.931210 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.932210 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m14:59:25.932210 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m14:59:25.933197 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m14:59:25.936211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:59:25.937195 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:25.937195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:25.937195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:25.939210 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.950219 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:59:25.952196 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:59:25.953195 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:59:25.953195 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m14:59:25.954194 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.954194 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.955196 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.955196 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m14:59:25.956193 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m14:59:25.956193 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m14:59:25.959193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:59:25.960211 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:59:25.960211 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.961194 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m14:59:25.976241 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m14:59:25.981239 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m14:59:25.984567 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m14:59:25.984567 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m14:59:25.988567 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m14:59:25.989557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m14:59:25.989557 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m14:59:25.991551 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m14:59:25.992551 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m14:59:25.994551 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m14:59:25.995552 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m14:59:25.996551 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m14:59:25.996551 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m14:59:25.997550 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m14:59:25.997550 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m14:59:25.998551 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m14:59:26.005566 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m14:59:26.007551 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m14:59:26.009551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F94C6BDD0>]}
[0m14:59:26.009551 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:59:26.010565 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m14:59:26.028551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.029 seconds
[0m14:59:26.028551 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.030 seconds
[0m14:59:26.029553 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.030 seconds
[0m14:59:26.030553 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m14:59:26.031552 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m14:59:26.033552 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m14:59:26.034552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F94B1C750>]}
[0m14:59:26.035588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9417B290>]}
[0m14:59:26.035588 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7a9254-26f1-4d44-8082-43c2a1d17d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F94178410>]}
[0m14:59:26.036552 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:59:26.037552 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m14:59:26.039551 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m14:59:26.038552 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:59:26.040605 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m14:59:26.041551 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m14:59:26.044551 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:26.045551 [debug] [MainThread]: On master: BEGIN
[0m14:59:26.045551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:26.099580 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m14:59:26.100577 [debug] [MainThread]: On master: COMMIT
[0m14:59:26.100577 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:26.100577 [debug] [MainThread]: On master: COMMIT
[0m14:59:26.104588 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:59:26.105597 [debug] [MainThread]: On master: Close
[0m14:59:26.105597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:26.105597 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m14:59:26.106577 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m14:59:26.106577 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m14:59:26.106577 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m14:59:26.106577 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m14:59:26.107577 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m14:59:26.107577 [info ] [MainThread]: 
[0m14:59:26.108578 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m14:59:26.109606 [debug] [MainThread]: Command end result
[0m14:59:26.123594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m14:59:26.125578 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m14:59:26.130595 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m14:59:26.130595 [info ] [MainThread]: 
[0m14:59:26.131577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:26.132579 [info ] [MainThread]: 
[0m14:59:26.133586 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:59:26.134578 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:26.134578 after 1.73 seconds
[0m14:59:26.135613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F921B1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F8E1E1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F900F5150>]}
[0m14:59:26.135613 [debug] [MainThread]: Flushing usage events
[0m14:59:26.873542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:38.622906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B118DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B11DB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B11DA950>]}


============================== 15:00:38.625924 | cd12d113-34ba-434d-816f-288a938de09d ==============================
[0m15:00:38.625924 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:00:38.626918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:00:38.777629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B1340FD0>]}
[0m15:00:38.819138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2AD209790>]}
[0m15:00:38.821139 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:39.008185 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:00:39.123772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:39.124788 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m15:00:39.294878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B11F7BD0>]}
[0m15:00:39.341877 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:00:39.345987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:00:39.360878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B19A0910>]}
[0m15:00:39.361878 [info ] [MainThread]: Found 4 models, 7 sources, 433 macros
[0m15:00:39.362878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B1878350>]}
[0m15:00:39.363906 [info ] [MainThread]: 
[0m15:00:39.364931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:39.364931 [info ] [MainThread]: 
[0m15:00:39.365931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:39.368914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m15:00:39.427429 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m15:00:39.428431 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m15:00:39.428431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:39.475678 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m15:00:39.476700 [debug] [ThreadPool]: On list_operacoes: Close
[0m15:00:39.478701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m15:00:39.485380 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:00:39.485380 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m15:00:39.486273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:39.578345 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m15:00:39.579947 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:00:39.579947 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:39.588059 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.008 seconds
[0m15:00:39.590062 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m15:00:39.594065 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m15:00:39.599061 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:39.600058 [debug] [MainThread]: On master: BEGIN
[0m15:00:39.600058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:39.661257 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m15:00:39.662241 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:39.662241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:39.671279 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m15:00:39.673287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B11C8B50>]}
[0m15:00:39.674296 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:39.677279 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:39.678278 [debug] [MainThread]: On master: BEGIN
[0m15:00:39.685376 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:00:39.685376 [debug] [MainThread]: On master: COMMIT
[0m15:00:39.685376 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:39.686377 [debug] [MainThread]: On master: COMMIT
[0m15:00:39.689394 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:00:39.690376 [debug] [MainThread]: On master: Close
[0m15:00:39.691375 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m15:00:39.692377 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m15:00:39.692377 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m15:00:39.692377 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m15:00:39.693377 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m15:00:39.694377 [info ] [Thread-2 (]: 2 of 4 START sql view model public.dim_sacados ................................. [RUN]
[0m15:00:39.694377 [info ] [Thread-3 (]: 3 of 4 START sql view model public.fato_operacoes .............................. [RUN]
[0m15:00:39.695377 [info ] [Thread-4 (]: 4 of 4 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m15:00:39.696382 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m15:00:39.697376 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m15:00:39.697376 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m15:00:39.698378 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_titulosabertos'
[0m15:00:39.698378 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m15:00:39.699377 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m15:00:39.699377 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m15:00:39.699377 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m15:00:39.705376 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.707393 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m15:00:39.711393 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m15:00:39.713393 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.715377 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m15:00:39.715377 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m15:00:39.744377 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m15:00:39.745380 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m15:00:39.747380 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.750393 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m15:00:39.754393 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.757378 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m15:00:39.758376 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.759378 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:39.761380 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m15:00:39.762382 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.762382 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:39.763379 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m15:00:39.764379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:39.765380 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m15:00:39.765380 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m15:00:39.766388 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:39.767385 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:00:39.767385 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:39.799727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:00:39.799727 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.800725 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m15:00:39.807727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:00:39.812746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.813746 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m15:00:39.833726 [debug] [Thread-4 (]: SQL status: BEGIN in 0.066 seconds
[0m15:00:39.833726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m15:00:39.834727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m15:00:39.834727 [debug] [Thread-3 (]: SQL status: BEGIN in 0.067 seconds
[0m15:00:39.835728 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.835728 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:39.838727 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.839727 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:39.839727 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m15:00:39.840728 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m15:00:39.840728 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m15:00:39.841728 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m15:00:39.846726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:00:39.858725 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:00:39.859726 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m15:00:39.859726 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m15:00:39.859726 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m15:00:39.859726 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.862728 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:39.866730 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:39.920853 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.920853 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:00:39.921852 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m15:00:39.921852 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m15:00:39.922852 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m15:00:39.927852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:00:39.928852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:00:39.928852 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:00:39.931853 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:39.933852 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:39.936852 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.937852 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m15:00:39.937852 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m15:00:39.938854 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m15:00:39.954852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m15:00:39.955852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m15:00:39.955852 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m15:00:39.955852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m15:00:39.961851 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m15:00:39.963852 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:00:39.964854 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:00:39.965852 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:00:39.969857 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:00:39.970856 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:39.970856 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.971856 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:39.971856 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m15:00:39.972857 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:00:39.972857 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:00:39.972857 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:00:39.993368 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m15:00:39.995367 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m15:00:39.996365 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:00:39.997365 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m15:00:40.006364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m15:00:40.007365 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m15:00:40.007365 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m15:00:40.010363 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m15:00:40.012363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m15:00:40.014365 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m15:00:40.016365 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:00:40.017367 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:00:40.019364 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m15:00:40.019364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B1984DD0>]}
[0m15:00:40.020365 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m15:00:40.021365 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m15:00:40.022367 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m15:00:40.038365 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.041 seconds
[0m15:00:40.039363 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m15:00:40.040367 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m15:00:40.041365 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m15:00:40.043367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B19EE490>]}
[0m15:00:40.043367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B1D6A710>]}
[0m15:00:40.044366 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.35s]
[0m15:00:40.045367 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.34s]
[0m15:00:40.046365 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m15:00:40.046365 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.025 seconds
[0m15:00:40.047366 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m15:00:40.049382 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m15:00:40.050364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd12d113-34ba-434d-816f-288a938de09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B1E51090>]}
[0m15:00:40.050364 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m15:00:40.051363 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m15:00:40.053364 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:40.053364 [debug] [MainThread]: On master: BEGIN
[0m15:00:40.056368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:40.084881 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m15:00:40.084881 [debug] [MainThread]: On master: COMMIT
[0m15:00:40.085884 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:40.085884 [debug] [MainThread]: On master: COMMIT
[0m15:00:40.088898 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:00:40.089899 [debug] [MainThread]: On master: Close
[0m15:00:40.090899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:40.090899 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m15:00:40.090899 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m15:00:40.091881 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m15:00:40.091881 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m15:00:40.091881 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m15:00:40.091881 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m15:00:40.092881 [info ] [MainThread]: 
[0m15:00:40.093901 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m15:00:40.094881 [debug] [MainThread]: Command end result
[0m15:00:40.113881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:00:40.116894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:00:40.122881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m15:00:40.122881 [info ] [MainThread]: 
[0m15:00:40.123881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:40.123881 [info ] [MainThread]: 
[0m15:00:40.124881 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:00:40.125882 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:40.125882 after 1.56 seconds
[0m15:00:40.126888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A8F41C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A8EC9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A8EC8D50>]}
[0m15:00:40.126888 [debug] [MainThread]: Flushing usage events
[0m15:00:40.842056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:32.478860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E68DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E68C210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E68E450>]}


============================== 15:07:32.483879 | fb6b51f1-e788-415b-aadf-d7ab28b99418 ==============================
[0m15:07:32.483879 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:07:32.484860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:07:32.699447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E842250>]}
[0m15:07:32.739571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9796BA010>]}
[0m15:07:32.740567 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:07:32.934012 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:07:33.070146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:07:33.071147 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\fato_detalhes_operacoes.sql
[0m15:07:33.071147 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m15:07:33.322192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E8E6690>]}
[0m15:07:33.367679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:07:33.372679 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:07:33.398681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97EFF2750>]}
[0m15:07:33.399680 [info ] [MainThread]: Found 5 models, 9 sources, 433 macros
[0m15:07:33.399680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E8B5BD0>]}
[0m15:07:33.401679 [info ] [MainThread]: 
[0m15:07:33.401679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:33.402679 [info ] [MainThread]: 
[0m15:07:33.403681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:33.406680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m15:07:33.459190 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m15:07:33.459190 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m15:07:33.460190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:33.731533 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.271 seconds
[0m15:07:33.732552 [debug] [ThreadPool]: On list_operacoes: Close
[0m15:07:33.734891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m15:07:33.740900 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:07:33.740900 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m15:07:33.741901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:33.999341 [debug] [ThreadPool]: SQL status: BEGIN in 0.257 seconds
[0m15:07:34.001341 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:07:34.002337 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:07:34.040798 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m15:07:34.042796 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m15:07:34.076144 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m15:07:34.089220 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:34.090332 [debug] [MainThread]: On master: BEGIN
[0m15:07:34.090332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:34.322754 [debug] [MainThread]: SQL status: BEGIN in 0.233 seconds
[0m15:07:34.324775 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:34.325757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:34.365554 [debug] [MainThread]: SQL status: SELECT 11 in 0.038 seconds
[0m15:07:34.367464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B900014790>]}
[0m15:07:34.368462 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:34.401240 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:34.401240 [debug] [MainThread]: On master: BEGIN
[0m15:07:34.465749 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m15:07:34.466750 [debug] [MainThread]: On master: COMMIT
[0m15:07:34.466750 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:34.467752 [debug] [MainThread]: On master: COMMIT
[0m15:07:34.500748 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m15:07:34.500748 [debug] [MainThread]: On master: Close
[0m15:07:34.503750 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m15:07:34.504750 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m15:07:34.504750 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m15:07:34.504750 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m15:07:34.505752 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m15:07:34.505752 [info ] [Thread-2 (]: 2 of 5 START sql view model public.dim_sacados ................................. [RUN]
[0m15:07:34.506750 [info ] [Thread-3 (]: 3 of 5 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m15:07:34.507749 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m15:07:34.506750 [info ] [Thread-4 (]: 4 of 5 START sql view model public.fato_operacoes .............................. [RUN]
[0m15:07:34.508750 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m15:07:34.508750 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m15:07:34.509749 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m15:07:34.509749 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m15:07:34.509749 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m15:07:34.510752 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m15:07:34.515750 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.516749 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m15:07:34.518751 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m15:07:34.521748 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:07:34.523749 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m15:07:34.524749 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m15:07:34.577282 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m15:07:34.599286 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m15:07:34.602307 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.602307 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m15:07:34.603264 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m15:07:34.604265 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:34.606370 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:07:34.609264 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m15:07:34.609937 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.609937 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m15:07:34.610954 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m15:07:34.610954 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:34.611953 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:07:34.611953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:34.612970 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:34.613302 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m15:07:34.614355 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m15:07:34.614355 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:07:34.614355 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:34.852258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m15:07:34.854256 [debug] [Thread-4 (]: SQL status: BEGIN in 0.239 seconds
[0m15:07:34.855256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.240 seconds
[0m15:07:34.855991 [debug] [Thread-2 (]: SQL status: BEGIN in 0.244 seconds
[0m15:07:34.857004 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.858003 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:34.859010 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:07:34.860008 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:34.862004 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m15:07:34.863125 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m15:07:34.864109 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes_fidc"
  );
[0m15:07:34.866005 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m15:07:34.900718 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m15:07:34.902740 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m15:07:34.903741 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.f_operacoes_detalhes_fidc" does not exist
LINE 13: FROM "operacoes"."public"."f_operacoes_detalhes_fidc"
              ^

[0m15:07:34.904743 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m15:07:34.916705 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.922885 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:34.923934 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: ROLLBACK
[0m15:07:34.927883 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:34.928883 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m15:07:34.928883 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m15:07:34.930187 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m15:07:34.963328 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m15:07:34.964326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m15:07:34.965342 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m15:07:34.966331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m15:07:34.973324 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:34.979322 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:34.982324 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:34.982324 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m15:07:34.983322 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m15:07:34.984325 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m15:07:34.989323 [debug] [Thread-3 (]: Database Error in model fato_detalhes_operacoes (models\fato_detalhes_operacoes.sql)
  relation "public.f_operacoes_detalhes_fidc" does not exist
  LINE 13: FROM "operacoes"."public"."f_operacoes_detalhes_fidc"
                ^
  compiled code at target\run\my_dbt_project\models\fato_detalhes_operacoes.sql
[0m15:07:34.991339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97ED62A10>]}
[0m15:07:34.992339 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model public.fato_detalhes_operacoes ............ [[31mERROR[0m in 0.48s]
[0m15:07:34.993323 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m15:07:34.993323 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m15:07:34.994330 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.fato_detalhes_operacoes' to be skipped because of status 'error'.  Reason: Database Error in model fato_detalhes_operacoes (models\fato_detalhes_operacoes.sql)
  relation "public.f_operacoes_detalhes_fidc" does not exist
  LINE 13: FROM "operacoes"."public"."f_operacoes_detalhes_fidc"
                ^
  compiled code at target\run\my_dbt_project\models\fato_detalhes_operacoes.sql.
[0m15:07:34.994330 [info ] [Thread-3 (]: 5 of 5 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m15:07:34.996342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m15:07:34.996342 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m15:07:34.999322 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.000339 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m15:07:35.003322 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.003322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m15:07:35.003322 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m15:07:35.004322 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m15:07:35.005323 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.019342 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:07:35.021323 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:07:35.024325 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:07:35.025325 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m15:07:35.026321 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:35.026321 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:35.027323 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:35.027323 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:35.028340 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:07:35.028340 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:07:35.028340 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:07:35.061674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m15:07:35.061674 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m15:07:35.062673 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m15:07:35.067690 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m15:07:35.069675 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m15:07:35.070700 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m15:07:35.074691 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:07:35.075674 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:07:35.075674 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:07:35.076707 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m15:07:35.076707 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m15:07:35.077675 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m15:07:35.116174 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m15:07:35.116174 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.038 seconds
[0m15:07:35.116174 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m15:07:35.119267 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m15:07:35.120174 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m15:07:35.121173 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m15:07:35.122173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B900004DD0>]}
[0m15:07:35.123220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B900330590>]}
[0m15:07:35.123220 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97EAF0110>]}
[0m15:07:35.124269 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.61s]
[0m15:07:35.126172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m15:07:35.125173 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.61s]
[0m15:07:35.125173 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.61s]
[0m15:07:35.127171 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m15:07:35.127171 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m15:07:35.293128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.266 seconds
[0m15:07:35.296127 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.297201 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m15:07:35.331948 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:07:35.337068 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.338071 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m15:07:35.372693 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m15:07:35.374749 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.375754 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m15:07:35.408928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m15:07:35.413944 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:07:35.415949 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.416945 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:07:35.465073 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m15:07:35.470924 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m15:07:35.472926 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:07:35.473925 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m15:07:35.518153 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.044 seconds
[0m15:07:35.522278 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m15:07:35.523277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b51f1-e788-415b-aadf-d7ab28b99418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9002BE990>]}
[0m15:07:35.525165 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.53s]
[0m15:07:35.526165 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m15:07:35.529348 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.530357 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.531469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:35.757360 [debug] [MainThread]: SQL status: BEGIN in 0.225 seconds
[0m15:07:35.760359 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.761367 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.762475 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.795927 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m15:07:35.796926 [debug] [MainThread]: On master: Close
[0m15:07:35.798025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:35.799025 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m15:07:35.800028 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m15:07:35.801036 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m15:07:35.801996 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m15:07:35.801996 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m15:07:35.802983 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m15:07:35.803925 [info ] [MainThread]: 
[0m15:07:35.805924 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m15:07:35.809015 [debug] [MainThread]: Command end result
[0m15:07:35.833987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:07:35.836986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:07:35.842992 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m15:07:35.842992 [info ] [MainThread]: 
[0m15:07:35.843993 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:35.844992 [info ] [MainThread]: 
[0m15:07:35.844992 [error] [MainThread]:   Database Error in model fato_detalhes_operacoes (models\fato_detalhes_operacoes.sql)
  relation "public.f_operacoes_detalhes_fidc" does not exist
  LINE 13: FROM "operacoes"."public"."f_operacoes_detalhes_fidc"
                ^
  compiled code at target\run\my_dbt_project\models\fato_detalhes_operacoes.sql
[0m15:07:35.845990 [info ] [MainThread]: 
[0m15:07:35.846808 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:07:35.847862 [debug] [MainThread]: Command `dbt run` failed at 15:07:35.847862 after 3.43 seconds
[0m15:07:35.847862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9787D9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97E4B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B978851C10>]}
[0m15:07:35.848869 [debug] [MainThread]: Flushing usage events
[0m15:07:37.718563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:04.811199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC09185D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC091C8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC091C8110>]}


============================== 15:09:04.815216 | a65275ad-bf3d-46f5-8639-ecd408bd0573 ==============================
[0m15:09:04.815216 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:09:04.816199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:04.964718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a65275ad-bf3d-46f5-8639-ecd408bd0573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0928CD10>]}
[0m15:09:05.005309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a65275ad-bf3d-46f5-8639-ecd408bd0573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC05309F90>]}
[0m15:09:05.006309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:09:05.193237 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:09:05.308350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:05.310354 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m15:09:05.510321 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fato_detalhes_operacoes' (models\fato_detalhes_operacoes.sql) depends on a source named 'public.f_operacoes_detalhes_fidc' which was not found
[0m15:09:05.512664 [debug] [MainThread]: Command `dbt run` failed at 15:09:05.512664 after 0.76 seconds
[0m15:09:05.512664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC091E59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC07EC88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC098E4410>]}
[0m15:09:05.513663 [debug] [MainThread]: Flushing usage events
[0m15:09:06.540180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:16.809243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501AA85190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A89FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A9895D0>]}


============================== 15:09:16.812243 | 3d2a55ed-bc95-4e63-8cbf-2d8cd5ee556e ==============================
[0m15:09:16.812243 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:09:16.813243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:16.918794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d2a55ed-bc95-4e63-8cbf-2d8cd5ee556e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501AB772D0>]}
[0m15:09:16.936415 [debug] [MainThread]: Command `dbt clean` succeeded at 15:09:16.936415 after 0.19 seconds
[0m15:09:16.937433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501AAB7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015014CB9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015014CB8DD0>]}
[0m15:09:16.937433 [debug] [MainThread]: Flushing usage events
[0m15:09:17.615403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:26.893268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D6586E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D65DB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D65DA210>]}


============================== 15:09:26.897253 | 5a12c27a-8169-4cc0-b4f3-897982a6db5c ==============================
[0m15:09:26.897253 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:09:26.897253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:26.909268 [info ] [MainThread]: dbt version: 1.9.2
[0m15:09:26.910251 [info ] [MainThread]: python version: 3.11.9
[0m15:09:26.910251 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m15:09:26.911252 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m15:09:26.963841 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m15:09:26.965825 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m15:09:26.965825 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m15:09:26.966826 [info ] [MainThread]: adapter type: postgres
[0m15:09:26.967826 [info ] [MainThread]: adapter version: 1.9.0
[0m15:09:27.035842 [info ] [MainThread]: Configuration:
[0m15:09:27.036823 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:27.037824 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:27.037824 [info ] [MainThread]: Required dependencies:
[0m15:09:27.038843 [debug] [MainThread]: Executing "git --help"
[0m15:09:27.083663 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:27.084681 [debug] [MainThread]: STDERR: "b''"
[0m15:09:27.084681 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:27.085662 [info ] [MainThread]: Connection:
[0m15:09:27.086681 [info ] [MainThread]:   host: 172.16.0.239
[0m15:09:27.086681 [info ] [MainThread]:   port: 5432
[0m15:09:27.087681 [info ] [MainThread]:   user: dmx-op-user
[0m15:09:27.087681 [info ] [MainThread]:   database: operacoes
[0m15:09:27.088688 [info ] [MainThread]:   schema: public
[0m15:09:27.088688 [info ] [MainThread]:   connect_timeout: 10
[0m15:09:27.089662 [info ] [MainThread]:   role: None
[0m15:09:27.090668 [info ] [MainThread]:   search_path: None
[0m15:09:27.091664 [info ] [MainThread]:   keepalives_idle: 0
[0m15:09:27.091664 [info ] [MainThread]:   sslmode: None
[0m15:09:27.092663 [info ] [MainThread]:   sslcert: None
[0m15:09:27.093665 [info ] [MainThread]:   sslkey: None
[0m15:09:27.093665 [info ] [MainThread]:   sslrootcert: None
[0m15:09:27.094663 [info ] [MainThread]:   application_name: dbt
[0m15:09:27.095662 [info ] [MainThread]:   retries: 1
[0m15:09:27.095662 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:09:27.291701 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:09:27.332704 [debug] [MainThread]: Using postgres connection "debug"
[0m15:09:27.333708 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:27.333708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:27.460004 [debug] [MainThread]: SQL status: SELECT 1 in 0.126 seconds
[0m15:09:27.461003 [debug] [MainThread]: On debug: Close
[0m15:09:27.462004 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:09:27.462004 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:09:27.463003 [debug] [MainThread]: Command `dbt debug` succeeded at 15:09:27.463003 after 0.63 seconds
[0m15:09:27.464003 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:27.464003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D65B7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D0841C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D07C9950>]}
[0m15:09:27.465003 [debug] [MainThread]: Flushing usage events
[0m15:09:28.129018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:32.348022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E18EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E18E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E18EB90>]}


============================== 15:09:32.351040 | 0531aa99-3959-4783-93a5-7ff3a5316e7d ==============================
[0m15:09:32.351040 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:09:32.352049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:32.505121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0531aa99-3959-4783-93a5-7ff3a5316e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E3B4310>]}
[0m15:09:32.547121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0531aa99-3959-4783-93a5-7ff3a5316e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845A209BD0>]}
[0m15:09:32.549120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:09:32.727830 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:09:32.728829 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:09:32.729829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0531aa99-3959-4783-93a5-7ff3a5316e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E1D9A90>]}
[0m15:09:33.360628 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fato_detalhes_operacoes' (models\fato_detalhes_operacoes.sql) depends on a source named 'public.f_operacoes_detalhes_fidc' which was not found
[0m15:09:33.362517 [debug] [MainThread]: Command `dbt run` failed at 15:09:33.362517 after 1.08 seconds
[0m15:09:33.362517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018455EC9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E1DB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001845E857F50>]}
[0m15:09:33.363517 [debug] [MainThread]: Flushing usage events
[0m15:09:34.067291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:21.933893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172DD82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172DDC8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172DDC8B10>]}


============================== 15:11:21.936910 | 7ad5017c-6800-47c8-9382-3ed7e4733769 ==============================
[0m15:11:21.936910 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:11:21.937912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:22.045594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ad5017c-6800-47c8-9382-3ed7e4733769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172DE18F50>]}
[0m15:11:22.060701 [debug] [MainThread]: Command `dbt clean` succeeded at 15:11:22.059595 after 0.18 seconds
[0m15:11:22.060701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172DB9FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021728F59950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021728F58DD0>]}
[0m15:11:22.060701 [debug] [MainThread]: Flushing usage events
[0m15:11:23.161788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:29.875570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879C588B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879C6C8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879C6C8C90>]}


============================== 15:11:29.878574 | e0b558b8-a6c2-4fbd-a01b-8166fb139d3d ==============================
[0m15:11:29.878574 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:11:29.879573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:29.891572 [info ] [MainThread]: dbt version: 1.9.2
[0m15:11:29.892578 [info ] [MainThread]: python version: 3.11.9
[0m15:11:29.893572 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m15:11:29.894576 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m15:11:29.951728 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m15:11:29.952729 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m15:11:29.953730 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m15:11:29.953730 [info ] [MainThread]: adapter type: postgres
[0m15:11:29.954730 [info ] [MainThread]: adapter version: 1.9.0
[0m15:11:30.024268 [info ] [MainThread]: Configuration:
[0m15:11:30.025265 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:30.026252 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:30.026252 [info ] [MainThread]: Required dependencies:
[0m15:11:30.027250 [debug] [MainThread]: Executing "git --help"
[0m15:11:30.063252 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:11:30.065252 [debug] [MainThread]: STDERR: "b''"
[0m15:11:30.066252 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:11:30.066252 [info ] [MainThread]: Connection:
[0m15:11:30.067250 [info ] [MainThread]:   host: 172.16.0.239
[0m15:11:30.068251 [info ] [MainThread]:   port: 5432
[0m15:11:30.068251 [info ] [MainThread]:   user: dmx-op-user
[0m15:11:30.069252 [info ] [MainThread]:   database: operacoes
[0m15:11:30.070251 [info ] [MainThread]:   schema: public
[0m15:11:30.070251 [info ] [MainThread]:   connect_timeout: 10
[0m15:11:30.071251 [info ] [MainThread]:   role: None
[0m15:11:30.071251 [info ] [MainThread]:   search_path: None
[0m15:11:30.072252 [info ] [MainThread]:   keepalives_idle: 0
[0m15:11:30.072252 [info ] [MainThread]:   sslmode: None
[0m15:11:30.073252 [info ] [MainThread]:   sslcert: None
[0m15:11:30.073252 [info ] [MainThread]:   sslkey: None
[0m15:11:30.074252 [info ] [MainThread]:   sslrootcert: None
[0m15:11:30.075250 [info ] [MainThread]:   application_name: dbt
[0m15:11:30.075250 [info ] [MainThread]:   retries: 1
[0m15:11:30.076251 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:11:30.269304 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:11:30.312831 [debug] [MainThread]: Using postgres connection "debug"
[0m15:11:30.312831 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:30.312831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:30.433002 [debug] [MainThread]: SQL status: SELECT 1 in 0.120 seconds
[0m15:11:30.434005 [debug] [MainThread]: On debug: Close
[0m15:11:30.435011 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:30.435951 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:11:30.437009 [debug] [MainThread]: Command `dbt debug` succeeded at 15:11:30.437009 after 0.62 seconds
[0m15:11:30.437009 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:11:30.437009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879C49FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018796941C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879C6C8110>]}
[0m15:11:30.438010 [debug] [MainThread]: Flushing usage events
[0m15:11:31.162560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:39.741210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A18E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A18C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A18E410>]}


============================== 15:11:39.745723 | 453570a5-59d8-403e-963a-6c68cb66ccef ==============================
[0m15:11:39.745723 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:11:39.746723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:11:39.898959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A31BA90>]}
[0m15:11:39.940987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46309A50>]}
[0m15:11:39.941986 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:11:40.124779 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:11:40.125782 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:11:40.126668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A301590>]}
[0m15:11:40.859488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A931B10>]}
[0m15:11:40.905488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:11:40.909487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:11:40.925493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A393690>]}
[0m15:11:40.925493 [info ] [MainThread]: Found 5 models, 9 sources, 433 macros
[0m15:11:40.926508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A8BAC90>]}
[0m15:11:40.927489 [info ] [MainThread]: 
[0m15:11:40.928487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:40.928487 [info ] [MainThread]: 
[0m15:11:40.929488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:40.933496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m15:11:40.986516 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m15:11:40.987517 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m15:11:40.987517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:41.161167 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.173 seconds
[0m15:11:41.162159 [debug] [ThreadPool]: On list_operacoes: Close
[0m15:11:41.164150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m15:11:41.177152 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:11:41.178151 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m15:11:41.179151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:41.309589 [debug] [ThreadPool]: SQL status: BEGIN in 0.131 seconds
[0m15:11:41.311592 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m15:11:41.312594 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:11:41.348437 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.035 seconds
[0m15:11:41.350447 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m15:11:41.354550 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m15:11:41.359559 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:41.360502 [debug] [MainThread]: On master: BEGIN
[0m15:11:41.360502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:41.526339 [debug] [MainThread]: SQL status: BEGIN in 0.166 seconds
[0m15:11:41.526339 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:41.527341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:41.538342 [debug] [MainThread]: SQL status: SELECT 11 in 0.011 seconds
[0m15:11:41.541342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4ACB1810>]}
[0m15:11:41.541342 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:41.571849 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:41.571849 [debug] [MainThread]: On master: BEGIN
[0m15:11:41.605849 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m15:11:41.605849 [debug] [MainThread]: On master: COMMIT
[0m15:11:41.606852 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:41.606852 [debug] [MainThread]: On master: COMMIT
[0m15:11:41.610850 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:11:41.610850 [debug] [MainThread]: On master: Close
[0m15:11:41.613850 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m15:11:41.613850 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m15:11:41.613850 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m15:11:41.614852 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m15:11:41.614852 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m15:11:41.615850 [info ] [Thread-2 (]: 2 of 5 START sql view model public.dim_sacados ................................. [RUN]
[0m15:11:41.615850 [info ] [Thread-3 (]: 3 of 5 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m15:11:41.616881 [info ] [Thread-4 (]: 4 of 5 START sql view model public.fato_operacoes .............................. [RUN]
[0m15:11:41.617852 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m15:11:41.618850 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m15:11:41.618850 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m15:11:41.619850 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m15:11:41.619850 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m15:11:41.620851 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m15:11:41.620851 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m15:11:41.620851 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m15:11:41.626850 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.629849 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m15:11:41.631849 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.634856 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m15:11:41.636857 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m15:11:41.647855 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m15:11:41.663053 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m15:11:41.663053 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m15:11:41.672054 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m15:11:41.676054 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.679053 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.682055 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m15:11:41.684070 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:41.685054 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.686055 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.686055 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.687055 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m15:11:41.687055 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m15:11:41.688056 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m15:11:41.688056 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m15:11:41.689055 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:11:41.689055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:41.690054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:41.690054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:41.849462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m15:11:41.849462 [debug] [Thread-4 (]: SQL status: BEGIN in 0.160 seconds
[0m15:11:41.850471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.161 seconds
[0m15:11:41.850471 [debug] [Thread-2 (]: SQL status: BEGIN in 0.162 seconds
[0m15:11:41.851510 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.852470 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.852470 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.853472 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:41.854471 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m15:11:41.854471 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m15:11:41.855471 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m15:11:41.856469 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m15:11:41.870467 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:11:41.871468 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:11:41.871468 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:11:41.871468 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:11:41.876469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.879469 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.881469 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.883547 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:41.884469 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m15:11:41.884469 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m15:11:41.885469 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m15:11:41.885469 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m15:11:41.903771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m15:11:41.903771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m15:11:41.904756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m15:11:41.904756 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m15:11:41.906754 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.909756 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.919755 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m15:11:41.921756 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:41.922755 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m15:11:41.922755 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m15:11:41.923755 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.923755 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m15:11:41.924755 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m15:11:41.944535 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m15:11:41.945520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m15:11:41.948521 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:11:41.949398 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m15:11:41.950943 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:11:41.950943 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.951986 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:11:41.953066 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:41.953066 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m15:11:41.954056 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:41.954056 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m15:11:41.954944 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m15:11:41.977146 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m15:11:41.978151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.053 seconds
[0m15:11:41.990150 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m15:11:41.993146 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m15:11:41.998144 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m15:11:41.998144 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m15:11:41.999147 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m15:11:41.999147 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m15:11:42.010344 [debug] [Thread-2 (]: SQL status: COMMIT in 0.054 seconds
[0m15:11:42.010344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.055 seconds
[0m15:11:42.011344 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.011 seconds
[0m15:11:42.013343 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m15:11:42.015343 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m15:11:42.018343 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m15:11:42.019342 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m15:11:42.020343 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m15:11:42.022343 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m15:11:42.022343 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m15:11:42.023343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A7C3E10>]}
[0m15:11:42.024343 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.40s]
[0m15:11:42.025344 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m15:11:42.025344 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m15:11:42.025344 [info ] [Thread-3 (]: 5 of 5 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m15:11:42.026342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m15:11:42.026342 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m15:11:42.029341 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.030343 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m15:11:42.033342 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.034345 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.035353 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m15:11:42.036352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:42.043352 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.043 seconds
[0m15:11:42.043352 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.020 seconds
[0m15:11:42.045351 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m15:11:42.046350 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m15:11:42.047350 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A3E3710>]}
[0m15:11:42.047350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4A932390>]}
[0m15:11:42.048349 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m15:11:42.048349 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.025 seconds
[0m15:11:42.049853 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m15:11:42.048349 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.43s]
[0m15:11:42.051862 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m15:11:42.052863 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m15:11:42.053865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4AC81050>]}
[0m15:11:42.054859 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m15:11:42.055859 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m15:11:42.219882 [debug] [Thread-3 (]: SQL status: BEGIN in 0.184 seconds
[0m15:11:42.220884 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.220884 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m15:11:42.254773 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:11:42.257798 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.258780 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m15:11:42.288692 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m15:11:42.290691 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.291692 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m15:11:42.326855 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m15:11:42.328856 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:11:42.328856 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.328856 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m15:11:42.355440 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m15:11:42.357442 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m15:11:42.358406 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m15:11:42.359405 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m15:11:42.389404 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.030 seconds
[0m15:11:42.391421 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m15:11:42.391421 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '453570a5-59d8-403e-963a-6c68cb66ccef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4AD9ACD0>]}
[0m15:11:42.392405 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.37s]
[0m15:11:42.393405 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m15:11:42.394406 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:42.395407 [debug] [MainThread]: On master: BEGIN
[0m15:11:42.395407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:42.616554 [debug] [MainThread]: SQL status: BEGIN in 0.220 seconds
[0m15:11:42.617553 [debug] [MainThread]: On master: COMMIT
[0m15:11:42.617553 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:42.618552 [debug] [MainThread]: On master: COMMIT
[0m15:11:42.622659 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:11:42.622659 [debug] [MainThread]: On master: Close
[0m15:11:42.623633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:42.623633 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m15:11:42.624561 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m15:11:42.624561 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m15:11:42.624561 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m15:11:42.624561 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m15:11:42.625552 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m15:11:42.625552 [info ] [MainThread]: 
[0m15:11:42.626551 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m15:11:42.627551 [debug] [MainThread]: Command end result
[0m15:11:42.648662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m15:11:42.654179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m15:11:42.664185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m15:11:42.665178 [info ] [MainThread]: 
[0m15:11:42.666177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:42.667178 [info ] [MainThread]: 
[0m15:11:42.668181 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:11:42.670177 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:42.670177 after 2.98 seconds
[0m15:11:42.671237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF48F9F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF444B1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF444B1C10>]}
[0m15:11:42.671237 [debug] [MainThread]: Flushing usage events
[0m15:11:43.527894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:28.528647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD41585550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4139F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD415DA210>]}


============================== 16:45:28.533664 | f5e06e44-ad8e-4172-81a1-0d2b0539a449 ==============================
[0m16:45:28.533664 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:45:28.534649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:28.693663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e06e44-ad8e-4172-81a1-0d2b0539a449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD416CA450>]}
[0m16:45:28.719194 [debug] [MainThread]: Command `dbt clean` succeeded at 16:45:28.718214 after 0.26 seconds
[0m16:45:28.719194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3B7C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3B7C8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD415C7F50>]}
[0m16:45:28.720193 [debug] [MainThread]: Flushing usage events
[0m16:45:29.774764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:44.018540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167425D3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016746389750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167464834D0>]}


============================== 16:45:44.021541 | a6f9e504-7e00-43d1-88a4-21d0b13cb2c1 ==============================
[0m16:45:44.021541 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:45:44.022540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:45:44.034539 [info ] [MainThread]: dbt version: 1.9.2
[0m16:45:44.035539 [info ] [MainThread]: python version: 3.11.9
[0m16:45:44.035539 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m16:45:44.036587 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m16:45:44.101717 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m16:45:44.102713 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m16:45:44.103714 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m16:45:44.104685 [info ] [MainThread]: adapter type: postgres
[0m16:45:44.104685 [info ] [MainThread]: adapter version: 1.9.0
[0m16:45:44.173946 [info ] [MainThread]: Configuration:
[0m16:45:44.175821 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:45:44.175821 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:45:44.176818 [info ] [MainThread]: Required dependencies:
[0m16:45:44.176818 [debug] [MainThread]: Executing "git --help"
[0m16:45:44.222365 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:45:44.222365 [debug] [MainThread]: STDERR: "b''"
[0m16:45:44.223351 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:45:44.223351 [info ] [MainThread]: Connection:
[0m16:45:44.224332 [info ] [MainThread]:   host: 172.16.0.239
[0m16:45:44.225335 [info ] [MainThread]:   port: 5432
[0m16:45:44.225335 [info ] [MainThread]:   user: dmx-op-user
[0m16:45:44.225335 [info ] [MainThread]:   database: operacoes
[0m16:45:44.226375 [info ] [MainThread]:   schema: public
[0m16:45:44.226375 [info ] [MainThread]:   connect_timeout: 10
[0m16:45:44.227362 [info ] [MainThread]:   role: None
[0m16:45:44.227362 [info ] [MainThread]:   search_path: None
[0m16:45:44.228354 [info ] [MainThread]:   keepalives_idle: 0
[0m16:45:44.228354 [info ] [MainThread]:   sslmode: None
[0m16:45:44.229333 [info ] [MainThread]:   sslcert: None
[0m16:45:44.229333 [info ] [MainThread]:   sslkey: None
[0m16:45:44.230333 [info ] [MainThread]:   sslrootcert: None
[0m16:45:44.230333 [info ] [MainThread]:   application_name: dbt
[0m16:45:44.231332 [info ] [MainThread]:   retries: 1
[0m16:45:44.231332 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:45:44.502152 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:45:44.552751 [debug] [MainThread]: Using postgres connection "debug"
[0m16:45:44.553767 [debug] [MainThread]: On debug: select 1 as id
[0m16:45:44.553767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:44.601229 [debug] [MainThread]: SQL status: SELECT 1 in 0.047 seconds
[0m16:45:44.602228 [debug] [MainThread]: On debug: Close
[0m16:45:44.603214 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:45:44.604212 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:45:44.605211 [debug] [MainThread]: Command `dbt debug` succeeded at 16:45:44.605211 after 0.66 seconds
[0m16:45:44.605211 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:45:44.606211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016740741BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001674629FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016746378ED0>]}
[0m16:45:44.606211 [debug] [MainThread]: Flushing usage events
[0m16:45:45.197107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:52.070495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8D856D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8AB9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8D87750>]}


============================== 16:45:52.074511 | 6d7d462c-2971-49a7-987b-ac02e44a6db4 ==============================
[0m16:45:52.074511 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:45:52.075494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:52.224310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8EF3110>]}
[0m16:45:52.263380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB4E38E50>]}
[0m16:45:52.264375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:45:52.453644 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:45:52.455543 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:45:52.456591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA1AF990>]}
[0m16:45:53.181376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB70AC550>]}
[0m16:45:53.225070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m16:45:53.230309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m16:45:53.248841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA252D10>]}
[0m16:45:53.248841 [info ] [MainThread]: Found 5 models, 9 sources, 433 macros
[0m16:45:53.249842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA00ACD0>]}
[0m16:45:53.250842 [info ] [MainThread]: 
[0m16:45:53.251842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:53.252840 [info ] [MainThread]: 
[0m16:45:53.252840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:53.256874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m16:45:53.309396 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m16:45:53.310396 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m16:45:53.310396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:53.361951 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m16:45:53.362938 [debug] [ThreadPool]: On list_operacoes: Close
[0m16:45:53.365045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m16:45:53.368935 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m16:45:53.369935 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m16:45:53.369935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:53.403141 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:45:53.404576 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m16:45:53.405591 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:45:53.413365 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.007 seconds
[0m16:45:53.415366 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m16:45:53.419372 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m16:45:53.428362 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.429379 [debug] [MainThread]: On master: BEGIN
[0m16:45:53.429379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:53.494164 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m16:45:53.494164 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.495154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:53.505162 [debug] [MainThread]: SQL status: SELECT 16 in 0.010 seconds
[0m16:45:53.507211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB888E590>]}
[0m16:45:53.508210 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:53.512181 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.512181 [debug] [MainThread]: On master: BEGIN
[0m16:45:53.520458 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:45:53.520458 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.521472 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.521472 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.525569 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:45:53.525569 [debug] [MainThread]: On master: Close
[0m16:45:53.531472 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m16:45:53.532472 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m16:45:53.532472 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m16:45:53.533471 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m16:45:53.533471 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m16:45:53.534472 [info ] [Thread-2 (]: 2 of 5 START sql view model public.dim_sacados ................................. [RUN]
[0m16:45:53.535471 [info ] [Thread-3 (]: 3 of 5 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m16:45:53.536470 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m16:45:53.535471 [info ] [Thread-4 (]: 4 of 5 START sql view model public.fato_operacoes .............................. [RUN]
[0m16:45:53.536968 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m16:45:53.537568 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m16:45:53.537568 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m16:45:53.538584 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m16:45:53.538584 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m16:45:53.538584 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m16:45:53.543601 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.544582 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m16:45:53.545864 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m16:45:53.547911 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.552911 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m16:45:53.553910 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m16:45:53.553910 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m16:45:53.554910 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m16:45:53.579911 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.580912 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m16:45:53.585990 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m16:45:53.588910 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.591915 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m16:45:53.594977 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.595977 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m16:45:53.595977 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.595977 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.596977 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.596977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:53.596977 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m16:45:53.597977 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m16:45:53.597977 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m16:45:53.598979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:53.598979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:45:53.599978 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:53.631804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m16:45:53.632686 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.633685 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m16:45:53.641780 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m16:45:53.642685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:45:53.643683 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:45:53.643683 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.644732 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.650682 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.651686 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m16:45:53.651686 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m16:45:53.652813 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m16:45:53.656083 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m16:45:53.657066 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:45:53.657066 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.660085 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.661067 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:45:53.661067 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m16:45:53.662066 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:45:53.662066 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m16:45:53.665081 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.668081 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.669082 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m16:45:53.670356 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m16:45:53.672177 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:45:53.673187 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:45:53.677184 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.678186 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:45:53.678186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:45:53.690377 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m16:45:53.691372 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m16:45:53.692825 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.694864 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.695716 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.696166 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m16:45:53.696166 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m16:45:53.697173 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m16:45:53.700170 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:45:53.700170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:45:53.702172 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.702172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:45:53.704188 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m16:45:53.705172 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m16:45:53.705675 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m16:45:53.706681 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.707681 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.707681 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m16:45:53.707681 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m16:45:53.712961 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:45:53.713965 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m16:45:53.713965 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.713965 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m16:45:53.720445 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m16:45:53.725431 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m16:45:53.729429 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m16:45:53.729429 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m16:45:53.732428 [debug] [Thread-4 (]: SQL status: COMMIT in 0.017 seconds
[0m16:45:53.732428 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m16:45:53.732428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m16:45:53.734428 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m16:45:53.736428 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m16:45:53.738431 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m16:45:53.738431 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m16:45:53.739430 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m16:45:53.740429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m16:45:53.740802 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m16:45:53.740802 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m16:45:53.741808 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m16:45:53.763963 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m16:45:53.763963 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m16:45:53.766114 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m16:45:53.768110 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m16:45:53.770109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA96F410>]}
[0m16:45:53.770109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA926290>]}
[0m16:45:53.771109 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:53.772129 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m16:45:53.772129 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m16:45:53.773109 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m16:45:53.773109 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m16:45:53.774170 [info ] [Thread-3 (]: 5 of 5 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m16:45:53.775112 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m16:45:53.775112 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m16:45:53.778129 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.778129 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m16:45:53.779111 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m16:45:53.779111 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.037 seconds
[0m16:45:53.783110 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.785113 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m16:45:53.787110 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m16:45:53.788111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA850750>]}
[0m16:45:53.788827 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.788827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA83F410>]}
[0m16:45:53.791846 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m16:45:53.789839 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:45:53.792846 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:45:53.792846 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:45:53.793845 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m16:45:53.794844 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m16:45:53.841393 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m16:45:53.842395 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.842395 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m16:45:53.851376 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:45:53.853395 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.854392 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m16:45:53.858391 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:45:53.860392 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.861394 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m16:45:53.865392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:45:53.867392 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m16:45:53.867392 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.867392 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m16:45:53.882376 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m16:45:53.885377 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m16:45:53.885377 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m16:45:53.886377 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m16:45:53.909219 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.023 seconds
[0m16:45:53.910221 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m16:45:53.911241 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d462c-2971-49a7-987b-ac02e44a6db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA9123D0>]}
[0m16:45:53.912222 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:45:53.912222 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m16:45:53.914221 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.914221 [debug] [MainThread]: On master: BEGIN
[0m16:45:53.914221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:53.964218 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m16:45:53.964218 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.965219 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:53.965219 [debug] [MainThread]: On master: COMMIT
[0m16:45:53.968219 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:45:53.968219 [debug] [MainThread]: On master: Close
[0m16:45:53.969219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:53.969219 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m16:45:53.970222 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m16:45:53.970222 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m16:45:53.970222 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m16:45:53.970222 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m16:45:53.971221 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m16:45:53.971221 [info ] [MainThread]: 
[0m16:45:53.972220 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m16:45:53.973220 [debug] [MainThread]: Command end result
[0m16:45:53.988221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m16:45:53.991226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m16:45:53.997225 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m16:45:53.998224 [info ] [MainThread]: 
[0m16:45:53.998224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:53.999226 [info ] [MainThread]: 
[0m16:45:53.999226 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:45:54.001226 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:54.001226 after 1.99 seconds
[0m16:45:54.002237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8DE5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBBA872310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBB8DE5E10>]}
[0m16:45:54.002237 [debug] [MainThread]: Flushing usage events
[0m16:45:54.767705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:46.930975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC61585250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC615D9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC615DB310>]}


============================== 09:14:46.945975 | b74c44c3-5bfc-4694-a0b6-4297863f6c06 ==============================
[0m09:14:46.945975 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:14:46.946975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:14:47.127254 [info ] [MainThread]: dbt version: 1.9.2
[0m09:14:47.128254 [info ] [MainThread]: python version: 3.11.9
[0m09:14:47.129256 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m09:14:47.130255 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m09:14:47.417221 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m09:14:47.418223 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m09:14:47.419126 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m09:14:47.425231 [info ] [MainThread]: adapter type: postgres
[0m09:14:47.426135 [info ] [MainThread]: adapter version: 1.9.0
[0m09:14:47.496865 [info ] [MainThread]: Configuration:
[0m09:14:47.497843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:14:47.498843 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:14:47.498843 [info ] [MainThread]: Required dependencies:
[0m09:14:47.499843 [debug] [MainThread]: Executing "git --help"
[0m09:14:47.545843 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:14:47.546844 [debug] [MainThread]: STDERR: "b''"
[0m09:14:47.546844 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:14:47.547843 [info ] [MainThread]: Connection:
[0m09:14:47.547843 [info ] [MainThread]:   host: 172.16.0.239
[0m09:14:47.548842 [info ] [MainThread]:   port: 5432
[0m09:14:47.548842 [info ] [MainThread]:   user: dmx-op-user
[0m09:14:47.549843 [info ] [MainThread]:   database: operacoes
[0m09:14:47.550850 [info ] [MainThread]:   schema: public
[0m09:14:47.550850 [info ] [MainThread]:   connect_timeout: 10
[0m09:14:47.551849 [info ] [MainThread]:   role: None
[0m09:14:47.551849 [info ] [MainThread]:   search_path: None
[0m09:14:47.552850 [info ] [MainThread]:   keepalives_idle: 0
[0m09:14:47.552850 [info ] [MainThread]:   sslmode: None
[0m09:14:47.553850 [info ] [MainThread]:   sslcert: None
[0m09:14:47.554851 [info ] [MainThread]:   sslkey: None
[0m09:14:47.555852 [info ] [MainThread]:   sslrootcert: None
[0m09:14:47.555852 [info ] [MainThread]:   application_name: dbt
[0m09:14:47.556848 [info ] [MainThread]:   retries: 1
[0m09:14:47.556848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:14:47.883248 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:14:50.615809 [debug] [MainThread]: Using postgres connection "debug"
[0m09:14:50.616808 [debug] [MainThread]: On debug: select 1 as id
[0m09:14:50.616808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:50.654800 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m09:14:50.655825 [debug] [MainThread]: On debug: Close
[0m09:14:50.656798 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:14:50.657798 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:14:50.658799 [debug] [MainThread]: Command `dbt debug` succeeded at 09:14:50.658799 after 3.80 seconds
[0m09:14:50.658799 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:14:50.659799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6139FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC617BC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5B7C9950>]}
[0m09:14:50.660802 [debug] [MainThread]: Flushing usage events
[0m09:14:52.004204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:56.865273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DE485010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DE4DA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DE4DA490>]}


============================== 09:14:56.868380 | 2dd735d6-cfcd-4c06-b093-f8622a35b9dd ==============================
[0m09:14:56.868380 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:14:56.869391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:14:57.108592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DE5F3810>]}
[0m09:14:57.146590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DA608690>]}
[0m09:14:57.147592 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:14:57.356025 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:14:58.157932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:14:58.158928 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\cedentesconsolidado.sql
[0m09:14:58.159911 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m09:14:58.398700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DEC6A110>]}
[0m09:14:58.441707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:14:58.463942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:14:58.509009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DEDFD590>]}
[0m09:14:58.510010 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:14:58.511009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DECE4C10>]}
[0m09:14:58.512045 [info ] [MainThread]: 
[0m09:14:58.513065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:14:58.513065 [info ] [MainThread]: 
[0m09:14:58.514010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:14:58.517024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:14:58.570010 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:14:58.570010 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:14:58.571009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:58.638482 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m09:14:58.642481 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:14:58.646469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:14:58.657578 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:14:58.658471 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:14:58.658471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:58.709833 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m09:14:58.710835 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:14:58.711833 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:14:58.719836 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m09:14:58.722830 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:14:58.727767 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:14:58.739887 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:58.739887 [debug] [MainThread]: On master: BEGIN
[0m09:14:58.740889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:58.775312 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m09:14:58.776229 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:58.776229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:14:58.785581 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m09:14:58.787588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DC7A3A10>]}
[0m09:14:58.787588 [debug] [MainThread]: On master: ROLLBACK
[0m09:14:58.791689 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:58.792589 [debug] [MainThread]: On master: BEGIN
[0m09:14:58.799357 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:14:58.799357 [debug] [MainThread]: On master: COMMIT
[0m09:14:58.800310 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:58.800310 [debug] [MainThread]: On master: COMMIT
[0m09:14:58.804074 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:14:58.805059 [debug] [MainThread]: On master: Close
[0m09:14:58.813344 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:14:58.814344 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:14:58.815341 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:14:58.815341 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:14:58.816344 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:14:58.817366 [info ] [Thread-2 (]: 2 of 5 START sql view model public.dim_sacados ................................. [RUN]
[0m09:14:58.818343 [info ] [Thread-3 (]: 3 of 5 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:14:58.820345 [info ] [Thread-4 (]: 4 of 5 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:14:58.821342 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:14:58.822341 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:14:58.823340 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:14:58.823340 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m09:14:58.824345 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:14:58.825752 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:14:58.826768 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:14:58.827769 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:14:58.835766 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:58.838767 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:14:58.841797 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:58.893962 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:14:58.894910 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:14:58.895866 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:14:58.895866 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:14:58.919067 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:58.919067 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:14:58.922070 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:14:58.924973 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:58.927973 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:14:58.928975 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:58.928975 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:58.929973 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:58.929973 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:14:58.930975 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:58.930975 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:14:58.930975 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:14:58.931972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:14:58.931972 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:14:58.932972 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:14:58.932972 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:14:58.933973 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:14:58.978222 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m09:14:58.978222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m09:14:58.978222 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m09:14:58.979222 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m09:14:58.979222 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:58.979222 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:58.980221 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:58.980221 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:58.981223 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:14:58.981223 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:14:58.982227 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:14:58.982227 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:14:58.990620 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:14:58.991620 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:14:58.991620 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:14:58.991620 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:14:58.997222 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:59.000227 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:59.002226 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:59.006227 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:59.006227 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:14:59.007228 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:14:59.008227 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:14:59.008227 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:14:59.013227 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:14:59.014226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:14:59.014226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:14:59.014226 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:14:59.017229 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:59.019229 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:59.022226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:59.025227 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:59.025227 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:14:59.025227 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:14:59.026229 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:14:59.026229 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:14:59.029225 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:14:59.030228 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:14:59.030228 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:14:59.030228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:14:59.041225 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:14:59.042225 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:14:59.043225 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:14:59.045228 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:14:59.045228 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:59.045228 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:59.046228 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:59.046228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:59.047227 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:14:59.047227 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:14:59.047227 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:14:59.048228 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:14:59.075225 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m09:14:59.079226 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:14:59.083229 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:14:59.083229 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:14:59.086230 [debug] [Thread-4 (]: SQL status: COMMIT in 0.038 seconds
[0m09:14:59.087231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m09:14:59.087231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m09:14:59.088229 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:14:59.090229 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:14:59.092232 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:14:59.092232 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:14:59.093230 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:14:59.094231 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:14:59.094231 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:14:59.094231 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:14:59.095231 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:14:59.098289 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:14:59.100293 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:14:59.107289 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DE904B90>]}
[0m09:14:59.108290 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.28s]
[0m09:14:59.109289 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:14:59.109289 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:14:59.110290 [info ] [Thread-3 (]: 5 of 5 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:14:59.110290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:14:59.111290 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:14:59.113289 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.114289 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:14:59.118289 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.118289 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:14:59.119289 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:14:59.120292 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.120292 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:14:59.121291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E0176F10>]}
[0m09:14:59.121291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:14:59.122290 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:14:59.123292 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:14:59.135290 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.039 seconds
[0m09:14:59.136294 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.040 seconds
[0m09:14:59.137289 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:14:59.138291 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:14:59.139291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E0194BD0>]}
[0m09:14:59.140291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E020BF90>]}
[0m09:14:59.140291 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.32s]
[0m09:14:59.141290 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:14:59.141290 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m09:14:59.142291 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:14:59.163289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m09:14:59.163289 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.164291 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:14:59.173670 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:14:59.176688 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.177669 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:14:59.181693 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:14:59.183713 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.184702 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:14:59.188701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:14:59.189700 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:14:59.190698 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.190698 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:14:59.206994 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m09:14:59.210985 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:14:59.211986 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:14:59.211986 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:14:59.230142 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:14:59.232160 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:14:59.232160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd735d6-cfcd-4c06-b093-f8622a35b9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DEBFBCD0>]}
[0m09:14:59.233140 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:14:59.234141 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:14:59.236141 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:59.236141 [debug] [MainThread]: On master: BEGIN
[0m09:14:59.236141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:14:59.264957 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m09:14:59.264957 [debug] [MainThread]: On master: COMMIT
[0m09:14:59.265955 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:59.265955 [debug] [MainThread]: On master: COMMIT
[0m09:14:59.270495 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:14:59.271497 [debug] [MainThread]: On master: Close
[0m09:14:59.271497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:59.272499 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:14:59.272499 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:14:59.272499 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:14:59.273498 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:14:59.273498 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:14:59.273498 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:14:59.273498 [info ] [MainThread]: 
[0m09:14:59.274498 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m09:14:59.275496 [debug] [MainThread]: Command end result
[0m09:14:59.290502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:14:59.293501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:14:59.299129 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:14:59.300129 [info ] [MainThread]: 
[0m09:14:59.300129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:14:59.301059 [info ] [MainThread]: 
[0m09:14:59.301059 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:14:59.302085 [debug] [MainThread]: Command `dbt run` succeeded at 09:14:59.302085 after 2.50 seconds
[0m09:14:59.302085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D8741C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D86C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D86C8D50>]}
[0m09:14:59.303115 [debug] [MainThread]: Flushing usage events
[0m09:15:00.057946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:02.696999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5668DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56589510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56588AD0>]}


============================== 09:16:02.699998 | 910f52a2-3d8c-41dd-9f42-a704d2db06dd ==============================
[0m09:16:02.699998 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:16:02.700998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:16:02.855927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D567F3510>]}
[0m09:16:02.893821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D516E9890>]}
[0m09:16:02.894823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:03.070331 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:16:03.169249 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m09:16:03.170251 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:16:03.170251 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\cedentesconsolidado.sql
[0m09:16:03.332168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56703E50>]}
[0m09:16:03.375888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:16:03.380819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:16:03.397776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56EFFE50>]}
[0m09:16:03.398777 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:16:03.399777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56DEAB50>]}
[0m09:16:03.400777 [info ] [MainThread]: 
[0m09:16:03.401777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:03.402777 [info ] [MainThread]: 
[0m09:16:03.402777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:03.406777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:16:03.457702 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:16:03.458693 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:16:03.458693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:03.493814 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m09:16:03.495861 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:16:03.499761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:16:03.506757 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:16:03.507758 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:16:03.508758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:03.567397 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m09:16:03.568499 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:16:03.569505 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:16:03.577483 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m09:16:03.581496 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:16:03.586542 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:16:03.598683 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:03.599687 [debug] [MainThread]: On master: BEGIN
[0m09:16:03.600688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:03.653430 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m09:16:03.653430 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:03.654430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:03.663612 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m09:16:03.668704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D582507D0>]}
[0m09:16:03.669709 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:03.674426 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:03.675547 [debug] [MainThread]: On master: BEGIN
[0m09:16:03.684452 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:16:03.685545 [debug] [MainThread]: On master: COMMIT
[0m09:16:03.686446 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:03.687544 [debug] [MainThread]: On master: COMMIT
[0m09:16:03.691666 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:16:03.693682 [debug] [MainThread]: On master: Close
[0m09:16:03.701295 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:03.702316 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:16:03.704292 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:03.704292 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:03.706402 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:16:03.707294 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:16:03.708302 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:16:03.710290 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:16:03.712291 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:16:03.713292 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:16:03.714292 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:16:03.715292 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:16:03.716290 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:03.717288 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:16:03.717288 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:03.718287 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:03.727302 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.730302 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:16:03.734287 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:03.737319 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.737991 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:03.739067 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:16:03.764730 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.765635 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:03.767751 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:16:03.768735 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:03.771635 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:03.772636 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.776634 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.776634 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.777635 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:16:03.777635 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:03.778660 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:16:03.778660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:16:03.779635 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.779635 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:16:03.779635 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:16:03.780676 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:16:03.781635 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:16:03.782634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:16:03.813611 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m09:16:03.813611 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.814612 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:16:03.817609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m09:16:03.818610 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.819607 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:16:03.832607 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:16:03.832607 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:16:03.841618 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.848613 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.849615 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:16:03.850615 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m09:16:03.852125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m09:16:03.853195 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:16:03.854161 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:03.854161 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.855134 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'YYYY-MM-DD') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        primeira_operacao AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'YYYY-MM-DD') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        timestamp_extracao AS timestamp_extracao
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        primeira_operacao AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente,
    cc.timestamp_extracao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
  );
[0m09:16:03.856256 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:16:03.858132 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:16:03.859133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:16:03.861134 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.865134 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.866133 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                       ^

[0m09:16:03.867134 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:16:03.868133 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:16:03.868133 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:16:03.869153 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:16:03.871199 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.872134 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:16:03.876126 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:03.876126 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:16:03.877139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:03.918144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:16:03.930143 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:16:03.933143 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.935144 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:16:03.935144 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.937145 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:16:03.936146 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:16:03.936146 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.937145 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:16:03.942151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:03.943152 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:16:03.944152 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.944152 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:16:03.959658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m09:16:03.964659 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:16:03.967659 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:03.968660 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:16:03.971682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m09:16:03.972659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m09:16:03.974674 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:16:03.976673 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:16:03.976673 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:03.977683 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:03.978657 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:16:03.978657 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:16:03.983693 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:16:03.985694 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:16:03.987732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D58251690>]}
[0m09:16:03.988693 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.27s]
[0m09:16:03.989694 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:03.989694 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:16:03.989694 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:16:03.990694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:16:03.990694 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:16:03.993693 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:16:03.994694 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:16:03.996694 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:16:03.997701 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:16:03.997701 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:16:03.998693 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:16:03.999694 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:16:03.999694 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.000694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5822B6D0>]}
[0m09:16:04.001694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5831E590>]}
[0m09:16:04.001694 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:16:04.002693 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:16:04.003693 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:16:04.002693 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:16:04.004694 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:16:04.005692 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:04.005692 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:16:04.006692 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:16:04.008696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:16:04.008696 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:16:04.012692 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.013694 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:16:04.016693 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.018694 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.018694 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:16:04.019696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:04.030695 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:16:04.030695 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D58384650>]}
[0m09:16:04.031695 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.32s]
[0m09:16:04.032693 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:04.033694 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:16:04.034693 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m09:16:04.034693 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.035726 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:16:04.043275 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:16:04.046276 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.046276 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:16:04.051276 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:04.056772 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.056772 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:16:04.060756 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:04.062758 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:16:04.062758 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.063756 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:16:04.073092 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m09:16:04.074077 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.074077 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:16:04.080092 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m09:16:04.082091 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:16:04.083092 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:04.083092 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:16:04.084075 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:16:04.087078 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.087078 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:16:04.091260 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:04.094472 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.094472 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:16:04.099258 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:04.100308 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:16:04.101273 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.101273 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:16:04.103439 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:16:04.105320 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:16:04.105320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56589410>]}
[0m09:16:04.106318 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m09:16:04.107322 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:16:04.116324 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m09:16:04.120428 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:16:04.121413 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:04.122385 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:16:04.140042 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:16:04.143393 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:16:04.144395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910f52a2-3d8c-41dd-9f42-a704d2db06dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D56803390>]}
[0m09:16:04.145486 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:16:04.146393 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:16:04.148393 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:04.148393 [debug] [MainThread]: On master: BEGIN
[0m09:16:04.150392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:04.182197 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:16:04.183183 [debug] [MainThread]: On master: COMMIT
[0m09:16:04.184183 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:04.184183 [debug] [MainThread]: On master: COMMIT
[0m09:16:04.188180 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:16:04.188180 [debug] [MainThread]: On master: Close
[0m09:16:04.189184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:04.189184 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:16:04.189184 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:16:04.190179 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:16:04.190179 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:16:04.190179 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:16:04.191181 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:16:04.191181 [info ] [MainThread]: 
[0m09:16:04.192181 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m09:16:04.193181 [debug] [MainThread]: Command end result
[0m09:16:04.210181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:16:04.213198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:16:04.218288 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:16:04.219183 [info ] [MainThread]: 
[0m09:16:04.221181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:16:04.221181 [info ] [MainThread]: 
[0m09:16:04.222183 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:16:04.223181 [info ] [MainThread]: 
[0m09:16:04.224182 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:16:04.225182 [debug] [MainThread]: Command `dbt run` failed at 09:16:04.225182 after 1.58 seconds
[0m09:16:04.225182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5648F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D508C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5668DCD0>]}
[0m09:16:04.226181 [debug] [MainThread]: Flushing usage events
[0m09:16:05.431430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:26.326943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE58E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE58E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE58E490>]}


============================== 09:16:26.330945 | b67c036e-f968-49dd-89ac-d8473cfa015e ==============================
[0m09:16:26.330945 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:16:26.331943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:16:26.483974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE618E90>]}
[0m09:16:26.524975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB9679390>]}
[0m09:16:26.525975 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:26.709160 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:16:26.801740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:26.802750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:26.823737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE701910>]}
[0m09:16:26.869746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:16:26.873648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:16:26.888798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBEC8DF10>]}
[0m09:16:26.889762 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:16:26.889762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE9F35D0>]}
[0m09:16:26.891763 [info ] [MainThread]: 
[0m09:16:26.892760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:26.892760 [info ] [MainThread]: 
[0m09:16:26.893762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:26.897777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:16:26.952762 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:16:26.952762 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:16:26.953762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:27.005978 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m09:16:27.008857 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:16:27.013859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:16:27.023852 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:16:27.023852 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:16:27.024852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:27.083708 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m09:16:27.084723 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:16:27.084723 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:16:27.094711 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.008 seconds
[0m09:16:27.097711 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:16:27.102655 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:16:27.116256 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.117250 [debug] [MainThread]: On master: BEGIN
[0m09:16:27.118248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:27.182133 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m09:16:27.184134 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.185151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:27.195437 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m09:16:27.201462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBEA00AD0>]}
[0m09:16:27.202466 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:27.206532 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.207644 [debug] [MainThread]: On master: BEGIN
[0m09:16:27.217968 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:16:27.218940 [debug] [MainThread]: On master: COMMIT
[0m09:16:27.219945 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.220942 [debug] [MainThread]: On master: COMMIT
[0m09:16:27.226433 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:16:27.227457 [debug] [MainThread]: On master: Close
[0m09:16:27.234993 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:27.234993 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:16:27.235995 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:27.237013 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:27.238023 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:16:27.239007 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:16:27.240994 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:16:27.241993 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:16:27.242991 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:16:27.243990 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:16:27.244995 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:16:27.245991 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:16:27.246820 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:27.247830 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:16:27.247830 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:27.248831 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:27.258825 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.262832 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:16:27.265832 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:27.267833 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.269833 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:27.269833 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:16:27.270832 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:27.294458 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.295345 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:27.297445 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:16:27.300344 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:27.303476 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.304345 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.305345 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.305345 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:27.305345 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:16:27.306345 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.307343 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:16:27.307343 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:16:27.307343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:16:27.308344 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:16:27.308344 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:16:27.309343 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:16:27.309343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:16:27.347867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m09:16:27.348866 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.348866 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:16:27.359318 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:16:27.364322 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.365322 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m09:16:27.365322 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m09:16:27.365322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m09:16:27.366323 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:16:27.366323 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.367323 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:16:27.367323 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.367323 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:16:27.368324 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'YYYY-MM-DD') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        primeira_operacao AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'YYYY-MM-DD') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        timestamp_extracao AS timestamp_extracao
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        primeira_operacao AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente,
    cc.timestamp_extracao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
  );
[0m09:16:27.368324 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:16:27.370865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:16:27.372869 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.373868 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:16:27.374869 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:16:27.374869 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                       ^

[0m09:16:27.377374 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.377374 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:16:27.378379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:27.381379 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:16:27.381379 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:16:27.384379 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.396379 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:16:27.396379 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:16:27.397380 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.398381 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:16:27.399379 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:16:27.400381 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:16:27.401379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:16:27.403380 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.405381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.406379 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:16:27.406379 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:16:27.409381 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:16:27.410382 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBEC8FC90>]}
[0m09:16:27.411382 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.16s]
[0m09:16:27.412380 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:16:27.412380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:16:27.412380 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:16:27.413380 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:16:27.415380 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:16:27.415380 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:16:27.416380 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.416380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.416380 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:16:27.417380 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:16:27.418379 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:16:27.418379 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:16:27.419380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:16:27.420380 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:16:27.424381 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:16:27.425381 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m09:16:27.426384 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:16:27.432380 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:16:27.436379 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:16:27.436379 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m09:16:27.440379 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:16:27.444381 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:16:27.445110 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.445110 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:16:27.446121 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:16:27.447121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m09:16:27.447121 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:16:27.448121 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:16:27.451123 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:16:27.452122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:16:27.453121 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:16:27.454122 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:16:27.463014 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:16:27.465014 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:16:27.466014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBF224C10>]}
[0m09:16:27.467015 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m09:16:27.468017 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:16:27.468017 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:16:27.469024 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:16:27.469024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:16:27.470018 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:16:27.473016 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.474016 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:16:27.476017 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.477522 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:16:27.477522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:16:27.478527 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:16:27.479530 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:16:27.480529 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.480529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBF20D090>]}
[0m09:16:27.481528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBF259210>]}
[0m09:16:27.481528 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:16:27.482528 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.23s]
[0m09:16:27.483528 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m09:16:27.483528 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:16:27.484528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:16:27.484528 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:16:27.485528 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.486530 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:16:27.487532 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:16:27.496883 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:16:27.500888 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.501889 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:16:27.505895 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:27.509889 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.509889 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:16:27.514276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:27.515276 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:16:27.516276 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.516276 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:16:27.519277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m09:16:27.519277 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.520279 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:16:27.529276 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:16:27.532276 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.533277 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:16:27.534277 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m09:16:27.536279 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:16:27.537277 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:16:27.537277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:27.537277 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:16:27.540276 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.540276 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:16:27.545179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:16:27.546179 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:16:27.547179 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.547179 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:16:27.563588 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:16:27.564590 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:16:27.565589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBF02ADD0>]}
[0m09:16:27.566615 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:16:27.566615 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:16:27.570486 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m09:16:27.571520 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:16:27.572516 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:16:27.573501 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:16:27.605365 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m09:16:27.606429 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:16:27.607367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67c036e-f968-49dd-89ac-d8473cfa015e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBEF5AE10>]}
[0m09:16:27.607367 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:16:27.608434 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:16:27.610366 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.610366 [debug] [MainThread]: On master: BEGIN
[0m09:16:27.610366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:27.642083 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:16:27.642083 [debug] [MainThread]: On master: COMMIT
[0m09:16:27.643083 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:27.643083 [debug] [MainThread]: On master: COMMIT
[0m09:16:27.646364 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:16:27.647398 [debug] [MainThread]: On master: Close
[0m09:16:27.647398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:27.647398 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:16:27.648372 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:16:27.648372 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:16:27.648372 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:16:27.648372 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:16:27.649403 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:16:27.649403 [info ] [MainThread]: 
[0m09:16:27.650375 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m09:16:27.651372 [debug] [MainThread]: Command end result
[0m09:16:27.720995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:16:27.722996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:16:27.727996 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:16:27.728997 [info ] [MainThread]: 
[0m09:16:27.728997 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:16:27.730295 [info ] [MainThread]: 
[0m09:16:27.730295 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 88: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:16:27.730295 [info ] [MainThread]: 
[0m09:16:27.731386 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:16:27.732387 [debug] [MainThread]: Command `dbt run` failed at 09:16:27.732387 after 1.46 seconds
[0m09:16:27.732387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BB87C9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE9AFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE100C50>]}
[0m09:16:27.733387 [debug] [MainThread]: Flushing usage events
[0m09:16:28.516264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:21.879465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7586390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7478850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A75DA190>]}


============================== 09:17:21.883021 | 8859db6e-01fd-4e34-b83b-81d7306c7e83 ==============================
[0m09:17:21.883021 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:17:21.884018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:17:22.043758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A76F3D50>]}
[0m09:17:22.083267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A77FD050>]}
[0m09:17:22.084284 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:22.267871 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:17:22.367381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:17:22.368402 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:17:22.541949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7C2ACD0>]}
[0m09:17:22.585899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:17:22.589833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:17:22.604793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7DFBE10>]}
[0m09:17:22.604793 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:17:22.605881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A771AB50>]}
[0m09:17:22.607794 [info ] [MainThread]: 
[0m09:17:22.608481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:17:22.608999 [info ] [MainThread]: 
[0m09:17:22.610004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:17:22.612963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:17:22.662068 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:17:22.663069 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:17:22.663069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:22.710772 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m09:17:22.713791 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:17:22.716927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:17:22.722923 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:17:22.722923 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:17:22.723925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:22.771557 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m09:17:22.772553 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:17:22.773554 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:17:22.781562 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m09:17:22.786117 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:17:22.790109 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:17:22.800103 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:22.800103 [debug] [MainThread]: On master: BEGIN
[0m09:17:22.801104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:17:22.841101 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m09:17:22.841101 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:22.842102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:17:22.850101 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m09:17:22.852101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A9148790>]}
[0m09:17:22.853101 [debug] [MainThread]: On master: ROLLBACK
[0m09:17:22.856101 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:22.856101 [debug] [MainThread]: On master: BEGIN
[0m09:17:22.863101 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:17:22.864101 [debug] [MainThread]: On master: COMMIT
[0m09:17:22.864101 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:22.864101 [debug] [MainThread]: On master: COMMIT
[0m09:17:22.868101 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:17:22.869106 [debug] [MainThread]: On master: Close
[0m09:17:22.870105 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:17:22.871105 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:17:22.871105 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:17:22.871105 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:17:22.872105 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:17:22.872105 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:17:22.873107 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:17:22.873107 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:17:22.874107 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:17:22.875105 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:17:22.875105 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:17:22.875105 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:17:22.876106 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:17:22.876106 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:17:22.877105 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:17:22.877105 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:17:22.883610 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:22.887617 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:17:22.891615 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:22.894614 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:22.895616 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:17:22.896617 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:17:22.897620 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:17:22.923618 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:22.923618 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:17:22.927615 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:17:22.929616 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:22.932614 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:22.933615 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:22.933615 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:22.934615 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:17:22.934615 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:22.935615 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:22.935615 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:17:22.935615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:17:22.936616 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:17:22.936616 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:17:22.937615 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:17:22.937615 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:17:22.938621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:17:22.968980 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m09:17:22.968980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:17:22.970010 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:22.970364 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:22.970364 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'YYYY-MM-DD') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        primeira_operacao AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'YYYY-MM-DD') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        timestamp_extracao AS timestamp_extracao
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        primeira_operacao AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente,
    cc.timestamp_extracao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:17:22.971372 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:17:22.979531 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m09:17:22.980518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:17:22.980518 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:22.981515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m09:17:22.982538 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:17:22.990065 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:22.991065 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:17:22.992051 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:22.995066 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:22.996041 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:17:22.997056 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:17:22.998077 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:17:23.002225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.003242 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:17:23.004243 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.007688 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:23.007688 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:17:23.011677 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:23.028766 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:17:23.029713 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:17:23.073789 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:23.073789 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:17:23.074788 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:23.075802 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:17:23.075802 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:17:23.079787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:17:23.079787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.079787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:17:23.081895 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:23.084408 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:23.086509 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:17:23.087513 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:17:23.087513 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:17:23.088408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:23.089407 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:17:23.097406 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m09:17:23.097406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:17:23.097406 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:17:23.102422 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:17:23.103405 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:17:23.104407 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:17:23.108423 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:17:23.108423 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:23.109406 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:23.109406 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:17:23.110428 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:17:23.110428 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:17:23.112406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m09:17:23.113408 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:17:23.114408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:17:23.114408 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:17:23.119408 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m09:17:23.120438 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:17:23.121407 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m09:17:23.123424 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:17:23.124421 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:17:23.124421 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:17:23.125424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7E1B310>]}
[0m09:17:23.125424 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.25s]
[0m09:17:23.126423 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:17:23.127445 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:17:23.127445 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:17:23.128407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:17:23.128407 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:17:23.130423 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:17:23.131405 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:17:23.133422 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:17:23.134422 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.134422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:17:23.135408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:17:23.137510 [debug] [Thread-4 (]: SQL status: COMMIT in 0.026 seconds
[0m09:17:23.137510 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:17:23.139541 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:17:23.140547 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:17:23.140547 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:17:23.141523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7A24ED0>]}
[0m09:17:23.141523 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:17:23.142527 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:17:23.143525 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:17:23.143525 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:17:23.144527 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:17:23.145551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m09:17:23.145551 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:17:23.149524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.150525 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:17:23.155524 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.156524 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.031 seconds
[0m09:17:23.157525 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.159525 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:17:23.159525 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:17:23.160527 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7776A50>]}
[0m09:17:23.161525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:23.162525 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:17:23.162525 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:17:23.164526 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:17:23.166524 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:17:23.167524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A7777150>]}
[0m09:17:23.168524 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:17:23.168524 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:17:23.184809 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m09:17:23.185810 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.185810 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:17:23.193809 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:17:23.197826 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.198810 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:17:23.203818 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.206829 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.206829 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:17:23.210808 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:17:23.211812 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:17:23.211812 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.212811 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:17:23.213810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:17:23.214808 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.214808 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:17:23.223808 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:17:23.226811 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.226811 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:17:23.228844 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:17:23.229809 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:17:23.230808 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:17:23.230808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.231809 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:17:23.233812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.233812 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:17:23.237809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:17:23.239808 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:17:23.239808 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.239808 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:17:23.252808 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:17:23.253809 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:17:23.253809 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A9199CD0>]}
[0m09:17:23.254808 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m09:17:23.255809 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:17:23.269811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m09:17:23.271811 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:17:23.272811 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:17:23.272811 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:17:23.295883 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:17:23.297888 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:17:23.298884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8859db6e-01fd-4e34-b83b-81d7306c7e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A9171A50>]}
[0m09:17:23.299884 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:17:23.299884 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:17:23.302885 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:23.303883 [debug] [MainThread]: On master: BEGIN
[0m09:17:23.303883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:17:23.350882 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m09:17:23.351883 [debug] [MainThread]: On master: COMMIT
[0m09:17:23.351883 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:23.351883 [debug] [MainThread]: On master: COMMIT
[0m09:17:23.355882 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:17:23.355882 [debug] [MainThread]: On master: Close
[0m09:17:23.356883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:23.356883 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:17:23.356883 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:17:23.357884 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:17:23.357884 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:17:23.357884 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:17:23.358884 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:17:23.358884 [info ] [MainThread]: 
[0m09:17:23.359883 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m09:17:23.361883 [debug] [MainThread]: Command end result
[0m09:17:23.376905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:17:23.378887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:17:23.384393 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:17:23.385401 [info ] [MainThread]: 
[0m09:17:23.386399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:17:23.386399 [info ] [MainThread]: 
[0m09:17:23.387400 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:17:23.388405 [debug] [MainThread]: Command `dbt run` succeeded at 09:17:23.387400 after 1.56 seconds
[0m09:17:23.388405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A1841C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A73CF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A17C9950>]}
[0m09:17:23.388405 [debug] [MainThread]: Flushing usage events
[0m09:17:24.661807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:33.243064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9418E0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E941DB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E92F9FCD0>]}


============================== 09:18:33.246045 | dbd951d2-84e8-4583-abff-6c28f864cd51 ==============================
[0m09:18:33.246045 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:18:33.247063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:18:33.400722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94201B10>]}
[0m09:18:33.441236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E90209190>]}
[0m09:18:33.442236 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:18:33.623764 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:18:33.730179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:33.731198 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:18:33.897927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E943A8250>]}
[0m09:18:33.943480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:18:33.947505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:18:33.964482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94A09090>]}
[0m09:18:33.964482 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:18:33.965506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E948BD610>]}
[0m09:18:33.967497 [info ] [MainThread]: 
[0m09:18:33.967497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:18:33.968481 [info ] [MainThread]: 
[0m09:18:33.968481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:18:33.972484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:18:34.027026 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:18:34.028044 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:18:34.028044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:34.077026 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m09:18:34.078029 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:18:34.080026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:18:34.084026 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:18:34.085025 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:18:34.085025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:34.113046 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m09:18:34.113046 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:18:34.114032 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:18:34.120211 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m09:18:34.121214 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:18:34.125211 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:18:34.130213 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.130213 [debug] [MainThread]: On master: BEGIN
[0m09:18:34.131214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:34.185211 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:18:34.186211 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.186211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:18:34.194211 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:18:34.196211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E92CEEB90>]}
[0m09:18:34.197211 [debug] [MainThread]: On master: ROLLBACK
[0m09:18:34.200669 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.200669 [debug] [MainThread]: On master: BEGIN
[0m09:18:34.206717 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:18:34.206717 [debug] [MainThread]: On master: COMMIT
[0m09:18:34.207698 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.207698 [debug] [MainThread]: On master: COMMIT
[0m09:18:34.210713 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:18:34.210713 [debug] [MainThread]: On master: Close
[0m09:18:34.213700 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:18:34.213700 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:18:34.214700 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:18:34.215701 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:18:34.215701 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:18:34.216702 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:18:34.220239 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:18:34.217705 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:18:34.221234 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:18:34.222235 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:18:34.217705 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:18:34.226234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:18:34.227231 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:18:34.233231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.234231 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:18:34.235238 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:18:34.238232 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:18:34.238232 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:18:34.239231 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:18:34.243248 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.246233 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.254234 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:18:34.274230 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.276232 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:18:34.276232 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:18:34.279248 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:18:34.283231 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.284231 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.288230 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.289230 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.290232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:18:34.290232 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.291232 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:18:34.291232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:18:34.292246 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.292246 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:18:34.292246 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:18:34.293232 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:18:34.294234 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:18:34.294234 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:18:34.324594 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m09:18:34.324594 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.325616 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:18:34.332616 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:18:34.337633 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.337633 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:18:34.341207 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:18:34.344182 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.344182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:18:34.345164 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m09:18:34.345164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m09:18:34.345164 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:18:34.346163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.347171 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.348170 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.348170 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:18:34.349164 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'YYYY-MM-DD') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        primeira_operacao AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'YYYY-MM-DD') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        primeira_operacao AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:18:34.350165 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:18:34.352273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.361296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:18:34.361296 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:18:34.362281 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:18:34.366284 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:18:34.369294 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.372294 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.418285 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.419284 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.419900 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:18:34.419900 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:18:34.420906 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:18:34.420906 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:18:34.425005 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:18:34.426907 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.426907 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:18:34.427906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:18:34.427906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:18:34.430007 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.431904 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.432905 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:18:34.432905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:18:34.432905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:18:34.434945 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:18:34.435936 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.435936 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:18:34.437904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.438922 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:18:34.438922 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.439904 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.439904 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:18:34.440905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:18:34.441922 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.441922 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:18:34.448920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m09:18:34.454009 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:18:34.457905 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:18:34.457905 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:18:34.461003 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m09:18:34.461003 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m09:18:34.461945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:18:34.463905 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:18:34.465010 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:18:34.467009 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:18:34.467915 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:18:34.469010 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:18:34.469010 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:18:34.470016 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:18:34.470016 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:18:34.470905 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:18:34.472905 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:18:34.474903 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:18:34.476905 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94CF4FD0>]}
[0m09:18:34.477903 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m09:18:34.478904 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:18:34.478904 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:18:34.478904 [info ] [Thread-2 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:18:34.479904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_operacoes)
[0m09:18:34.480906 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:18:34.482906 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:18:34.483906 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:18:34.486906 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:18:34.486906 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.487907 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:18:34.487907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:34.492905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:18:34.493905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:18:34.494906 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94CF4F90>]}
[0m09:18:34.495917 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.26s]
[0m09:18:34.496906 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:18:34.497908 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:18:34.498905 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:18:34.499905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:18:34.499905 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:18:34.503905 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.504909 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:18:34.509908 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.510910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.039 seconds
[0m09:18:34.510910 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.040 seconds
[0m09:18:34.511910 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:18:34.512913 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.513693 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:18:34.514698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94333E10>]}
[0m09:18:34.514698 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:18:34.515698 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94E56750>]}
[0m09:18:34.517984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:18:34.516985 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:18:34.517984 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.29s]
[0m09:18:34.519490 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:18:34.519490 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:18:34.522239 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m09:18:34.522779 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.522779 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:18:34.530859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:18:34.533867 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.534885 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:18:34.538867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.541429 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.541429 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:18:34.545033 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:18:34.546053 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:18:34.547051 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.547051 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:18:34.559997 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m09:18:34.560997 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.562235 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:18:34.569235 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m09:18:34.572758 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:18:34.572758 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:18:34.573812 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:18:34.577867 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.578864 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:18:34.579769 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:18:34.584909 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.587921 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.588920 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:18:34.593324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:18:34.594283 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:18:34.595281 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.595281 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:18:34.599278 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:18:34.600293 [debug] [Thread-2 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:18:34.601279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94078410>]}
[0m09:18:34.601279 [info ] [Thread-2 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:18:34.602647 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:18:34.609279 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m09:18:34.612812 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:18:34.613923 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:18:34.614823 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:18:34.635412 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:18:34.637399 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:18:34.638400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd951d2-84e8-4583-abff-6c28f864cd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E94A0D4D0>]}
[0m09:18:34.638400 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:18:34.639400 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:18:34.641944 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.641944 [debug] [MainThread]: On master: BEGIN
[0m09:18:34.642945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:18:34.678663 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m09:18:34.679661 [debug] [MainThread]: On master: COMMIT
[0m09:18:34.680662 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:34.681166 [debug] [MainThread]: On master: COMMIT
[0m09:18:34.685113 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:18:34.685113 [debug] [MainThread]: On master: Close
[0m09:18:34.686237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:34.687120 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:18:34.687120 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:18:34.687120 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:18:34.688157 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:18:34.688157 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:18:34.688157 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:18:34.689120 [info ] [MainThread]: 
[0m09:18:34.689120 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m09:18:34.691635 [debug] [MainThread]: Command end result
[0m09:18:34.707287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:18:34.710792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:18:34.715814 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:18:34.716797 [info ] [MainThread]: 
[0m09:18:34.717797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:18:34.717797 [info ] [MainThread]: 
[0m09:18:34.717797 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:18:34.719302 [debug] [MainThread]: Command `dbt run` succeeded at 09:18:34.719302 after 1.53 seconds
[0m09:18:34.720849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E92F9F690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8BF71C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8BF71BD0>]}
[0m09:18:34.721859 [debug] [MainThread]: Flushing usage events
[0m09:18:36.043938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:34.028652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9888E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB988DA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9878D450>]}


============================== 09:20:34.033671 | f27b97cb-5575-4f8e-b0a7-4303eaf75193 ==============================
[0m09:20:34.033671 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:34.034652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:20:34.222335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB989F3050>]}
[0m09:20:34.262273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB938D92D0>]}
[0m09:20:34.264272 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:34.447930 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:20:34.563095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:34.564095 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:20:34.731747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98A31990>]}
[0m09:20:34.777748 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:20:34.781863 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:20:34.806865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB99105150>]}
[0m09:20:34.807865 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:20:34.807865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB99042CD0>]}
[0m09:20:34.809866 [info ] [MainThread]: 
[0m09:20:34.809866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:34.810863 [info ] [MainThread]: 
[0m09:20:34.810863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:34.814862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:20:34.869882 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:20:34.870882 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:20:34.870882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:34.910638 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m09:20:34.914521 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:20:34.919523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:20:34.928519 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:20:34.929520 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:20:34.930523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:35.006640 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m09:20:35.008706 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:20:35.009640 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:20:35.018635 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.007 seconds
[0m09:20:35.020682 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:20:35.025740 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:20:35.031627 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.031627 [debug] [MainThread]: On master: BEGIN
[0m09:20:35.032628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:35.084986 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m09:20:35.085982 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.086983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:35.095308 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:20:35.099383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98F29110>]}
[0m09:20:35.100383 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:35.104727 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.104727 [debug] [MainThread]: On master: BEGIN
[0m09:20:35.112607 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:20:35.113452 [debug] [MainThread]: On master: COMMIT
[0m09:20:35.114455 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.114455 [debug] [MainThread]: On master: COMMIT
[0m09:20:35.119458 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:20:35.120455 [debug] [MainThread]: On master: Close
[0m09:20:35.126150 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:35.126150 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:20:35.128153 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:20:35.128153 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:20:35.127168 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:20:35.129151 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:20:35.131150 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:20:35.132150 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:20:35.133150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:20:35.134149 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:20:35.134149 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:20:35.135148 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:20:35.136148 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:35.137149 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:20:35.137149 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:20:35.138149 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:20:35.146163 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.149148 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:20:35.153149 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.157149 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.159151 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:35.179153 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:20:35.183902 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.186672 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:20:35.186672 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:20:35.187573 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:20:35.190618 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.190618 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.193606 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.193606 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.194544 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.194544 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:20:35.195499 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:20:35.195499 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:20:35.196498 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.196498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:20:35.197542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:20:35.197542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:20:35.197542 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:20:35.199499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:20:35.277694 [debug] [Thread-4 (]: SQL status: BEGIN in 0.080 seconds
[0m09:20:35.278730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.081 seconds
[0m09:20:35.278730 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.278730 [debug] [Thread-3 (]: SQL status: BEGIN in 0.080 seconds
[0m09:20:35.279642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m09:20:35.279642 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.280594 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:20:35.280594 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.281594 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.282122 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:20:35.283128 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'YYYY-MM-DD') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        TO_DATE(primeira_operacao, 'YYYY-MM-DD') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'YYYY-MM-DD') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'YYYY-MM-DD') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:20:35.283128 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:20:35.287126 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:20:35.292125 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.293126 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:20:35.293126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:20:35.296126 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.296126 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:20:35.296126 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:20:35.297126 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:20:35.297126 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:35.299126 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.302127 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.303126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:20:35.305126 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.305126 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:20:35.343547 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:20:35.345011 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.346204 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:20:35.347317 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:20:35.349333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.350318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.350318 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:35.351316 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.352318 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.364337 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:20:35.366315 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.367728 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:20:35.367728 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:20:35.367728 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.368940 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:20:35.368940 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.369946 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:20:35.369946 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:20:35.373045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.373045 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.374944 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:20:35.375946 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:20:35.375946 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.376945 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.376945 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:20:35.376945 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:20:35.392613 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m09:20:35.397612 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:20:35.400632 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:20:35.401630 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:20:35.411613 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m09:20:35.411613 [debug] [Thread-2 (]: SQL status: COMMIT in 0.041 seconds
[0m09:20:35.412613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m09:20:35.413615 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:20:35.415614 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:20:35.417615 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:20:35.418615 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:20:35.419614 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:20:35.419614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:20:35.420644 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:20:35.420644 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:20:35.421627 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:20:35.423631 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:20:35.425615 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:20:35.426614 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB99554BD0>]}
[0m09:20:35.427646 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:20:35.428758 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:20:35.428758 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:20:35.429872 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:20:35.430763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:20:35.430763 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:20:35.433777 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:20:35.433777 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:20:35.436778 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:20:35.436778 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:20:35.438949 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:20:35.438949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB99447950>]}
[0m09:20:35.439918 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.439918 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.30s]
[0m09:20:35.440976 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:20:35.440976 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:20:35.441987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:20:35.441987 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:20:35.442987 [info ] [Thread-3 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:20:35.443985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_titulosabertos)
[0m09:20:35.443985 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:20:35.447986 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.448996 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:20:35.448996 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:20:35.449984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:20:35.451987 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:20:35.451987 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:20:35.452986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98A07F90>]}
[0m09:20:35.453984 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98AEF590>]}
[0m09:20:35.456007 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.456985 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m09:20:35.457984 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.32s]
[0m09:20:35.459987 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:20:35.459987 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.461011 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:20:35.461986 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:20:35.463011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:20:35.497769 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m09:20:35.498765 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.499760 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:20:35.507755 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:20:35.512754 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.512754 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:20:35.517013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m09:20:35.517013 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:35.518186 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.521282 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.521282 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:20:35.522185 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:20:35.526645 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:20:35.527650 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:20:35.528647 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.528647 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:20:35.530674 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:20:35.533661 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.533661 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:20:35.538646 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:20:35.542661 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.542661 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:20:35.547548 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m09:20:35.547548 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:20:35.551560 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:20:35.553149 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:20:35.555239 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:20:35.555239 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.556148 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:20:35.557205 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:20:35.573957 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m09:20:35.577955 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:20:35.579944 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:20:35.579944 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:20:35.584848 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:20:35.587867 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:20:35.588866 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98F05450>]}
[0m09:20:35.589864 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:20:35.591916 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:20:35.604513 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:20:35.607508 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:20:35.608508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27b97cb-5575-4f8e-b0a7-4303eaf75193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98F29310>]}
[0m09:20:35.609508 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:20:35.610511 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:20:35.613511 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.613511 [debug] [MainThread]: On master: BEGIN
[0m09:20:35.614511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:35.676515 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m09:20:35.677512 [debug] [MainThread]: On master: COMMIT
[0m09:20:35.678516 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:35.679514 [debug] [MainThread]: On master: COMMIT
[0m09:20:35.682811 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:20:35.683644 [debug] [MainThread]: On master: Close
[0m09:20:35.684644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:35.684644 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:20:35.685642 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:20:35.685642 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:20:35.685642 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:20:35.686641 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:20:35.686641 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:20:35.686641 [info ] [MainThread]: 
[0m09:20:35.687594 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m09:20:35.688510 [debug] [MainThread]: Command end result
[0m09:20:35.704638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:20:35.706642 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:20:35.711529 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:20:35.712530 [info ] [MainThread]: 
[0m09:20:35.713528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:35.714530 [info ] [MainThread]: 
[0m09:20:35.714530 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:20:35.716531 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:35.715530 after 1.75 seconds
[0m09:20:35.716531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB929F9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB929F8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB929F8D50>]}
[0m09:20:35.716531 [debug] [MainThread]: Flushing usage events
[0m09:20:37.064360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:22:53.041123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A2F8C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A2FC8B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A2F8E610>]}


============================== 09:22:53.047124 | a4d7c4f8-d415-4bcb-ab90-0f154813839e ==============================
[0m09:22:53.047124 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:22:53.048124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:22:53.240234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A2FE45D0>]}
[0m09:22:53.280193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A0008110>]}
[0m09:22:53.281193 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:22:53.465375 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:22:53.574667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:22:53.575669 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:22:53.735838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4482810>]}
[0m09:22:53.780853 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:22:53.785854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:22:53.812854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4805550>]}
[0m09:22:53.812854 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:22:53.813854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4634ED0>]}
[0m09:22:53.815856 [info ] [MainThread]: 
[0m09:22:53.816856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:53.816856 [info ] [MainThread]: 
[0m09:22:53.817855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:22:53.820854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:22:53.874375 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:22:53.875376 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:22:53.875376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:53.937932 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m09:22:53.939921 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:22:53.942917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:22:53.952916 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:22:53.954020 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:22:53.954020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:54.015370 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m09:22:54.016365 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:22:54.016365 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:22:54.023811 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.007 seconds
[0m09:22:54.027898 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:22:54.031894 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:22:54.045010 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.046010 [debug] [MainThread]: On master: BEGIN
[0m09:22:54.046997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:22:54.108699 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m09:22:54.109702 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.110699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:22:54.119800 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:22:54.122844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4BAA390>]}
[0m09:22:54.123826 [debug] [MainThread]: On master: ROLLBACK
[0m09:22:54.126845 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.127829 [debug] [MainThread]: On master: BEGIN
[0m09:22:54.133844 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:22:54.133844 [debug] [MainThread]: On master: COMMIT
[0m09:22:54.134829 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.134829 [debug] [MainThread]: On master: COMMIT
[0m09:22:54.138392 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:22:54.138392 [debug] [MainThread]: On master: Close
[0m09:22:54.141780 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:22:54.141780 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:22:54.142781 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:22:54.143781 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:22:54.142781 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:22:54.143781 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:22:54.144779 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:22:54.145781 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:22:54.144779 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:22:54.146779 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:22:54.146779 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:22:54.146779 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:22:54.147780 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:22:54.147780 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:22:54.148779 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:22:54.154795 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.155781 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:22:54.158779 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:22:54.162780 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.165796 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.166834 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:22:54.178984 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:22:54.191885 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.194902 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:22:54.195904 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:22:54.195904 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:22:54.196887 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.199907 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.200886 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.202906 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.203885 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:22:54.203885 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:22:54.204888 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.204888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:22:54.205885 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:22:54.205885 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.206886 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:22:54.206886 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:22:54.207885 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:22:54.207885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:22:54.240397 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m09:22:54.241399 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.241399 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:22:54.247399 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:22:54.252397 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.253398 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m09:22:54.253398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m09:22:54.253398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m09:22:54.254401 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:22:54.254401 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.255399 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.255399 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.256400 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        bloqueado::BOOLEAN AS bloqueado,
        TO_DATE(primeira_operacao, 'DD-MM-YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    cc.bloqueado,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:22:54.256400 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:22:54.257399 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:22:54.260399 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:22:54.262400 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.263398 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:22:54.264398 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:22:54.264398 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:22:54.264398 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:22:54.267402 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.267402 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.270397 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.273404 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.273404 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:22:54.321398 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:22:54.321398 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:22:54.321398 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:22:54.322401 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.323405 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:22:54.325401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.326403 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:22:54.326403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:22:54.328401 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.330401 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.332401 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.333400 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:22:54.333400 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:22:54.333400 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:22:54.337907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.337907 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.338907 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.339908 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:22:54.340907 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:22:54.341909 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:22:54.342907 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.342907 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.342907 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.343907 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:22:54.343907 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m09:22:54.344909 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:22:54.344909 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:22:54.348908 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:22:54.354909 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:22:54.354909 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:22:54.360908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:22:54.362908 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:22:54.363908 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:22:54.363908 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:22:54.372908 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:22:54.373909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m09:22:54.373909 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m09:22:54.375915 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:22:54.377908 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:22:54.379908 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:22:54.381915 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:22:54.382912 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:22:54.382912 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:22:54.383912 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A481B3D0>]}
[0m09:22:54.383912 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:22:54.383912 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:22:54.385914 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:22:54.385914 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.23s]
[0m09:22:54.386913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4B23350>]}
[0m09:22:54.387912 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:22:54.388910 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:22:54.388910 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:22:54.389911 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:22:54.389911 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:22:54.390910 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:22:54.390910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:22:54.391913 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:22:54.391913 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:22:54.394910 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:22:54.394910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m09:22:54.395913 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:22:54.398915 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.399916 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:22:54.404912 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:22:54.405915 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:22:54.410010 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.410915 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.410915 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.025 seconds
[0m09:22:54.412050 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:22:54.412050 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.413910 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:22:54.414910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:54.415915 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:22:54.415915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A2FD1C50>]}
[0m09:22:54.416913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:54.417913 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m09:22:54.418914 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:22:54.419912 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m09:22:54.420929 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:22:54.421908 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A41B6B50>]}
[0m09:22:54.421908 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.28s]
[0m09:22:54.422911 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:22:54.448763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:22:54.449761 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.449761 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:22:54.458762 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:22:54.462769 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.462769 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:22:54.467592 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m09:22:54.467592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.467592 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.470592 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.470592 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:22:54.471594 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:22:54.475592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:22:54.476593 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:22:54.477611 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.477611 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:22:54.479145 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:22:54.481250 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.482251 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:22:54.487156 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.489158 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.490157 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:22:54.494175 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:22:54.496172 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:22:54.497178 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.498157 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:22:54.499667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m09:22:54.501687 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:22:54.503688 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:22:54.503688 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:22:54.511684 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m09:22:54.514699 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:22:54.516697 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:22:54.516697 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:22:54.521405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:22:54.523416 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:22:54.524516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4104D10>]}
[0m09:22:54.525417 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.13s]
[0m09:22:54.526218 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:22:54.539980 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:22:54.542980 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:22:54.544979 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d7c4f8-d415-4bcb-ab90-0f154813839e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4C7E050>]}
[0m09:22:54.546072 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:22:54.548981 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:22:54.552977 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.552977 [debug] [MainThread]: On master: BEGIN
[0m09:22:54.553978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:22:54.612302 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m09:22:54.613302 [debug] [MainThread]: On master: COMMIT
[0m09:22:54.614306 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:54.616305 [debug] [MainThread]: On master: COMMIT
[0m09:22:54.620575 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:22:54.622720 [debug] [MainThread]: On master: Close
[0m09:22:54.623840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:54.624818 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:22:54.624818 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:22:54.625815 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:22:54.626716 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:22:54.627714 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:22:54.627714 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:22:54.628715 [info ] [MainThread]: 
[0m09:22:54.629713 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m09:22:54.631921 [debug] [MainThread]: Command end result
[0m09:22:54.652589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:22:54.655418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:22:54.660425 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:22:54.660425 [info ] [MainThread]: 
[0m09:22:54.661424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:22:54.662425 [info ] [MainThread]: 
[0m09:22:54.662425 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:22:54.663424 [debug] [MainThread]: Command `dbt run` succeeded at 09:22:54.663424 after 1.69 seconds
[0m09:22:54.664425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D89E151BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A4ACED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D89E0D9A90>]}
[0m09:22:54.664425 [debug] [MainThread]: Flushing usage events
[0m09:22:55.495526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:35.920243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B5F8E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B5F85990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B5FDA6D0>]}


============================== 09:24:35.924331 | 46e4d03a-c246-4921-b1f2-19a02a0750ac ==============================
[0m09:24:35.924331 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:24:35.925282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:36.075487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B715F1D0>]}
[0m09:24:36.115543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B3009050>]}
[0m09:24:36.116487 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:36.291992 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:24:36.393402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:36.393402 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:24:36.558742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B741E1D0>]}
[0m09:24:36.602363 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:36.606365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:36.622536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B76EEAD0>]}
[0m09:24:36.622536 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:24:36.623535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B76A5590>]}
[0m09:24:36.624536 [info ] [MainThread]: 
[0m09:24:36.625639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:36.625639 [info ] [MainThread]: 
[0m09:24:36.626727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:36.629833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:24:36.682298 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:24:36.682298 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:24:36.683298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.724297 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m09:24:36.725300 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:24:36.726299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:24:36.730299 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:36.731297 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:24:36.731297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.771301 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m09:24:36.772301 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:36.772301 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:24:36.778807 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m09:24:36.780810 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:24:36.783807 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:24:36.788807 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:36.788807 [debug] [MainThread]: On master: BEGIN
[0m09:24:36.789807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:36.830807 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m09:24:36.831809 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:36.831809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:36.839807 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:24:36.842807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B78205D0>]}
[0m09:24:36.842807 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:36.846807 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:36.846807 [debug] [MainThread]: On master: BEGIN
[0m09:24:36.852807 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:24:36.852807 [debug] [MainThread]: On master: COMMIT
[0m09:24:36.853810 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:36.853810 [debug] [MainThread]: On master: COMMIT
[0m09:24:36.860810 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m09:24:36.861811 [debug] [MainThread]: On master: Close
[0m09:24:36.864264 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:36.864264 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:24:36.865265 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:36.865265 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:36.864264 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:24:36.866265 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:24:36.866265 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:24:36.867264 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:24:36.867264 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:24:36.868265 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:24:36.868265 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:24:36.869263 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:24:36.871283 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:36.869263 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:36.871283 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:36.870264 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:24:36.879802 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:36.882917 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:36.887855 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:36.889911 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:24:36.890802 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:36.891801 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:36.891801 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:36.915911 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:36.918801 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:36.919800 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:24:36.922904 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:36.923802 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:36.926800 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:24:36.926800 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:36.927801 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:24:36.928802 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:36.929802 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:24:36.929802 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:36.929802 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:24:36.930802 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:24:36.930802 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:36.931801 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:24:36.932801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:24:36.932801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:24:36.970346 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m09:24:36.971334 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:36.972243 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:24:36.981772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m09:24:36.982772 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:36.983772 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:24:36.984771 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:24:36.985876 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m09:24:36.992772 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:36.993773 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:36.993773 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:24:36.994772 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:24:36.997074 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:24:36.999080 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:37.000081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:24:37.000738 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:24:37.002752 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:37.003752 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:24:37.003752 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:24:37.009088 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:37.011189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:24:37.012149 [debug] [Thread-3 (]: SQL status: BEGIN in 0.079 seconds
[0m09:24:37.013144 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:24:37.018192 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:37.018192 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:24:37.019087 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:37.020088 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:24:37.061489 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m09:24:37.070489 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:24:37.071491 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD-MM-YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(limite_global, ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(limite_boleto_especial, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(limite_comissaria, ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(limite_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(limite_boleto_especial_tranche, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(limite_boleto_garantido, ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(limite_operacao_clean, ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(saldo, ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:24:37.074099 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:37.074099 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:37.075106 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:24:37.075106 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:24:37.077417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:24:37.078425 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:37.078425 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:37.078425 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:37.080599 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:24:37.081423 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:24:37.082424 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:37.082424 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:24:37.085802 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:24:37.088800 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:37.089801 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:24:37.093981 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:37.095902 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:37.096811 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:24:37.105914 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m09:24:37.105914 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:24:37.110020 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:24:37.110921 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:24:37.115094 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:37.115094 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m09:24:37.116094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m09:24:37.116094 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:37.117093 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:24:37.118096 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:24:37.120191 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:24:37.121092 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:24:37.121092 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:37.122119 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:37.123094 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:24:37.123094 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:24:37.139519 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:24:37.143533 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:24:37.144535 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:37.145533 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:24:37.163944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.039 seconds
[0m09:24:37.164940 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.041 seconds
[0m09:24:37.165936 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.044 seconds
[0m09:24:37.170936 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:24:37.172693 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:24:37.175336 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:24:37.178244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B7B24D90>]}
[0m09:24:37.179442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B7AF8C50>]}
[0m09:24:37.180064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B7ACD650>]}
[0m09:24:37.181175 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:24:37.182177 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:24:37.185178 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:37.184177 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:24:37.186175 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:37.187092 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.041 seconds
[0m09:24:37.187092 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:24:37.189162 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:24:37.189162 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:24:37.191160 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:24:37.192174 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:24:37.194162 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B7C20C10>]}
[0m09:24:37.193162 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:24:37.195159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_operacoes)
[0m09:24:37.196158 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:24:37.196158 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.33s]
[0m09:24:37.196158 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:24:37.197157 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:24:37.197157 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:37.200157 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:24:37.202258 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.203197 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:24:37.207263 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:24:37.207263 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:24:37.210160 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.211159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.211159 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:24:37.212160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:37.212160 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.213161 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:24:37.213161 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:24:37.269842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m09:24:37.270822 [debug] [Thread-4 (]: SQL status: BEGIN in 0.058 seconds
[0m09:24:37.271822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.271822 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.272821 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:24:37.272821 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:24:37.282334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:24:37.287334 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.287334 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:24:37.288335 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:24:37.292048 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.292955 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:24:37.296554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:37.300566 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.300566 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:24:37.301566 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:24:37.304214 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.304214 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:24:37.305212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:37.306212 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:24:37.307213 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.307213 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:24:37.308362 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:37.309472 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:24:37.309472 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.310370 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:24:37.327510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:24:37.329523 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:24:37.330523 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:37.330523 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:24:37.342002 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m09:24:37.344003 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:24:37.345001 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:37.345001 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:24:37.366367 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m09:24:37.367376 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:24:37.368374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B7AF9110>]}
[0m09:24:37.368374 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m09:24:37.369534 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:24:37.379437 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.034 seconds
[0m09:24:37.380436 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:24:37.381529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e4d03a-c246-4921-b1f2-19a02a0750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B71905D0>]}
[0m09:24:37.382480 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.19s]
[0m09:24:37.383437 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:24:37.385434 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.386433 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.387433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:37.421434 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m09:24:37.421434 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.421434 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.422435 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.425459 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:24:37.426435 [debug] [MainThread]: On master: Close
[0m09:24:37.426435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:37.427434 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:24:37.427434 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:24:37.427434 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:24:37.428434 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:24:37.428434 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:24:37.428434 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:24:37.429433 [info ] [MainThread]: 
[0m09:24:37.430435 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m09:24:37.431437 [debug] [MainThread]: Command end result
[0m09:24:37.450435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:37.452543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:37.457435 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:24:37.457435 [info ] [MainThread]: 
[0m09:24:37.458435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:37.459436 [info ] [MainThread]: 
[0m09:24:37.459436 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:24:37.461441 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:37.461441 after 1.60 seconds
[0m09:24:37.461441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B10C9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B10C9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230B10C8D50>]}
[0m09:24:37.462442 [debug] [MainThread]: Flushing usage events
[0m09:24:38.262029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:10.663559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A487D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A38BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A4D90D0>]}


============================== 09:26:10.667577 | bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4 ==============================
[0m09:26:10.667577 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:26:10.668561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:26:10.811932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A555AD0>]}
[0m09:26:10.851530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026566509D90>]}
[0m09:26:10.852531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:26:11.029444 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:26:11.123306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:26:11.124303 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:26:11.281937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A48ED50>]}
[0m09:26:11.324751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:26:11.328650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:26:11.342648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AC281D0>]}
[0m09:26:11.343649 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:26:11.344650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656ABEE290>]}
[0m09:26:11.345673 [info ] [MainThread]: 
[0m09:26:11.346653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:26:11.347647 [info ] [MainThread]: 
[0m09:26:11.347647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:26:11.350664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:26:11.402649 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:26:11.402649 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:26:11.402649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:11.455301 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m09:26:11.457278 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:26:11.458277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:26:11.463279 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:26:11.463279 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:26:11.464277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:11.534652 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m09:26:11.535654 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:26:11.535654 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:26:11.550774 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.014 seconds
[0m09:26:11.552717 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:26:11.558645 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:26:11.569575 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:11.569575 [debug] [MainThread]: On master: BEGIN
[0m09:26:11.570617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:11.627145 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m09:26:11.628141 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:11.629145 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:26:11.638130 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:26:11.645130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A640750>]}
[0m09:26:11.646134 [debug] [MainThread]: On master: ROLLBACK
[0m09:26:11.650330 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:11.651329 [debug] [MainThread]: On master: BEGIN
[0m09:26:11.659323 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:26:11.660326 [debug] [MainThread]: On master: COMMIT
[0m09:26:11.661329 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:11.662328 [debug] [MainThread]: On master: COMMIT
[0m09:26:11.666322 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:26:11.666322 [debug] [MainThread]: On master: Close
[0m09:26:11.669321 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:26:11.670320 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:26:11.671321 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:26:11.671321 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:26:11.672321 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:26:11.673321 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:26:11.674321 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:26:11.675321 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:26:11.676322 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:26:11.677341 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:26:11.678322 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:26:11.679324 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:26:11.680323 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:26:11.680887 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:26:11.681904 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:26:11.681904 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:26:11.690904 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.693918 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:26:11.698903 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.700904 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.701904 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:26:11.702913 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:26:11.730655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.730655 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:26:11.733682 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:26:11.733682 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:26:11.736665 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.737788 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.739799 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.740817 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.741799 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:26:11.741799 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.742825 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:26:11.742825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:26:11.743797 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.743797 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:26:11.743797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:26:11.744798 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:26:11.744798 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:26:11.745799 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:26:11.788338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m09:26:11.789437 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.790448 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:26:11.799333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:26:11.806335 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.806335 [debug] [Thread-3 (]: SQL status: BEGIN in 0.061 seconds
[0m09:26:11.807344 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m09:26:11.807344 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:26:11.807344 [debug] [Thread-4 (]: SQL status: BEGIN in 0.062 seconds
[0m09:26:11.808357 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.808357 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.809335 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.810334 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
         TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:26:11.810334 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:26:11.811334 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:26:11.814576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:11.816706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.816706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:26:11.818684 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:26:11.821212 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.821212 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:26:11.826303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:26:11.827195 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:26:11.827195 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:26:11.827195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:26:11.838287 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:26:11.842287 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.880459 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.883471 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.883809 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.884287 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:26:11.884693 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:26:11.884693 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:26:11.885700 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:26:11.890867 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:11.890867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:11.891700 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:11.893700 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.894807 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.896701 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:26:11.896701 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:26:11.896701 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:26:11.897700 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.898699 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:26:11.901843 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:26:11.901843 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:26:11.903255 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:26:11.904254 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:26:11.905255 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.905255 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.905255 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:26:11.906260 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:26:11.906857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m09:26:11.910862 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:26:11.914863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:26:11.914863 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:26:11.918088 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m09:26:11.919151 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:26:11.920150 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:26:11.920656 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:26:11.921702 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m09:26:11.921702 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m09:26:11.923775 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:26:11.925770 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:26:11.926664 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:26:11.926664 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:26:11.927661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:26:11.927661 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:26:11.928662 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:26:11.929680 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:26:11.931661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656B11C690>]}
[0m09:26:11.932660 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m09:26:11.933661 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:26:11.933661 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.013 seconds
[0m09:26:11.934662 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:26:11.935663 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:26:11.936663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656B062290>]}
[0m09:26:11.935663 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:26:11.937663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_operacoes)
[0m09:26:11.937663 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.26s]
[0m09:26:11.938663 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:26:11.940667 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:26:11.945662 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:26:11.946662 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:26:11.947662 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:26:11.947662 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:26:11.949666 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:26:11.950662 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:26:11.951662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:26:11.951662 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:26:11.952700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656B04AED0>]}
[0m09:26:11.957662 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:26:11.958663 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:26:11.959674 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:26:11.960683 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m09:26:11.965667 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:26:11.966662 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:11.966662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A499B90>]}
[0m09:26:11.967664 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:26:11.968662 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:26:11.968662 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:26:11.968662 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.29s]
[0m09:26:11.972663 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:26:11.972663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:11.973663 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:26:11.974662 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:11.974662 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:26:11.974662 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:26:12.035284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m09:26:12.036283 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:12.037300 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:26:12.041415 [debug] [Thread-4 (]: SQL status: BEGIN in 0.066 seconds
[0m09:26:12.042432 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:12.043431 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:26:12.048854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:26:12.053867 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:12.054866 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:26:12.059867 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:26:12.060873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:12.066855 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:12.071381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:12.072481 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:26:12.073382 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:26:12.078389 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:26:12.083338 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:12.084336 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:26:12.085341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:26:12.087327 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:26:12.088336 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:12.089323 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:26:12.090316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:12.092235 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:26:12.093329 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:12.094235 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:26:12.116406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m09:26:12.120401 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:26:12.120908 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:26:12.121920 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:26:12.144582 [debug] [Thread-4 (]: SQL status: COMMIT in 0.050 seconds
[0m09:26:12.145578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:26:12.150575 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:26:12.152674 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:26:12.154576 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:26:12.158574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AD1A290>]}
[0m09:26:12.159573 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:26:12.159573 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m09:26:12.160577 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:26:12.179402 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:26:12.181416 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:26:12.182400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae25bf0-e2fb-40cd-87ae-d97a9b41f4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026568EBDA10>]}
[0m09:26:12.183421 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.23s]
[0m09:26:12.184408 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:26:12.185397 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:12.186423 [debug] [MainThread]: On master: BEGIN
[0m09:26:12.186423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:12.250125 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m09:26:12.252227 [debug] [MainThread]: On master: COMMIT
[0m09:26:12.253227 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:12.253227 [debug] [MainThread]: On master: COMMIT
[0m09:26:12.258227 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:26:12.259230 [debug] [MainThread]: On master: Close
[0m09:26:12.261230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:12.262225 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:26:12.263225 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:26:12.264222 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:26:12.265243 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:26:12.265243 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:26:12.266221 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:26:12.266221 [info ] [MainThread]: 
[0m09:26:12.268220 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:26:12.269328 [debug] [MainThread]: Command end result
[0m09:26:12.289218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:26:12.292217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:26:12.296217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:26:12.297217 [info ] [MainThread]: 
[0m09:26:12.298217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:12.298217 [info ] [MainThread]: 
[0m09:26:12.299217 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:26:12.300218 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:12.300218 after 1.69 seconds
[0m09:26:12.301216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265646D1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656A29FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026564659950>]}
[0m09:26:12.301216 [debug] [MainThread]: Flushing usage events
[0m09:26:13.743083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:36.326048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A48E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A4DA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A4D9FD0>]}


============================== 09:29:36.330062 | 38ea2ff0-a5f9-4942-8291-ffc3bcecf214 ==============================
[0m09:29:36.330062 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:29:36.330062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:29:36.496571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A600650>]}
[0m09:29:36.537094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A76539110>]}
[0m09:29:36.538078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:29:36.728950 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:29:36.835311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:29:36.836408 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:29:36.997250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7AB65690>]}
[0m09:29:37.044965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:29:37.049949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:29:37.065950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7AC281D0>]}
[0m09:29:37.066976 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:29:37.067966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A8AFC50>]}
[0m09:29:37.069976 [info ] [MainThread]: 
[0m09:29:37.070729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:29:37.071758 [info ] [MainThread]: 
[0m09:29:37.072755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:29:37.076697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:29:37.129218 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:29:37.129218 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:29:37.130220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:37.244839 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.114 seconds
[0m09:29:37.245839 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:29:37.246839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:29:37.250839 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:29:37.251838 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:29:37.251838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:37.364720 [debug] [ThreadPool]: SQL status: BEGIN in 0.112 seconds
[0m09:29:37.365720 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:29:37.365720 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:29:37.387894 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.021 seconds
[0m09:29:37.389896 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:29:37.407093 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:29:37.413065 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:37.413065 [debug] [MainThread]: On master: BEGIN
[0m09:29:37.413065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:37.548424 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m09:29:37.549425 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:37.550430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:29:37.565474 [debug] [MainThread]: SQL status: SELECT 11 in 0.014 seconds
[0m09:29:37.571413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7C046690>]}
[0m09:29:37.572414 [debug] [MainThread]: On master: ROLLBACK
[0m09:29:37.595890 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:37.596896 [debug] [MainThread]: On master: BEGIN
[0m09:29:37.605492 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:29:37.606702 [debug] [MainThread]: On master: COMMIT
[0m09:29:37.607824 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:37.608784 [debug] [MainThread]: On master: COMMIT
[0m09:29:37.632026 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m09:29:37.634165 [debug] [MainThread]: On master: Close
[0m09:29:37.643944 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:29:37.644943 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:29:37.645943 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:29:37.646942 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:29:37.647940 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:29:37.648943 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:29:37.649941 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:29:37.652947 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:29:37.650942 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:29:37.653974 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:29:37.655168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:29:37.656283 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:29:37.658184 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:29:37.659184 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:29:37.660189 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:29:37.669178 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.670177 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:29:37.672282 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:29:37.676177 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.679177 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.681178 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:29:37.681178 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:29:37.704182 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:29:37.706850 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.707893 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:29:37.708314 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:29:37.709330 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:37.711432 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.712329 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.714428 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.714428 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:29:37.715374 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:29:37.715374 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.716419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:29:37.716419 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.717380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:29:37.717380 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:29:37.718379 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:29:37.719379 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:29:37.719379 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:29:37.804096 [debug] [Thread-3 (]: SQL status: BEGIN in 0.085 seconds
[0m09:29:37.804989 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.804989 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.nome,
    cc.cpf_cnpj,
    cc.endereco,
    cc.cep,
    cc.cidade,
    cc.uf,
    cc.email,
    cc.telefone,
    cc.gerente,
    cc.operador,
    cc.captador,
    cc.controlador,
    cc.fator_percentual,
    cc.advalorem_percentual,
    cc.data_cadastro,
    cc.fonte_captacao,
    cc.setor,
    cc.grupo_economico,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao,
    cc.limite_global,
    cc.limite_boleto_especial,
    cc.limite_comissaria,
    cc.limite_tranche,
    cc.limite_boleto_especial_tranche,
    cc.limite_boleto_garantido,
    cc.limite_operacao_clean,
    cc.risco_atual,
    cc.saldo,
    cc.vencimento_contrato,
    cc.id_cedente
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m09:29:37.805987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m09:29:37.805987 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.805987 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:29:37.829950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m09:29:37.834822 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.834822 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m09:29:37.835833 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m09:29:37.835833 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:29:37.836438 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:37.838517 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.839249 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:29:37.839863 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:29:37.858029 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m09:29:37.858029 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m09:29:37.859091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m09:29:37.861092 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.862092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.143 seconds
[0m09:29:37.865091 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:37.867091 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.867091 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:29:37.867091 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.868176 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:29:37.868176 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:29:37.869092 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:29:37.890473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m09:29:37.892468 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m09:29:37.893468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:29:37.893468 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:29:37.939977 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:37.942081 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.952076 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:29:37.954091 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:29:37.954091 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:29:37.955020 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:29:37.955020 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:37.955977 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:37.956976 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:29:37.957342 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:29:37.962271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:29:37.962271 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:29:37.964391 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:37.965287 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:29:37.966286 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:29:37.966286 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:37.967306 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:29:37.989640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m09:29:37.990642 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:29:38.001706 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:29:38.003806 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:29:38.010447 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:29:38.010447 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:38.011341 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:29:38.012340 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:29:38.020551 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m09:29:38.020551 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m09:29:38.024607 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:29:38.028605 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:29:38.029504 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:29:38.030606 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m09:29:38.031502 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:29:38.032551 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:29:38.035504 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:29:38.036272 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:29:38.038286 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:29:38.039284 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:29:38.059383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m09:29:38.065367 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:29:38.069356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7A99CCD0>]}
[0m09:29:38.070359 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.41s]
[0m09:29:38.071598 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:29:38.072710 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:29:38.073608 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:29:38.074607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_operacoes)
[0m09:29:38.075608 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:29:38.079607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:29:38.081613 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:29:38.087607 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:29:38.087607 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.051 seconds
[0m09:29:38.088664 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.048 seconds
[0m09:29:38.088664 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:29:38.090613 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:29:38.091609 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.093618 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:29:38.094615 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:29:38.095613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7C03CD50>]}
[0m09:29:38.095613 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:29:38.096614 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7AADE250>]}
[0m09:29:38.096614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7C01B310>]}
[0m09:29:38.098639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:38.097614 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.44s]
[0m09:29:38.098639 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.44s]
[0m09:29:38.100614 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:29:38.100614 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:29:38.099614 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.44s]
[0m09:29:38.101623 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:29:38.102616 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:29:38.103635 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:29:38.104615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:29:38.104615 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:29:38.111241 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.113340 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:29:38.116238 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.118238 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.118238 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:29:38.119237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:29:38.164263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m09:29:38.164263 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.165277 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:29:38.189442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m09:29:38.198554 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.199547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.080 seconds
[0m09:29:38.200445 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:29:38.201558 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.203445 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:29:38.226954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m09:29:38.228976 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m09:29:38.235079 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.241979 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.242983 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:29:38.244317 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:29:38.249818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:29:38.251017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:29:38.254107 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:29:38.258996 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.260009 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.260998 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:29:38.262002 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:29:38.267015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:29:38.268996 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:29:38.268996 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.269996 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:29:38.296995 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m09:29:38.296995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m09:29:38.298998 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:29:38.300998 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:29:38.301996 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:29:38.301996 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:29:38.302996 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:29:38.302996 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:29:38.319525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:29:38.320503 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:29:38.321502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7C034E50>]}
[0m09:29:38.321502 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m09:29:38.322502 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:29:38.331502 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.028 seconds
[0m09:29:38.332502 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:29:38.333515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea2ff0-a5f9-4942-8291-ffc3bcecf214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7AD22CD0>]}
[0m09:29:38.334504 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.23s]
[0m09:29:38.334504 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:29:38.336503 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:38.336503 [debug] [MainThread]: On master: BEGIN
[0m09:29:38.337505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:38.402506 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m09:29:38.403505 [debug] [MainThread]: On master: COMMIT
[0m09:29:38.403505 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:38.404505 [debug] [MainThread]: On master: COMMIT
[0m09:29:38.407506 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:29:38.408009 [debug] [MainThread]: On master: Close
[0m09:29:38.408009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:38.409013 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:29:38.409013 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:29:38.409013 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:29:38.410025 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:29:38.410025 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:29:38.410025 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:29:38.411012 [info ] [MainThread]: 
[0m09:29:38.411012 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m09:29:38.413012 [debug] [MainThread]: Command end result
[0m09:29:38.428024 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:29:38.430012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:29:38.435013 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:29:38.435013 [info ] [MainThread]: 
[0m09:29:38.436014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:38.437014 [info ] [MainThread]: 
[0m09:29:38.438030 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:29:38.439015 [debug] [MainThread]: Command `dbt run` succeeded at 09:29:38.439015 after 2.18 seconds
[0m09:29:38.440014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A74659950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A74658DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A74658D50>]}
[0m09:29:38.440014 [debug] [MainThread]: Flushing usage events
[0m09:29:39.810942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:53.946982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E1398E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13889F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E139C4490>]}


============================== 09:50:53.950984 | 639f79d8-0670-405e-99cf-debc95e06985 ==============================
[0m09:50:53.950984 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:50:53.951984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:50:54.149093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13998090>]}
[0m09:50:54.187994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E0E9C92D0>]}
[0m09:50:54.188993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:50:54.407876 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:50:54.562137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:54.562137 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:50:54.727657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13E15250>]}
[0m09:50:54.772166 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:50:54.776168 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:50:54.799831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E14128150>]}
[0m09:50:54.800815 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:50:54.801813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E14004B50>]}
[0m09:50:54.803814 [info ] [MainThread]: 
[0m09:50:54.803814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:54.804814 [info ] [MainThread]: 
[0m09:50:54.804814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:54.809813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:50:54.867281 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:50:54.868281 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:50:54.869282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:54.997863 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.129 seconds
[0m09:50:55.000852 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:50:55.004852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:50:55.013749 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:50:55.014746 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:50:55.015745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:55.084773 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m09:50:55.084773 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:50:55.085770 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:50:55.095790 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.009 seconds
[0m09:50:55.096790 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:50:55.101805 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:50:55.106807 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.106807 [debug] [MainThread]: On master: BEGIN
[0m09:50:55.107791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:55.161865 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m09:50:55.161865 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.162864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:55.173864 [debug] [MainThread]: SQL status: SELECT 11 in 0.010 seconds
[0m09:50:55.175868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E14013A10>]}
[0m09:50:55.175868 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:55.179564 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.180565 [debug] [MainThread]: On master: BEGIN
[0m09:50:55.189578 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:50:55.190583 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.190583 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.190583 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.195614 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:50:55.195614 [debug] [MainThread]: On master: Close
[0m09:50:55.203652 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:50:55.204748 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:50:55.205650 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:50:55.206749 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:50:55.207647 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:50:55.208645 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:50:55.209646 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:50:55.210646 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:50:55.209646 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:50:55.211644 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:50:55.212669 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:50:55.212669 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:50:55.214645 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:50:55.215565 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:50:55.215565 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:50:55.222591 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.223591 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:50:55.225577 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:50:55.229469 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:50:55.234580 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.235501 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:50:55.236468 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:50:55.236468 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:50:55.244885 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:50:55.272984 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.275885 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:50:55.278884 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:50:55.281886 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.282884 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.282884 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.283885 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:50:55.284884 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:50:55.284884 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:50:55.284884 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.285886 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:50:55.285886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:50:55.286884 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:50:55.286884 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:50:55.286884 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:50:55.287886 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:50:55.317034 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m09:50:55.318037 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.318037 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:50:55.319036 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m09:50:55.319036 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.320036 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:50:55.322042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m09:50:55.322042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.322042 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:50:55.326034 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:50:55.326034 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:50:55.331041 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.332041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:50:55.334314 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.334314 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:50:55.337317 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.337317 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:50:55.338296 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:50:55.340561 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m09:50:55.340561 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:50:55.340561 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:50:55.341561 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  );
  );
[0m09:50:55.344068 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.345069 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:50:55.345069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:50:55.346068 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:50:55.348068 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.388069 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96:   );
            ^

[0m09:50:55.390070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.390070 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:50:55.391236 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:50:55.391236 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:50:55.394278 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:50:55.404443 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:50:55.405442 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m09:50:55.405442 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.405442 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:50:55.407437 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:50:55.407437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:50:55.408335 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:50:55.409335 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.410335 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:50:55.411557 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:50:55.412566 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.413566 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:50:55.417567 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:50:55.419584 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E146B8650>]}
[0m09:50:55.420566 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.21s]
[0m09:50:55.421569 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:50:55.421569 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:50:55.421569 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:50:55.422569 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:50:55.423567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:50:55.423567 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:50:55.426566 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:50:55.427566 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:50:55.430571 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:50:55.431570 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.432571 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:50:55.432571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:50:55.447419 [debug] [Thread-4 (]: SQL status: COMMIT in 0.036 seconds
[0m09:50:55.454418 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:50:55.454418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m09:50:55.457417 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:50:55.458721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.045 seconds
[0m09:50:55.460757 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:50:55.460757 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:50:55.462731 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:50:55.462731 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:50:55.463748 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:50:55.464732 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:50:55.464732 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:50:55.486624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m09:50:55.488625 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.489638 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:50:55.493625 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.029 seconds
[0m09:50:55.496622 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:50:55.497622 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E14649FD0>]}
[0m09:50:55.498622 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.28s]
[0m09:50:55.499621 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:50:55.499621 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:50:55.500623 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:50:55.503621 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.504623 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:50:55.504623 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:50:55.505622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:50:55.505622 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:50:55.508623 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.509622 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:50:55.512622 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.513620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:50:55.516637 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.516637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.051 seconds
[0m09:50:55.517622 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.052 seconds
[0m09:50:55.517622 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:50:55.517622 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.519646 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:50:55.519955 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:50:55.520963 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:50:55.522004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13E3FE50>]}
[0m09:50:55.522960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E144FB9D0>]}
[0m09:50:55.522960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:50:55.524085 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:50:55.524962 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:50:55.525985 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:50:55.526965 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:50:55.528965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:50:55.529967 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:50:55.530968 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.530968 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:50:55.546858 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:50:55.549857 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:50:55.549857 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:50:55.550861 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:50:55.571862 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:50:55.573861 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:50:55.573861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13BB61D0>]}
[0m09:50:55.574860 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:50:55.575862 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:50:55.593860 [debug] [Thread-4 (]: SQL status: BEGIN in 0.071 seconds
[0m09:50:55.594863 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.595861 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:50:55.605892 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:50:55.608859 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.608859 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:50:55.614859 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:50:55.616863 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.616863 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:50:55.622985 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:50:55.624864 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:50:55.625982 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.625982 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:50:55.647557 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m09:50:55.649560 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:50:55.650556 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:50:55.650556 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:50:55.673792 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:50:55.675794 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:50:55.675794 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639f79d8-0670-405e-99cf-debc95e06985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E13BCC990>]}
[0m09:50:55.677791 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.17s]
[0m09:50:55.678790 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:50:55.680790 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.680790 [debug] [MainThread]: On master: BEGIN
[0m09:50:55.680790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:55.742607 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m09:50:55.742607 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.742607 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:55.743609 [debug] [MainThread]: On master: COMMIT
[0m09:50:55.749121 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m09:50:55.749121 [debug] [MainThread]: On master: Close
[0m09:50:55.749121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:55.750225 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:50:55.750225 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:50:55.750225 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:50:55.750225 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:50:55.751122 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:50:55.751122 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:50:55.751122 [info ] [MainThread]: 
[0m09:50:55.752119 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m09:50:55.753122 [debug] [MainThread]: Command end result
[0m09:50:55.767120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:50:55.769122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:50:55.774122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:50:55.775123 [info ] [MainThread]: 
[0m09:50:55.776120 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:50:55.776120 [info ] [MainThread]: 
[0m09:50:55.777122 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:50:55.778121 [info ] [MainThread]: 
[0m09:50:55.778121 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:50:55.779133 [debug] [MainThread]: Command `dbt run` failed at 09:50:55.779133 after 1.89 seconds
[0m09:50:55.780221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E0DB09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E0DB81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E146FD250>]}
[0m09:50:55.780221 [debug] [MainThread]: Flushing usage events
[0m09:50:57.216403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:10.489765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24A8E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24A85990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24AC9090>]}


============================== 09:51:10.492767 | 215da405-ca9d-4ebc-924f-1fefdad9c700 ==============================
[0m09:51:10.492767 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:51:10.493765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:10.642349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24CB4F10>]}
[0m09:51:10.681359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E1FB4A190>]}
[0m09:51:10.682382 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:10.857679 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:51:10.951197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:10.952190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:10.972181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24AE42D0>]}
[0m09:51:11.016755 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:51:11.019755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:51:11.034738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E2516DC50>]}
[0m09:51:11.035740 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:51:11.035740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24F63510>]}
[0m09:51:11.037738 [info ] [MainThread]: 
[0m09:51:11.038739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:51:11.038739 [info ] [MainThread]: 
[0m09:51:11.039740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:11.043740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:51:11.099254 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:51:11.100253 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:51:11.100253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:11.245617 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.145 seconds
[0m09:51:11.248620 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:51:11.251623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:51:11.261708 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:11.261708 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:51:11.262711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:11.444227 [debug] [ThreadPool]: SQL status: BEGIN in 0.182 seconds
[0m09:51:11.445060 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:11.445060 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:51:11.464059 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.019 seconds
[0m09:51:11.466061 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:51:11.479061 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:51:11.484061 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:11.485061 [debug] [MainThread]: On master: BEGIN
[0m09:51:11.485061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:11.611419 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m09:51:11.611419 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:11.612430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:11.643910 [debug] [MainThread]: SQL status: SELECT 11 in 0.032 seconds
[0m09:51:11.652930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E24C283D0>]}
[0m09:51:11.653933 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:11.678073 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:11.680070 [debug] [MainThread]: On master: BEGIN
[0m09:51:11.717519 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m09:51:11.718641 [debug] [MainThread]: On master: COMMIT
[0m09:51:11.719635 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:11.720541 [debug] [MainThread]: On master: COMMIT
[0m09:51:11.745221 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m09:51:11.746316 [debug] [MainThread]: On master: Close
[0m09:51:11.753620 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:11.753620 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:51:11.754718 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:11.756622 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:11.755721 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:51:11.757621 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:51:11.758619 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:51:11.760640 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:51:11.759619 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:51:11.761664 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:51:11.763620 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:51:11.764617 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:11.765620 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:51:11.774650 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:11.766666 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:11.774313 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:11.765620 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:51:11.777653 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:11.781652 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:11.785264 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:51:11.786269 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:11.787270 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:11.787270 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:11.787270 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:51:11.813271 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:11.817376 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:11.820367 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:11.822373 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:51:11.823270 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:11.824271 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:11.824271 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:11.825486 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:51:11.825486 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:51:11.826492 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:11.826492 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:51:11.826492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:51:11.827491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:51:11.827491 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:51:11.827491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:51:11.828519 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:51:11.983305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m09:51:11.984430 [debug] [Thread-4 (]: SQL status: BEGIN in 0.157 seconds
[0m09:51:11.985837 [debug] [Thread-2 (]: SQL status: BEGIN in 0.157 seconds
[0m09:51:11.988854 [debug] [Thread-3 (]: SQL status: BEGIN in 0.160 seconds
[0m09:51:11.989856 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:11.990952 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:11.991853 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:11.992849 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:11.993849 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:51:11.994847 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:51:11.995851 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:51:11.996982 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  );
  );
[0m09:51:12.007720 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:51:12.008846 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:51:12.009787 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96:   );
            ^

[0m09:51:12.024728 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:51:12.020827 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:12.024728 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:12.010738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:51:12.024728 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:51:12.025728 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:51:12.027728 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:12.028729 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:51:12.045827 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m09:51:12.046771 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:51:12.046771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m09:51:12.047846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m09:51:12.049833 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:12.052842 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:12.054730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:12.055729 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:51:12.056729 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:51:12.056729 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:51:12.058728 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:51:12.060729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E25634210>]}
[0m09:51:12.060729 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.30s]
[0m09:51:12.061728 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:12.062729 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:51:12.063728 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:51:12.062729 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:51:12.064729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:51:12.064729 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:51:12.067729 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:51:12.067729 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:51:12.070729 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:51:12.072734 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.072734 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:51:12.073733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:51:12.078735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m09:51:12.079734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:51:12.079734 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:51:12.092203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:51:12.093212 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:51:12.094204 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:51:12.095197 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:12.095197 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:12.096199 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:12.096199 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:51:12.097098 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:51:12.097098 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:51:12.115793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m09:51:12.116776 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m09:51:12.121792 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:51:12.121792 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.125877 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:12.125877 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:51:12.126851 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:51:12.127775 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m09:51:12.127775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m09:51:12.129793 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:51:12.133775 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:51:12.134862 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:12.135874 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:12.136873 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:51:12.136873 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:51:12.159705 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:51:12.160701 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m09:51:12.161703 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:51:12.162697 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.034 seconds
[0m09:51:12.167695 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:51:12.172924 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.175817 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:51:12.177817 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:51:12.179969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E257131D0>]}
[0m09:51:12.180961 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:51:12.181961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E25706BD0>]}
[0m09:51:12.183075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E25505FD0>]}
[0m09:51:12.184961 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.41s]
[0m09:51:12.186340 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m09:51:12.189470 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:12.188356 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.42s]
[0m09:51:12.191855 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:12.192906 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:51:12.193852 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:51:12.195851 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:51:12.196850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:51:12.197850 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:51:12.200846 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.201848 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:51:12.204848 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.205850 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.205850 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:51:12.205850 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:51:12.214846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m09:51:12.216847 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.217847 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:51:12.221846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:12.223846 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:51:12.223846 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.223846 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:51:12.241847 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m09:51:12.241847 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m09:51:12.243851 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:51:12.244847 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.244847 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:12.245846 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:51:12.245846 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:51:12.273850 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m09:51:12.273850 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:51:12.276850 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.277850 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:51:12.277850 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:51:12.278851 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E255F8210>]}
[0m09:51:12.279851 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:51:12.279851 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:51:12.285850 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:51:12.288360 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.288360 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:51:12.295360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:51:12.298358 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:51:12.299360 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.299360 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:51:12.341358 [debug] [Thread-4 (]: SQL status: COMMIT in 0.041 seconds
[0m09:51:12.343359 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:51:12.344359 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:12.344359 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:51:12.361266 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:51:12.362312 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:51:12.362312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215da405-ca9d-4ebc-924f-1fefdad9c700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E254666D0>]}
[0m09:51:12.363300 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.17s]
[0m09:51:12.364281 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:51:12.365281 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:12.366306 [debug] [MainThread]: On master: BEGIN
[0m09:51:12.366306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:12.465465 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m09:51:12.467438 [debug] [MainThread]: On master: COMMIT
[0m09:51:12.469350 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:12.470412 [debug] [MainThread]: On master: COMMIT
[0m09:51:12.475467 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:51:12.476571 [debug] [MainThread]: On master: Close
[0m09:51:12.477530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:12.478526 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:51:12.479552 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:51:12.479552 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:51:12.480562 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:51:12.481521 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:51:12.481521 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:51:12.482466 [info ] [MainThread]: 
[0m09:51:12.484380 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m09:51:12.486905 [debug] [MainThread]: Command end result
[0m09:51:12.555902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:51:12.557901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:51:12.562899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:51:12.562899 [info ] [MainThread]: 
[0m09:51:12.563900 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:51:12.563900 [info ] [MainThread]: 
[0m09:51:12.564902 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:51:12.565901 [info ] [MainThread]: 
[0m09:51:12.565901 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:51:12.566901 [debug] [MainThread]: Command `dbt run` failed at 09:51:12.566901 after 2.13 seconds
[0m09:51:12.567903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E1ECB9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E2501CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E25118150>]}
[0m09:51:12.567903 [debug] [MainThread]: Flushing usage events
[0m09:51:13.402541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:29.091932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87284D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D872DA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D85013E10>]}


============================== 09:51:29.094949 | 52c70ac3-042f-44b1-86e6-e887a5e81d0c ==============================
[0m09:51:29.094949 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:51:29.095931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:29.238473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87318E50>]}
[0m09:51:29.277010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D83409890>]}
[0m09:51:29.278905 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:29.457209 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:51:29.552043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:29.552043 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:51:29.714708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D876AFF10>]}
[0m09:51:29.756494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:51:29.760442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:51:29.775442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87B08F90>]}
[0m09:51:29.775442 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:51:29.776460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D879B3010>]}
[0m09:51:29.778444 [info ] [MainThread]: 
[0m09:51:29.778801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:51:29.778801 [info ] [MainThread]: 
[0m09:51:29.779829 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:29.782828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:51:29.833829 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:51:29.834846 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:51:29.834846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:30.035439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.201 seconds
[0m09:51:30.038639 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:51:30.041660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:51:30.049660 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:30.050662 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:51:30.050662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:30.110795 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m09:51:30.111797 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:51:30.111797 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:51:30.119795 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m09:51:30.120797 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:51:30.123795 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:51:30.128795 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.129795 [debug] [MainThread]: On master: BEGIN
[0m09:51:30.129795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:30.173954 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m09:51:30.173954 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.174957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:30.182953 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m09:51:30.184954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D85DEEA50>]}
[0m09:51:30.185954 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:30.188954 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.188954 [debug] [MainThread]: On master: BEGIN
[0m09:51:30.200031 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:51:30.200031 [debug] [MainThread]: On master: COMMIT
[0m09:51:30.201043 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.201043 [debug] [MainThread]: On master: COMMIT
[0m09:51:30.204811 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:51:30.204811 [debug] [MainThread]: On master: Close
[0m09:51:30.207344 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:30.208324 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:51:30.208324 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:30.209365 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:30.208324 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:51:30.209365 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:51:30.210352 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:51:30.211324 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:51:30.210352 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:51:30.212323 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:51:30.212323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:51:30.213323 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:30.213323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:51:30.213323 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:51:30.214324 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:30.219338 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.219338 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:30.222325 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:51:30.225697 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:30.227727 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.228722 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:30.229700 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:51:30.256209 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.257216 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:30.257216 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:30.260215 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:51:30.263215 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:30.266215 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.266215 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.267215 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.268214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:51:30.268214 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:30.269214 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:51:30.269214 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.269214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:51:30.270261 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:51:30.270261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:51:30.271215 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:51:30.271215 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:51:30.272215 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:51:30.314995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m09:51:30.314995 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m09:51:30.315998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.315998 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.316996 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:51:30.316996 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:51:30.326304 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:51:30.327292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:51:30.327292 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m09:51:30.335305 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.336289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.064 seconds
[0m09:51:30.339305 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.340304 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.341319 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:51:30.342236 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:51:30.343181 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:51:30.344194 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:51:30.346193 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
)

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  )
  );
[0m09:51:30.348876 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:30.351907 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.352906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:51:30.353892 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:51:30.353892 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:51:30.354895 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "cedentes_fidc_com_tipagem"
LINE 45: cedentes_fidc_com_tipagem AS (
         ^

[0m09:51:30.358446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.366437 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.367434 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:51:30.368542 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:51:30.369434 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:51:30.372274 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:51:30.372274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:51:30.415330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m09:51:30.416287 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m09:51:30.428325 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:51:30.429389 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:51:30.431286 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.432385 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.433287 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.433287 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:51:30.434286 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:51:30.434286 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:51:30.436314 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "cedentes_fidc_com_tipagem"
  LINE 45: cedentes_fidc_com_tipagem AS (
           ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:51:30.437285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87A99190>]}
[0m09:51:30.438303 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.22s]
[0m09:51:30.439286 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:51:30.439286 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:51:30.440288 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "cedentes_fidc_com_tipagem"
  LINE 45: cedentes_fidc_com_tipagem AS (
           ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:51:30.440288 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:51:30.440288 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:51:30.442318 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:51:30.443292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:51:30.443292 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.443984 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:51:30.443984 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:51:30.446997 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:51:30.446997 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:51:30.449996 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:51:30.450996 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.450996 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:51:30.450996 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:51:30.455994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m09:51:30.460047 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:51:30.464046 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:51:30.464046 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:51:30.468030 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m09:51:30.469028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m09:51:30.472064 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:51:30.474031 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:51:30.476029 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:51:30.476029 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:51:30.477031 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:51:30.477031 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:51:30.480500 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:51:30.482527 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:51:30.483505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8738FB10>]}
[0m09:51:30.483505 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m09:51:30.484532 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.484532 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m09:51:30.485504 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:51:30.486250 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:51:30.486250 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:51:30.487263 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:51:30.488304 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:51:30.489263 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:51:30.489263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87E5DE50>]}
[0m09:51:30.490263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:51:30.490263 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.28s]
[0m09:51:30.491572 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:51:30.491572 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:51:30.494601 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.495585 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:51:30.498585 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.498585 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:51:30.499587 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:51:30.503585 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.504585 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:51:30.505583 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.506586 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:51:30.506586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D87E4BB50>]}
[0m09:51:30.507586 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:51:30.508214 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:51:30.509229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:51:30.509229 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:51:30.511862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:30.515867 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.516869 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:51:30.521865 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:51:30.522867 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:51:30.523867 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.523867 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:51:30.539655 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:51:30.542662 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:51:30.543661 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:51:30.543661 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:51:30.558485 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m09:51:30.559482 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.560479 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:51:30.564461 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:51:30.566475 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:51:30.567475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D873C5250>]}
[0m09:51:30.567475 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:51:30.569459 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:51:30.569459 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:51:30.573475 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.573475 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:51:30.578752 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:30.581755 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.581755 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:51:30.586800 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:30.588901 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:51:30.588901 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.589799 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:51:30.607833 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m09:51:30.611777 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:51:30.612707 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:51:30.613792 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:51:30.630264 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:51:30.633266 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:51:30.634269 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c70ac3-042f-44b1-86e6-e887a5e81d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8728F550>]}
[0m09:51:30.636283 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:51:30.637262 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:51:30.640262 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.640262 [debug] [MainThread]: On master: BEGIN
[0m09:51:30.641262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:30.679105 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m09:51:30.681095 [debug] [MainThread]: On master: COMMIT
[0m09:51:30.681095 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:30.682111 [debug] [MainThread]: On master: COMMIT
[0m09:51:30.687096 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:51:30.688099 [debug] [MainThread]: On master: Close
[0m09:51:30.690096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:30.690096 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:51:30.691097 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:51:30.692096 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:51:30.692096 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:51:30.693095 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:51:30.693095 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:51:30.694095 [info ] [MainThread]: 
[0m09:51:30.695091 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m09:51:30.697176 [debug] [MainThread]: Command end result
[0m09:51:30.730091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:51:30.732098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:51:30.737094 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:51:30.738092 [info ] [MainThread]: 
[0m09:51:30.739094 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:51:30.740095 [info ] [MainThread]: 
[0m09:51:30.742109 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "cedentes_fidc_com_tipagem"
  LINE 45: cedentes_fidc_com_tipagem AS (
           ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:51:30.743108 [info ] [MainThread]: 
[0m09:51:30.745109 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:51:30.747105 [debug] [MainThread]: Command `dbt run` failed at 09:51:30.747105 after 1.71 seconds
[0m09:51:30.748115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D81559950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D870B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D815D1C10>]}
[0m09:51:30.748115 [debug] [MainThread]: Flushing usage events
[0m09:51:31.604884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:59.706862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956B8E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239569B00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956BDB2D0>]}


============================== 09:52:59.709858 | dee71e0a-0f9a-4d04-934d-884faf498e9c ==============================
[0m09:52:59.709858 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:52:59.710856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:59.856630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395670EA10>]}
[0m09:52:59.897717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023951BC9290>]}
[0m09:52:59.899717 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:00.085390 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:53:00.201569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:00.201569 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:53:00.373802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956B9ABD0>]}
[0m09:53:00.421849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:53:00.425485 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:53:00.443041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023957408F90>]}
[0m09:53:00.444043 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:53:00.444550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956D42850>]}
[0m09:53:00.446560 [info ] [MainThread]: 
[0m09:53:00.447558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:00.448556 [info ] [MainThread]: 
[0m09:53:00.448556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:00.452672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:53:00.509729 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:53:00.509729 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:53:00.510712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:00.589828 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m09:53:00.590825 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:53:00.592823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:53:00.598062 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:00.598062 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:53:00.599077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:00.628912 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:53:00.628912 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:00.629908 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:53:00.639489 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.009 seconds
[0m09:53:00.640452 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:53:00.642590 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:53:00.649373 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:00.649373 [debug] [MainThread]: On master: BEGIN
[0m09:53:00.649373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:00.701553 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m09:53:00.701553 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:00.702548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:00.712260 [debug] [MainThread]: SQL status: SELECT 11 in 0.010 seconds
[0m09:53:00.714962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395740CF90>]}
[0m09:53:00.714962 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:00.718927 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:00.718927 [debug] [MainThread]: On master: BEGIN
[0m09:53:00.726553 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:53:00.726553 [debug] [MainThread]: On master: COMMIT
[0m09:53:00.726553 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:00.727556 [debug] [MainThread]: On master: COMMIT
[0m09:53:00.730570 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:53:00.730570 [debug] [MainThread]: On master: Close
[0m09:53:00.732557 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:00.734063 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:53:00.735069 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:00.735069 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:00.734063 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:53:00.735069 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:53:00.736074 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:53:00.736074 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:53:00.737074 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:53:00.737074 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:53:00.738074 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:53:00.738074 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:53:00.739075 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:00.739075 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:53:00.739075 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:00.740074 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:00.745643 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.747640 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:53:00.750640 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:00.752625 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.754143 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:00.755147 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:53:00.781740 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.782725 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:00.785265 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:53:00.786316 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:00.789341 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:00.789341 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.792342 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.792659 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:00.792659 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:53:00.792659 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:00.794273 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:53:00.794273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:53:00.794273 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.795280 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:53:00.795280 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:00.796279 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:53:00.796279 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:00.797281 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:00.867789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.071 seconds
[0m09:53:00.867789 [debug] [Thread-3 (]: SQL status: BEGIN in 0.073 seconds
[0m09:53:00.868810 [debug] [Thread-4 (]: SQL status: BEGIN in 0.071 seconds
[0m09:53:00.868810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m09:53:00.869810 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:00.869810 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:00.870810 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.870810 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.870810 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:53:00.871809 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
)

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  )
  );
[0m09:53:00.872811 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:53:00.872811 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:53:00.880429 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:53:00.880429 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "'d_cedentes'"
LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                 ^

[0m09:53:00.885832 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:00.886838 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:53:00.886838 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:53:00.886838 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:53:00.887879 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:53:00.890947 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.893947 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.895182 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:53:00.895182 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:53:00.896088 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:53:00.896088 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:53:00.901154 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:00.901154 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:53:00.902063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:53:00.904552 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.904552 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:53:00.905612 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:53:00.948612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m09:53:00.948612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m09:53:00.950832 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.961431 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:53:00.962435 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:53:00.963086 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:53:00.964214 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:53:00.964626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:00.964626 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:00.966631 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023957853790>]}
[0m09:53:00.966631 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:53:00.967631 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:53:00.967631 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.23s]
[0m09:53:00.968634 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:00.969632 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:53:00.969632 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:53:00.970632 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:53:00.969632 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:53:00.972734 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:53:00.972734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:53:00.972734 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:00.972734 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:53:00.974239 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:53:00.976251 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:53:00.977251 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:53:00.980349 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:53:00.980349 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:00.981255 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:53:00.981255 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:00.988739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:53:00.995250 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:53:01.000246 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:01.000246 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:53:01.002247 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m09:53:01.002247 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m09:53:01.005916 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:53:01.007972 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:53:01.007972 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:01.008925 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:01.009922 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:53:01.009922 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:53:01.012074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m09:53:01.013190 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:53:01.014588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395780BF10>]}
[0m09:53:01.014588 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.28s]
[0m09:53:01.015593 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:01.015593 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:53:01.016593 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:53:01.016593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m09:53:01.017594 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:53:01.019594 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.020595 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:53:01.022595 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.024101 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.024101 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:53:01.025107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:01.026112 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:53:01.027113 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:53:01.027113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023957746E50>]}
[0m09:53:01.028113 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:53:01.029112 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:53:01.029112 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:53:01.031141 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:53:01.031141 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023957864290>]}
[0m09:53:01.032112 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.29s]
[0m09:53:01.032112 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:01.059156 [debug] [Thread-3 (]: SQL status: BEGIN in 0.078 seconds
[0m09:53:01.060158 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:01.061157 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:53:01.071342 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:53:01.075878 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:01.076836 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:53:01.092011 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:53:01.096529 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:01.096529 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:53:01.102460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:53:01.105025 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:53:01.106135 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:01.107078 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:53:01.107078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m09:53:01.108038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.109023 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:53:01.137706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m09:53:01.138587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m09:53:01.146441 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.151439 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:53:01.152434 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:53:01.153954 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:01.156076 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:53:01.170621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:53:01.177163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.178059 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:53:01.178839 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:53:01.180937 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:53:01.182854 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395709E510>]}
[0m09:53:01.184584 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:53:01.186594 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:53:01.207291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m09:53:01.210295 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:53:01.211294 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.212297 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:53:01.239969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m09:53:01.241969 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:53:01.241969 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:01.242969 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:53:01.271151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.028 seconds
[0m09:53:01.273152 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:53:01.273152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dee71e0a-0f9a-4d04-934d-884faf498e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956D52150>]}
[0m09:53:01.274151 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.26s]
[0m09:53:01.275181 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:53:01.276185 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:01.276185 [debug] [MainThread]: On master: BEGIN
[0m09:53:01.277187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:01.416445 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m09:53:01.417339 [debug] [MainThread]: On master: COMMIT
[0m09:53:01.417339 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:01.417339 [debug] [MainThread]: On master: COMMIT
[0m09:53:01.449491 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m09:53:01.450450 [debug] [MainThread]: On master: Close
[0m09:53:01.450450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:01.450450 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:53:01.451449 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:53:01.451449 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:53:01.451449 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:53:01.451449 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:53:01.452450 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:53:01.452450 [info ] [MainThread]: 
[0m09:53:01.453955 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m09:53:01.454960 [debug] [MainThread]: Command end result
[0m09:53:01.471977 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:53:01.474091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:53:01.480409 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:53:01.480409 [info ] [MainThread]: 
[0m09:53:01.481409 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:01.482408 [info ] [MainThread]: 
[0m09:53:01.482408 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:53:01.483947 [info ] [MainThread]: 
[0m09:53:01.484955 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:53:01.485979 [debug] [MainThread]: Command `dbt run` failed at 09:53:01.485979 after 1.84 seconds
[0m09:53:01.485979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023950CE9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239567BA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023950D61C10>]}
[0m09:53:01.485979 [debug] [MainThread]: Flushing usage events
[0m09:53:02.916262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:31.031097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD18E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD1C8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD18E890>]}


============================== 09:53:31.035115 | aa546122-8d60-4d74-a418-2af087df538c ==============================
[0m09:53:31.035115 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:53:31.036097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:53:31.181766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD300A50>]}
[0m09:53:31.221971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D9208310>]}
[0m09:53:31.223516 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:31.406162 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:53:31.516725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:31.517725 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:53:31.688746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD318A50>]}
[0m09:53:31.738262 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:53:31.742264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:53:31.759263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD99C050>]}
[0m09:53:31.760263 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:53:31.761263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD3CD010>]}
[0m09:53:31.762263 [info ] [MainThread]: 
[0m09:53:31.763262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:31.763262 [info ] [MainThread]: 
[0m09:53:31.764264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:31.767263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:53:31.822290 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:53:31.822290 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:53:31.822290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:31.961192 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.138 seconds
[0m09:53:31.962198 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:53:31.964175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:53:31.968176 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:31.968176 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:53:31.969176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:32.098237 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m09:53:32.099242 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:53:32.099242 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:53:32.129834 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.030 seconds
[0m09:53:32.131834 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:53:32.161834 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:53:32.167834 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:32.168834 [debug] [MainThread]: On master: BEGIN
[0m09:53:32.168834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:32.333331 [debug] [MainThread]: SQL status: BEGIN in 0.164 seconds
[0m09:53:32.333331 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:32.334331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:32.364992 [debug] [MainThread]: SQL status: SELECT 11 in 0.031 seconds
[0m09:53:32.367996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDA31690>]}
[0m09:53:32.369000 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:32.412155 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:32.413110 [debug] [MainThread]: On master: BEGIN
[0m09:53:32.473633 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m09:53:32.474636 [debug] [MainThread]: On master: COMMIT
[0m09:53:32.474636 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:32.474636 [debug] [MainThread]: On master: COMMIT
[0m09:53:32.504239 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m09:53:32.505242 [debug] [MainThread]: On master: Close
[0m09:53:32.508242 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:32.508242 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:53:32.509242 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:32.510248 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:32.510248 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:53:32.511273 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:53:32.512249 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:53:32.513249 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:53:32.514249 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:53:32.514249 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:53:32.515263 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:53:32.515263 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:53:32.516248 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:32.516248 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:53:32.517246 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:32.517246 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:32.523250 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.524903 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:53:32.528909 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:32.531910 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.532910 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:53:32.533911 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:32.564909 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:53:32.565911 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:32.565911 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:32.568928 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.571907 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.573925 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:32.574925 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.575908 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:53:32.575908 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.576909 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.576909 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:32.576909 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:32.577909 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:53:32.577909 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:53:32.578939 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:53:32.578939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:32.578939 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:53:32.579908 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:32.777882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.201 seconds
[0m09:53:32.778883 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.779884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.201 seconds
[0m09:53:32.780875 [debug] [Thread-4 (]: SQL status: BEGIN in 0.202 seconds
[0m09:53:32.781978 [debug] [Thread-3 (]: SQL status: BEGIN in 0.202 seconds
[0m09:53:32.782939 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:53:32.784878 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.785940 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.786876 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:53:32.788877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:53:32.789928 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:53:32.790933 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  );
  );
[0m09:53:32.812297 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m09:53:32.813285 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m09:53:32.814392 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "'d_cedentes'"
LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                 ^

[0m09:53:32.815545 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m09:53:32.826145 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.829144 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.830128 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:53:32.832154 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.832154 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:53:32.833139 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:53:32.833139 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:53:32.847142 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:53:32.848144 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:53:32.849140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:53:32.849140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:53:32.856237 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.859138 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.899566 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:53:32.900583 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:53:32.901583 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.903585 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:53:32.903585 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:53:32.905681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDA30550>]}
[0m09:53:32.906582 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.39s]
[0m09:53:32.907583 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:53:32.908582 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:53:32.908582 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:53:32.909284 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:53:32.910528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:53:32.910528 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:53:32.912535 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:53:32.913534 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:53:32.916533 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:53:32.916533 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:32.917534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:53:32.917534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:53:32.917534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:53:32.918534 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:53:32.934359 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:32.932268 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:53:32.934359 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:53:32.931369 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:53:32.935268 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.935268 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.936294 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.936294 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:53:32.937267 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:53:32.937267 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:53:32.984266 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m09:53:32.984266 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m09:53:32.985265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m09:53:32.989267 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:53:32.991268 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:53:32.993265 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:53:32.996264 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:53:32.997264 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:53:32.998267 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:53:32.998267 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:53:32.998267 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:53:32.999268 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:53:33.048772 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:53:33.049772 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:53:33.049772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:53:33.051772 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:53:33.052772 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:53:33.053775 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:53:33.053775 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDD7FC50>]}
[0m09:53:33.054774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDD1FB50>]}
[0m09:53:33.054774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDA2C350>]}
[0m09:53:33.055774 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.54s]
[0m09:53:33.056774 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.54s]
[0m09:53:33.057773 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:53:33.056774 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.54s]
[0m09:53:33.057773 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:53:33.058772 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:53:33.059772 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:53:33.060772 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:53:33.060772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:53:33.061774 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:53:33.063772 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.065772 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:53:33.068779 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.069776 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.069776 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:53:33.070776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:33.085772 [debug] [Thread-3 (]: SQL status: BEGIN in 0.151 seconds
[0m09:53:33.086773 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:33.086773 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:53:33.115069 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:53:33.118090 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:33.119109 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:53:33.149001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m09:53:33.157028 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:33.158028 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:53:33.185696 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m09:53:33.189803 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:53:33.191694 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:33.192801 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:53:33.220485 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m09:53:33.225993 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:53:33.225993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.156 seconds
[0m09:53:33.228526 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:53:33.229526 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.230525 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:53:33.231523 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:53:33.251620 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m09:53:33.254628 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.254628 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:53:33.285268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m09:53:33.286211 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.053 seconds
[0m09:53:33.292205 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.294300 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:53:33.295208 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:53:33.295718 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DD29F050>]}
[0m09:53:33.298073 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.39s]
[0m09:53:33.299025 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:53:33.319636 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:53:33.322633 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:53:33.324638 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.325144 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:53:33.353342 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m09:53:33.361479 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:53:33.362486 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:53:33.363473 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:53:33.401586 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.037 seconds
[0m09:53:33.402586 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:53:33.403586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa546122-8d60-4d74-a418-2af087df538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136DDD7A110>]}
[0m09:53:33.403586 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.34s]
[0m09:53:33.404589 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:53:33.405586 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:33.406586 [debug] [MainThread]: On master: BEGIN
[0m09:53:33.406586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:33.596667 [debug] [MainThread]: SQL status: BEGIN in 0.190 seconds
[0m09:53:33.598657 [debug] [MainThread]: On master: COMMIT
[0m09:53:33.599667 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:33.600670 [debug] [MainThread]: On master: COMMIT
[0m09:53:33.631425 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m09:53:33.633371 [debug] [MainThread]: On master: Close
[0m09:53:33.635371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:33.636369 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:53:33.638471 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:53:33.639464 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:53:33.640465 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:53:33.641459 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:53:33.643364 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:53:33.644365 [info ] [MainThread]: 
[0m09:53:33.646462 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m09:53:33.649363 [debug] [MainThread]: Command end result
[0m09:53:33.672357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:53:33.674358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:53:33.679383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:53:33.679383 [info ] [MainThread]: 
[0m09:53:33.680359 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:33.680359 [info ] [MainThread]: 
[0m09:53:33.681385 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near "'d_cedentes'"
  LINE 41:         'd_cedentes' AS source_table -- Adicionando uma colu...
                   ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:53:33.681385 [info ] [MainThread]: 
[0m09:53:33.682358 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:53:33.683384 [debug] [MainThread]: Command `dbt run` failed at 09:53:33.683384 after 2.71 seconds
[0m09:53:33.684359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D4F09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D4F09A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D4F08DD0>]}
[0m09:53:33.684359 [debug] [MainThread]: Flushing usage events
[0m09:53:34.477744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:01.172512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802A927D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802ADBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802A926D0>]}


============================== 09:55:01.177512 | 315edced-a191-4803-a838-95569022f81e ==============================
[0m09:55:01.177512 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:55:01.177512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:55:01.365769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802BF3B10>]}
[0m09:55:01.407017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C87DB99AD0>]}
[0m09:55:01.408033 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:01.597204 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:55:01.711883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:01.712776 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:55:01.881907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802F40FD0>]}
[0m09:55:01.925801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:01.929804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:01.954851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80329FF10>]}
[0m09:55:01.954851 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:55:01.955851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803285550>]}
[0m09:55:01.957872 [info ] [MainThread]: 
[0m09:55:01.958848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:01.958848 [info ] [MainThread]: 
[0m09:55:01.959849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:01.963848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:55:02.020208 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:55:02.021207 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:55:02.021207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:02.181413 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.160 seconds
[0m09:55:02.182416 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:55:02.184416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:55:02.188414 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:02.189414 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:55:02.189414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:02.346076 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m09:55:02.346076 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:02.347077 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:55:02.380801 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m09:55:02.381804 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:55:02.412630 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:55:02.418630 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:02.418630 [debug] [MainThread]: On master: BEGIN
[0m09:55:02.418630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:02.552457 [debug] [MainThread]: SQL status: BEGIN in 0.133 seconds
[0m09:55:02.553458 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:02.553458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:02.583096 [debug] [MainThread]: SQL status: SELECT 11 in 0.029 seconds
[0m09:55:02.585099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803334710>]}
[0m09:55:02.586110 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:02.593079 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:02.593079 [debug] [MainThread]: On master: BEGIN
[0m09:55:02.642465 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m09:55:02.643467 [debug] [MainThread]: On master: COMMIT
[0m09:55:02.643467 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:02.644464 [debug] [MainThread]: On master: COMMIT
[0m09:55:02.649464 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m09:55:02.650470 [debug] [MainThread]: On master: Close
[0m09:55:02.654463 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:02.654463 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:55:02.655463 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:02.656463 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:02.655463 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:55:02.656463 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:55:02.657466 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:55:02.658465 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:55:02.657466 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:55:02.659465 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:55:02.659465 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:55:02.660505 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:02.660505 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:55:02.661467 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:55:02.661467 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:02.666508 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:02.667492 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:02.669510 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:55:02.673508 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:02.676491 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:02.677491 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:02.689000 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:55:02.690001 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:02.690001 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:02.708000 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:02.710017 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:55:02.713001 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:02.715834 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:02.717819 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:02.717819 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:02.718817 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:02.718817 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:55:02.719816 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:02.719816 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:55:02.720816 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:55:02.720816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:55:02.721831 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:55:02.721831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:02.721831 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:55:02.722817 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:55:02.858047 [debug] [Thread-2 (]: SQL status: BEGIN in 0.137 seconds
[0m09:55:02.858047 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:02.858975 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:55:02.892556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.170 seconds
[0m09:55:02.892556 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m09:55:02.893540 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:02.898539 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:02.899540 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  );
  );
[0m09:55:02.899540 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:55:02.923654 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:55:02.923654 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96:   );
            ^

[0m09:55:02.926652 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:02.926652 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m09:55:02.927542 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:55:02.957032 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m09:55:02.958045 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:55:02.969075 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:02.971058 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:02.971058 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:02.976075 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:55:02.978074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803679710>]}
[0m09:55:02.978074 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.32s]
[0m09:55:02.979075 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:02.980078 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:55:02.980078 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m09:55:02.980078 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:55:02.982146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:55:02.983172 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:55:02.986147 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:55:02.987149 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:55:02.991146 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:55:02.992146 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m09:55:03.050148 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.054266 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:55:03.054266 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:55:03.058254 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:03.058254 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:55:03.059149 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:55:03.083463 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:55:03.087472 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:55:03.088471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.366 seconds
[0m09:55:03.089471 [debug] [Thread-4 (]: SQL status: BEGIN in 0.367 seconds
[0m09:55:03.089983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803636D10>]}
[0m09:55:03.090997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:03.092055 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:03.093994 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:55:03.092995 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.43s]
[0m09:55:03.094993 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:55:03.096043 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:55:03.097995 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:55:03.097995 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:55:03.098995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:55:03.099995 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:55:03.102991 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.103991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:55:03.103991 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:55:03.107109 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:03.109990 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:03.111114 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:55:03.111992 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:55:03.111992 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:55:03.114990 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.116989 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.116989 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:55:03.118030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:55:03.120645 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.122651 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:03.122651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:55:03.123651 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:55:03.123651 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m09:55:03.126654 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:03.127651 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.127651 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:55:03.127651 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:55:03.130667 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.131653 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:03.132652 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:03.132652 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:03.132652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.134653 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:03.134653 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:03.135653 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:03.136651 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:55:03.138668 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.139652 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:55:03.143421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.145528 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.145528 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:55:03.147428 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:55:03.149449 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:55:03.149449 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:03.150428 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:55:03.150428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.152428 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:03.152428 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.153449 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:03.159425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m09:55:03.162426 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:55:03.163446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:03.164426 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:55:03.166148 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m09:55:03.166148 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.167156 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:55:03.171266 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:55:03.172212 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m09:55:03.174256 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:55:03.177252 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:55:03.178253 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:55:03.179163 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803786010>]}
[0m09:55:03.180793 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:03.186805 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.187805 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:55:03.188913 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.52s]
[0m09:55:03.189806 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:55:03.190806 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:55:03.192901 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:55:03.193812 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:03.195812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C800E8C5D0>]}
[0m09:55:03.197809 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.54s]
[0m09:55:03.198806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.199882 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:03.204820 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.205806 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:55:03.211223 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:03.213222 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:03.213222 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.214222 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:55:03.214222 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:03.216222 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:55:03.217259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80364FF90>]}
[0m09:55:03.217259 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m09:55:03.218220 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:55:03.232187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m09:55:03.235186 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:55:03.237185 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:03.238199 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:55:03.256368 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:55:03.259383 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:55:03.260367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315edced-a191-4803-a838-95569022f81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C803793750>]}
[0m09:55:03.261384 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:55:03.264370 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:55:03.267380 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:03.268382 [debug] [MainThread]: On master: BEGIN
[0m09:55:03.268382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:03.331708 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m09:55:03.332697 [debug] [MainThread]: On master: COMMIT
[0m09:55:03.333810 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:03.335810 [debug] [MainThread]: On master: COMMIT
[0m09:55:03.345629 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m09:55:03.345629 [debug] [MainThread]: On master: Close
[0m09:55:03.346860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:03.347758 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:55:03.348870 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:55:03.348870 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:55:03.349861 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:55:03.350761 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:55:03.350761 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m09:55:03.351759 [info ] [MainThread]: 
[0m09:55:03.352973 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m09:55:03.356087 [debug] [MainThread]: Command end result
[0m09:55:03.374079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:03.376182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:03.380688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:55:03.381701 [info ] [MainThread]: 
[0m09:55:03.381701 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:03.382695 [info ] [MainThread]: 
[0m09:55:03.383694 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 96:   );
              ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m09:55:03.384696 [info ] [MainThread]: 
[0m09:55:03.385696 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:55:03.387700 [debug] [MainThread]: Command `dbt run` failed at 09:55:03.387700 after 2.27 seconds
[0m09:55:03.388696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C87CCB9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C800E8C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80289F890>]}
[0m09:55:03.388696 [debug] [MainThread]: Flushing usage events
[0m09:55:04.764809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:49.381885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019180D8C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019180DDA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019180C89690>]}


============================== 09:55:49.385436 | 42f2075a-7b04-4e68-a838-14468f34a856 ==============================
[0m09:55:49.385436 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:55:49.386475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:49.533804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019180F6CA10>]}
[0m09:55:49.574110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FCE39610>]}
[0m09:55:49.575150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:49.754920 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:55:49.861615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:49.861615 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m09:55:50.053792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019180D8F3D0>]}
[0m09:55:50.104066 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:50.108078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:50.126631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191826051D0>]}
[0m09:55:50.127633 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m09:55:50.127633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191824BD350>]}
[0m09:55:50.129630 [info ] [MainThread]: 
[0m09:55:50.130631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:50.131630 [info ] [MainThread]: 
[0m09:55:50.131630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:50.135144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:55:50.200119 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:55:50.200119 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:55:50.201139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:50.342628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.142 seconds
[0m09:55:50.344136 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:55:50.347153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:55:50.352151 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:50.353657 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:55:50.353657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:50.486659 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m09:55:50.487663 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:50.487663 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:55:50.517069 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.029 seconds
[0m09:55:50.518577 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:55:50.564723 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:55:50.571730 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:50.571730 [debug] [MainThread]: On master: BEGIN
[0m09:55:50.572731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:50.696068 [debug] [MainThread]: SQL status: BEGIN in 0.123 seconds
[0m09:55:50.697071 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:50.697071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:50.727641 [debug] [MainThread]: SQL status: SELECT 11 in 0.030 seconds
[0m09:55:50.730641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001918261F690>]}
[0m09:55:50.731641 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:50.760778 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:50.761779 [debug] [MainThread]: On master: BEGIN
[0m09:55:50.797704 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m09:55:50.798706 [debug] [MainThread]: On master: COMMIT
[0m09:55:50.798706 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:50.799709 [debug] [MainThread]: On master: COMMIT
[0m09:55:50.802705 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:55:50.802705 [debug] [MainThread]: On master: Close
[0m09:55:50.806082 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:50.806082 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:55:50.807081 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:50.807081 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:50.807081 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:55:50.808081 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m09:55:50.809083 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:55:50.809083 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:55:50.810089 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:55:50.811082 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:55:50.812081 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:55:50.812081 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:55:50.812081 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:50.812081 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:55:50.813586 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:50.813586 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:50.822103 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:50.826615 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:55:50.831616 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:50.834122 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:50.836138 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:50.837137 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:55:50.838138 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:50.870188 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:50.872187 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:55:50.873691 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:50.877695 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:50.878697 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:50.881695 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:50.882697 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:50.882697 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:55:50.883697 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:50.883697 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:55:50.884970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:50.884970 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:50.884970 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:55:50.885974 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:55:50.885974 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:55:50.886970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:55:50.886970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:55:50.991719 [debug] [Thread-4 (]: SQL status: BEGIN in 0.105 seconds
[0m09:55:50.992719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.106 seconds
[0m09:55:50.992719 [debug] [Thread-2 (]: SQL status: BEGIN in 0.107 seconds
[0m09:55:50.993721 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:50.993721 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:50.993721 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:50.994752 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:55:50.995756 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        -- As tabelas têm estruturas ligeiramente diferentes, então preencha com NULL ou o valor apropriado
        CAST(NULL AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(NULL AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente,
        'd_cedentes_fidc' AS source_table -- Adicionando uma coluna para identificar a origem
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT *
FROM cedentes_com_tipagem
WHERE primeira_operacao IS NOT NULL

UNION ALL

SELECT cf.*
FROM cedentes_fidc_com_tipagem cf
WHERE cf.primeira_operacao IS NOT NULL
  AND NOT EXISTS (
      SELECT 1
      FROM cedentes_com_tipagem cc
      WHERE cc.cpf_cnpj = cf.cpf_cnpj
        AND cc.primeira_operacao IS NOT NULL
  )
  );
[0m09:55:50.995756 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:55:51.029793 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m09:55:51.030795 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m09:55:51.030795 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m09:55:51.037326 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:51.041347 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:51.044867 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:51.044867 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:55:51.045887 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:55:51.045887 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:55:51.063883 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m09:55:51.064888 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m09:55:51.064888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m09:55:51.068920 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:51.071887 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:51.129861 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:51.129861 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:55:51.130896 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:55:51.130896 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:55:51.135431 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:51.136431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:51.143453 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:55:51.148965 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:51.150965 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:51.151965 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:55:51.151965 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:51.153471 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:51.153471 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:51.154475 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:51.154475 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:51.154475 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:55:51.198920 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m09:55:51.198920 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m09:55:51.198920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m09:55:51.204435 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:55:51.207436 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:55:51.209436 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:55:51.213945 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:51.214951 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:51.215951 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:51.215951 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:55:51.216950 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:55:51.216950 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:55:51.232721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.348 seconds
[0m09:55:51.232721 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:55:51.232721 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:51.235898 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:55:51.235898 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:55:51.238898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019182860C90>]}
[0m09:55:51.238898 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.42s]
[0m09:55:51.239900 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:51.240896 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:55:51.240896 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:55:51.241898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:55:51.241898 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:55:51.244410 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:55:51.245410 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:55:51.249411 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:55:51.250409 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.251410 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:55:51.251410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:55:51.267117 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.049 seconds
[0m09:55:51.267117 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:55:51.268115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:55:51.269117 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:55:51.271116 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:55:51.274637 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:51.275641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019182988710>]}
[0m09:55:51.275641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019182950E10>]}
[0m09:55:51.275641 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:55:51.276643 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.46s]
[0m09:55:51.276643 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.46s]
[0m09:55:51.277643 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:55:51.278642 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:51.278642 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:55:51.279645 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:55:51.280642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:55:51.280642 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:55:51.283643 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.284150 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:55:51.287162 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.288162 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.289162 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:55:51.289162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:55:51.299671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:55:51.304174 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:51.304174 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:55:51.334605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m09:55:51.336607 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:51.337607 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:51.337607 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:51.368529 [debug] [Thread-4 (]: SQL status: BEGIN in 0.117 seconds
[0m09:55:51.369531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m09:55:51.369531 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.372531 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:55:51.372531 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:55:51.373530 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:51.374552 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:55:51.402197 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:55:51.402197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.028 seconds
[0m09:55:51.406716 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.408718 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:55:51.408718 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:55:51.409716 [debug] [Thread-2 (]: SQL status: BEGIN in 0.120 seconds
[0m09:55:51.410718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191822B9010>]}
[0m09:55:51.410718 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.411716 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:55:51.411716 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.60s]
[0m09:55:51.412716 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:51.414995 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:51.417995 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.417995 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:55:51.449079 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m09:55:51.449079 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m09:55:51.452097 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.454612 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:51.454612 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:55:51.454612 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.455611 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:51.459610 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:51.461610 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.462610 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:55:51.465648 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:51.467649 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:51.467649 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.468649 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:51.501688 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m09:55:51.502688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m09:55:51.504191 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:55:51.507198 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:55:51.508198 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:51.509198 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:51.509198 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:55:51.510198 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:55:51.534231 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:55:51.536238 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:55:51.537239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001918227B990>]}
[0m09:55:51.538238 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:55:51.539238 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:55:51.569776 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.059 seconds
[0m09:55:51.571776 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:55:51.572776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f2075a-7b04-4e68-a838-14468f34a856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001918227A610>]}
[0m09:55:51.573776 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:55:51.574279 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:55:51.576286 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:51.577286 [debug] [MainThread]: On master: BEGIN
[0m09:55:51.577286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:51.685637 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m09:55:51.685637 [debug] [MainThread]: On master: COMMIT
[0m09:55:51.686640 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:51.686640 [debug] [MainThread]: On master: COMMIT
[0m09:55:51.690637 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:55:51.690637 [debug] [MainThread]: On master: Close
[0m09:55:51.691640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:51.691640 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:55:51.692639 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:55:51.692639 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:55:51.692639 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:55:51.693640 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m09:55:51.693640 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:55:51.694146 [info ] [MainThread]: 
[0m09:55:51.694146 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m09:55:51.696163 [debug] [MainThread]: Command end result
[0m09:55:51.715064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:51.718056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:51.724673 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:55:51.725667 [info ] [MainThread]: 
[0m09:55:51.726667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:51.726667 [info ] [MainThread]: 
[0m09:55:51.727668 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:55:51.728668 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:51.728668 after 2.40 seconds
[0m09:55:51.729668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FBFD1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FBF59950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FBF58D50>]}
[0m09:55:51.729668 [debug] [MainThread]: Flushing usage events
[0m09:55:53.785633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:34.007894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E68E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E68E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E68EC90>]}


============================== 10:15:34.012906 | b4cde389-5f65-45f0-82a0-c8dcea211ed1 ==============================
[0m10:15:34.012906 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:15:34.013891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:34.216251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E698FD0>]}
[0m10:15:34.254908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C397897D0>]}
[0m10:15:34.255909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:15:34.473251 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:15:34.593653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:15:34.594653 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:15:34.765984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3EC683D0>]}
[0m10:15:34.814018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:15:34.817798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:15:34.847326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3EF04E90>]}
[0m10:15:34.848359 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:15:34.849325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E842B50>]}
[0m10:15:34.850327 [info ] [MainThread]: 
[0m10:15:34.851327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:34.852325 [info ] [MainThread]: 
[0m10:15:34.852325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:34.856326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:15:34.933254 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:15:34.933254 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:15:34.934212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:35.041967 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.108 seconds
[0m10:15:35.047016 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:15:35.051308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:15:35.061419 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:15:35.061419 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:15:35.062322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:35.214049 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m10:15:35.214049 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:15:35.215050 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:15:35.246065 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.030 seconds
[0m10:15:35.247066 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:15:35.250065 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:15:35.256065 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:35.256065 [debug] [MainThread]: On master: BEGIN
[0m10:15:35.257065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:35.414101 [debug] [MainThread]: SQL status: BEGIN in 0.158 seconds
[0m10:15:35.415101 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:35.415101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:35.447611 [debug] [MainThread]: SQL status: SELECT 11 in 0.032 seconds
[0m10:15:35.449611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3ED2FA90>]}
[0m10:15:35.450611 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:35.480611 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:35.481611 [debug] [MainThread]: On master: BEGIN
[0m10:15:35.515611 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:15:35.515611 [debug] [MainThread]: On master: COMMIT
[0m10:15:35.515611 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:35.516611 [debug] [MainThread]: On master: COMMIT
[0m10:15:35.548120 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m10:15:35.549120 [debug] [MainThread]: On master: Close
[0m10:15:35.553120 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:35.554121 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:15:35.554121 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:35.554121 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:35.555121 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:15:35.556121 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:15:35.556121 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:15:35.558121 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:15:35.557121 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:15:35.558121 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:15:35.559121 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:15:35.559121 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:35.560121 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:15:35.560121 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:15:35.560121 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:35.566120 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.566120 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:35.568123 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:15:35.572124 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:35.574120 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.575120 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:35.576120 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:15:35.576120 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:35.587123 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:35.603229 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.607225 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:15:35.610122 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:35.613282 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.613983 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.615019 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:15:35.615997 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.615997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:35.615997 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:35.616997 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:15:35.616997 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.617997 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:15:35.617997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:15:35.618997 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:15:35.618997 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:15:35.619997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:15:35.757934 [debug] [Thread-2 (]: SQL status: BEGIN in 0.139 seconds
[0m10:15:35.758937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m10:15:35.758937 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.759933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.760938 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:15:35.761935 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:15:35.791889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:15:35.791889 [debug] [Thread-4 (]: SQL status: BEGIN in 0.172 seconds
[0m10:15:35.791889 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:15:35.792905 [debug] [Thread-3 (]: SQL status: BEGIN in 0.174 seconds
[0m10:15:35.797973 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.797973 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.800881 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.800881 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:35.801862 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:15:35.801862 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:15:35.802864 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:15:35.802864 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.*,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
  );
[0m10:15:35.833493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m10:15:35.833493 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m10:15:35.834567 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:15:35.835985 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.836987 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                       ^

[0m10:15:35.840081 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.844505 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.844505 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:15:35.845505 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:15:35.846504 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:15:35.847506 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:15:35.851837 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:15:35.853023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:35.853023 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:15:35.893018 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:15:35.904123 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:15:35.906021 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:15:35.908806 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.909068 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.909666 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.909666 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:15:35.910671 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:15:35.910671 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:15:35.913753 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:15:35.915770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3F389E50>]}
[0m10:15:35.915770 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.36s]
[0m10:15:35.916833 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:35.917735 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:15:35.917735 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:15:35.917735 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:15:35.918734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:15:35.919736 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:15:35.921736 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:15:35.922736 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:15:35.922736 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:15:35.924838 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:15:35.926736 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:15:35.926736 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.927735 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:15:35.927735 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:35.928741 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:15:35.928741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:15:35.944876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m10:15:35.951968 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:15:35.955967 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:35.956965 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:15:35.958127 [debug] [Thread-4 (]: SQL status: COMMIT in 0.030 seconds
[0m10:15:35.958127 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m10:15:35.960136 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:15:35.962242 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:15:35.963215 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:35.963215 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:35.964215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m10:15:35.964215 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:15:35.965214 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:15:35.965214 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:35.966214 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:15:35.974214 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:15:35.978232 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:35.978232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:15:35.978232 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:15:35.981232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:15:35.982215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3EF21CD0>]}
[0m10:15:35.982215 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m10:15:35.983439 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:35.984495 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:15:35.985448 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:35.987486 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:35.984495 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:15:35.988632 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:15:35.988981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m10:15:35.988981 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:15:35.991989 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:15:35.992989 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:15:35.997989 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:15:35.998988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:15:36.000989 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:15:36.000989 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.036 seconds
[0m10:15:36.001989 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m10:15:36.001989 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:36.002993 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.004102 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:15:36.004989 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:15:36.004989 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:15:36.006051 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:15:36.006989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E8B6850>]}
[0m10:15:36.006989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E82E350>]}
[0m10:15:36.007987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:36.007987 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.45s]
[0m10:15:36.009989 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:36.009029 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.45s]
[0m10:15:36.010988 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:15:36.026103 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:15:36.030111 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:15:36.031113 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:36.031113 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:15:36.066247 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m10:15:36.069354 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:15:36.070261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m10:15:36.071262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3E6C7410>]}
[0m10:15:36.072262 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.074260 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:15:36.075258 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:15:36.077257 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:15:36.086318 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:15:36.093308 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.094308 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:15:36.099310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:36.104409 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.105387 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:15:36.110194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:36.112208 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:15:36.113206 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.113206 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:15:36.130191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:15:36.135299 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:15:36.136205 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:36.136205 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:15:36.167488 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.031 seconds
[0m10:15:36.170478 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:15:36.172483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4cde389-5f65-45f0-82a0-c8dcea211ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C3EB7E1D0>]}
[0m10:15:36.173491 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:15:36.175548 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:15:36.179539 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:36.180634 [debug] [MainThread]: On master: BEGIN
[0m10:15:36.180634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:36.238910 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m10:15:36.239911 [debug] [MainThread]: On master: COMMIT
[0m10:15:36.240912 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:36.241978 [debug] [MainThread]: On master: COMMIT
[0m10:15:36.245724 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:15:36.246694 [debug] [MainThread]: On master: Close
[0m10:15:36.247775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:36.248774 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:15:36.248774 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:15:36.249765 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:15:36.250662 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:15:36.251764 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:15:36.251764 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:15:36.252660 [info ] [MainThread]: 
[0m10:15:36.254660 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m10:15:36.257662 [debug] [MainThread]: Command end result
[0m10:15:36.275763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:15:36.278655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:15:36.284654 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:15:36.284654 [info ] [MainThread]: 
[0m10:15:36.285695 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:15:36.286654 [info ] [MainThread]: 
[0m10:15:36.287655 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:15:36.287655 [info ] [MainThread]: 
[0m10:15:36.288655 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:15:36.289655 [debug] [MainThread]: Command `dbt run` failed at 10:15:36.289655 after 2.34 seconds
[0m10:15:36.290672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C388C9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C388C8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C388C9910>]}
[0m10:15:36.290672 [debug] [MainThread]: Flushing usage events
[0m10:15:37.625464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:46.211879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCA8E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCADA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCADAC10>]}


============================== 10:15:46.214875 | 0ddfe864-d748-45a1-be30-cf6b9bfb2464 ==============================
[0m10:15:46.214875 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:15:46.215893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:46.381976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCC06490>]}
[0m10:15:46.423025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED7B29A10>]}
[0m10:15:46.424023 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:15:46.612551 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:15:46.711618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:46.711618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:46.734706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCF61A10>]}
[0m10:15:46.779535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:15:46.783451 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:15:46.799535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD18E150>]}
[0m10:15:46.800437 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:15:46.801434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCEF11D0>]}
[0m10:15:46.803437 [info ] [MainThread]: 
[0m10:15:46.803437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:46.804435 [info ] [MainThread]: 
[0m10:15:46.804435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:46.808436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:15:46.863999 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:15:46.865000 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:15:46.865000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:46.913450 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m10:15:46.914450 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:15:46.916434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:15:46.920432 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:15:46.921434 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:15:46.921434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:47.007294 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m10:15:47.008306 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:15:47.008306 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:15:47.015295 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:15:47.016306 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:15:47.020239 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:15:47.026309 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.026309 [debug] [MainThread]: On master: BEGIN
[0m10:15:47.026309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:47.079286 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m10:15:47.079286 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.080271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:47.089434 [debug] [MainThread]: SQL status: SELECT 11 in 0.009 seconds
[0m10:15:47.092365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCF54CD0>]}
[0m10:15:47.093366 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:47.097330 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.097330 [debug] [MainThread]: On master: BEGIN
[0m10:15:47.112172 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:15:47.112172 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.113217 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.113217 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.117192 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:15:47.117192 [debug] [MainThread]: On master: Close
[0m10:15:47.120172 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:47.120172 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:15:47.120172 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:47.121172 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:47.121172 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:15:47.122173 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:15:47.122173 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:15:47.123172 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:15:47.122173 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:15:47.123172 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:15:47.124201 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:15:47.124201 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:47.125173 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:15:47.131215 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:47.125173 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:47.130172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.125173 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:15:47.135174 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.140174 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:47.143590 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:15:47.144596 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:47.144596 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:47.162411 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:47.174309 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.177344 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.178310 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:15:47.180309 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:47.181345 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.184536 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:15:47.185067 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.185067 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:15:47.186077 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:47.186077 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:15:47.187211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:47.187211 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:15:47.188220 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.188220 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:15:47.189222 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:15:47.189222 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:15:47.191221 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:15:47.221719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m10:15:47.221719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m10:15:47.222719 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:15:47.223769 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.223769 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.*,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
  );
[0m10:15:47.224721 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:15:47.229720 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                       ^

[0m10:15:47.229720 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:15:47.232517 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:15:47.239530 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.240529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m10:15:47.240529 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:15:47.241216 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m10:15:47.241698 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:15:47.241698 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.242705 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.244809 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:15:47.245911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:15:47.246876 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:15:47.249912 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.251816 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:15:47.252878 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:15:47.253835 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:15:47.256815 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.257815 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:15:47.257815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:15:47.258815 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:15:47.259236 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD59CC50>]}
[0m10:15:47.261720 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.276697 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:15:47.278698 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:15:47.278698 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.13s]
[0m10:15:47.279711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.280649 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:15:47.281219 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:15:47.281219 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:15:47.282233 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:15:47.282233 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:15:47.284251 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.285268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:15:47.285268 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:15:47.287233 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:15:47.289235 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.290232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:15:47.291233 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:15:47.291233 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:15:47.294233 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:15:47.295233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:15:47.295233 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:47.297250 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:15:47.299234 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:15:47.299234 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:15:47.300234 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.300234 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.304234 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:15:47.305473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m10:15:47.305473 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:15:47.306479 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:15:47.311479 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:15:47.312479 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.318479 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:15:47.318479 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:15:47.319479 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:15:47.319479 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:15:47.327479 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m10:15:47.329516 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:15:47.330495 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:15:47.330495 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:15:47.341479 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:15:47.341479 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m10:15:47.344477 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:15:47.347483 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:15:47.348481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD6B6150>]}
[0m10:15:47.349485 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:15:47.350482 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:15:47.350482 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:15:47.351481 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:15:47.351481 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:15:47.352483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m10:15:47.352483 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:15:47.354482 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:15:47.354482 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.356482 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:15:47.357482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD6B7D50>]}
[0m10:15:47.356482 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:15:47.358484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m10:15:47.358484 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m10:15:47.359989 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:15:47.359989 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:15:47.362993 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.364995 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.013 seconds
[0m10:15:47.365994 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:15:47.367011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD6F0950>]}
[0m10:15:47.367011 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:15:47.367011 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:15:47.370994 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.367994 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.24s]
[0m10:15:47.374993 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.375993 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:15:47.375993 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:15:47.376995 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.377994 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:15:47.377994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:47.381013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:47.384011 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.385010 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:15:47.388882 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:47.390921 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:15:47.391894 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.391894 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:15:47.404727 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m10:15:47.408759 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:15:47.409726 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:15:47.409726 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:15:47.417725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m10:15:47.417725 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.418725 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:15:47.427046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:15:47.430092 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.431080 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:15:47.431080 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:15:47.433080 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:15:47.434063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD483790>]}
[0m10:15:47.435078 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:15:47.436062 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:15:47.438061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:47.441063 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.441063 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:15:47.445382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:15:47.447385 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:15:47.448384 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.448384 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:15:47.464970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:15:47.469956 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:15:47.471956 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:15:47.473956 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:15:47.492107 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:15:47.493108 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:15:47.494215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfe864-d748-45a1-be30-cf6b9bfb2464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD6B6150>]}
[0m10:15:47.495216 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:15:47.496108 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:15:47.498107 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.498107 [debug] [MainThread]: On master: BEGIN
[0m10:15:47.498107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:47.544549 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m10:15:47.545556 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.546558 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:47.546558 [debug] [MainThread]: On master: COMMIT
[0m10:15:47.549569 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:15:47.550557 [debug] [MainThread]: On master: Close
[0m10:15:47.551559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:47.551559 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:15:47.552557 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:15:47.552557 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:15:47.553555 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:15:47.553555 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:15:47.553555 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:15:47.554588 [info ] [MainThread]: 
[0m10:15:47.555555 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m10:15:47.556559 [debug] [MainThread]: Command end result
[0m10:15:47.629116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:15:47.631117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:15:47.636116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:15:47.636116 [info ] [MainThread]: 
[0m10:15:47.637116 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:15:47.638049 [info ] [MainThread]: 
[0m10:15:47.639059 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 55: ...N cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:15:47.640061 [info ] [MainThread]: 
[0m10:15:47.641062 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:15:47.642098 [debug] [MainThread]: Command `dbt run` failed at 10:15:47.642098 after 1.49 seconds
[0m10:15:47.642098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDC7C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED6C49A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDCF87D50>]}
[0m10:15:47.643088 [debug] [MainThread]: Flushing usage events
[0m10:15:48.383818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:15.397744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957D8DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957DD9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957DDBDD0>]}


============================== 10:16:15.401746 | 6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc ==============================
[0m10:16:15.401746 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:15.402744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:15.548960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957F5B0D0>]}
[0m10:16:15.588056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022953E08CD0>]}
[0m10:16:15.589057 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:16:15.769074 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:15.864014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:16:15.865016 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:16:16.036329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957F470D0>]}
[0m10:16:16.082824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:16:16.085841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:16:16.102826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229596059D0>]}
[0m10:16:16.102826 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:16:16.103825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022959008350>]}
[0m10:16:16.105828 [info ] [MainThread]: 
[0m10:16:16.106825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:16.108825 [info ] [MainThread]: 
[0m10:16:16.109826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:16.113826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:16:16.173345 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:16:16.173345 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:16:16.173345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:16.226412 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m10:16:16.228394 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:16:16.230394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:16:16.234415 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:16:16.234415 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:16:16.235415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:16.288806 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m10:16:16.288806 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:16:16.289796 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:16:16.296814 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:16:16.297815 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:16:16.301813 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:16:16.307813 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.308797 [debug] [MainThread]: On master: BEGIN
[0m10:16:16.308797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:16.338825 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m10:16:16.338825 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.339843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:16.346841 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m10:16:16.350409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295788E550>]}
[0m10:16:16.350409 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:16.353888 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.354897 [debug] [MainThread]: On master: BEGIN
[0m10:16:16.360895 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:16:16.361897 [debug] [MainThread]: On master: COMMIT
[0m10:16:16.361897 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.361897 [debug] [MainThread]: On master: COMMIT
[0m10:16:16.365896 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:16:16.365896 [debug] [MainThread]: On master: Close
[0m10:16:16.368896 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:16:16.369898 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:16:16.369898 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:16.370896 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:16.370896 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:16:16.371897 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:16:16.371897 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:16:16.372897 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:16:16.372897 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:16:16.373896 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:16:16.373896 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:16:16.374916 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:16:16.374916 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:16:16.375898 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:16:16.375898 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:16.375898 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:16.381898 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.384916 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:16:16.387895 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.390896 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.392898 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:16:16.393896 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:16:16.394896 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:16.404896 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:16.424896 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.428269 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:16:16.431369 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.433412 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.434520 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.435418 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.436417 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:16:16.436417 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.436417 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:16:16.437417 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.437417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:16:16.437417 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:16:16.438416 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:16:16.438416 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:16:16.439452 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:16:16.440418 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:16:16.470471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m10:16:16.470471 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.471473 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.*,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m10:16:16.479488 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:16:16.485472 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.486474 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:16:16.491512 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.493513 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.493513 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m10:16:16.494472 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m10:16:16.494472 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:16:16.495472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m10:16:16.495472 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.495472 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.496472 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.497507 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:16:16.497507 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:16:16.498472 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:16:16.500470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.510487 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:16:16.511486 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:16:16.511486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m10:16:16.512496 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.512496 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m10:16:16.515473 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.518487 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.518487 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:16:16.568128 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.569120 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:16:16.569120 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:16:16.570008 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:16:16.574077 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:16:16.574077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.575008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.577107 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.579117 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.582045 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.582045 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:16:16.583008 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:16:16.583008 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:16:16.587701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.587701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.588707 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:16:16.589828 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:16:16.590732 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:16:16.591706 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m10:16:16.592727 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:16:16.592727 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.593710 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.597706 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:16:16.598707 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.598707 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:16:16.599706 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:16:16.602707 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:16.603710 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:16:16.603710 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:16:16.638856 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m10:16:16.638856 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m10:16:16.639828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m10:16:16.639828 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.035 seconds
[0m10:16:16.641935 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:16:16.643828 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:16:16.645943 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:16:16.646890 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:16:16.648493 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:16.649573 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:16.650560 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:16:16.652501 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:16:16.652501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022959A81B90>]}
[0m10:16:16.653500 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:16:16.653500 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:16:16.654986 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.28s]
[0m10:16:16.655992 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:16.655992 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:16:16.656992 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:16:16.657993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:16:16.657993 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:16:16.659993 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:16:16.660993 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:16:16.663992 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:16:16.664993 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.664993 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:16:16.664993 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:16.673991 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:16:16.676019 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:16:16.677008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229598ECDD0>]}
[0m10:16:16.677008 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.30s]
[0m10:16:16.677990 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:16.678991 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:16:16.679991 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:16:16.679991 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m10:16:16.680993 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:16:16.685992 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.686992 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:16:16.692013 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.692991 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m10:16:16.692991 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m10:16:16.694991 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:16:16.696993 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:16:16.696993 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.697992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957F4CA50>]}
[0m10:16:16.698993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022959979910>]}
[0m10:16:16.698993 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:16:16.699991 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:16:16.700992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:16.700992 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.32s]
[0m10:16:16.701992 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:16:16.701992 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:16:16.718028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m10:16:16.719011 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.719011 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:16:16.727008 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:16:16.729991 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.730992 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:16:16.735011 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.737996 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.738996 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:16:16.743011 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.745011 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:16:16.745011 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.745994 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:16:16.747012 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m10:16:16.747012 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.747012 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:16:16.755530 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:16:16.759530 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.760544 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:16:16.763549 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:16:16.763549 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:16:16.765547 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:16:16.769547 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.770546 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:16.771529 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:16:16.771529 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:16:16.775546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:16.776547 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:16:16.777547 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.777547 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:16:16.791550 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.019 seconds
[0m10:16:16.792533 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:16:16.793532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957103E50>]}
[0m10:16:16.794533 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:16:16.795532 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:16:16.811633 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m10:16:16.814530 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:16:16.815531 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:16.815531 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:16:16.831548 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.015 seconds
[0m10:16:16.832547 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:16:16.833549 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa6f86-5ccd-4874-a703-5bb8e5e4a0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022959619690>]}
[0m10:16:16.834561 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:16:16.835559 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:16:16.836564 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.836564 [debug] [MainThread]: On master: BEGIN
[0m10:16:16.837561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:16.865883 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m10:16:16.866883 [debug] [MainThread]: On master: COMMIT
[0m10:16:16.866883 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.866883 [debug] [MainThread]: On master: COMMIT
[0m10:16:16.870884 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:16:16.870884 [debug] [MainThread]: On master: Close
[0m10:16:16.871882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:16.871882 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:16:16.871882 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:16:16.872882 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m10:16:16.872882 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:16:16.872882 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:16:16.872882 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:16:16.873882 [info ] [MainThread]: 
[0m10:16:16.873882 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:16:16.875885 [debug] [MainThread]: Command end result
[0m10:16:16.892882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:16:16.896881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:16:16.901883 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:16:16.902884 [info ] [MainThread]: 
[0m10:16:16.903886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:16.903886 [info ] [MainThread]: 
[0m10:16:16.905883 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:16:16.906884 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:16.906884 after 1.56 seconds
[0m10:16:16.907882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022952FA1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022952FA1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022952F29950>]}
[0m10:16:16.907882 [debug] [MainThread]: Flushing usage events
[0m10:16:17.662471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:56.205498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EBAC8C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EBA85990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EBA861D0>]}


============================== 10:17:56.209720 | 409bfa7a-e789-4204-839e-b4efde45dbc2 ==============================
[0m10:17:56.209720 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:17:56.210719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:17:56.344935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '409bfa7a-e789-4204-839e-b4efde45dbc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EBBCAC10>]}
[0m10:17:56.376415 [debug] [MainThread]: Command `dbt clean` succeeded at 10:17:56.376415 after 0.23 seconds
[0m10:17:56.376415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6E5C09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6E5C08DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EBAB7F50>]}
[0m10:17:56.377417 [debug] [MainThread]: Flushing usage events
[0m10:17:57.643914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:18.315123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A36E9F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A364F5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A38186E10>]}


============================== 10:18:18.318123 | ca8148ea-82d7-4a03-9d96-6ba3b070d2e3 ==============================
[0m10:18:18.318123 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:18:18.319123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:18:18.330668 [info ] [MainThread]: dbt version: 1.9.2
[0m10:18:18.330668 [info ] [MainThread]: python version: 3.11.9
[0m10:18:18.331666 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m10:18:18.332653 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m10:18:18.399762 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m10:18:18.400683 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m10:18:18.401651 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m10:18:18.402703 [info ] [MainThread]: adapter type: postgres
[0m10:18:18.402703 [info ] [MainThread]: adapter version: 1.9.0
[0m10:18:18.472277 [info ] [MainThread]: Configuration:
[0m10:18:18.473172 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:18:18.475172 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:18:18.475172 [info ] [MainThread]: Required dependencies:
[0m10:18:18.476171 [debug] [MainThread]: Executing "git --help"
[0m10:18:18.518178 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:18:18.518178 [debug] [MainThread]: STDERR: "b''"
[0m10:18:18.519178 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:18:18.520177 [info ] [MainThread]: Connection:
[0m10:18:18.521179 [info ] [MainThread]:   host: 172.16.0.239
[0m10:18:18.521179 [info ] [MainThread]:   port: 5432
[0m10:18:18.522177 [info ] [MainThread]:   user: dmx-op-user
[0m10:18:18.522177 [info ] [MainThread]:   database: operacoes
[0m10:18:18.523178 [info ] [MainThread]:   schema: public
[0m10:18:18.523178 [info ] [MainThread]:   connect_timeout: 10
[0m10:18:18.524177 [info ] [MainThread]:   role: None
[0m10:18:18.524177 [info ] [MainThread]:   search_path: None
[0m10:18:18.524177 [info ] [MainThread]:   keepalives_idle: 0
[0m10:18:18.525683 [info ] [MainThread]:   sslmode: None
[0m10:18:18.525683 [info ] [MainThread]:   sslcert: None
[0m10:18:18.526696 [info ] [MainThread]:   sslkey: None
[0m10:18:18.526696 [info ] [MainThread]:   sslrootcert: None
[0m10:18:18.527692 [info ] [MainThread]:   application_name: dbt
[0m10:18:18.527692 [info ] [MainThread]:   retries: 1
[0m10:18:18.528691 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:18.718726 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:18:18.764220 [debug] [MainThread]: Using postgres connection "debug"
[0m10:18:18.765236 [debug] [MainThread]: On debug: select 1 as id
[0m10:18:18.765236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:18.869396 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m10:18:18.870388 [debug] [MainThread]: On debug: Close
[0m10:18:18.870388 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:18:18.871390 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:18:18.872384 [debug] [MainThread]: Command `dbt debug` succeeded at 10:18:18.872384 after 0.61 seconds
[0m10:18:18.872384 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:18:18.872384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A385E41D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A2FF31BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A2FF31C10>]}
[0m10:18:18.873383 [debug] [MainThread]: Flushing usage events
[0m10:18:19.484183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:22.218206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DF98DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DF9DB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DF9DA650>]}


============================== 10:18:22.221210 | 4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d ==============================
[0m10:18:22.221210 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:18:22.222209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:22.370262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFB01C10>]}
[0m10:18:22.412363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DAA28F90>]}
[0m10:18:22.413341 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:22.600370 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:18:22.601354 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:18:22.601354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFB5FB10>]}
[0m10:18:23.330398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E006BA10>]}
[0m10:18:23.375444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:18:23.380444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:18:23.398446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFEB06D0>]}
[0m10:18:23.399445 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:18:23.399445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E00646D0>]}
[0m10:18:23.401444 [info ] [MainThread]: 
[0m10:18:23.401444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:23.402444 [info ] [MainThread]: 
[0m10:18:23.403444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:23.406444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:18:23.464027 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:18:23.465030 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:18:23.465030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:23.545021 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.080 seconds
[0m10:18:23.548021 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:18:23.552016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:18:23.559034 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:18:23.559034 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:18:23.560033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:23.595779 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m10:18:23.596783 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:18:23.596783 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:18:23.604774 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.007 seconds
[0m10:18:23.606776 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:18:23.611756 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:18:23.622800 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:23.623800 [debug] [MainThread]: On master: BEGIN
[0m10:18:23.624788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:23.676112 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m10:18:23.677221 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:23.678226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:23.687180 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m10:18:23.691194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFF58950>]}
[0m10:18:23.691194 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:23.695125 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:23.696127 [debug] [MainThread]: On master: BEGIN
[0m10:18:23.703256 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:18:23.704256 [debug] [MainThread]: On master: COMMIT
[0m10:18:23.705254 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:23.706205 [debug] [MainThread]: On master: COMMIT
[0m10:18:23.710176 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:18:23.711328 [debug] [MainThread]: On master: Close
[0m10:18:23.717546 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:18:23.718571 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:18:23.718571 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:18:23.719592 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:18:23.720545 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:18:23.720545 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:18:23.721553 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:18:23.723551 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:18:23.722553 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:18:23.723551 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:18:23.724551 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:18:23.724551 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:18:23.725552 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:18:23.726550 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:18:23.726550 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:18:23.733565 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.733565 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:18:23.737097 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:18:23.740084 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.743102 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.744084 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:18:23.772083 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:18:23.772083 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:18:23.773086 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:18:23.774086 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:18:23.778084 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.780086 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.783109 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.784086 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.785085 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.785085 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:18:23.786086 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.786086 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.786086 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:18:23.787086 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:18:23.787086 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:18:23.788088 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:18:23.788088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:18:23.789085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:18:23.789085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:18:23.819083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:18:23.820085 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m10:18:23.820085 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.820085 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.821085 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:18:23.821085 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

WITH cedentes_com_tipagem AS (
    SELECT
        nome::VARCHAR(8000) AS nome,
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        endereco::VARCHAR(8000) AS endereco,
        cep::VARCHAR(8000) AS cep,
        cidade::VARCHAR(8000) AS cidade,
        uf::VARCHAR(2) AS uf,
        email::VARCHAR(8000) AS email,
        telefone::VARCHAR(20) AS telefone,
        gerente::VARCHAR(8000) AS gerente,
        operador::VARCHAR(8000) AS operador,
        captador::VARCHAR(8000) AS captador,
        controlador::VARCHAR(8000) AS controlador,
        CAST(REPLACE(fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
        CAST(REPLACE(advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
        TO_DATE(data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
        fonte_captacao::VARCHAR(8000) AS fonte_captacao,
        setor::VARCHAR(8000) AS setor,
        grupo_economico::VARCHAR(8000) AS grupo_economico,
        TO_DATE(primeira_operacao, 'DD/MM/YYYY') AS primeira_operacao_d_cedentes,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
        risco_atual::VARCHAR(8000) AS risco_atual,
        CAST(REPLACE(REPLACE(REGEXP_REPLACE(saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
        TO_DATE(vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
        id_cedente::INT AS id_cedente
    FROM "operacoes"."public"."d_cedentes"
),

cedentes_fidc_com_tipagem AS (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD/MM/YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
)

SELECT
    cc.*,
    COALESCE(cc.primeira_operacao_d_cedentes, cf.primeira_operacao_fidc) AS primeira_operacao
FROM cedentes_com_tipagem cc
LEFT JOIN cedentes_fidc_com_tipagem cf ON cc.cpf_cnpj = cf.cpf_cnpj
  );
[0m10:18:23.832090 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:18:23.833089 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:18:23.837620 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.840596 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.840596 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:18:23.841597 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:18:23.844598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m10:18:23.845597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:18:23.845597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:23.846598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m10:18:23.846598 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.848597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.858597 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:18:23.859599 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.859599 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:18:23.859599 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:18:23.860619 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.860619 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:18:23.861598 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:18:23.864596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:23.867596 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:18:23.867596 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:18:23.867596 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:18:23.868597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.870599 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.873596 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.874596 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:18:23.874596 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:18:23.875597 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:18:23.879597 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:18:23.879597 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:23.881599 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.883597 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.883597 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m10:18:23.883597 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:18:23.884597 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:18:23.889596 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:18:23.893598 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:18:23.893598 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:23.894597 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:23.894597 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:18:23.895598 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:18:23.896598 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:18:23.897597 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.897597 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.897597 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:18:23.898598 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:18:23.903596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m10:18:23.905597 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:18:23.905597 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m10:18:23.905597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:18:23.907598 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:18:23.908597 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:18:23.909598 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFF8EB50>]}
[0m10:18:23.910597 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.18s]
[0m10:18:23.911597 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:18:23.911597 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:18:23.912597 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:18:23.912597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:18:23.912597 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:18:23.915596 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:18:23.916597 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:18:23.918596 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:18:23.919596 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m10:18:23.921601 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:18:23.921601 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:23.921601 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:18:23.923165 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:18:23.923602 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:18:23.923602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:18:23.929602 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:18:23.929602 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m10:18:23.930602 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:18:23.932603 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:18:23.933604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5DFBD3990>]}
[0m10:18:23.934602 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:18:23.934602 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:18:23.934602 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:18:23.936108 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:18:23.937115 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:18:23.937115 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:18:23.938116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m10:18:23.938116 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:18:23.942115 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:18:23.943131 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:18:23.946115 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:18:23.946115 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:18:23.947116 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E0445750>]}
[0m10:18:23.951130 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:18:23.952117 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.22s]
[0m10:18:23.953114 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:18:23.954115 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:23.954115 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:18:23.955114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:23.956116 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:18:23.958132 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:18:23.958132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E051FC50>]}
[0m10:18:23.959114 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m10:18:23.960114 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:18:23.975453 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m10:18:23.976488 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:23.977473 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:18:23.985453 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:18:23.988484 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:23.989455 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:18:23.993453 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:18:23.995453 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:23.996454 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:18:24.000453 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:18:24.001470 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:18:24.001470 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:24.002453 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:18:24.007480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:18:24.007480 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:24.008453 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:18:24.016471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:18:24.020452 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:24.020452 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:18:24.021476 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:18:24.022458 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:18:24.023474 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:18:24.024456 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:18:24.027456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:24.029456 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:24.029456 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:18:24.034015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:18:24.035023 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:18:24.035023 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:24.036022 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:18:24.052729 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.028 seconds
[0m10:18:24.054719 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:18:24.056816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E05EE610>]}
[0m10:18:24.057719 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:18:24.059824 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:18:24.067820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m10:18:24.071715 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:18:24.072716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:18:24.072716 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:18:24.091919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:18:24.093936 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:18:24.094934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c38c07c-b3a8-4dcc-b375-6b6c51f1ce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5E05E7590>]}
[0m10:18:24.094934 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:18:24.096918 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:18:24.098873 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:24.099870 [debug] [MainThread]: On master: BEGIN
[0m10:18:24.099870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:24.149950 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m10:18:24.151950 [debug] [MainThread]: On master: COMMIT
[0m10:18:24.152948 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:24.152948 [debug] [MainThread]: On master: COMMIT
[0m10:18:24.156949 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:18:24.157954 [debug] [MainThread]: On master: Close
[0m10:18:24.158954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:24.159955 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:18:24.159955 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:18:24.160954 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:18:24.161951 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:18:24.161951 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:18:24.163053 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:18:24.163955 [info ] [MainThread]: 
[0m10:18:24.164550 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:18:24.167562 [debug] [MainThread]: Command end result
[0m10:18:24.181557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:18:24.183560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:18:24.189561 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:18:24.190560 [info ] [MainThread]: 
[0m10:18:24.191558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:24.192085 [info ] [MainThread]: 
[0m10:18:24.193090 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:18:24.194091 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:24.194091 after 2.03 seconds
[0m10:18:24.194091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D9C81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D9C09950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D9C08D50>]}
[0m10:18:24.195091 [debug] [MainThread]: Flushing usage events
[0m10:18:25.009571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:06.430808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1ADBE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1AE09490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1ACB95D0>]}


============================== 10:25:06.436768 | fa79f1e7-c82c-4094-bd3f-f85633535c9d ==============================
[0m10:25:06.436768 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:06.437768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:06.649451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C0B6F90>]}
[0m10:25:06.689486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C0FD050>]}
[0m10:25:06.690483 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:06.906880 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:07.032065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:07.033053 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:25:07.194737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C5B0090>]}
[0m10:25:07.245073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:25:07.249341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:25:07.276594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C6FBE50>]}
[0m10:25:07.276594 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:25:07.277617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C5462D0>]}
[0m10:25:07.279591 [info ] [MainThread]: 
[0m10:25:07.280590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:07.280590 [info ] [MainThread]: 
[0m10:25:07.281590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:07.285589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:25:07.340812 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:25:07.342316 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:25:07.342316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:07.450411 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.108 seconds
[0m10:25:07.451412 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:25:07.453551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:25:07.457603 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:07.457603 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:25:07.457603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:07.512267 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m10:25:07.514472 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:07.516469 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:25:07.524470 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:25:07.527467 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:25:07.533648 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:25:07.540707 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:07.540707 [debug] [MainThread]: On master: BEGIN
[0m10:25:07.541708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:07.575866 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:25:07.577862 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:07.578955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:07.588420 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m10:25:07.595311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C5D37D0>]}
[0m10:25:07.596315 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:07.600728 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:07.601728 [debug] [MainThread]: On master: BEGIN
[0m10:25:07.610104 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:25:07.611108 [debug] [MainThread]: On master: COMMIT
[0m10:25:07.612166 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:07.613215 [debug] [MainThread]: On master: COMMIT
[0m10:25:07.617309 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:25:07.618208 [debug] [MainThread]: On master: Close
[0m10:25:07.627225 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:07.628241 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:25:07.629239 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:07.630240 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:07.631239 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:25:07.632238 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:25:07.634238 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:25:07.636249 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:25:07.635237 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:25:07.637235 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:25:07.638234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:25:07.639234 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:07.640234 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:25:07.640234 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:25:07.641251 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:07.646975 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.646975 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:07.648969 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:25:07.652867 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:07.654867 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.656865 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:07.656865 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:25:07.657870 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:07.657870 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:07.688866 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.691889 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:25:07.694876 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:07.697882 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.699866 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.699866 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.700866 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:25:07.700866 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:07.701868 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.701868 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:25:07.701868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:07.702867 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:25:07.702867 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:25:07.703866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:25:07.703866 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:25:07.704867 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:25:07.758396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m10:25:07.759396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m10:25:07.760396 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m10:25:07.760396 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.761395 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.762398 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m10:25:07.762398 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.763421 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:25:07.764398 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:25:07.764398 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:07.765395 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:25:07.767396 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON dc.cpf_cnpj = df.cpf_cnpj;
  );
[0m10:25:07.771395 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj;
                                          ^

[0m10:25:07.771395 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:25:07.772396 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:25:07.772396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:25:07.773397 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:25:07.778397 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.778397 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:25:07.781395 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.783395 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.784396 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:25:07.785397 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:25:07.785397 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:25:07.789396 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:25:07.789396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:25:07.792395 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.792395 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:25:07.795395 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.796396 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:25:07.840400 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.841400 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:25:07.842905 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj;
                                            ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:25:07.842905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:25:07.844912 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1CA03050>]}
[0m10:25:07.845912 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:07.845912 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.21s]
[0m10:25:07.856913 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:25:07.857913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:25:07.857913 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:25:07.858913 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:07.858913 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.860913 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:25:07.861913 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:25:07.862911 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:25:07.862911 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj;
                                            ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:25:07.863914 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:25:07.863914 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.864912 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.864912 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:25:07.866912 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:25:07.866912 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:25:07.867911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:25:07.868912 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:25:07.870911 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:25:07.871911 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:25:07.874914 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:25:07.876919 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.876919 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:25:07.877913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:25:07.887912 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m10:25:07.894911 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:25:07.900913 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:07.901911 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:25:07.905911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m10:25:07.905911 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m10:25:07.907911 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:25:07.909912 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:25:07.910911 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:07.910911 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:07.911911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m10:25:07.911911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:25:07.911911 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:25:07.912912 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.913911 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:25:07.920921 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m10:25:07.923911 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:25:07.923911 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:25:07.924911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1CA7FB50>]}
[0m10:25:07.926912 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.927913 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:25:07.927913 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m10:25:07.928920 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:25:07.928920 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:25:07.929918 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:25:07.929918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m10:25:07.930918 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:25:07.932918 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:25:07.933917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:25:07.935919 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.935919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m10:25:07.936918 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.023 seconds
[0m10:25:07.936918 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:25:07.936918 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:25:07.938919 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:25:07.939918 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:25:07.946031 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:25:07.947030 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:25:07.948031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C079750>]}
[0m10:25:07.948031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C079D90>]}
[0m10:25:07.950044 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:25:07.951030 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:07.950044 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m10:25:07.952030 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.31s]
[0m10:25:07.952030 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.953030 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:25:07.953030 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:07.954031 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:07.954031 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:25:07.955029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:25:07.966433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m10:25:07.968457 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:25:07.969450 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:07.969450 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:25:07.984487 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m10:25:07.986487 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:07.987484 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:25:07.991795 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.022 seconds
[0m10:25:07.992795 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:25:07.993816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C092CD0>]}
[0m10:25:07.994794 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:25:07.994794 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:25:07.995796 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:25:07.998794 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:07.998794 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:25:08.003034 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:08.005054 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:08.006057 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:25:08.009060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:25:08.010055 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:25:08.011055 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:08.011055 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:25:08.026130 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m10:25:08.029165 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:25:08.030138 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:08.031157 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:25:08.050088 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:25:08.054204 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:25:08.057085 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa79f1e7-c82c-4094-bd3f-f85633535c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1C526A50>]}
[0m10:25:08.058150 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:25:08.061084 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:25:08.064080 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:08.065078 [debug] [MainThread]: On master: BEGIN
[0m10:25:08.065078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:08.122424 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m10:25:08.123425 [debug] [MainThread]: On master: COMMIT
[0m10:25:08.124420 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:08.124420 [debug] [MainThread]: On master: COMMIT
[0m10:25:08.129519 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:25:08.129519 [debug] [MainThread]: On master: Close
[0m10:25:08.130637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:08.130637 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:25:08.131573 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:25:08.131573 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m10:25:08.132638 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:25:08.132638 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:25:08.132638 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:25:08.133529 [info ] [MainThread]: 
[0m10:25:08.134531 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:25:08.137639 [debug] [MainThread]: Command end result
[0m10:25:08.160283 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:25:08.164250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:25:08.170250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:25:08.170250 [info ] [MainThread]: 
[0m10:25:08.171250 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:25:08.172249 [info ] [MainThread]: 
[0m10:25:08.172249 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj;
                                            ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:25:08.173289 [info ] [MainThread]: 
[0m10:25:08.174249 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:25:08.175249 [debug] [MainThread]: Command `dbt run` failed at 10:25:08.175249 after 1.81 seconds
[0m10:25:08.175249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D15FE9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D15FE8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D15FE9A90>]}
[0m10:25:08.176249 [debug] [MainThread]: Flushing usage events
[0m10:25:09.164099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:18.839295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D186390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D1C9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D089D90>]}


============================== 10:25:18.843297 | 9febe729-4479-42be-a21e-8d431fa36afa ==============================
[0m10:25:18.843297 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:18.844296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:18.995371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D24D6D0>]}
[0m10:25:19.037356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C39309A90>]}
[0m10:25:19.039378 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:19.216746 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:19.319263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:19.320263 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:25:19.493480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D843E50>]}
[0m10:25:19.537359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:25:19.542355 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:25:19.559345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D99ED50>]}
[0m10:25:19.559345 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:25:19.560360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D842B50>]}
[0m10:25:19.562541 [info ] [MainThread]: 
[0m10:25:19.563524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:19.564524 [info ] [MainThread]: 
[0m10:25:19.564524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:19.568542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:25:19.621523 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:25:19.622522 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:25:19.622522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:19.695954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m10:25:19.696955 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:25:19.697953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:25:19.702952 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:19.702952 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:25:19.703954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:19.749929 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m10:25:19.749929 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:25:19.750915 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:25:19.757912 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:25:19.758913 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:25:19.763461 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:25:19.768449 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:19.769425 [debug] [MainThread]: On master: BEGIN
[0m10:25:19.769425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:19.814803 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m10:25:19.815803 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:19.815803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:19.824475 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m10:25:19.827459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D84B890>]}
[0m10:25:19.827459 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:19.831459 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:19.831459 [debug] [MainThread]: On master: BEGIN
[0m10:25:19.838477 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:25:19.839458 [debug] [MainThread]: On master: COMMIT
[0m10:25:19.839458 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:19.839458 [debug] [MainThread]: On master: COMMIT
[0m10:25:19.843478 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:25:19.844485 [debug] [MainThread]: On master: Close
[0m10:25:19.847479 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:19.848463 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:25:19.849479 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:19.849479 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:19.848463 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:25:19.850464 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:25:19.850464 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:25:19.852463 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:25:19.851462 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:25:19.852463 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:25:19.853514 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:25:19.854463 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:19.854463 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:25:19.854463 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:25:19.855463 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:19.861018 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.861018 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:19.864048 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:25:19.867028 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:19.871028 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:19.872028 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:19.874029 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:25:19.881034 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:19.901029 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.904046 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:25:19.905048 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:19.907046 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:19.910047 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:19.911045 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:19.911045 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.912029 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:25:19.912029 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:19.913029 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:25:19.913029 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:19.913029 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:25:19.914029 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:25:19.914029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:19.915029 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:25:19.915029 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:25:19.916029 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:25:19.942028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m10:25:19.942028 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:25:19.943028 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON dc.cpf_cnpj = df.cpf_cnpj
  );
[0m10:25:19.945028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m10:25:19.945028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m10:25:19.946078 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.946078 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:19.947034 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:25:19.947034 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:25:19.948031 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text = bigint
LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj
                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m10:25:19.948031 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:25:19.952032 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:25:19.953049 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:25:19.954032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:25:19.959056 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:19.961573 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.962573 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:25:19.963573 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:25:19.965589 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  operator does not exist: text = bigint
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:25:19.967589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3DD27690>]}
[0m10:25:19.967589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:19.967589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:19.968593 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m10:25:19.968593 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.11s]
[0m10:25:19.971573 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:19.974573 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:19.974573 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:19.975574 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:25:19.975574 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:25:19.976570 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:25:19.976570 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:25:19.976570 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:25:19.977571 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  operator does not exist: text = bigint
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:25:19.978572 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:25:19.979572 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:25:19.979572 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:25:19.983589 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:25:19.983589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:25:19.984572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:25:20.049331 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.071 seconds
[0m10:25:20.054343 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:25:20.055345 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:25:20.056345 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:25:20.059343 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:20.059343 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:20.061855 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:25:20.062561 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:20.062561 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:25:20.062561 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:25:20.063666 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:25:20.064566 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.065567 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:25:20.065567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:25:20.068567 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:20.070690 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:20.070690 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:25:20.074686 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:25:20.075677 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:25:20.075677 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:20.075677 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:25:20.079685 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m10:25:20.084569 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:25:20.088568 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:25:20.088568 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:25:20.092565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m10:25:20.093566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m10:25:20.094566 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:25:20.096565 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:25:20.097567 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m10:25:20.097567 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:25:20.098568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:25:20.098568 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.099567 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:25:20.099567 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:25:20.100565 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:25:20.103565 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:25:20.104565 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:25:20.105564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D60FD90>]}
[0m10:25:20.106565 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m10:25:20.106565 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:25:20.107564 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:25:20.107564 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:25:20.108565 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:25:20.108565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m10:25:20.111565 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.111565 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:25:20.111565 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:25:20.114564 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.115568 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:25:20.118569 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.119570 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.120567 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:25:20.120567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:25:20.121566 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:25:20.122567 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:25:20.123568 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:25:20.126567 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.127566 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m10:25:20.127566 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BD41750>]}
[0m10:25:20.127566 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:25:20.131568 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:25:20.131568 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.27s]
[0m10:25:20.132565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D1D0690>]}
[0m10:25:20.133567 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:25:20.133567 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:25:20.134568 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:25:20.136565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:20.138567 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:25:20.138567 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.139567 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:25:20.148592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m10:25:20.149572 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.149572 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:25:20.158569 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:25:20.161071 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.162078 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:25:20.163080 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m10:25:20.165076 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:25:20.166076 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:25:20.166076 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:25:20.167074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:25:20.169075 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.170074 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:25:20.174076 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:25:20.175076 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:25:20.176076 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.176076 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:25:20.187075 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:25:20.189074 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:25:20.189074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3DD175D0>]}
[0m10:25:20.190075 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:25:20.191074 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:25:20.205074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m10:25:20.206074 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:25:20.207074 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:25:20.207074 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:25:20.225074 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:25:20.227074 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:25:20.227074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9febe729-4479-42be-a21e-8d431fa36afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3D2EFA90>]}
[0m10:25:20.228074 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.12s]
[0m10:25:20.229076 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:25:20.230075 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:20.231078 [debug] [MainThread]: On master: BEGIN
[0m10:25:20.231078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:20.281572 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m10:25:20.283565 [debug] [MainThread]: On master: COMMIT
[0m10:25:20.283565 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:20.285561 [debug] [MainThread]: On master: COMMIT
[0m10:25:20.289562 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:25:20.290566 [debug] [MainThread]: On master: Close
[0m10:25:20.291565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:20.291565 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:25:20.292562 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:25:20.292562 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m10:25:20.293562 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:25:20.293562 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:25:20.294560 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:25:20.294560 [info ] [MainThread]: 
[0m10:25:20.295574 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m10:25:20.297589 [debug] [MainThread]: Command end result
[0m10:25:20.317693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:25:20.319688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:25:20.324627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:25:20.324627 [info ] [MainThread]: 
[0m10:25:20.325588 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:25:20.326584 [info ] [MainThread]: 
[0m10:25:20.326584 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  operator does not exist: text = bigint
  LINE 46: ) df ON dc.cpf_cnpj = df.cpf_cnpj
                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:25:20.327560 [info ] [MainThread]: 
[0m10:25:20.328363 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:25:20.329369 [debug] [MainThread]: Command `dbt run` failed at 10:25:20.329369 after 1.55 seconds
[0m10:25:20.330369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C37439950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C374B1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C374B1C10>]}
[0m10:25:20.330369 [debug] [MainThread]: Flushing usage events
[0m10:25:21.098821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:19.903236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941F8E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941F8DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941F8E690>]}


============================== 10:26:19.906253 | 3c78f2df-6f07-4df3-ba78-1b29f844277a ==============================
[0m10:26:19.906253 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:26:19.907236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:26:20.073455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9431B7410>]}
[0m10:26:20.116461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F109C50>]}
[0m10:26:20.118357 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:26:20.329129 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:26:20.453190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:20.454170 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:26:20.639049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9436B4190>]}
[0m10:26:20.687049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:26:20.691047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:26:20.709048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94379FF50>]}
[0m10:26:20.709048 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:26:20.710068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943685590>]}
[0m10:26:20.712050 [info ] [MainThread]: 
[0m10:26:20.712674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:26:20.713698 [info ] [MainThread]: 
[0m10:26:20.714684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:20.717686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:26:20.775251 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:26:20.775251 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:26:20.776268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:20.820636 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m10:26:20.821636 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:26:20.823640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:26:20.827639 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:26:20.828640 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:26:20.828640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:20.878722 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m10:26:20.879726 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:26:20.879726 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:26:20.886721 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:26:20.888723 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:26:20.891721 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:26:20.896722 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:20.896722 [debug] [MainThread]: On master: BEGIN
[0m10:26:20.897721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:20.940231 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m10:26:20.940231 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:20.941232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:20.949233 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m10:26:20.952231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94363EC50>]}
[0m10:26:20.952231 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:20.955232 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:20.956231 [debug] [MainThread]: On master: BEGIN
[0m10:26:20.962232 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:26:20.962232 [debug] [MainThread]: On master: COMMIT
[0m10:26:20.963234 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:20.963234 [debug] [MainThread]: On master: COMMIT
[0m10:26:20.966231 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:26:20.967233 [debug] [MainThread]: On master: Close
[0m10:26:20.969233 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:20.969233 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:26:20.969233 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:20.970234 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:20.970234 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:26:20.971234 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:26:20.971234 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:26:20.972233 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:26:20.973233 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:26:20.972233 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:26:20.973233 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:26:20.974233 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:20.974233 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:26:20.975233 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:26:20.975233 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:20.981234 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:20.984233 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:26:20.984233 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:20.989232 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:20.991233 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:20.995238 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:20.995238 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:26:21.021254 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.021254 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:21.024285 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:26:21.024990 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:21.027997 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:21.027997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.030999 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.031996 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:26:21.032998 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.032998 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:21.033996 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:26:21.033996 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:26:21.033996 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.035001 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:26:21.035001 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:26:21.035997 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:26:21.035997 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:26:21.036688 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:26:21.088625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m10:26:21.088625 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m10:26:21.089625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m10:26:21.090144 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.090144 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.091153 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.092151 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:26:21.092151 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:26:21.093153 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:26:21.094179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m10:26:21.095152 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:21.095152 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj;
  );
[0m10:26:21.099147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:26:21.100147 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 46: ....cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj;
                                                                       ^

[0m10:26:21.104151 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.105150 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:26:21.105150 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:26:21.105150 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:26:21.106196 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:26:21.109150 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.111150 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.112149 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:26:21.112149 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:26:21.115150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:26:21.115150 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:26:21.118256 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.119151 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:26:21.119151 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:26:21.120150 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:26:21.122156 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.162775 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.163783 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:26:21.164666 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:26:21.166711 [debug] [Thread-3 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ....cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:26:21.168664 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943ACFFD0>]}
[0m10:26:21.168664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:26:21.168664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:21.169665 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.19s]
[0m10:26:21.180771 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:26:21.180771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:26:21.181666 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:26:21.182665 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:21.182665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.184664 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:26:21.184664 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.185665 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:26:21.185665 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ....cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:26:21.186665 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:26:21.186665 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.187667 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:26:21.187667 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:26:21.189666 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:26:21.189666 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:26:21.190665 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:26:21.194667 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:26:21.195665 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:26:21.198681 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:26:21.199670 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.200668 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:26:21.200668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:26:21.209840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m10:26:21.214868 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:26:21.218868 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:21.219868 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:26:21.221869 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m10:26:21.222906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m10:26:21.223882 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:26:21.225906 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:26:21.226879 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:21.227882 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:21.227882 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:26:21.228882 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:26:21.233878 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m10:26:21.233878 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.234880 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:26:21.236868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m10:26:21.237978 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:26:21.238980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F2C9B10>]}
[0m10:26:21.239876 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m10:26:21.240920 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:21.240920 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:26:21.240920 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:26:21.241874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m10:26:21.242873 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:26:21.244889 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.245873 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:26:21.247874 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.248873 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:26:21.248873 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:26:21.250890 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.251891 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.251891 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.023 seconds
[0m10:26:21.253051 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:21.253349 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:26:21.253349 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:26:21.253994 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:26:21.257110 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.258099 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:26:21.259107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:21.260002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943132810>]}
[0m10:26:21.260002 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:26:21.261001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943130BD0>]}
[0m10:26:21.262002 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m10:26:21.262002 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.29s]
[0m10:26:21.263001 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:26:21.264046 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:21.265001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:26:21.267001 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:26:21.267001 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.268002 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:26:21.289293 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m10:26:21.292294 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:26:21.292294 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:21.293295 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:26:21.300385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m10:26:21.300385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.301387 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:26:21.310389 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:26:21.314386 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.314386 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m10:26:21.315386 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:26:21.316386 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:26:21.317387 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9431B6050>]}
[0m10:26:21.318517 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:26:21.319386 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:26:21.321426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:21.323432 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.324432 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:26:21.328431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:21.329432 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:26:21.330435 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.330435 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:26:21.350697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:26:21.353695 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:26:21.354695 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:21.357693 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:26:21.378694 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:26:21.379696 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:26:21.380696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c78f2df-6f07-4df3-ba78-1b29f844277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943B6FED0>]}
[0m10:26:21.380696 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:26:21.381695 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:26:21.384700 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.384700 [debug] [MainThread]: On master: BEGIN
[0m10:26:21.385694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:21.422693 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:26:21.422693 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.423695 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:21.423695 [debug] [MainThread]: On master: COMMIT
[0m10:26:21.427700 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:26:21.427700 [debug] [MainThread]: On master: Close
[0m10:26:21.428701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:21.428701 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:26:21.428701 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:26:21.429702 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:26:21.429702 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:26:21.430737 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:26:21.430737 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:26:21.430737 [info ] [MainThread]: 
[0m10:26:21.431700 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:26:21.432700 [debug] [MainThread]: Command end result
[0m10:26:21.449215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:26:21.452210 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:26:21.457337 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:26:21.458320 [info ] [MainThread]: 
[0m10:26:21.459213 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:26:21.460211 [info ] [MainThread]: 
[0m10:26:21.460211 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  syntax error at or near ";"
  LINE 46: ....cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj;
                                                                         ^
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:26:21.461209 [info ] [MainThread]: 
[0m10:26:21.462212 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:26:21.463212 [debug] [MainThread]: Command `dbt run` failed at 10:26:21.463212 after 1.62 seconds
[0m10:26:21.464212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93D189950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93FD75290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943CFD250>]}
[0m10:26:21.464212 [debug] [MainThread]: Flushing usage events
[0m10:26:22.265512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:31.895113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5359871D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5359DA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5359C8510>]}


============================== 10:26:31.898113 | 4b9ffec1-bc38-4e8f-b012-a67049d6ff10 ==============================
[0m10:26:31.898113 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:26:31.899113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:26:32.043723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535B40FD0>]}
[0m10:26:32.085455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5309E9910>]}
[0m10:26:32.086440 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:26:32.271681 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:26:32.377188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:32.377188 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:26:32.552923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535E14F50>]}
[0m10:26:32.598465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:26:32.602462 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:26:32.618359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5361FBDD0>]}
[0m10:26:32.619359 [info ] [MainThread]: Found 6 models, 10 sources, 433 macros
[0m10:26:32.620358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535DF1150>]}
[0m10:26:32.622375 [info ] [MainThread]: 
[0m10:26:32.622375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:26:32.623359 [info ] [MainThread]: 
[0m10:26:32.624358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:32.627378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:26:32.678936 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:26:32.679935 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:26:32.679935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:32.735995 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m10:26:32.736998 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:26:32.739980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:26:32.744996 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:26:32.744996 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:26:32.744996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:32.775657 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m10:26:32.776664 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:26:32.776664 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:26:32.784568 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.007 seconds
[0m10:26:32.785566 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:26:32.788633 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:26:32.793683 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.794683 [debug] [MainThread]: On master: BEGIN
[0m10:26:32.794683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:32.825700 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m10:26:32.826684 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.826684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:32.836685 [debug] [MainThread]: SQL status: SELECT 11 in 0.009 seconds
[0m10:26:32.838794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D53622F690>]}
[0m10:26:32.839795 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:32.843705 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.844706 [debug] [MainThread]: On master: BEGIN
[0m10:26:32.851688 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:26:32.851688 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.852688 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:32.852688 [debug] [MainThread]: On master: COMMIT
[0m10:26:32.856046 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:26:32.856046 [debug] [MainThread]: On master: Close
[0m10:26:32.858046 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:32.858046 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:26:32.859046 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:32.859046 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:32.859046 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:26:32.860047 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:26:32.860047 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:26:32.861550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:26:32.861047 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:26:32.862557 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:26:32.862557 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:26:32.863556 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:32.863556 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:26:32.863556 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:26:32.864555 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:32.870571 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.870571 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:32.872554 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:26:32.876557 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:32.878657 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:32.879557 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:32.880558 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:32.881561 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:26:32.916556 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.916556 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:32.919556 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:32.922663 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:26:32.925650 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:32.926660 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.928559 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:32.928559 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:26:32.929560 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:32.930556 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:32.930556 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:26:32.930556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:26:32.931558 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:26:32.931558 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:26:32.932557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:26:32.933556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:26:32.933556 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:26:32.960878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:26:32.960878 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.961882 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:26:32.964882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m10:26:32.964882 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:32.965899 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:26:32.967900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:26:32.973986 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.973986 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:26:32.974884 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:26:32.977900 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:32.977900 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:26:32.980901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:26:32.983882 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:32.983882 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:26:32.984882 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m10:26:32.984882 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m10:26:32.984882 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:26:32.987899 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:32.987899 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:32.988883 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:32.988883 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:26:32.989883 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:26:32.989883 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:26:32.992881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:33.004883 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:26:33.005931 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m10:26:33.005931 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m10:26:33.006965 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:33.006965 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m10:26:33.008883 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:26:33.058105 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:33.058105 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:26:33.061504 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:33.061504 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:33.062603 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:26:33.062603 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:26:33.063511 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:26:33.074510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:33.074510 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:26:33.077512 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:33.079634 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:33.080511 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:26:33.080511 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:26:33.081510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m10:26:33.086612 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:26:33.086612 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:26:33.087511 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:26:33.091508 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:26:33.091508 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m10:26:33.093510 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:26:33.095509 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:26:33.095509 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:26:33.097526 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:26:33.098508 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:33.098508 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:33.099508 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:26:33.099508 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:26:33.100508 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:26:33.100508 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:26:33.116533 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:26:33.118548 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:26:33.120550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535E2DBD0>]}
[0m10:26:33.121533 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.26s]
[0m10:26:33.122534 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:26:33.122534 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:26:33.123535 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:26:33.123535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_operacoes)
[0m10:26:33.123535 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:26:33.126534 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:26:33.126534 [debug] [Thread-4 (]: SQL status: COMMIT in 0.026 seconds
[0m10:26:33.127637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.026 seconds
[0m10:26:33.127637 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m10:26:33.129557 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:26:33.129557 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:26:33.130535 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:26:33.132532 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:26:33.133532 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:26:33.136531 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:26:33.137534 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535B52010>]}
[0m10:26:33.138534 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:26:33.138534 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:26:33.140534 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:26:33.140534 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.139535 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m10:26:33.141535 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:26:33.142534 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:26:33.142534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:33.142534 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:26:33.143535 [info ] [Thread-2 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:26:33.144566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m10:26:33.144566 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:26:33.149542 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.150541 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:26:33.152541 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.153541 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.154541 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:26:33.154541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:26:33.158712 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:26:33.159832 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:26:33.159832 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535BB6910>]}
[0m10:26:33.159832 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.30s]
[0m10:26:33.161439 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:26:33.167566 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.026 seconds
[0m10:26:33.168568 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:26:33.169550 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535BA9690>]}
[0m10:26:33.170569 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.31s]
[0m10:26:33.170569 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:26:33.187328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m10:26:33.187328 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.188329 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:26:33.197327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:26:33.202327 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.203326 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:26:33.203326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m10:26:33.204326 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.204326 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:26:33.207326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:26:33.209344 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.209344 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:26:33.213650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:33.215735 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:26:33.216626 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:26:33.216626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.218730 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.219734 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:26:33.219734 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:26:33.224625 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:26:33.227625 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.227625 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:26:33.235058 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:26:33.237071 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:26:33.237071 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.238071 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:26:33.240187 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m10:26:33.242069 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:26:33.243068 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:26:33.243068 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:26:33.252243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m10:26:33.255243 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:26:33.256243 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:26:33.257244 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:26:33.258224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:26:33.260140 [debug] [Thread-1 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:26:33.261649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D536528A50>]}
[0m10:26:33.261649 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:26:33.263658 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:26:33.272656 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:26:33.273656 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:26:33.274675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9ffec1-bc38-4e8f-b012-a67049d6ff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D535B531D0>]}
[0m10:26:33.275671 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:26:33.276576 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:26:33.279583 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:33.280585 [debug] [MainThread]: On master: BEGIN
[0m10:26:33.280585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:33.328424 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m10:26:33.329422 [debug] [MainThread]: On master: COMMIT
[0m10:26:33.330423 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:33.330423 [debug] [MainThread]: On master: COMMIT
[0m10:26:33.335531 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:26:33.336425 [debug] [MainThread]: On master: Close
[0m10:26:33.336425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:33.337424 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:26:33.337424 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:26:33.338422 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:26:33.338422 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:26:33.338422 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m10:26:33.338422 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:26:33.339421 [info ] [MainThread]: 
[0m10:26:33.340153 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:26:33.342076 [debug] [MainThread]: Command end result
[0m10:26:33.356095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:26:33.358096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:26:33.363617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:26:33.364609 [info ] [MainThread]: 
[0m10:26:33.365609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:33.366609 [info ] [MainThread]: 
[0m10:26:33.366609 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:26:33.367607 [debug] [MainThread]: Command `dbt run` succeeded at 10:26:33.367607 after 1.54 seconds
[0m10:26:33.367607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5356BD190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D52FB81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D52FB81BD0>]}
[0m10:26:33.368608 [debug] [MainThread]: Flushing usage events
[0m10:26:34.140198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:14.123340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0328DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD032C8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD032C8890>]}


============================== 17:19:14.131369 | 02238340-f562-4b31-9153-5fa80cbeb14f ==============================
[0m17:19:14.131369 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:19:14.133341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:19:14.501771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD03414FD0>]}
[0m17:19:14.541770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCFF409CD0>]}
[0m17:19:14.544769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:19:14.845087 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:19:15.146369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:19:15.147370 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\fato_quitados.sql
[0m17:19:15.147370 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m17:19:15.387241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD037459D0>]}
[0m17:19:15.436239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m17:19:15.459305 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m17:19:15.617169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD03B32690>]}
[0m17:19:15.617169 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m17:19:15.618170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0371F690>]}
[0m17:19:15.620169 [info ] [MainThread]: 
[0m17:19:15.620169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:15.621171 [info ] [MainThread]: 
[0m17:19:15.622169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:15.626511 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m17:19:17.975027 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m17:19:17.976037 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m17:19:17.976037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:18.094914 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.118 seconds
[0m17:19:18.095914 [debug] [ThreadPool]: On list_operacoes: Close
[0m17:19:18.099034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m17:19:18.102915 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:19:18.104021 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m17:19:18.104021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:18.216257 [debug] [ThreadPool]: SQL status: BEGIN in 0.112 seconds
[0m17:19:18.216257 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m17:19:18.217258 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:19:18.248363 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.031 seconds
[0m17:19:18.250257 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m17:19:18.275382 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m17:19:18.281680 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:18.282698 [debug] [MainThread]: On master: BEGIN
[0m17:19:18.282698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:18.362847 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m17:19:18.363788 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:18.363788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:18.389569 [debug] [MainThread]: SQL status: SELECT 12 in 0.024 seconds
[0m17:19:18.391569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD050687D0>]}
[0m17:19:18.392467 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:18.415528 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:18.415528 [debug] [MainThread]: On master: BEGIN
[0m17:19:18.468334 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m17:19:18.468334 [debug] [MainThread]: On master: COMMIT
[0m17:19:18.469353 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:18.469353 [debug] [MainThread]: On master: COMMIT
[0m17:19:18.495897 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m17:19:18.495897 [debug] [MainThread]: On master: Close
[0m17:19:18.501896 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m17:19:18.502896 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m17:19:18.503897 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m17:19:18.503897 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m17:19:18.502896 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m17:19:18.503897 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m17:19:18.504896 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m17:19:18.505895 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m17:19:18.506923 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m17:19:18.506923 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m17:19:18.507896 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m17:19:18.508912 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m17:19:18.508912 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m17:19:18.509899 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m17:19:18.509899 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m17:19:18.510895 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m17:19:18.517897 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.582583 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m17:19:18.586605 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.589582 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.591583 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m17:19:18.592585 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m17:19:18.616688 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.617678 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m17:19:18.620684 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m17:19:18.621584 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m17:19:18.624688 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.625584 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.628678 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.629699 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.629699 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m17:19:18.630585 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.631584 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m17:19:18.631584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:18.632584 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.632584 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m17:19:18.633583 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:19:18.633583 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m17:19:18.634584 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:19:18.635582 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:19:18.710619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.076 seconds
[0m17:19:18.711619 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.712621 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m17:19:18.739618 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m17:19:18.745620 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.745620 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m17:19:18.764621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m17:19:18.768620 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.769625 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m17:19:18.773622 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:19:18.787681 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m17:19:18.788681 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.788681 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m17:19:18.789703 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m17:19:18.789703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.157 seconds
[0m17:19:18.790683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m17:19:18.790683 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.791681 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.791681 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.792682 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m17:19:18.792682 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj, endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT id, nome,CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco, cep, cidade, uf, e_mail, telefone, sms, data_cadastro, timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m17:19:18.793682 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m17:19:18.805681 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:19:18.805681 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:19:18.805681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:19:18.808681 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.812683 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.812683 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m17:19:18.814681 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.815680 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m17:19:18.816682 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m17:19:18.820681 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m17:19:18.821680 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m17:19:18.825680 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m17:19:18.826681 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m17:19:18.848680 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m17:19:18.849681 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m17:19:18.849681 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.022 seconds
[0m17:19:18.849681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m17:19:18.852683 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.854681 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.856684 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m17:19:18.859682 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.860682 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m17:19:18.860682 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m17:19:18.861688 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m17:19:18.864686 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD037535D0>]}
[0m17:19:18.865688 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.35s]
[0m17:19:18.866687 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m17:19:18.866687 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m17:19:18.867686 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m17:19:18.867686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m17:19:18.868689 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m17:19:18.870688 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m17:19:18.872687 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m17:19:18.875720 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m17:19:18.877908 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:18.877908 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m17:19:18.877908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:19:18.878906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:19:18.879907 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:19:18.879907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:19:18.881906 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m17:19:18.883939 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m17:19:18.885906 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m17:19:18.885906 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.886908 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.887906 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.888906 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m17:19:18.888906 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m17:19:18.889911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m17:19:18.917925 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m17:19:18.920922 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m17:19:18.921906 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m17:19:18.922905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m17:19:18.922905 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m17:19:18.923934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m17:19:18.926922 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m17:19:18.928924 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m17:19:18.929905 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m17:19:18.930923 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m17:19:18.931906 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m17:19:18.931906 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m17:19:18.950017 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.027 seconds
[0m17:19:18.951905 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m17:19:18.952905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD033F4550>]}
[0m17:19:18.952905 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.44s]
[0m17:19:18.953908 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m17:19:18.954905 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m17:19:18.954905 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m17:19:18.955905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m17:19:18.956905 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m17:19:18.959921 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m17:19:18.960905 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.028 seconds
[0m17:19:18.960905 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.028 seconds
[0m17:19:18.961947 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m17:19:18.962908 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m17:19:18.963908 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m17:19:18.963908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD032DA950>]}
[0m17:19:18.967910 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m17:19:18.969909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD05047190>]}
[0m17:19:18.968910 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m17:19:18.971911 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m17:19:18.970910 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.46s]
[0m17:19:18.971911 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:18.972911 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m17:19:18.973911 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m17:19:18.974911 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:19:18.989420 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m17:19:18.990420 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:18.990420 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m17:19:19.021421 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m17:19:19.024422 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:19.025422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m17:19:19.045423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m17:19:19.048422 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:19.048422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m17:19:19.053421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:19:19.054422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m17:19:19.055422 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:19.055422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m17:19:19.064638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.089 seconds
[0m17:19:19.064638 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:19.065644 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m17:19:19.096812 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m17:19:19.096812 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m17:19:19.098810 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m17:19:19.101813 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:19.101813 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m17:19:19.102811 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m17:19:19.102811 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m17:19:19.107829 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:19:19.111949 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:19.111949 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m17:19:19.135811 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.032 seconds
[0m17:19:19.136810 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m17:19:19.137810 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m17:19:19.138810 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m17:19:19.139809 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD034C6AD0>]}
[0m17:19:19.140810 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:19.141810 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m17:19:19.141810 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m17:19:19.142810 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m17:19:19.176167 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m17:19:19.179675 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m17:19:19.180717 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m17:19:19.180717 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m17:19:19.208091 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.027 seconds
[0m17:19:19.210094 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m17:19:19.210094 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02238340-f562-4b31-9153-5fa80cbeb14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD03A35550>]}
[0m17:19:19.211093 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.25s]
[0m17:19:19.212093 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m17:19:19.214093 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:19.214093 [debug] [MainThread]: On master: BEGIN
[0m17:19:19.215092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:19.262095 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:19:19.263095 [debug] [MainThread]: On master: COMMIT
[0m17:19:19.263095 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:19.264095 [debug] [MainThread]: On master: COMMIT
[0m17:19:19.268095 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:19:19.268095 [debug] [MainThread]: On master: Close
[0m17:19:19.269098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:19.270097 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m17:19:19.270097 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m17:19:19.270097 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m17:19:19.271097 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m17:19:19.271097 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m17:19:19.271097 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m17:19:19.272096 [info ] [MainThread]: 
[0m17:19:19.272096 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m17:19:19.274097 [debug] [MainThread]: Command end result
[0m17:19:19.293606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m17:19:19.297607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m17:19:19.305606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m17:19:19.306607 [info ] [MainThread]: 
[0m17:19:19.306607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:19.307606 [info ] [MainThread]: 
[0m17:19:19.308607 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:19:19.309605 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:19.309605 after 5.30 seconds
[0m17:19:19.309605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD01FC88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCFD5D1C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCFD5D1C90>]}
[0m17:19:19.310606 [debug] [MainThread]: Flushing usage events
[0m17:19:20.196641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:53:17.059291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C38C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C3D9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C288B50>]}


============================== 08:53:17.068291 | 8b9e5984-6ef4-4379-8a27-9611d200aeff ==============================
[0m08:53:17.068291 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:53:17.068291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:53:17.130963 [info ] [MainThread]: dbt version: 1.9.2
[0m08:53:17.131964 [info ] [MainThread]: python version: 3.11.9
[0m08:53:17.132947 [info ] [MainThread]: python path: C:\Users\henrique.soares\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
[0m08:53:17.133946 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m08:53:17.414308 [info ] [MainThread]: Using profiles dir at C:\Users\henrique.soares\Desktop\dbt
[0m08:53:17.415312 [info ] [MainThread]: Using profiles.yml file at C:\Users\henrique.soares\Desktop\dbt\profiles.yml
[0m08:53:17.416240 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\henrique.soares\Desktop\dbt\dbt_project.yml
[0m08:53:17.419219 [info ] [MainThread]: adapter type: postgres
[0m08:53:17.420227 [info ] [MainThread]: adapter version: 1.9.0
[0m08:53:17.487698 [info ] [MainThread]: Configuration:
[0m08:53:17.488718 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:53:17.489695 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:53:17.489695 [info ] [MainThread]: Required dependencies:
[0m08:53:17.490959 [debug] [MainThread]: Executing "git --help"
[0m08:53:17.563239 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:53:17.563239 [debug] [MainThread]: STDERR: "b''"
[0m08:53:17.564239 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:53:17.565240 [info ] [MainThread]: Connection:
[0m08:53:17.566241 [info ] [MainThread]:   host: 172.16.0.239
[0m08:53:17.566241 [info ] [MainThread]:   port: 5432
[0m08:53:17.567239 [info ] [MainThread]:   user: dmx-op-user
[0m08:53:17.567239 [info ] [MainThread]:   database: operacoes
[0m08:53:17.568240 [info ] [MainThread]:   schema: public
[0m08:53:17.568240 [info ] [MainThread]:   connect_timeout: 10
[0m08:53:17.569240 [info ] [MainThread]:   role: None
[0m08:53:17.569240 [info ] [MainThread]:   search_path: None
[0m08:53:17.570242 [info ] [MainThread]:   keepalives_idle: 0
[0m08:53:17.570242 [info ] [MainThread]:   sslmode: None
[0m08:53:17.571240 [info ] [MainThread]:   sslcert: None
[0m08:53:17.571240 [info ] [MainThread]:   sslkey: None
[0m08:53:17.572240 [info ] [MainThread]:   sslrootcert: None
[0m08:53:17.572240 [info ] [MainThread]:   application_name: dbt
[0m08:53:17.573240 [info ] [MainThread]:   retries: 1
[0m08:53:17.573240 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:53:17.802038 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:53:18.636924 [debug] [MainThread]: Using postgres connection "debug"
[0m08:53:18.636924 [debug] [MainThread]: On debug: select 1 as id
[0m08:53:18.637883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:18.726625 [debug] [MainThread]: SQL status: SELECT 1 in 0.089 seconds
[0m08:53:18.728626 [debug] [MainThread]: On debug: Close
[0m08:53:18.729627 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:53:18.729627 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:53:18.731626 [debug] [MainThread]: Command `dbt debug` succeeded at 08:53:18.731626 after 1.75 seconds
[0m08:53:18.732625 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:53:18.732625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C57A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C0BD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237566D1C10>]}
[0m08:53:18.732625 [debug] [MainThread]: Flushing usage events
[0m08:53:19.422161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:53:22.940663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E088E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0788950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E088E590>]}


============================== 08:53:22.945671 | ec4bdf9e-6a97-4d6c-851e-565c44fe6342 ==============================
[0m08:53:22.945671 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:53:22.946656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:53:23.180253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0AB72D0>]}
[0m08:53:23.220303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DB8F8A50>]}
[0m08:53:23.221196 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:53:23.424445 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:53:23.687137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:53:23.688215 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dim_sacados.sql
[0m08:53:23.865142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0F96B50>]}
[0m08:53:23.911861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:53:23.922861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:53:23.966145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E1113E90>]}
[0m08:53:23.966145 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m08:53:23.967159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0FD78D0>]}
[0m08:53:23.969161 [info ] [MainThread]: 
[0m08:53:23.969161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:23.970092 [info ] [MainThread]: 
[0m08:53:23.970092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:23.974098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m08:53:24.036096 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m08:53:24.037096 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m08:53:24.037096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:24.195670 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.158 seconds
[0m08:53:24.199738 [debug] [ThreadPool]: On list_operacoes: Close
[0m08:53:24.203727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m08:53:24.213739 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:53:24.214739 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m08:53:24.214739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:24.327630 [debug] [ThreadPool]: SQL status: BEGIN in 0.112 seconds
[0m08:53:24.327630 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m08:53:24.328649 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:53:24.336651 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.007 seconds
[0m08:53:24.338650 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m08:53:24.342654 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m08:53:24.352752 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:24.353745 [debug] [MainThread]: On master: BEGIN
[0m08:53:24.353745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:24.517094 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m08:53:24.518096 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:24.518096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:24.527934 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m08:53:24.530982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E1449950>]}
[0m08:53:24.530982 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:24.556671 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:24.556671 [debug] [MainThread]: On master: BEGIN
[0m08:53:24.592182 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m08:53:24.593182 [debug] [MainThread]: On master: COMMIT
[0m08:53:24.593182 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:24.594188 [debug] [MainThread]: On master: COMMIT
[0m08:53:24.623431 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m08:53:24.624542 [debug] [MainThread]: On master: Close
[0m08:53:24.628438 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m08:53:24.629456 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m08:53:24.629456 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m08:53:24.630438 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m08:53:24.631436 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m08:53:24.631436 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m08:53:24.632436 [info ] [Thread-3 (]: 3 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m08:53:24.632436 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m08:53:24.633435 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m08:53:24.633435 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m08:53:24.634440 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m08:53:24.634440 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m08:53:24.635437 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m08:53:24.635437 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m08:53:24.636436 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m08:53:24.636436 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m08:53:24.642451 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.645437 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m08:53:24.649544 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.652438 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.654437 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m08:53:24.681958 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.682957 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m08:53:24.682957 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m08:53:24.684067 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m08:53:24.684067 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.686973 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m08:53:24.690063 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.692052 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.692959 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m08:53:24.693957 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:24.693957 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.695168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:53:24.695168 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m08:53:24.695168 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.696218 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m08:53:24.697174 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:53:24.697174 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m08:53:24.697174 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:53:24.698173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:53:24.857296 [debug] [Thread-4 (]: SQL status: BEGIN in 0.159 seconds
[0m08:53:24.859322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m08:53:24.860320 [debug] [Thread-2 (]: SQL status: BEGIN in 0.163 seconds
[0m08:53:24.861324 [debug] [Thread-3 (]: SQL status: BEGIN in 0.163 seconds
[0m08:53:24.862318 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.864321 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.865317 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:24.866334 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.867331 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m08:53:24.868333 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m08:53:24.868333 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m08:53:24.869333 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m08:53:24.903053 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m08:53:24.903053 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m08:53:24.903053 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m08:53:24.904052 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m08:53:24.908052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.911155 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.914052 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:24.917157 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.917157 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m08:53:24.918053 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m08:53:24.918053 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m08:53:24.919102 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m08:53:24.932144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m08:53:24.968056 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m08:53:24.970054 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:24.971054 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m08:53:24.971054 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.051 seconds
[0m08:53:24.973058 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:24.973058 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m08:53:24.974058 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.054 seconds
[0m08:53:24.975056 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:24.977058 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:24.978057 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m08:53:24.978544 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m08:53:24.996819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m08:53:24.996819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m08:53:24.998097 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m08:53:24.998097 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m08:53:25.010102 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m08:53:25.011860 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:53:25.012955 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m08:53:25.013861 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m08:53:25.014616 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:25.015047 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:25.015047 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:25.016053 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:25.016053 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m08:53:25.016053 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m08:53:25.017057 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m08:53:25.017057 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m08:53:25.061658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m08:53:25.063656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m08:53:25.064698 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m08:53:25.065878 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m08:53:25.076892 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m08:53:25.079986 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m08:53:25.084375 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m08:53:25.088615 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m08:53:25.096507 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m08:53:25.097766 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m08:53:25.099908 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m08:53:25.101001 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m08:53:25.101909 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m08:53:25.102955 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m08:53:25.103922 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m08:53:25.104913 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m08:53:25.145248 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.039 seconds
[0m08:53:25.147362 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.040 seconds
[0m08:53:25.148475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.042 seconds
[0m08:53:25.149458 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.042 seconds
[0m08:53:25.154356 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m08:53:25.157468 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m08:53:25.159464 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m08:53:25.162453 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m08:53:25.171395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E1127690>]}
[0m08:53:25.172364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0ACCA90>]}
[0m08:53:25.173370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0FD7810>]}
[0m08:53:25.174368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E13F1A90>]}
[0m08:53:25.174368 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.53s]
[0m08:53:25.175390 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.53s]
[0m08:53:25.177412 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.53s]
[0m08:53:25.178367 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.54s]
[0m08:53:25.179367 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m08:53:25.179367 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m08:53:25.180873 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m08:53:25.181900 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m08:53:25.182881 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m08:53:25.183883 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m08:53:25.185886 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m08:53:25.186882 [info ] [Thread-3 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m08:53:25.187883 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m08:53:25.187883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_titulosabertos)
[0m08:53:25.188881 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m08:53:25.188881 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m08:53:25.191880 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m08:53:25.195880 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.197881 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m08:53:25.197881 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m08:53:25.203879 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m08:53:25.207678 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.208678 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.210678 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m08:53:25.210678 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.211686 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:53:25.212443 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m08:53:25.212443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:53:25.333175 [debug] [Thread-4 (]: SQL status: BEGIN in 0.122 seconds
[0m08:53:25.333175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.120 seconds
[0m08:53:25.334181 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.334181 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.334181 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m08:53:25.335173 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m08:53:25.344008 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m08:53:25.344008 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m08:53:25.347068 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.349161 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.350130 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m08:53:25.350130 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m08:53:25.370803 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m08:53:25.377902 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.378805 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m08:53:25.379801 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m08:53:25.384552 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.385457 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m08:53:25.408557 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m08:53:25.412656 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m08:53:25.413661 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.414660 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m08:53:25.415664 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m08:53:25.418658 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m08:53:25.419663 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.419663 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m08:53:25.446049 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m08:53:25.449042 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m08:53:25.450044 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m08:53:25.450044 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m08:53:25.471485 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m08:53:25.472499 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.021 seconds
[0m08:53:25.475495 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m08:53:25.477541 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m08:53:25.478493 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m08:53:25.479493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E0A19F50>]}
[0m08:53:25.479493 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m08:53:25.479493 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m08:53:25.480999 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m08:53:25.509469 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.028 seconds
[0m08:53:25.511359 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m08:53:25.512358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4bdf9e-6a97-4d6c-851e-565c44fe6342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E1578990>]}
[0m08:53:25.513361 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.32s]
[0m08:53:25.515357 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m08:53:25.517356 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:25.518463 [debug] [MainThread]: On master: BEGIN
[0m08:53:25.518463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:25.615869 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m08:53:25.616863 [debug] [MainThread]: On master: COMMIT
[0m08:53:25.617974 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:25.617974 [debug] [MainThread]: On master: COMMIT
[0m08:53:25.643910 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m08:53:25.644955 [debug] [MainThread]: On master: Close
[0m08:53:25.646928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:25.646928 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m08:53:25.647929 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m08:53:25.648928 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m08:53:25.650025 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m08:53:25.650025 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m08:53:25.651025 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m08:53:25.651928 [info ] [MainThread]: 
[0m08:53:25.653019 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m08:53:25.656020 [debug] [MainThread]: Command end result
[0m08:53:25.676922 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m08:53:25.679924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m08:53:25.684550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m08:53:25.684550 [info ] [MainThread]: 
[0m08:53:25.685548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:25.686549 [info ] [MainThread]: 
[0m08:53:25.686853 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:53:25.687462 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:25.687462 after 2.82 seconds
[0m08:53:25.688526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DAA91C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DAA1D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DAA1CD50>]}
[0m08:53:25.688526 [debug] [MainThread]: Flushing usage events
[0m08:53:26.486507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:27.777976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1B8E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1B82710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1B8E590>]}


============================== 09:23:27.783994 | 2a60abe4-6c37-49ea-bf13-31e6285872b8 ==============================
[0m09:23:27.783994 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:23:27.784994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:28.035074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a60abe4-6c37-49ea-bf13-31e6285872b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1D2D050>]}
[0m09:23:28.075058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a60abe4-6c37-49ea-bf13-31e6285872b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ADCBE9E50>]}
[0m09:23:28.077080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:28.281951 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:23:28.410671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:23:28.411671 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m09:23:28.411671 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_quitados.sql
[0m09:23:28.606554 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fato_quitados' (models\fato_quitados.sql) depends on a source named 'public.f_titulosquitados_fidc' which was not found
[0m09:23:28.608013 [debug] [MainThread]: Command `dbt run` failed at 09:23:28.608013 after 0.91 seconds
[0m09:23:28.609033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ADBD0D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1BE6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE1BE4BD0>]}
[0m09:23:28.609033 [debug] [MainThread]: Flushing usage events
[0m09:23:29.262725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:26.486882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2D8C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2DDB790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2D8E690>]}


============================== 09:24:26.489940 | 26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff ==============================
[0m09:24:26.489940 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:24:26.490959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:24:26.641976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2DDB9D0>]}
[0m09:24:26.681088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBDEE88B90>]}
[0m09:24:26.682077 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:26.888685 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:24:26.977592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:24:26.978695 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yml
[0m09:24:26.979702 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_quitados.sql
[0m09:24:27.208534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE42277D0>]}
[0m09:24:27.251235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:27.255247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:27.298901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE468FC10>]}
[0m09:24:27.298901 [info ] [MainThread]: Found 7 models, 12 sources, 433 macros
[0m09:24:27.300228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE45EE850>]}
[0m09:24:27.302257 [info ] [MainThread]: 
[0m09:24:27.304241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:27.304748 [info ] [MainThread]: 
[0m09:24:27.305762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:27.311796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:24:27.427005 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:24:27.427005 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:24:27.428006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:27.822692 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.395 seconds
[0m09:24:27.823745 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:24:27.826800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:24:27.831806 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:27.831806 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:24:27.831806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:27.866428 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m09:24:27.867426 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:24:27.868427 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:24:27.876432 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.007 seconds
[0m09:24:27.879424 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:24:27.883771 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:24:27.895782 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:27.896780 [debug] [MainThread]: On master: BEGIN
[0m09:24:27.897781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:32.214131 [debug] [MainThread]: SQL status: BEGIN in 4.316 seconds
[0m09:24:32.215173 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:32.217064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:32.351118 [debug] [MainThread]: SQL status: SELECT 12 in 0.134 seconds
[0m09:24:32.359240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE4718810>]}
[0m09:24:32.360240 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:32.366315 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:32.367318 [debug] [MainThread]: On master: BEGIN
[0m09:24:32.377315 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:24:32.379334 [debug] [MainThread]: On master: COMMIT
[0m09:24:32.380326 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:32.381315 [debug] [MainThread]: On master: COMMIT
[0m09:24:32.385369 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:24:32.386338 [debug] [MainThread]: On master: Close
[0m09:24:32.396861 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:32.397876 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:24:32.398872 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:32.399861 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:32.400885 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:24:32.401863 [info ] [Thread-2 (]: 2 of 7 START sql view model public.dim_sacados ................................. [RUN]
[0m09:24:32.408866 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:24:32.410863 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:24:32.404861 [info ] [Thread-4 (]: 4 of 7 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:24:32.403862 [info ] [Thread-3 (]: 3 of 7 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:24:32.406863 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:24:32.420892 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:24:32.421860 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:24:32.422369 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:24:32.423416 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:32.424415 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:32.424415 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:32.424415 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:24:32.493146 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.495041 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.498143 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.520040 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:24:32.521175 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:32.522144 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:32.523150 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:32.525642 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.527542 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.528776 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.531221 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.532221 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.532221 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:24:32.533221 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.533221 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:24:32.534222 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.534222 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:24:32.535221 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:24:32.535221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:32.535221 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:24:32.536225 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:24:32.537226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:24:32.600157 [debug] [Thread-4 (]: SQL status: BEGIN in 0.064 seconds
[0m09:24:32.600157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m09:24:32.601258 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.602216 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m09:24:32.603277 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.603277 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:24:32.604213 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.605214 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:24:32.606232 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m09:24:32.607212 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:24:32.609226 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.610226 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m09:24:32.613228 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:24:32.622212 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.622212 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:24:32.623209 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:24:32.623209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:24:32.626260 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.627212 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m09:24:32.627212 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:24:32.632326 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.633297 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:24:32.638318 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.641986 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.643036 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:24:32.644006 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:24:32.644987 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:24:32.648138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.650753 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.651860 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:24:32.651860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:24:32.652762 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:24:32.652762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:24:32.654873 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.655802 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.666864 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:24:32.668762 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.669997 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:24:32.671219 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:24:32.671219 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.672115 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:24:32.672115 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.673113 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:24:32.673113 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:24:32.675973 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:24:32.676980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.677980 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:24:32.678979 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:32.679981 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.679981 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.680981 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:24:32.680981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:24:32.698852 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m09:24:32.705913 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:24:32.708913 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:24:32.709913 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:24:32.715217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m09:24:32.715217 [debug] [Thread-2 (]: SQL status: COMMIT in 0.041 seconds
[0m09:24:32.716235 [debug] [Thread-3 (]: SQL status: COMMIT in 0.034 seconds
[0m09:24:32.717236 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:24:32.719337 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:24:32.721236 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:24:32.722234 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:24:32.723235 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:24:32.723235 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:24:32.724368 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:24:32.724368 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:24:32.725263 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:24:32.728408 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:24:32.730338 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:24:32.732337 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE20E61D0>]}
[0m09:24:32.732337 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:24:32.733235 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:24:32.733235 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:24:32.734235 [info ] [Thread-4 (]: 5 of 7 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:24:32.734235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:24:32.735280 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:24:32.738389 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:24:32.739346 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:24:32.741287 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:24:32.742285 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.742285 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:24:32.743391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:24:32.744428 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:24:32.745436 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:24:32.745436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE49C6990>]}
[0m09:24:32.746435 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.32s]
[0m09:24:32.747435 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:24:32.747435 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_quitados
[0m09:24:32.748436 [info ] [Thread-3 (]: 6 of 7 START sql view model public.fato_quitados ............................... [RUN]
[0m09:24:32.748436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_quitados)
[0m09:24:32.749436 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m09:24:32.751951 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m09:24:32.752951 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_quitados
[0m09:24:32.756952 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m09:24:32.758951 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.033 seconds
[0m09:24:32.758951 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m09:24:32.759970 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:24:32.760997 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.762055 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:24:32.762957 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m09:24:32.762957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE4A70150>]}
[0m09:24:32.764092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE4707BD0>]}
[0m09:24:32.764092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:24:32.765066 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.35s]
[0m09:24:32.766175 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.36s]
[0m09:24:32.767176 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:24:32.767176 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:24:32.768174 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:24:32.769175 [info ] [Thread-2 (]: 7 of 7 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:24:32.770174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m09:24:32.770174 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:24:32.773173 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.774196 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:24:32.777277 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.778176 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.778176 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:24:32.779175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:32.792399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m09:24:32.792399 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.793406 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:24:32.801734 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:24:32.804734 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.805734 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:24:32.808733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m09:24:32.808733 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.809749 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    TO_DATE(data_custodia, 'DD/MM/YYYY') AS data_custodia, --conversao para data correta
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    TO_DATE(data_custodia, 'DD/MM/YYYY') AS data_custodia, --conversao para data correta
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m09:24:32.809749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.812750 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.813733 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:24:32.816751 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:24:32.818734 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:24:32.818734 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.818734 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:24:32.819735 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:24:32.822733 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.822733 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m09:24:32.822733 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m09:24:32.823721 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.823721 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:24:32.827073 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.829086 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.829086 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m09:24:32.832446 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:24:32.832446 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:24:32.833460 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:24:32.834402 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:24:32.836414 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.836414 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.839512 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:24:32.840414 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:24:32.840414 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:24:32.841458 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:24:32.842413 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:24:32.848473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:24:32.849517 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.851124 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:24:32.855587 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:32.856689 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:24:32.856689 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.857753 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:24:32.858768 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m09:24:32.861754 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m09:24:32.861754 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:24:32.862757 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m09:24:32.874133 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.032 seconds
[0m09:24:32.878975 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:24:32.879979 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE4B95690>]}
[0m09:24:32.880978 [info ] [Thread-4 (]: 5 of 7 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:24:32.881935 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:24:32.890123 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:24:32.891304 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m09:24:32.894296 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: Close
[0m09:24:32.897294 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:24:32.899298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2DDA810>]}
[0m09:24:32.900297 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:24:32.902319 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:24:32.901298 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:24:32.903297 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_quitados
[0m09:24:32.924326 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:24:32.927314 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:24:32.929311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d0dc6a-f890-4f40-8ce1-eac40ee3c6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE44992D0>]}
[0m09:24:32.930315 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.16s]
[0m09:24:32.932314 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:24:32.935201 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:32.937204 [debug] [MainThread]: On master: BEGIN
[0m09:24:32.937204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:33.000860 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m09:24:33.001863 [debug] [MainThread]: On master: COMMIT
[0m09:24:33.002867 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:33.003864 [debug] [MainThread]: On master: COMMIT
[0m09:24:33.012029 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m09:24:33.013064 [debug] [MainThread]: On master: Close
[0m09:24:33.015058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:33.016058 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:24:33.017059 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:24:33.018057 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m09:24:33.018057 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:24:33.019057 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:24:33.020055 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m09:24:33.020055 [info ] [MainThread]: 
[0m09:24:33.021053 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m09:24:33.023054 [debug] [MainThread]: Command end result
[0m09:24:33.040114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:24:33.042115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:24:33.048124 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:24:33.048124 [info ] [MainThread]: 
[0m09:24:33.049352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:33.050405 [info ] [MainThread]: 
[0m09:24:33.050405 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:24:33.051405 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:33.051405 after 6.66 seconds
[0m09:24:33.051405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE2A87D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBDE021C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBDE021BD0>]}
[0m09:24:33.052652 [debug] [MainThread]: Flushing usage events
[0m09:24:33.821316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:52.160532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1F6DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1DB7C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1F6DBD50>]}


============================== 09:55:52.165535 | 4aad4bd4-eba8-436a-bbae-2cc24eecdf77 ==============================
[0m09:55:52.165535 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:55:52.166537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:55:52.414203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1F804E90>]}
[0m09:55:52.454222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1A749810>]}
[0m09:55:52.456238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:52.671258 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:55:52.800504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:55:52.801487 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m09:55:52.802487 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_quitados.sql
[0m09:55:52.977618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1F891250>]}
[0m09:55:53.021599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:53.026063 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:53.062343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1FF0F710>]}
[0m09:55:53.062343 [info ] [MainThread]: Found 7 models, 12 sources, 433 macros
[0m09:55:53.063598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1FDD7990>]}
[0m09:55:53.065605 [info ] [MainThread]: 
[0m09:55:53.065605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:53.066645 [info ] [MainThread]: 
[0m09:55:53.067605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:53.070619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:55:53.234806 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:55:53.234806 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:55:53.235808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:53.341702 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.107 seconds
[0m09:55:53.343706 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:55:53.344704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:55:53.349703 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:53.349703 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:55:53.349703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:53.482973 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m09:55:53.483973 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:55:53.483973 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:55:53.513303 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.028 seconds
[0m09:55:53.514302 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:55:53.546026 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:55:53.552026 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:53.552026 [debug] [MainThread]: On master: BEGIN
[0m09:55:53.553026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:53.679869 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m09:55:53.681871 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:53.681871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:53.704645 [debug] [MainThread]: SQL status: SELECT 13 in 0.021 seconds
[0m09:55:53.707646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B2026E810>]}
[0m09:55:53.707646 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:53.714645 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:53.715646 [debug] [MainThread]: On master: BEGIN
[0m09:55:53.749231 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:55:53.750232 [debug] [MainThread]: On master: COMMIT
[0m09:55:53.750232 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:53.750232 [debug] [MainThread]: On master: COMMIT
[0m09:55:53.756230 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m09:55:53.756230 [debug] [MainThread]: On master: Close
[0m09:55:53.761236 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:53.761236 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:55:53.762248 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:53.763246 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:53.764249 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:55:53.765246 [info ] [Thread-2 (]: 2 of 7 START sql view model public.dim_sacados ................................. [RUN]
[0m09:55:53.766246 [info ] [Thread-3 (]: 3 of 7 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:55:53.768248 [info ] [Thread-4 (]: 4 of 7 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:55:53.769246 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:55:53.771247 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:55:53.772241 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:55:53.772241 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:55:53.773243 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:53.773243 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:55:53.774245 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:53.775246 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:53.786765 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:53.791764 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:55:53.795766 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:53.800765 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:53.803764 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:53.821763 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:55:53.829763 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:53.830763 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:53.833764 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:55:53.833764 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:53.836765 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:53.837764 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:53.840763 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:53.840763 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:53.841764 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:55:53.841764 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:55:53.842764 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:53.842764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:53.842764 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:53.843764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:55:53.843764 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:55:53.844764 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:55:53.845764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:55:53.845764 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:55:53.954288 [debug] [Thread-3 (]: SQL status: BEGIN in 0.108 seconds
[0m09:55:53.954288 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:53.955288 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m09:55:53.984942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m09:55:53.984942 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m09:55:53.985944 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:53.990961 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:53.990961 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:55:53.991940 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:55:54.009942 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m09:55:54.009942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m09:55:54.012940 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:54.014942 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:54.015939 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:55:54.016941 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:55:54.036941 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m09:55:54.037940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m09:55:54.049942 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:55:54.104469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:54.104469 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:54.105468 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:55:54.105468 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:55:54.109466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.111467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:54.111467 [debug] [Thread-4 (]: SQL status: BEGIN in 0.266 seconds
[0m09:55:54.111467 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:54.112467 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:54.112467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:55:54.113467 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:55:54.119467 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:55:54.121467 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:54.121467 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:55:54.126467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.126467 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m09:55:54.128467 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:54.132606 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:55:54.133589 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:55:54.136592 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:55:54.137604 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:55:54.141501 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.141501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m09:55:54.142500 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:54.144500 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:55:54.145501 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:54.146471 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:55:54.146471 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:55:54.147469 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:55:54.158469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.315 seconds
[0m09:55:54.158469 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m09:55:54.159468 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:54.161468 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:55:54.161468 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:55:54.163539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1FE397D0>]}
[0m09:55:54.164538 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.39s]
[0m09:55:54.164538 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:55:54.165559 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:55:54.165559 [info ] [Thread-3 (]: 5 of 7 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:55:54.166558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m09:55:54.166558 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:55:54.169556 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:55:54.169556 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:55:54.172546 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:54.172546 [debug] [Thread-4 (]: SQL status: COMMIT in 0.026 seconds
[0m09:55:54.173544 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:55:54.173544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.026 seconds
[0m09:55:54.174546 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:55:54.175549 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:55:54.177560 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:55:54.179931 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:55:54.180941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.180941 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:55:54.181931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B203ADD50>]}
[0m09:55:54.184924 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:54.184924 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:55:54.185927 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.185927 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.41s]
[0m09:55:54.186937 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:55:54.187897 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:55:54.188896 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:55:54.188896 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:55:54.189892 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_quitados
[0m09:55:54.190892 [info ] [Thread-1 (]: 6 of 7 START sql view model public.fato_quitados ............................... [RUN]
[0m09:55:54.190892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_quitados)
[0m09:55:54.191892 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m09:55:54.194891 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m09:55:54.196892 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_quitados
[0m09:55:54.198891 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m09:55:54.200930 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.200930 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:55:54.201954 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m09:55:54.203021 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:54.203021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:54.204019 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:54.204019 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:55:54.205020 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:55:54.206028 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:55:54.206028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1FC6AA10>]}
[0m09:55:54.207026 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.43s]
[0m09:55:54.208903 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:55:54.209953 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:55:54.210894 [info ] [Thread-4 (]: 7 of 7 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:55:54.211894 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m09:55:54.211894 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:55:54.214929 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.216963 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:55:54.220930 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.220930 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m09:55:54.223933 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:55:54.223933 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.224896 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:55:54.225895 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:55:54.225895 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:55:54.225895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:55:54.251990 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.026 seconds
[0m09:55:54.254899 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:55:54.255893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1FB69B10>]}
[0m09:55:54.256898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m09:55:54.255893 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.49s]
[0m09:55:54.256898 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.257953 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:55:54.257953 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m09:55:54.268915 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:55:54.272898 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.273899 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m09:55:54.274900 [debug] [Thread-3 (]: SQL status: BEGIN in 0.086 seconds
[0m09:55:54.275898 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.275898 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE("finalizacao", 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    TO_DATE(finalizacao, 'DD-MM-YYYY') AS FINALIZACAO,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:55:54.278467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.280445 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.281446 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m09:55:54.281446 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m09:55:54.282446 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.282446 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:55:54.284446 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:55:54.287446 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.287446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:55:54.288446 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:55:54.289445 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:55:54.289445 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.290445 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:55:54.290445 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:55:54.293446 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.293446 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:55:54.294445 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:55:54.296445 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.296445 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:55:54.297445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.299445 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.300447 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:55:54.301447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.302447 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:54.302447 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.303446 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:55:54.304447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:54.305447 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:54.306446 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.306446 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:55:54.310446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:55:54.313445 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m09:55:54.314446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:55:54.314446 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m09:55:54.321904 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m09:55:54.321904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m09:55:54.323941 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:55:54.325942 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:55:54.326942 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:55:54.326942 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:55:54.327942 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:55:54.327942 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:55:54.330941 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:55:54.331974 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: Close
[0m09:55:54.333049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B1F8B8ED0>]}
[0m09:55:54.333999 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:55:54.333999 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_quitados
[0m09:55:54.355404 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.027 seconds
[0m09:55:54.356314 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.028 seconds
[0m09:55:54.358313 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:55:54.361396 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:55:54.362370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B2025EF10>]}
[0m09:55:54.364382 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aad4bd4-eba8-436a-bbae-2cc24eecdf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B2025FF90>]}
[0m09:55:54.365382 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m09:55:54.367381 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:55:54.366380 [info ] [Thread-4 (]: 7 of 7 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:55:54.369379 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:55:54.371378 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:54.372376 [debug] [MainThread]: On master: BEGIN
[0m09:55:54.372376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:54.444707 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m09:55:54.445934 [debug] [MainThread]: On master: COMMIT
[0m09:55:54.446937 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:54.446937 [debug] [MainThread]: On master: COMMIT
[0m09:55:54.451498 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:55:54.452608 [debug] [MainThread]: On master: Close
[0m09:55:54.453516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:54.454515 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:55:54.454515 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:55:54.455512 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m09:55:54.455512 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:55:54.456511 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:55:54.456511 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:55:54.457511 [info ] [MainThread]: 
[0m09:55:54.458510 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m09:55:54.460513 [debug] [MainThread]: Command end result
[0m09:55:54.480754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:55:54.482757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:55:54.488755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:55:54.489755 [info ] [MainThread]: 
[0m09:55:54.489755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:54.490755 [info ] [MainThread]: 
[0m09:55:54.491758 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:55:54.493755 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:54.492756 after 2.43 seconds
[0m09:55:54.493755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B19941BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B198CD910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010B198CCD50>]}
[0m09:55:54.494754 [debug] [MainThread]: Flushing usage events
[0m09:55:55.407637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:24.274158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365A834D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365A82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365A83F90>]}


============================== 09:57:24.278224 | b48afc54-3f92-4f31-ad92-b2cef157eec5 ==============================
[0m09:57:24.278224 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:57:24.279120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:24.493859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365C049D0>]}
[0m09:57:24.537460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029360B28590>]}
[0m09:57:24.538457 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:24.803660 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:57:24.913518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:24.913518 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m09:57:25.086925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293661B6D10>]}
[0m09:57:25.133659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:57:25.138550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:57:25.163761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002936630B890>]}
[0m09:57:25.164760 [info ] [MainThread]: Found 7 models, 12 sources, 433 macros
[0m09:57:25.164760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002936623A510>]}
[0m09:57:25.166770 [info ] [MainThread]: 
[0m09:57:25.166770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:25.167760 [info ] [MainThread]: 
[0m09:57:25.168759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:25.171761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m09:57:25.229288 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m09:57:25.229288 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m09:57:25.230311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:25.431773 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.202 seconds
[0m09:57:25.433776 [debug] [ThreadPool]: On list_operacoes: Close
[0m09:57:25.435775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m09:57:25.439789 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:57:25.440789 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m09:57:25.440789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:25.602421 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m09:57:25.603423 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m09:57:25.603423 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:25.636481 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.032 seconds
[0m09:57:25.637482 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m09:57:25.670481 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m09:57:25.677481 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.678483 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.678483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:25.808486 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m09:57:25.809487 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.809487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:25.838948 [debug] [MainThread]: SQL status: SELECT 13 in 0.029 seconds
[0m09:57:25.842948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029366690350>]}
[0m09:57:25.842948 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:25.862235 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.862235 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.878637 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:57:25.879637 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.879637 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.880636 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.908380 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m09:57:25.909398 [debug] [MainThread]: On master: Close
[0m09:57:25.920393 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m09:57:25.921395 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m09:57:25.922392 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m09:57:25.923015 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:57:25.924028 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m09:57:25.925029 [info ] [Thread-2 (]: 2 of 7 START sql view model public.dim_sacados ................................. [RUN]
[0m09:57:25.927040 [info ] [Thread-3 (]: 3 of 7 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m09:57:25.929025 [info ] [Thread-4 (]: 4 of 7 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m09:57:25.930027 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m09:57:25.931535 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m09:57:25.932547 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m09:57:25.933547 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m09:57:25.934547 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m09:57:25.934912 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m09:57:25.935925 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m09:57:25.935925 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m09:57:25.946929 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:25.950936 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m09:57:25.953922 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:25.956017 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:25.956921 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m09:57:25.981919 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:25.981919 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m09:57:25.981919 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m09:57:25.982921 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m09:57:25.985936 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:25.988947 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m09:57:25.988947 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:25.990937 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:25.991937 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m09:57:25.992921 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:25.992921 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:25.993920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:57:25.993920 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:25.993920 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m09:57:25.994920 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m09:57:25.994920 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m09:57:25.995920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:57:25.995920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:25.995920 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:26.142307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m09:57:26.142307 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m09:57:26.142307 [debug] [Thread-2 (]: SQL status: BEGIN in 0.147 seconds
[0m09:57:26.143308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.147 seconds
[0m09:57:26.143308 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:26.144331 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:26.145326 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:26.146307 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:26.146307 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m09:57:26.147343 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m09:57:26.147343 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m09:57:26.148318 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m09:57:26.179513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:57:26.179513 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:57:26.179513 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:57:26.180547 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:57:26.185527 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:26.188512 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:26.191530 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:26.193515 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:26.194516 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m09:57:26.194516 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m09:57:26.195512 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m09:57:26.195512 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m09:57:26.209526 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m09:57:26.210516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:57:26.256047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:57:26.256047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.060 seconds
[0m09:57:26.258048 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:26.260047 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:26.262011 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:26.265011 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:26.265011 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m09:57:26.265011 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m09:57:26.266012 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m09:57:26.266012 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m09:57:26.281155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:57:26.282143 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:57:26.282143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:57:26.282143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:57:26.294142 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:57:26.295143 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:57:26.297144 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:57:26.298144 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:57:26.298144 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:26.298144 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:26.299142 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:26.299142 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:26.300142 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m09:57:26.300142 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m09:57:26.301142 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m09:57:26.301142 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m09:57:26.349250 [debug] [Thread-4 (]: SQL status: COMMIT in 0.047 seconds
[0m09:57:26.349250 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m09:57:26.350248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m09:57:26.354291 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m09:57:26.355347 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m09:57:26.357249 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m09:57:26.358250 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m09:57:26.363249 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m09:57:26.365251 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m09:57:26.365251 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m09:57:26.366249 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m09:57:26.366249 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m09:57:26.367250 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m09:57:26.368249 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m09:57:26.368249 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m09:57:26.369250 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m09:57:26.384982 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:57:26.386981 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m09:57:26.388982 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365C072D0>]}
[0m09:57:26.388982 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.45s]
[0m09:57:26.389982 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m09:57:26.390980 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m09:57:26.390980 [info ] [Thread-4 (]: 5 of 7 START sql view model public.fato_operacoes .............................. [RUN]
[0m09:57:26.391982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m09:57:26.391982 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m09:57:26.393997 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m09:57:26.394980 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m09:57:26.398981 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m09:57:26.399980 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.400980 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m09:57:26.400980 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:57:26.418370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.049 seconds
[0m09:57:26.418370 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.049 seconds
[0m09:57:26.419371 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.049 seconds
[0m09:57:26.420370 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m09:57:26.421370 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m09:57:26.422370 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m09:57:26.423373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365580ED0>]}
[0m09:57:26.424372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365BC7850>]}
[0m09:57:26.424372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029365C612D0>]}
[0m09:57:26.425371 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.49s]
[0m09:57:26.426372 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.49s]
[0m09:57:26.426372 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.49s]
[0m09:57:26.427371 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m09:57:26.428391 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m09:57:26.428391 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m09:57:26.429372 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_quitados
[0m09:57:26.429372 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m09:57:26.430370 [info ] [Thread-1 (]: 6 of 7 START sql view model public.fato_quitados ............................... [RUN]
[0m09:57:26.430370 [info ] [Thread-3 (]: 7 of 7 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m09:57:26.431371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_quitados)
[0m09:57:26.431840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_titulosabertos)
[0m09:57:26.432353 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m09:57:26.432353 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m09:57:26.435375 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m09:57:26.438358 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.440359 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_quitados
[0m09:57:26.441365 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m09:57:26.444374 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m09:57:26.447359 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.448358 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.448358 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.449359 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m09:57:26.449359 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m09:57:26.450360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:26.450360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:57:26.525384 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m09:57:26.525384 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.526391 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m09:57:26.558203 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m09:57:26.561202 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.561202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m09:57:26.562202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.112 seconds
[0m09:57:26.562202 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m09:57:26.563202 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.563202 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.564203 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m09:57:26.565202 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m09:57:26.592202 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m09:57:26.593203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m09:57:26.593203 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:57:26.596202 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.599202 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.602203 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.603204 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m09:57:26.603204 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m09:57:26.604203 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m09:57:26.626209 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:57:26.626209 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:57:26.627208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m09:57:26.628315 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:57:26.630316 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.632926 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.634032 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.634032 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m09:57:26.635037 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m09:57:26.635037 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m09:57:26.660039 [debug] [Thread-4 (]: SQL status: COMMIT in 0.024 seconds
[0m09:57:26.660974 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:57:26.660974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:57:26.663033 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m09:57:26.663933 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:57:26.665035 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:57:26.666032 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m09:57:26.667035 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.667035 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.667984 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m09:57:26.667984 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m09:57:26.667984 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m09:57:26.682033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:57:26.686034 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m09:57:26.687035 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m09:57:26.687035 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m09:57:26.714930 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.046 seconds
[0m09:57:26.714930 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m09:57:26.714930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.028 seconds
[0m09:57:26.716930 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m09:57:26.718933 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m09:57:26.719933 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: Close
[0m09:57:26.720934 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m09:57:26.720934 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029366731250>]}
[0m09:57:26.721934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029366633C10>]}
[0m09:57:26.721934 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m09:57:26.722934 [info ] [Thread-4 (]: 5 of 7 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m09:57:26.722934 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:57:26.723934 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m09:57:26.724934 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_quitados
[0m09:57:26.747101 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:57:26.749104 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m09:57:26.749104 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48afc54-3f92-4f31-ad92-b2cef157eec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002936678B990>]}
[0m09:57:26.750104 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.32s]
[0m09:57:26.751109 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m09:57:26.753101 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:26.753101 [debug] [MainThread]: On master: BEGIN
[0m09:57:26.753101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:26.923189 [debug] [MainThread]: SQL status: BEGIN in 0.169 seconds
[0m09:57:26.923189 [debug] [MainThread]: On master: COMMIT
[0m09:57:26.923189 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:26.924208 [debug] [MainThread]: On master: COMMIT
[0m09:57:26.956821 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m09:57:26.957862 [debug] [MainThread]: On master: Close
[0m09:57:26.957862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:26.957862 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m09:57:26.958850 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m09:57:26.958850 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m09:57:26.958850 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m09:57:26.959803 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m09:57:26.959803 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m09:57:26.959803 [info ] [MainThread]: 
[0m09:57:26.960764 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m09:57:26.961764 [debug] [MainThread]: Command end result
[0m09:57:26.976779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m09:57:26.979762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m09:57:26.984765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m09:57:26.984765 [info ] [MainThread]: 
[0m09:57:26.985763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:26.985763 [info ] [MainThread]: 
[0m09:57:26.986811 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:57:26.987763 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:26.987763 after 2.80 seconds
[0m09:57:26.987763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935FC4DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935FC4CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935FC4CD50>]}
[0m09:57:26.988779 [debug] [MainThread]: Flushing usage events
[0m09:57:27.780279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:35.810885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4B82E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4BDA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4B81D10>]}


============================== 10:00:35.815886 | 74caea4d-085b-46d1-be59-e951ec21c6c5 ==============================
[0m10:00:35.815886 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:00:35.816885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:36.056041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4D703D0>]}
[0m10:00:36.095541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BFC681D0>]}
[0m10:00:36.096542 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:00:36.416800 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:00:36.550314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:36.550314 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:00:36.723585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C52236D0>]}
[0m10:00:36.769479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:00:36.774481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:00:36.806890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C540A4D0>]}
[0m10:00:36.807891 [info ] [MainThread]: Found 7 models, 12 sources, 433 macros
[0m10:00:36.807891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4E0BAD0>]}
[0m10:00:36.809888 [info ] [MainThread]: 
[0m10:00:36.809888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:36.810889 [info ] [MainThread]: 
[0m10:00:36.810889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:00:36.814889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:00:36.932403 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:00:36.933403 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:00:36.933403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:37.133482 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.200 seconds
[0m10:00:37.135484 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:00:37.137482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:00:37.143481 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:00:37.144482 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:00:37.145489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:37.300999 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m10:00:37.302000 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:00:37.302000 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:00:37.334394 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.032 seconds
[0m10:00:37.335383 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:00:37.368613 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:00:37.375616 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:37.375616 [debug] [MainThread]: On master: BEGIN
[0m10:00:37.376599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:37.537629 [debug] [MainThread]: SQL status: BEGIN in 0.161 seconds
[0m10:00:37.537629 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:37.538633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:00:37.570634 [debug] [MainThread]: SQL status: SELECT 13 in 0.031 seconds
[0m10:00:37.573635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C542F950>]}
[0m10:00:37.574636 [debug] [MainThread]: On master: ROLLBACK
[0m10:00:37.604141 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:37.605141 [debug] [MainThread]: On master: BEGIN
[0m10:00:37.671146 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m10:00:37.671146 [debug] [MainThread]: On master: COMMIT
[0m10:00:37.672145 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:37.672145 [debug] [MainThread]: On master: COMMIT
[0m10:00:37.704669 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m10:00:37.705655 [debug] [MainThread]: On master: Close
[0m10:00:37.709652 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:00:37.709652 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:00:37.710653 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:00:37.710653 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:00:37.710653 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:00:37.711692 [info ] [Thread-2 (]: 2 of 7 START sql view model public.dim_sacados ................................. [RUN]
[0m10:00:37.712657 [info ] [Thread-3 (]: 3 of 7 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:00:37.712657 [info ] [Thread-4 (]: 4 of 7 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:00:37.713655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:00:37.714653 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:00:37.714653 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:00:37.715655 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:00:37.715655 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:00:37.716654 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:00:37.716654 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:00:37.717656 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:00:37.723669 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.726667 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:00:37.729672 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:37.732659 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:37.734663 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:00:37.746655 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:00:37.747662 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:00:37.764653 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.768080 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:37.768080 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:00:37.770977 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:00:37.774019 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:37.775095 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.775978 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:37.776978 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:00:37.776978 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:37.776978 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:00:37.777977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:00:37.777977 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:37.778977 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:00:37.778977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:00:37.779977 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:00:37.779977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:00:37.780976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:00:37.912109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.134 seconds
[0m10:00:37.914131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.133 seconds
[0m10:00:37.915128 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.917125 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:37.918143 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:00:37.919545 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL AND df.primeira_operacao_fidc IS NULL THEN NULL
        WHEN dc.primeira_operacao IS NOT NULL THEN TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
        ELSE df.primeira_operacao_fidc
    END AS primeira_operacao,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_global,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(NULLIF(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.'), '') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:00:37.941628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.162 seconds
[0m10:00:37.942645 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m10:00:37.943641 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m10:00:37.944645 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:37.953636 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.956636 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:37.956636 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:00:37.956636 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:00:37.957636 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:00:37.975217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m10:00:37.977114 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m10:00:37.977114 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m10:00:37.982113 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:37.988297 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:38.031388 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:38.031388 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:00:38.032512 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:00:38.032512 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:00:38.042467 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:00:38.042467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:00:38.052483 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:00:38.053483 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m10:00:38.054484 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:00:38.055483 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:38.057580 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:38.057580 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:38.057580 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:00:38.058483 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:00:38.059093 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:00:38.075935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:00:38.077937 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:00:38.078936 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:38.078936 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:00:38.110209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m10:00:38.112229 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m10:00:38.113229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.053 seconds
[0m10:00:38.122329 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:00:38.124223 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:00:38.127327 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:00:38.131222 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:00:38.132329 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:00:38.133222 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:00:38.134268 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:00:38.135222 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:00:38.135222 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:00:38.146640 [debug] [Thread-4 (]: SQL status: BEGIN in 0.367 seconds
[0m10:00:38.147641 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:38.148640 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:00:38.179998 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:00:38.180924 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.045 seconds
[0m10:00:38.182915 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m10:00:38.183992 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.047 seconds
[0m10:00:38.188761 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:00:38.192103 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:00:38.198004 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:38.201106 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:00:38.206008 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:00:38.207076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C582F010>]}
[0m10:00:38.208009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4DD2AD0>]}
[0m10:00:38.209147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C588DED0>]}
[0m10:00:38.211319 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.49s]
[0m10:00:38.214240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:00:38.213239 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.49s]
[0m10:00:38.215291 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.50s]
[0m10:00:38.216239 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:00:38.220236 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:38.221235 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:00:38.222237 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:00:38.223334 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:00:38.224238 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:00:38.224238 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:00:38.225236 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:00:38.226235 [info ] [Thread-3 (]: 5 of 7 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:00:38.227236 [info ] [Thread-2 (]: 6 of 7 START sql view model public.fato_quitados ............................... [RUN]
[0m10:00:38.228235 [info ] [Thread-1 (]: 7 of 7 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:00:38.228235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_operacoes)
[0m10:00:38.229235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_quitados)
[0m10:00:38.230235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_cedentes_fidic, now model.my_dbt_project.fato_titulosabertos)
[0m10:00:38.230235 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:00:38.231236 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:00:38.231236 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:00:38.234252 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:00:38.237236 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:00:38.240234 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.243239 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:00:38.248251 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:00:38.249233 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:00:38.249233 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:00:38.252234 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.252234 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m10:00:38.255235 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:00:38.256234 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.257268 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:00:38.258234 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.258234 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:00:38.259236 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.260235 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:38.260235 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:00:38.261235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:00:38.261235 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:00:38.261235 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:00:38.262235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:38.263234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:00:38.281373 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m10:00:38.284373 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:00:38.284373 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:00:38.285479 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:00:38.313785 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.028 seconds
[0m10:00:38.315757 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:00:38.315757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BFB820D0>]}
[0m10:00:38.316770 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.60s]
[0m10:00:38.317656 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:00:38.414374 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m10:00:38.415362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.153 seconds
[0m10:00:38.416390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m10:00:38.417361 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.418371 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.419372 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.421376 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:00:38.422358 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:00:38.424358 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:00:38.448951 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m10:00:38.450053 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m10:00:38.451142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m10:00:38.459279 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.465271 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.469284 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.470284 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:00:38.471267 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:00:38.471267 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:00:38.480727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:00:38.481742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:00:38.482729 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:00:38.486726 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.490949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.494963 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.495963 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:00:38.496949 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:00:38.497954 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:00:38.515029 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:00:38.517040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m10:00:38.518040 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m10:00:38.522029 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:00:38.526026 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:00:38.529024 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:00:38.530027 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.531026 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.531026 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.532026 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:00:38.533026 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:00:38.533026 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:00:38.585024 [debug] [Thread-2 (]: SQL status: COMMIT in 0.051 seconds
[0m10:00:38.585024 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m10:00:38.586026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m10:00:38.589069 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:00:38.591072 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:00:38.592071 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:00:38.593070 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:00:38.594071 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:00:38.594071 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:00:38.595070 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:00:38.595070 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:00:38.596071 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:00:38.616069 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:00:38.618073 [debug] [Thread-3 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:00:38.618073 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C4C181D0>]}
[0m10:00:38.619072 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.39s]
[0m10:00:38.620071 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:00:38.650069 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.054 seconds
[0m10:00:38.650069 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.054 seconds
[0m10:00:38.652070 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:00:38.653070 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:00:38.654070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C5752B10>]}
[0m10:00:38.654070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74caea4d-085b-46d1-be59-e951ec21c6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4C574B490>]}
[0m10:00:38.655070 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.42s]
[0m10:00:38.655070 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.42s]
[0m10:00:38.656070 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:00:38.656070 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:00:38.658071 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:38.659074 [debug] [MainThread]: On master: BEGIN
[0m10:00:38.659074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:00:38.816436 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m10:00:38.817812 [debug] [MainThread]: On master: COMMIT
[0m10:00:38.817812 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:38.817812 [debug] [MainThread]: On master: COMMIT
[0m10:00:38.849353 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m10:00:38.850357 [debug] [MainThread]: On master: Close
[0m10:00:38.852354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:38.853356 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:00:38.854359 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:00:38.855357 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:00:38.856353 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:00:38.857354 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:00:38.857354 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:00:38.858356 [info ] [MainThread]: 
[0m10:00:38.860355 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m10:00:38.862354 [debug] [MainThread]: Command end result
[0m10:00:38.880360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:00:38.883362 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:00:38.890677 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:00:38.890677 [info ] [MainThread]: 
[0m10:00:38.892676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:38.892676 [info ] [MainThread]: 
[0m10:00:38.893676 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:00:38.894720 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:38.894720 after 3.17 seconds
[0m10:00:38.895676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BEE01BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BED8DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BED8CD50>]}
[0m10:00:38.895676 [debug] [MainThread]: Flushing usage events
[0m10:00:39.732671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:13.282347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1C8E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1B8BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1B89490>]}


============================== 10:11:13.287365 | 5fab7b79-26c7-4b3f-8d72-56ae906d9e91 ==============================
[0m10:11:13.287365 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:11:13.288347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:11:13.538010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1D55950>]}
[0m10:11:13.579014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247DDD79790>]}
[0m10:11:13.580017 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:13.895238 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:11:14.014706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:14.014706 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:11:14.188971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3128D50>]}
[0m10:11:14.235495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:11:14.240536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:11:14.270498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3503E50>]}
[0m10:11:14.271395 [info ] [MainThread]: Found 7 models, 12 sources, 433 macros
[0m10:11:14.272391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E30F0C50>]}
[0m10:11:14.274405 [info ] [MainThread]: 
[0m10:11:14.275391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:11:14.275391 [info ] [MainThread]: 
[0m10:11:14.276391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:14.281496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:11:14.349587 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:11:14.350566 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:11:14.350566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:14.522352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.172 seconds
[0m10:11:14.523858 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:11:14.525864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:11:14.529863 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:11:14.530862 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:11:14.530862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:14.692217 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m10:11:14.693217 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:11:14.693217 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:11:14.727030 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.033 seconds
[0m10:11:14.728033 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:11:14.735054 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:11:14.740029 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:14.741046 [debug] [MainThread]: On master: BEGIN
[0m10:11:14.741046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:14.870011 [debug] [MainThread]: SQL status: BEGIN in 0.128 seconds
[0m10:11:14.870011 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:14.870995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:14.901994 [debug] [MainThread]: SQL status: SELECT 13 in 0.031 seconds
[0m10:11:14.904994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3849950>]}
[0m10:11:14.905996 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:14.936642 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:14.937727 [debug] [MainThread]: On master: BEGIN
[0m10:11:14.973846 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:11:14.974869 [debug] [MainThread]: On master: COMMIT
[0m10:11:14.974869 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:14.975797 [debug] [MainThread]: On master: COMMIT
[0m10:11:15.004727 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m10:11:15.005723 [debug] [MainThread]: On master: Close
[0m10:11:15.011742 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_cedentes_fidic
[0m10:11:15.011742 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:11:15.012745 [debug] [Thread-3 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:11:15.012745 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:11:15.013744 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_cedentes_fidic .......................... [RUN]
[0m10:11:15.013744 [info ] [Thread-2 (]: 2 of 7 START sql view model public.dim_sacados ................................. [RUN]
[0m10:11:15.014743 [info ] [Thread-3 (]: 3 of 7 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:11:15.015744 [info ] [Thread-4 (]: 4 of 7 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:11:15.016743 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_cedentes_fidic'
[0m10:11:15.017743 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:11:15.017743 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:11:15.018744 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:11:15.018744 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_cedentes_fidic
[0m10:11:15.019742 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:11:15.019742 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:11:15.020742 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:11:15.026254 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.030254 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:11:15.032254 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.035254 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.037257 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_cedentes_fidic
[0m10:11:15.065255 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.066253 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:11:15.066253 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:11:15.067259 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:11:15.070253 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.073253 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:11:15.073253 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.076257 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.077254 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.077254 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: BEGIN
[0m10:11:15.078256 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.078256 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:11:15.079258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:15.079258 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.080254 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:11:15.080254 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:11:15.081253 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:11:15.081253 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:11:15.082257 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:11:15.238921 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m10:11:15.239899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m10:11:15.239899 [debug] [Thread-4 (]: SQL status: BEGIN in 0.160 seconds
[0m10:11:15.240898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m10:11:15.240898 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.241898 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.241898 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.242920 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.242920 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN TO_DATE(COALESCE(dc.primeira_operacao, df.primeira_operacao_fidc::TEXT), 'YYYY-MM-DD') = '0001-01-01' THEN NULL
        ELSE TO_DATE(COALESCE(dc.primeira_operacao, df.primeira_operacao_fidc::TEXT),
                     CASE
                         WHEN dc.primeira_operacao LIKE '%/%/%' THEN 'DD/MM/YYYY'
                         WHEN dc.primeira_operacao LIKE '%-%-%' THEN 'YYYY-MM-DD'
                         ELSE NULL -- Ou outro formato padrão que possa existir
                     END)
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao = '01-01-0001' THEN NULL
            ELSE TO_DATE(primeira_operacao, 'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:11:15.243900 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */

  create view "operacoes"."public"."dim_cedentes_fidic__dbt_tmp"
    
    
  as (
    SELECT 
    nome,
    CAST(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    email,
    telefone,
    gerente,
    operador,
    captador,
    controlador,
    fator_percentual,
    advalorem_percentual,
    TO_DATE(data_cadastro, 'dd/MM/yyyy')::date AS data_cadastro,
    fonte_captacao,
    setor,
    grupo_economico,
    bloqueado,
    TO_DATE(primeira_operacao, 'dd/MM/yyyy')::date AS primeira_operacao,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_global, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_global,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_boleto_especial, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_boleto_especial,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_comissaria, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_comissaria,
    CAST(REGEXP_REPLACE(REGEXP_REPLACE(limite_tranche, '\.', '', 'g'), ',', '.', 'g') AS DECIMAL(18,2)) AS limite_tranche,
    risco_atual,
    saldo,
    vencimento_contrato,
    id_cedente,
    timestamp_extracao
FROM 
    "operacoes"."public"."d_cedentes_fidc"
  );
[0m10:11:15.243900 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:11:15.244897 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:11:15.272236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m10:11:15.272236 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m10:11:15.273235 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m10:11:15.273235 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m10:11:15.278251 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.281236 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.284338 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.286269 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.287250 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic" rename to "dim_cedentes_fidic__dbt_backup"
[0m10:11:15.288236 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:11:15.288236 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:11:15.289234 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:11:15.308235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m10:11:15.308235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m10:11:15.358804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m10:11:15.359813 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m10:11:15.361868 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.364908 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.366831 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.368912 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.369906 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:11:15.370844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
alter table "operacoes"."public"."dim_cedentes_fidic__dbt_tmp" rename to "dim_cedentes_fidic"
[0m10:11:15.370844 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:11:15.371909 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:11:15.377843 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:15.377843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:11:15.378913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:11:15.378913 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:11:15.390801 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:11:15.392911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:11:15.393932 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:11:15.394842 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:11:15.395803 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.395803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.395803 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.396803 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.396803 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:11:15.397803 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: COMMIT
[0m10:11:15.397803 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:11:15.398802 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:11:15.448923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m10:11:15.449795 [debug] [Thread-3 (]: SQL status: COMMIT in 0.050 seconds
[0m10:11:15.449795 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m10:11:15.449795 [debug] [Thread-4 (]: SQL status: COMMIT in 0.051 seconds
[0m10:11:15.454792 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_cedentes_fidic__dbt_backup"
[0m10:11:15.457792 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:11:15.459793 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:11:15.461792 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:11:15.465794 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_cedentes_fidic"
[0m10:11:15.466794 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:11:15.467792 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:11:15.467792 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:11:15.468793 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_cedentes_fidic"} */
drop view if exists "operacoes"."public"."dim_cedentes_fidic__dbt_backup" cascade
[0m10:11:15.468793 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:11:15.469793 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:11:15.469793 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:11:15.514025 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:11:15.514025 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:11:15.515027 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.044 seconds
[0m10:11:15.515027 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.044 seconds
[0m10:11:15.517054 [debug] [Thread-4 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:11:15.518025 [debug] [Thread-3 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:11:15.519043 [debug] [Thread-1 (]: On model.my_dbt_project.dim_cedentes_fidic: Close
[0m10:11:15.520041 [debug] [Thread-2 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:11:15.522027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3124210>]}
[0m10:11:15.523027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3116250>]}
[0m10:11:15.523027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E393BFD0>]}
[0m10:11:15.523027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E31A6D90>]}
[0m10:11:15.524026 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.50s]
[0m10:11:15.524026 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.50s]
[0m10:11:15.526173 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:11:15.525027 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.51s]
[0m10:11:15.527173 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:11:15.525027 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_cedentes_fidic ..................... [[32mCREATE VIEW[0m in 0.51s]
[0m10:11:15.527173 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:11:15.528174 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:11:15.528174 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:11:15.529172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_cedentes_fidic
[0m10:11:15.529172 [info ] [Thread-4 (]: 5 of 7 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:11:15.530174 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:11:15.530174 [info ] [Thread-3 (]: 6 of 7 START sql view model public.fato_quitados ............................... [RUN]
[0m10:11:15.531174 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_operacoes)
[0m10:11:15.533173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_quitados)
[0m10:11:15.533173 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:11:15.532175 [info ] [Thread-2 (]: 7 of 7 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:11:15.534175 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:11:15.536193 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:11:15.538175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m10:11:15.541172 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:11:15.542176 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:11:15.543180 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:11:15.551172 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.555283 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:11:15.555283 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:11:15.559172 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:11:15.560174 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:11:15.561172 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.564172 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.564172 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.565172 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:11:15.566175 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:11:15.566175 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:15.567177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:15.567177 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.569177 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:11:15.569177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:15.684629 [debug] [Thread-3 (]: SQL status: BEGIN in 0.118 seconds
[0m10:11:15.684629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.119 seconds
[0m10:11:15.685630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.116 seconds
[0m10:11:15.685630 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.686632 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.686632 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.686632 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:11:15.687629 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:11:15.688631 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:11:15.717633 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:11:15.718632 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:11:15.718632 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:11:15.721634 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.724632 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.727896 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.727896 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:11:15.728900 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:11:15.728900 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:11:15.751896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m10:11:15.751896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m10:11:15.752899 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m10:11:15.755898 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.758896 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.760897 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.761896 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:11:15.761896 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:11:15.762896 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:11:15.784896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m10:11:15.785898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m10:11:15.786898 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:11:15.786898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m10:11:15.788900 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:11:15.788900 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.789897 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:11:15.790897 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.791896 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:11:15.791896 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.792898 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:11:15.792898 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:11:15.817942 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m10:11:15.819924 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:11:15.822925 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:11:15.823927 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:11:15.824926 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m10:11:15.824926 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m10:11:15.827464 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:11:15.829437 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:11:15.830438 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:11:15.831460 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:11:15.831460 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:11:15.832440 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:11:15.852448 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.019 seconds
[0m10:11:15.852448 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.028 seconds
[0m10:11:15.853423 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:11:15.855423 [debug] [Thread-2 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:11:15.855423 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E37E58D0>]}
[0m10:11:15.857383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E352C6D0>]}
[0m10:11:15.856423 [info ] [Thread-4 (]: 5 of 7 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m10:11:15.857383 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.32s]
[0m10:11:15.858386 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:11:15.859411 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:11:15.887491 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.054 seconds
[0m10:11:15.888490 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:11:15.889491 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fab7b79-26c7-4b3f-8d72-56ae906d9e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3744F90>]}
[0m10:11:15.890490 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m10:11:15.891489 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:11:15.892488 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:15.893489 [debug] [MainThread]: On master: BEGIN
[0m10:11:15.893489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:16.007047 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m10:11:16.007047 [debug] [MainThread]: On master: COMMIT
[0m10:11:16.008049 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:16.008049 [debug] [MainThread]: On master: COMMIT
[0m10:11:16.013067 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m10:11:16.014052 [debug] [MainThread]: On master: Close
[0m10:11:16.015053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:16.015053 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:11:16.015053 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:11:16.015053 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_cedentes_fidic' was properly closed.
[0m10:11:16.016053 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:11:16.016053 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:11:16.016053 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:11:16.017053 [info ] [MainThread]: 
[0m10:11:16.017053 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m10:11:16.018051 [debug] [MainThread]: Command end result
[0m10:11:16.035754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:11:16.038643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:11:16.044644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:11:16.045645 [info ] [MainThread]: 
[0m10:11:16.047643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:16.047643 [info ] [MainThread]: 
[0m10:11:16.048654 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:11:16.049643 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:16.049643 after 2.86 seconds
[0m10:11:16.050645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247DCE9D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247DCE9CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247DCE9CD50>]}
[0m10:11:16.051644 [debug] [MainThread]: Flushing usage events
[0m10:11:16.863359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:06.417336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE9858D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE9DA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE9D9850>]}


============================== 10:16:06.429334 | 79ed3117-6d1e-4a6f-955e-0df269d15705 ==============================
[0m10:16:06.429334 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:06.430334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:06.769230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE79F690>]}
[0m10:16:06.807853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F9A18BD0>]}
[0m10:16:06.810970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:16:07.054880 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:07.320462 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m10:16:07.320462 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\dim_cedentes_fidic.sql
[0m10:16:07.321445 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:16:07.523498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEB48D50>]}
[0m10:16:07.576541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:16:07.583505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:16:07.691780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FF209090>]}
[0m10:16:07.692790 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m10:16:07.693733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEE43F50>]}
[0m10:16:07.695730 [info ] [MainThread]: 
[0m10:16:07.696733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:07.697239 [info ] [MainThread]: 
[0m10:16:07.697239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:07.706247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:16:10.224821 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:16:10.225822 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:16:10.225822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:10.316858 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.091 seconds
[0m10:16:10.318859 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:16:10.320857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:16:10.325857 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:16:10.326859 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:16:10.326859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:10.424705 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m10:16:10.425707 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:16:10.425707 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:16:10.442044 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.016 seconds
[0m10:16:10.443042 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:16:10.456044 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:16:10.462042 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:10.463042 [debug] [MainThread]: On master: BEGIN
[0m10:16:10.463042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:10.499091 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:16:10.499635 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:10.500676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:10.508691 [debug] [MainThread]: SQL status: SELECT 13 in 0.008 seconds
[0m10:16:10.511774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FF0B9B90>]}
[0m10:16:10.511774 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:10.515842 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:10.515842 [debug] [MainThread]: On master: BEGIN
[0m10:16:10.539858 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:16:10.540854 [debug] [MainThread]: On master: COMMIT
[0m10:16:10.540854 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:10.541840 [debug] [MainThread]: On master: COMMIT
[0m10:16:10.544857 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:16:10.544857 [debug] [MainThread]: On master: Close
[0m10:16:10.549856 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:16:10.549856 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:10.550841 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:10.550841 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:16:10.550841 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:16:10.551840 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:16:10.552841 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:16:10.552841 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:16:10.553841 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:16:10.554840 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:16:10.554840 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:16:10.555840 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m10:16:10.555840 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:16:10.556842 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:10.556842 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:10.556842 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:16:10.563842 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:16:10.566861 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.569857 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.573841 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:16:10.574845 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:16:10.600409 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:10.613414 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.615463 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:16:10.616411 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:10.617411 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:16:10.621411 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.624408 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:16:10.625407 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.626410 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.626410 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:16:10.627408 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.627408 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:16:10.627408 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.628410 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:16:10.628410 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:16:10.629424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:16:10.629424 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:16:10.630411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:16:10.631449 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:16:10.677427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m10:16:10.678411 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.680414 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:16:10.681411 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m10:16:10.682412 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.682412 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    COALESCE(TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY'), df.primeira_operacao_fidc) AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        TO_DATE(primeira_operacao,'DD-MM-YYYY') AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:16:10.685415 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m10:16:10.686414 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.686414 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:16:10.687416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:16:10.693414 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.693414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:16:10.694415 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:16:10.694415 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:16:10.698431 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.703922 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.703922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:16:10.704923 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:16:10.704923 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:16:10.707940 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.760923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.078 seconds
[0m10:16:10.761922 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:16:10.762923 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.763921 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:16:10.765923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:16:10.765923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:16:10.767924 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.767924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:16:10.778938 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:16:10.779938 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:16:10.781939 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.782938 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.783922 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:16:10.784232 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:16:10.786288 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m10:16:10.789378 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.789378 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:16:10.790328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:16:10.790328 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:16:10.792334 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:16:10.794379 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:16:10.794379 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.795387 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.795387 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:16:10.796326 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:16:10.811068 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:16:10.811068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m10:16:10.814041 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.819052 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:16:10.819052 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:16:10.823069 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:16:10.824072 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:16:10.839034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m10:16:10.840055 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m10:16:10.840055 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:16:10.842033 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:16:10.844942 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:16:10.845980 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:16:10.845980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.022 seconds
[0m10:16:10.847065 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:16:10.848088 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:16:10.849055 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.849944 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:16:10.851054 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:16:10.852048 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:16:10.852048 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:16:10.854944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FF472910>]}
[0m10:16:10.856042 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.30s]
[0m10:16:10.856994 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:16:10.856994 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:16:10.857944 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m10:16:10.857944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_quitados)
[0m10:16:10.858982 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:16:10.861943 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:16:10.862942 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:16:10.866943 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:16:10.867944 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.868943 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:16:10.868943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:10.873946 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m10:16:10.877945 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:16:10.878944 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:16:10.878944 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:16:10.904102 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.050 seconds
[0m10:16:10.904102 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.051 seconds
[0m10:16:10.904994 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.025 seconds
[0m10:16:10.906067 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:16:10.906993 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:16:10.907994 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:16:10.908993 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEB4D510>]}
[0m10:16:10.909993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEB716D0>]}
[0m10:16:10.909993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEB65850>]}
[0m10:16:10.910994 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m10:16:10.911994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m10:16:10.911994 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.36s]
[0m10:16:10.912995 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.36s]
[0m10:16:10.913992 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:16:10.913992 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.914995 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:16:10.916029 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:16:10.916029 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:16:10.917031 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:16:10.918044 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:16:10.919994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m10:16:10.919994 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:16:10.923033 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.924030 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:16:10.926994 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.927993 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.929032 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:16:10.929032 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:10.943083 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m10:16:10.947043 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.948046 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:16:10.954032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:10.956093 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.957000 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:16:10.961992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:10.963993 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:16:10.963993 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.964993 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:16:10.971994 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m10:16:10.973032 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.973032 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:16:10.987107 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m10:16:10.992102 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.992102 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:16:10.993162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m10:16:10.995065 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:16:10.996064 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:16:10.996064 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:16:10.997065 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:16:10.998083 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:10.999593 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:16:11.019950 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m10:16:11.020951 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m10:16:11.021946 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:16:11.022918 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:16:11.023944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FF6A9AD0>]}
[0m10:16:11.023944 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:11.024934 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:16:11.024934 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m10:16:11.025915 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:16:11.052662 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m10:16:11.055669 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:16:11.055669 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:16:11.056666 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:16:11.076733 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:16:11.078734 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:16:11.079662 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ed3117-6d1e-4a6f-955e-0df269d15705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FEB73A90>]}
[0m10:16:11.079662 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:16:11.081665 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:16:11.082725 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.083720 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.083720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:11.114930 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m10:16:11.115937 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.115937 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.115937 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.119934 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:16:11.119934 [debug] [MainThread]: On master: Close
[0m10:16:11.120937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:11.120937 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:16:11.120937 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:16:11.121937 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:16:11.121937 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m10:16:11.121937 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:16:11.121937 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:16:11.122937 [info ] [MainThread]: 
[0m10:16:11.122937 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m10:16:11.124935 [debug] [MainThread]: Command end result
[0m10:16:11.141935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:16:11.143957 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:16:11.149934 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:16:11.150937 [info ] [MainThread]: 
[0m10:16:11.150937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:11.151937 [info ] [MainThread]: 
[0m10:16:11.152936 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:16:11.153937 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:11.153937 after 4.85 seconds
[0m10:16:11.153937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE7CF810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189FE79FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F8C0D950>]}
[0m10:16:11.154937 [debug] [MainThread]: Flushing usage events
[0m10:16:11.959975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:37.003959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DDCC8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DDCC9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DDC85990>]}


============================== 10:19:37.008958 | 138c0ca6-7785-4b00-9674-074ace9aebef ==============================
[0m10:19:37.008958 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:19:37.009952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:37.214542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DDEAF550>]}
[0m10:19:37.254252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D9D68DD0>]}
[0m10:19:37.255253 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:19:37.535149 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:19:37.671188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:37.672186 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:19:37.836508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF386CD0>]}
[0m10:19:37.883450 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:19:37.887448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:19:37.917359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF50D650>]}
[0m10:19:37.918360 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m10:19:37.918360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF2DC2D0>]}
[0m10:19:37.920361 [info ] [MainThread]: 
[0m10:19:37.920361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:37.921361 [info ] [MainThread]: 
[0m10:19:37.922361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:37.925359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:19:37.988016 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:19:37.989008 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:19:37.989008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:38.067047 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.078 seconds
[0m10:19:38.069938 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:19:38.073975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:19:38.081046 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:19:38.082044 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:19:38.082044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:38.140778 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m10:19:38.141829 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:19:38.143868 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:38.152560 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.008 seconds
[0m10:19:38.154601 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:19:38.159528 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:19:38.172608 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.173610 [debug] [MainThread]: On master: BEGIN
[0m10:19:38.174602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:38.233084 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m10:19:38.235189 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.236307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:38.247200 [debug] [MainThread]: SQL status: SELECT 13 in 0.010 seconds
[0m10:19:38.255055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF489990>]}
[0m10:19:38.256072 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:38.261019 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.261954 [debug] [MainThread]: On master: BEGIN
[0m10:19:38.269853 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:19:38.270841 [debug] [MainThread]: On master: COMMIT
[0m10:19:38.271841 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.272941 [debug] [MainThread]: On master: COMMIT
[0m10:19:38.281840 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m10:19:38.282944 [debug] [MainThread]: On master: Close
[0m10:19:38.293311 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:19:38.294313 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:19:38.295314 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:19:38.296371 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:19:38.297415 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:19:38.298307 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:19:38.299306 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:19:38.299306 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:19:38.301422 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:19:38.302387 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:19:38.303311 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:19:38.304314 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m10:19:38.305412 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:19:38.306425 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:19:38.306425 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:19:38.307308 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:19:38.317358 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:19:38.323406 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:19:38.330308 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.333307 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:19:38.335311 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:19:38.337331 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:19:38.373840 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:19:38.373840 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:19:38.373840 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:19:38.376838 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:19:38.379840 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.381860 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:19:38.382854 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.383840 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:19:38.383840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:19:38.384838 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:19:38.384838 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.385839 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.385839 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:19:38.386840 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:19:38.386840 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:19:38.387839 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:19:38.387839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:19:38.388838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:19:38.418592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m10:19:38.419593 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.419593 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:19:38.428594 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m10:19:38.429593 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:19:38.429593 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.435598 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.436599 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:19:38.436599 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:19:38.440597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:19:38.442601 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.442601 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:19:38.443601 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:19:38.446597 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.446597 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:19:38.448598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.060 seconds
[0m10:19:38.448598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.061 seconds
[0m10:19:38.449598 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:19:38.449598 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.450598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:38.450598 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL OR TRIM(dc.primeira_operacao) = '' THEN
            CASE
                WHEN df.primeira_operacao IS NULL OR TRIM(df.primeira_operacao) = '' THEN NULL
                ELSE df.primeira_operacao
            END
        ELSE
            TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao IS NULL OR TRIM(primeira_operacao) = '' THEN NULL
            ELSE TO_DATE(primeira_operacao,'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:19:38.451625 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:19:38.462624 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:19:38.463624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:19:38.463988 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.507993 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.508995 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column df.primeira_operacao does not exist
LINE 31:                 WHEN df.primeira_operacao IS NULL OR TRIM(df...
                              ^
HINT:  Perhaps you meant to reference the column "dc.primeira_operacao".

[0m10:19:38.508995 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m10:19:38.508995 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:19:38.509992 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:19:38.509992 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: ROLLBACK
[0m10:19:38.512993 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.513993 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:19:38.516438 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:19:38.517444 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:19:38.518443 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:19:38.518443 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:38.519443 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.521442 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.522442 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:19:38.522442 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:19:38.530442 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:19:38.532445 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:19:38.533444 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.533444 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:19:38.539449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m10:19:38.544449 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:19:38.548450 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:19:38.549449 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:19:38.550450 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m10:19:38.550450 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m10:19:38.552508 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:19:38.555507 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:19:38.555507 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:19:38.556509 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:19:38.557508 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:19:38.558508 [debug] [Thread-2 (]: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  column df.primeira_operacao does not exist
  LINE 31:                 WHEN df.primeira_operacao IS NULL OR TRIM(df...
                                ^
  HINT:  Perhaps you meant to reference the column "dc.primeira_operacao".
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:19:38.559507 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:19:38.561507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF774210>]}
[0m10:19:38.561507 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.dimcedentesconsolidado ............. [[31mERROR[0m in 0.26s]
[0m10:19:38.562509 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:19:38.562509 [debug] [Thread-2 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:19:38.563513 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt_project.dimcedentesconsolidado' to be skipped because of status 'error'.  Reason: Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  column df.primeira_operacao does not exist
  LINE 31:                 WHEN df.primeira_operacao IS NULL OR TRIM(df...
                                ^
  HINT:  Perhaps you meant to reference the column "dc.primeira_operacao".
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql.
[0m10:19:38.563513 [info ] [Thread-2 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m10:19:38.565507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dimcedentesconsolidado, now model.my_dbt_project.fato_quitados)
[0m10:19:38.565507 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:19:38.568508 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:19:38.569508 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:19:38.571507 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:19:38.572506 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.573508 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:19:38.573508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:38.574509 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:19:38.576509 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:19:38.577510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF899D50>]}
[0m10:19:38.577510 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m10:19:38.578509 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:19:38.578509 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:19:38.579510 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:19:38.579510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_titulosabertos)
[0m10:19:38.580508 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:19:38.582507 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.584510 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:19:38.587513 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.589514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.590515 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.031 seconds
[0m10:19:38.591509 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:19:38.592508 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:19:38.592508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:38.593507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF0F6650>]}
[0m10:19:38.594508 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.29s]
[0m10:19:38.595509 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.034 seconds
[0m10:19:38.595509 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:19:38.597508 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:19:38.598510 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF32D350>]}
[0m10:19:38.598510 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m10:19:38.599509 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:19:38.619508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m10:19:38.620513 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.621509 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:19:38.634508 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:19:38.639515 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.640517 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:19:38.647515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:19:38.649514 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.650516 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:19:38.651934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m10:19:38.651934 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.652934 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:19:38.655933 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:19:38.657935 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:19:38.658934 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.658934 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:19:38.662932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:19:38.665935 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.666935 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:19:38.670934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:38.672934 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.673933 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:19:38.677933 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m10:19:38.678933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:19:38.680936 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:19:38.681937 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:19:38.682936 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:19:38.682936 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.683935 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:19:38.683935 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:19:38.698936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:19:38.700939 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:19:38.701938 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:19:38.701938 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:19:38.707934 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:19:38.709934 [debug] [Thread-2 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:19:38.709934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF101BD0>]}
[0m10:19:38.710936 [info ] [Thread-2 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:19:38.711938 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:19:38.725934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m10:19:38.726934 [debug] [Thread-1 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:19:38.727933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138c0ca6-7785-4b00-9674-074ace9aebef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DDEEA650>]}
[0m10:19:38.728934 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:19:38.728934 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:19:38.730940 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.731938 [debug] [MainThread]: On master: BEGIN
[0m10:19:38.732940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:38.761451 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m10:19:38.762452 [debug] [MainThread]: On master: COMMIT
[0m10:19:38.762452 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:38.763453 [debug] [MainThread]: On master: COMMIT
[0m10:19:38.766449 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:19:38.767452 [debug] [MainThread]: On master: Close
[0m10:19:38.767452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:38.768454 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:19:38.768454 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:19:38.769453 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:19:38.769453 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:19:38.769453 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_detalhes_operacoes' was properly closed.
[0m10:19:38.770455 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:19:38.770455 [info ] [MainThread]: 
[0m10:19:38.771453 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:19:38.773455 [debug] [MainThread]: Command end result
[0m10:19:38.791462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:19:38.794452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:19:38.799449 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:19:38.800453 [info ] [MainThread]: 
[0m10:19:38.800453 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:38.801452 [info ] [MainThread]: 
[0m10:19:38.801452 [error] [MainThread]:   Database Error in model dimcedentesconsolidado (models\dimcedentesconsolidado.sql)
  column df.primeira_operacao does not exist
  LINE 31:                 WHEN df.primeira_operacao IS NULL OR TRIM(df...
                                ^
  HINT:  Perhaps you meant to reference the column "dc.primeira_operacao".
  compiled code at target\run\my_dbt_project\models\dimcedentesconsolidado.sql
[0m10:19:38.802453 [info ] [MainThread]: 
[0m10:19:38.803466 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:19:38.804455 [debug] [MainThread]: Command `dbt run` failed at 10:19:38.804455 after 1.89 seconds
[0m10:19:38.805456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208D8E8D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DD987E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF4FF550>]}
[0m10:19:38.805456 [debug] [MainThread]: Flushing usage events
[0m10:19:39.601864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:07.131368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6281A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A62D9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6282CD0>]}


============================== 10:21:07.136328 | 865d36e4-ac50-48b1-9260-817ee87b1261 ==============================
[0m10:21:07.136328 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:21:07.137357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:07.361643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6419510>]}
[0m10:21:07.401173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A2309610>]}
[0m10:21:07.403171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:21:07.691489 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:21:07.812002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:21:07.813004 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:21:07.993124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A648F3D0>]}
[0m10:21:08.040109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:21:08.045109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:21:08.074110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6B0D710>]}
[0m10:21:08.075112 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m10:21:08.076112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6703A50>]}
[0m10:21:08.078111 [info ] [MainThread]: 
[0m10:21:08.078111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:21:08.079111 [info ] [MainThread]: 
[0m10:21:08.080111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:08.083113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:21:08.145621 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:21:08.146622 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:21:08.146622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:08.195133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m10:21:08.196134 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:21:08.198135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:21:08.203134 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:21:08.203134 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:21:08.204134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:08.233583 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m10:21:08.233583 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:21:08.234616 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:21:08.241582 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.007 seconds
[0m10:21:08.242583 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:21:08.245583 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:21:08.251582 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.252585 [debug] [MainThread]: On master: BEGIN
[0m10:21:08.252585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:08.288104 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:21:08.288104 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.289104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:08.298104 [debug] [MainThread]: SQL status: SELECT 13 in 0.009 seconds
[0m10:21:08.300104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A4DECF50>]}
[0m10:21:08.301146 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:08.305108 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.306143 [debug] [MainThread]: On master: BEGIN
[0m10:21:08.313105 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:21:08.313105 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.314141 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.314141 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.318104 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:21:08.318104 [debug] [MainThread]: On master: Close
[0m10:21:08.321104 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:21:08.321104 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:21:08.321104 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:21:08.322104 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:21:08.322104 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:21:08.323105 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:21:08.323105 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:21:08.324107 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:21:08.325106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:21:08.325106 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:21:08.326107 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:21:08.326107 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m10:21:08.326107 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:21:08.327106 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:21:08.327106 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:21:08.328105 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:21:08.333108 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:21:08.337105 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.341107 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.344123 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:21:08.345104 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:21:08.347106 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:21:08.361108 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:21:08.380113 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:21:08.383114 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.384111 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:21:08.387190 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.392194 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:21:08.394192 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.394192 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.395193 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:21:08.395193 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:21:08.396193 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.396193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:21:08.396193 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.397221 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:21:08.397221 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:21:08.398190 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:21:08.398190 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:21:08.399194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:21:08.447195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m10:21:08.447195 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m10:21:08.448231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m10:21:08.449191 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.449191 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.449191 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.450190 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:21:08.450190 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m10:21:08.451190 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL OR TRIM(dc.primeira_operacao) = '' THEN
            CASE
                WHEN df.primeira_operacao_fidc IS NULL THEN NULL
                ELSE df.primeira_operacao_fidc
            END
        ELSE
            TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao IS NULL OR TRIM(primeira_operacao) = '' THEN NULL
            ELSE TO_DATE(primeira_operacao,'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:21:08.451190 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:21:08.452191 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.453193 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:21:08.457188 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:21:08.463190 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.463190 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:21:08.463190 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:21:08.464190 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:21:08.464190 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:21:08.467190 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.471198 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.526718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.527719 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:21:08.527719 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:21:08.528718 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:21:08.530719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:21:08.533753 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.533753 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:21:08.534763 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:21:08.534763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:21:08.534763 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:21:08.537720 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.539756 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.542756 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.543754 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:21:08.543754 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:21:08.544755 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:21:08.546755 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:21:08.559718 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:21:08.559718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:21:08.559718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m10:21:08.560720 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m10:21:08.560720 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.562719 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:21:08.563720 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:21:08.565718 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:21:08.565718 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:21:08.565718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.566716 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.566716 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.567717 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:21:08.567717 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:21:08.568721 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:21:08.599241 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m10:21:08.604246 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:21:08.608276 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:21:08.608276 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:21:08.611280 [debug] [Thread-4 (]: SQL status: COMMIT in 0.042 seconds
[0m10:21:08.612240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m10:21:08.612240 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m10:21:08.614282 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:21:08.616278 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:21:08.618281 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:21:08.619295 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:21:08.620243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:21:08.621275 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:21:08.621275 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:21:08.622276 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:21:08.622276 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:21:08.625278 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m10:21:08.628277 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:21:08.630276 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A670D5D0>]}
[0m10:21:08.631282 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.30s]
[0m10:21:08.632283 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:21:08.632283 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:21:08.633278 [info ] [Thread-3 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m10:21:08.633278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_quitados)
[0m10:21:08.634290 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:21:08.637240 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:21:08.638241 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:21:08.643241 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:21:08.645240 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.645240 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:21:08.646240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:21:08.646240 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:21:08.648242 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:21:08.649369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A646E810>]}
[0m10:21:08.650300 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m10:21:08.651242 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:21:08.652291 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:21:08.653275 [info ] [Thread-4 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:21:08.654264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m10:21:08.654264 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:21:08.658241 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.658241 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m10:21:08.659285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m10:21:08.660274 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:21:08.662284 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:21:08.662284 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:21:08.663242 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A642DA90>]}
[0m10:21:08.663242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6404D10>]}
[0m10:21:08.666377 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.667381 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.34s]
[0m10:21:08.668372 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.34s]
[0m10:21:08.670257 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:21:08.670257 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:21:08.671291 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.673288 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:21:08.673288 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:21:08.677307 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m10:21:08.678283 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.679293 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:21:08.688636 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:21:08.693604 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.694602 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:21:08.699601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:21:08.701603 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.702601 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:21:08.702601 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m10:21:08.703602 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.703602 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:21:08.706601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:21:08.708603 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:21:08.708603 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.709600 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:21:08.712604 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:21:08.715601 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.715601 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:21:08.719601 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:21:08.722600 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.722600 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:21:08.724636 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m10:21:08.726602 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:21:08.727603 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:21:08.727603 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:21:08.728602 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:21:08.729603 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:21:08.730603 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.730603 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:21:08.742618 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:21:08.743618 [debug] [Thread-3 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:21:08.744618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6407590>]}
[0m10:21:08.745618 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m10:21:08.746601 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:21:08.753617 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m10:21:08.755625 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:21:08.756618 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:21:08.757619 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:21:08.773611 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.015 seconds
[0m10:21:08.775628 [debug] [Thread-4 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:21:08.776618 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865d36e4-ac50-48b1-9260-817ee87b1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A64B6850>]}
[0m10:21:08.777612 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.12s]
[0m10:21:08.778611 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:21:08.781617 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.782611 [debug] [MainThread]: On master: BEGIN
[0m10:21:08.782611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:08.815901 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:21:08.816900 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.816900 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:08.816900 [debug] [MainThread]: On master: COMMIT
[0m10:21:08.821900 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m10:21:08.822925 [debug] [MainThread]: On master: Close
[0m10:21:08.823903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:08.823903 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:21:08.823903 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:21:08.824901 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:21:08.824901 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m10:21:08.824901 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:21:08.825900 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:21:08.825900 [info ] [MainThread]: 
[0m10:21:08.825900 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m10:21:08.827900 [debug] [MainThread]: Command end result
[0m10:21:08.850901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:21:08.853903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:21:08.860902 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:21:08.860902 [info ] [MainThread]: 
[0m10:21:08.861901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:08.862904 [info ] [MainThread]: 
[0m10:21:08.863904 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:21:08.864903 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:08.864903 after 1.85 seconds
[0m10:21:08.865903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A4FB91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A04B1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A043DA90>]}
[0m10:21:08.866901 [debug] [MainThread]: Flushing usage events
[0m10:21:09.645980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:52.489987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F37F8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F37F8C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F37F8E450>]}


============================== 10:27:52.494986 | bafba388-625f-4413-b78b-3d67315c7658 ==============================
[0m10:27:52.494986 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:27:52.495970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:52.763745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F391052D0>]}
[0m10:27:52.804273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F35009510>]}
[0m10:27:52.805832 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:27:53.120677 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:27:53.249245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:53.249245 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_operacoes.sql
[0m10:27:53.421615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F396430D0>]}
[0m10:27:53.467812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:27:53.473119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:27:53.503120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F3980C390>]}
[0m10:27:53.504119 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m10:27:53.504119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F39401150>]}
[0m10:27:53.506119 [info ] [MainThread]: 
[0m10:27:53.507140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:27:53.508119 [info ] [MainThread]: 
[0m10:27:53.508119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:53.512120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:27:53.604779 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:27:53.604779 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:27:53.605678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:53.867084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.262 seconds
[0m10:27:53.868644 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:27:53.870768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:27:53.874687 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:27:53.874687 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:27:53.875687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:54.104857 [debug] [ThreadPool]: SQL status: BEGIN in 0.229 seconds
[0m10:27:54.104857 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:27:54.105857 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:54.142567 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.037 seconds
[0m10:27:54.144585 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:27:54.177057 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:27:54.183043 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.183043 [debug] [MainThread]: On master: BEGIN
[0m10:27:54.184055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:54.420782 [debug] [MainThread]: SQL status: BEGIN in 0.236 seconds
[0m10:27:54.420782 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.420782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:54.454236 [debug] [MainThread]: SQL status: SELECT 13 in 0.033 seconds
[0m10:27:54.457219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F391ACF50>]}
[0m10:27:54.457219 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:54.489791 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.490792 [debug] [MainThread]: On master: BEGIN
[0m10:27:54.554827 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m10:27:54.555821 [debug] [MainThread]: On master: COMMIT
[0m10:27:54.555821 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.556820 [debug] [MainThread]: On master: COMMIT
[0m10:27:54.589366 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m10:27:54.590371 [debug] [MainThread]: On master: Close
[0m10:27:54.593348 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:27:54.593348 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:27:54.594348 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:27:54.594348 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:27:54.595350 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:27:54.595350 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:27:54.596349 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:27:54.597348 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:27:54.598368 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:27:54.596349 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:27:54.598368 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:27:54.599349 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:27:54.599349 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:27:54.600348 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m10:27:54.600348 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:27:54.606366 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:27:54.610348 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:54.610348 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:27:54.613365 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:54.617349 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:27:54.618349 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:27:54.645364 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:27:54.646349 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:27:54.646349 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:27:54.649348 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:54.650373 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:27:54.653369 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:54.654398 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:54.657381 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:27:54.657381 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:54.658381 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:27:54.658381 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:54.659382 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:27:54.659382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:54.660380 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:54.660380 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:27:54.660380 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:27:54.661380 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:27:54.661380 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:27:54.662381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:27:54.905115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.243 seconds
[0m10:27:54.906109 [debug] [Thread-3 (]: SQL status: BEGIN in 0.245 seconds
[0m10:27:54.907158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m10:27:54.908284 [debug] [Thread-4 (]: SQL status: BEGIN in 0.246 seconds
[0m10:27:54.913370 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:54.910375 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:54.911451 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:54.909373 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:54.914376 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
     operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:27:54.915380 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:27:54.916415 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:27:54.917372 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL OR TRIM(dc.primeira_operacao) = '' THEN
            CASE
                WHEN df.primeira_operacao_fidc IS NULL THEN NULL
                ELSE df.primeira_operacao_fidc
            END
        ELSE
            TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    TO_DATE(dc.vencimento_contrato, 'DD-MM-YYYY') AS vencimento_contrato,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao IS NULL OR TRIM(primeira_operacao) = '' THEN NULL
            ELSE TO_DATE(primeira_operacao,'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:27:54.954950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m10:27:54.955948 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m10:27:54.956950 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m10:27:54.956950 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m10:27:54.965946 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:54.969668 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:54.974677 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:54.977724 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:54.977724 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:27:54.978676 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:27:54.978676 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:27:54.979676 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:27:55.014416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m10:27:55.064644 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m10:27:55.064644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m10:27:55.066708 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:55.067267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m10:27:55.069329 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:55.070841 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:55.071851 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:27:55.073839 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:55.073839 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:27:55.074839 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:27:55.074839 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:27:55.108810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m10:27:55.109789 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m10:27:55.110687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m10:27:55.111866 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m10:27:55.130861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:27:55.131761 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:27:55.132891 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:27:55.134855 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:27:55.134855 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:55.135760 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:55.135760 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:55.136397 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:55.136823 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:27:55.137226 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:27:55.137646 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:27:55.137646 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:27:55.187411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m10:27:55.188432 [debug] [Thread-3 (]: SQL status: COMMIT in 0.050 seconds
[0m10:27:55.188432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.050 seconds
[0m10:27:55.189479 [debug] [Thread-2 (]: SQL status: COMMIT in 0.051 seconds
[0m10:27:55.196616 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:27:55.198608 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:27:55.200517 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:27:55.203916 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:27:55.209914 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:27:55.209914 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:27:55.210914 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:27:55.211821 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:27:55.212863 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:27:55.212863 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:27:55.213819 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:27:55.214816 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:27:55.265584 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.050 seconds
[0m10:27:55.265584 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.050 seconds
[0m10:27:55.266607 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.050 seconds
[0m10:27:55.266607 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.052 seconds
[0m10:27:55.270118 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:27:55.272243 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:27:55.273230 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:27:55.275176 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:27:55.279126 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F394280D0>]}
[0m10:27:55.280128 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F39B3DD10>]}
[0m10:27:55.280128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F39B5D290>]}
[0m10:27:55.281128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F39B06510>]}
[0m10:27:55.282128 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.68s]
[0m10:27:55.283128 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.68s]
[0m10:27:55.284149 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.68s]
[0m10:27:55.284149 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.68s]
[0m10:27:55.285825 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:27:55.286516 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:27:55.287283 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:27:55.288143 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:27:55.289154 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:27:55.290154 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:27:55.292157 [info ] [Thread-4 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m10:27:55.293156 [info ] [Thread-3 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:27:55.295156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_operacoes, now model.my_dbt_project.fato_quitados)
[0m10:27:55.297159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m10:27:55.298151 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:27:55.298151 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:27:55.302150 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:27:55.305167 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.308151 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:27:55.309156 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:27:55.314172 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:27:55.317151 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.318044 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.318044 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:27:55.319051 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.319051 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:55.319051 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:27:55.320049 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:55.572900 [debug] [Thread-4 (]: SQL status: BEGIN in 0.254 seconds
[0m10:27:55.573898 [debug] [Thread-3 (]: SQL status: BEGIN in 0.254 seconds
[0m10:27:55.573898 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.574898 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.574898 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:27:55.575898 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:27:55.609439 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m10:27:55.609439 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m10:27:55.612501 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.614724 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.615724 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:27:55.615724 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:27:55.651725 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m10:27:55.652724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m10:27:55.658737 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.664733 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.665737 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:27:55.666837 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:27:55.701614 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m10:27:55.702601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m10:27:55.706597 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:27:55.709605 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:27:55.710601 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.711947 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.713173 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:27:55.714046 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:27:55.761568 [debug] [Thread-4 (]: SQL status: COMMIT in 0.045 seconds
[0m10:27:55.762558 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m10:27:55.767555 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:27:55.771722 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:27:55.773779 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:27:55.775292 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:27:55.776307 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:27:55.777376 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:27:55.827329 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.047 seconds
[0m10:27:55.828318 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.049 seconds
[0m10:27:55.831318 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:27:55.834418 [debug] [Thread-4 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:27:55.836318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F37DCF9D0>]}
[0m10:27:55.837398 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafba388-625f-4413-b78b-3d67315c7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F39BB52D0>]}
[0m10:27:55.839320 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.54s]
[0m10:27:55.840809 [info ] [Thread-4 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m10:27:55.841808 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:27:55.843809 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:27:55.847904 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:55.847904 [debug] [MainThread]: On master: BEGIN
[0m10:27:55.848906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:56.084222 [debug] [MainThread]: SQL status: BEGIN in 0.235 seconds
[0m10:27:56.086219 [debug] [MainThread]: On master: COMMIT
[0m10:27:56.087301 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:56.088326 [debug] [MainThread]: On master: COMMIT
[0m10:27:56.122721 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m10:27:56.124772 [debug] [MainThread]: On master: Close
[0m10:27:56.126870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:56.127870 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:27:56.128855 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:27:56.128855 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_sacados' was properly closed.
[0m10:27:56.130768 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m10:27:56.130768 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:27:56.131768 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:27:56.132768 [info ] [MainThread]: 
[0m10:27:56.133774 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m10:27:56.136862 [debug] [MainThread]: Command end result
[0m10:27:56.158762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:27:56.160763 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:27:56.166771 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:27:56.166771 [info ] [MainThread]: 
[0m10:27:56.167768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:27:56.167768 [info ] [MainThread]: 
[0m10:27:56.168769 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:27:56.169769 [debug] [MainThread]: Command `dbt run` succeeded at 10:27:56.169769 after 3.77 seconds
[0m10:27:56.170770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F330ED910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F330EDA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F330ECD50>]}
[0m10:27:56.170770 [debug] [MainThread]: Flushing usage events
[0m10:27:57.032858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:49.966315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715092A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019713F8D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197133FF650>]}


============================== 10:29:49.971330 | aaf67262-812e-4029-8e79-34ec13fa34b4 ==============================
[0m10:29:49.971330 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:29:49.972330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:50.225153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715218410>]}
[0m10:29:50.265633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019711109690>]}
[0m10:29:50.267632 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:29:50.603857 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:29:50.743677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:50.744676 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\dimcedentesconsolidado.sql
[0m10:29:50.918222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715272B50>]}
[0m10:29:50.965781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:29:50.969781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:29:51.001803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971590D850>]}
[0m10:29:51.002795 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m10:29:51.002795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197156DC610>]}
[0m10:29:51.004813 [info ] [MainThread]: 
[0m10:29:51.005803 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:51.006785 [info ] [MainThread]: 
[0m10:29:51.007783 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:51.011798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m10:29:51.125885 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m10:29:51.126919 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m10:29:51.126919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:51.234337 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.107 seconds
[0m10:29:51.235285 [debug] [ThreadPool]: On list_operacoes: Close
[0m10:29:51.238291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m10:29:51.243290 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:29:51.244291 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m10:29:51.244291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:51.300343 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m10:29:51.300343 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m10:29:51.301346 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:51.332342 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.031 seconds
[0m10:29:51.333345 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m10:29:51.337349 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m10:29:51.344348 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.345348 [debug] [MainThread]: On master: BEGIN
[0m10:29:51.345348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:51.392394 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m10:29:51.392394 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.393394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:51.422394 [debug] [MainThread]: SQL status: SELECT 13 in 0.029 seconds
[0m10:29:51.425396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715C85210>]}
[0m10:29:51.425396 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:51.431398 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.432394 [debug] [MainThread]: On master: BEGIN
[0m10:29:51.462459 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m10:29:51.463460 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.463460 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.464459 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.468458 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:29:51.468458 [debug] [MainThread]: On master: Close
[0m10:29:51.472459 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m10:29:51.472459 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m10:29:51.472459 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:29:51.473461 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m10:29:51.473461 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m10:29:51.474459 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m10:29:51.475460 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m10:29:51.476458 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m10:29:51.476458 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m10:29:51.477460 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m10:29:51.478459 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m10:29:51.478459 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m10:29:51.479460 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m10:29:51.479460 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m10:29:51.479460 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m10:29:51.480459 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m10:29:51.486460 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m10:29:51.489459 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.492458 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.496459 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m10:29:51.497458 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m10:29:51.523457 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m10:29:51.524458 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m10:29:51.524458 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m10:29:51.524458 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m10:29:51.527458 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.528457 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.530458 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m10:29:51.533458 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.534459 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m10:29:51.534459 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.535458 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:51.535458 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.536464 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m10:29:51.536464 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.537463 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m10:29:51.537463 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:29:51.537463 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m10:29:51.538463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:29:51.538463 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:29:51.633684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m10:29:51.633684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.096 seconds
[0m10:29:51.634685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m10:29:51.634685 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m10:29:51.634685 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.635684 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.635684 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.635684 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.636690 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m10:29:51.636690 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL OR TRIM(dc.primeira_operacao) = '' THEN
            CASE
                WHEN df.primeira_operacao_fidc IS NULL THEN NULL
                ELSE df.primeira_operacao_fidc
            END
        ELSE
            TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao IS NULL OR TRIM(primeira_operacao) = '' THEN NULL
            ELSE TO_DATE(primeira_operacao,'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m10:29:51.637692 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m10:29:51.637692 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
     operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m10:29:51.644692 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:29:51.649692 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.650693 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:29:51.651198 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:29:51.651198 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:29:51.651198 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m10:29:51.654343 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.657207 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.718206 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.719205 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m10:29:51.720205 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m10:29:51.720205 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m10:29:51.733205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:29:51.733205 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:29:51.733205 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:29:51.734205 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:29:51.737210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.740211 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.744211 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.747213 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.747213 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m10:29:51.748212 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m10:29:51.748212 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m10:29:51.749213 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m10:29:51.775730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m10:29:51.776729 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m10:29:51.776729 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m10:29:51.776729 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m10:29:51.791731 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:29:51.793741 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:29:51.794733 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:29:51.796730 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:29:51.797729 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.797729 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.798730 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.798730 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.799729 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m10:29:51.799729 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m10:29:51.800731 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m10:29:51.800731 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m10:29:51.819732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:29:51.825748 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m10:29:51.829730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m10:29:51.830728 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m10:29:51.854235 [debug] [Thread-2 (]: SQL status: COMMIT in 0.052 seconds
[0m10:29:51.855197 [debug] [Thread-3 (]: SQL status: COMMIT in 0.053 seconds
[0m10:29:51.855197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:29:51.855197 [debug] [Thread-4 (]: SQL status: COMMIT in 0.054 seconds
[0m10:29:51.857196 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m10:29:51.860195 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m10:29:51.862195 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m10:29:51.865196 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m10:29:51.866195 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m10:29:51.867197 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m10:29:51.868197 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m10:29:51.869196 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m10:29:51.870195 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m10:29:51.870195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715C51390>]}
[0m10:29:51.870195 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m10:29:51.872197 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.39s]
[0m10:29:51.873197 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m10:29:51.873197 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_quitados
[0m10:29:51.874196 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m10:29:51.875195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_quitados)
[0m10:29:51.875195 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m10:29:51.878196 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m10:29:51.880198 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_quitados
[0m10:29:51.886197 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m10:29:51.886197 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m10:29:51.888197 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m10:29:51.888197 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:51.889197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715093710>]}
[0m10:29:51.889197 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m10:29:51.890197 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.41s]
[0m10:29:51.891197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:51.892197 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m10:29:51.892197 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m10:29:51.893197 [info ] [Thread-3 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m10:29:51.894195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m10:29:51.894195 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m10:29:51.898200 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m10:29:51.900198 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.028 seconds
[0m10:29:51.901199 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.030 seconds
[0m10:29:51.902196 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m10:29:51.904199 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m10:29:51.905196 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m10:29:51.911195 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m10:29:51.913196 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197152AF690>]}
[0m10:29:51.914195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715515ED0>]}
[0m10:29:51.915197 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m10:29:51.917199 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:51.916197 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.44s]
[0m10:29:51.917199 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m10:29:51.918197 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m10:29:51.919196 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m10:29:51.919196 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:29:51.974733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m10:29:51.975734 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:51.975734 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m10:29:51.989733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m10:29:51.993734 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:51.993734 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m10:29:51.997735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:29:51.999737 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:52.000735 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m10:29:52.028653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m10:29:52.030688 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:29:52.030688 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:52.031673 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m10:29:52.031673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m10:29:52.032669 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:52.032669 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m10:29:52.069263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m10:29:52.069263 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m10:29:52.071263 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m10:29:52.074262 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:52.075262 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m10:29:52.076262 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m10:29:52.076262 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m10:29:52.093392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:29:52.096392 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:52.096392 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m10:29:52.109263 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.031 seconds
[0m10:29:52.109263 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:29:52.111264 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: Close
[0m10:29:52.112263 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:29:52.113263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715924410>]}
[0m10:29:52.114262 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:52.115261 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m10:29:52.115261 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m10:29:52.116401 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_quitados
[0m10:29:52.140645 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m10:29:52.143646 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m10:29:52.144648 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m10:29:52.145647 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m10:29:52.163144 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m10:29:52.165162 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m10:29:52.165162 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf67262-812e-4029-8e79-34ec13fa34b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019715C3F750>]}
[0m10:29:52.166169 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.27s]
[0m10:29:52.167145 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m10:29:52.169146 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:52.169146 [debug] [MainThread]: On master: BEGIN
[0m10:29:52.169146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:52.198145 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m10:29:52.198145 [debug] [MainThread]: On master: COMMIT
[0m10:29:52.199171 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:52.199171 [debug] [MainThread]: On master: COMMIT
[0m10:29:52.203145 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:29:52.203145 [debug] [MainThread]: On master: Close
[0m10:29:52.204147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:52.204147 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m10:29:52.205180 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m10:29:52.205180 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m10:29:52.206146 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m10:29:52.206146 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m10:29:52.206146 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m10:29:52.206146 [info ] [MainThread]: 
[0m10:29:52.207168 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m10:29:52.208147 [debug] [MainThread]: Command end result
[0m10:29:52.225164 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m10:29:52.228146 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m10:29:52.233147 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m10:29:52.233147 [info ] [MainThread]: 
[0m10:29:52.234147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:52.235147 [info ] [MainThread]: 
[0m10:29:52.236147 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:29:52.237154 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:52.237154 after 2.37 seconds
[0m10:29:52.238150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001970FE90CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019713D87D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001970F1ED950>]}
[0m10:29:52.239151 [debug] [MainThread]: Flushing usage events
[0m10:29:53.048781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:06.344083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5058E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5058E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4E313C90>]}


============================== 13:45:06.350083 | 6f22a1d4-629d-4cef-a8a8-da76e7990d76 ==============================
[0m13:45:06.350083 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:45:06.351083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\henrique.soares\\Desktop\\dbt', 'log_path': 'C:\\Users\\henrique.soares\\Desktop\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:06.599068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C507B6650>]}
[0m13:45:06.638659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4C609350>]}
[0m13:45:06.640657 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:45:06.847445 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:45:06.960819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:06.961818 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\fato_titulosabertos.sql
[0m13:45:07.129364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50CB9890>]}
[0m13:45:07.172889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:45:07.177198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:45:07.213745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50CEEB10>]}
[0m13:45:07.214747 [info ] [MainThread]: Found 6 models, 12 sources, 433 macros
[0m13:45:07.214747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50C4BF50>]}
[0m13:45:07.216762 [info ] [MainThread]: 
[0m13:45:07.217745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:07.217745 [info ] [MainThread]: 
[0m13:45:07.217745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:07.221289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes'
[0m13:45:07.332925 [debug] [ThreadPool]: Using postgres connection "list_operacoes"
[0m13:45:07.333927 [debug] [ThreadPool]: On list_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes"} */

    select distinct nspname from pg_namespace
  
[0m13:45:07.333927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:07.377925 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m13:45:07.378926 [debug] [ThreadPool]: On list_operacoes: Close
[0m13:45:07.380925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_operacoes_public'
[0m13:45:07.385925 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:45:07.386925 [debug] [ThreadPool]: On list_operacoes_public: BEGIN
[0m13:45:07.386925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:07.451995 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m13:45:07.452996 [debug] [ThreadPool]: Using postgres connection "list_operacoes_public"
[0m13:45:07.452996 [debug] [ThreadPool]: On list_operacoes_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_operacoes_public"} */
select
      'operacoes' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'operacoes' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:45:07.463997 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.011 seconds
[0m13:45:07.465996 [debug] [ThreadPool]: On list_operacoes_public: ROLLBACK
[0m13:45:07.470996 [debug] [ThreadPool]: On list_operacoes_public: Close
[0m13:45:07.477997 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:07.477997 [debug] [MainThread]: On master: BEGIN
[0m13:45:07.478996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:07.531868 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m13:45:07.532874 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:07.532874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:07.541875 [debug] [MainThread]: SQL status: SELECT 13 in 0.008 seconds
[0m13:45:07.544875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4C60DE10>]}
[0m13:45:07.544875 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:07.547891 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:07.548876 [debug] [MainThread]: On master: BEGIN
[0m13:45:07.554280 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:45:07.555282 [debug] [MainThread]: On master: COMMIT
[0m13:45:07.555282 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:07.555282 [debug] [MainThread]: On master: COMMIT
[0m13:45:07.559280 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:45:07.559280 [debug] [MainThread]: On master: Close
[0m13:45:07.562280 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sacados
[0m13:45:07.562280 [debug] [Thread-2 (]: Began running node model.my_dbt_project.dimcedentesconsolidado
[0m13:45:07.563281 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_detalhes_operacoes
[0m13:45:07.563281 [info ] [Thread-1 (]: 1 of 6 START sql view model public.dim_sacados ................................. [RUN]
[0m13:45:07.564281 [debug] [Thread-4 (]: Began running node model.my_dbt_project.fato_operacoes
[0m13:45:07.564281 [info ] [Thread-2 (]: 2 of 6 START sql view model public.dimcedentesconsolidado ...................... [RUN]
[0m13:45:07.565281 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.dim_sacados'
[0m13:45:07.565281 [info ] [Thread-3 (]: 3 of 6 START sql view model public.fato_detalhes_operacoes ..................... [RUN]
[0m13:45:07.566282 [info ] [Thread-4 (]: 4 of 6 START sql view model public.fato_operacoes .............................. [RUN]
[0m13:45:07.566282 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.dimcedentesconsolidado'
[0m13:45:07.567281 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sacados
[0m13:45:07.567281 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_detalhes_operacoes'
[0m13:45:07.568281 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.fato_operacoes'
[0m13:45:07.568281 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.dimcedentesconsolidado
[0m13:45:07.573282 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sacados"
[0m13:45:07.574283 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_detalhes_operacoes
[0m13:45:07.574283 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.fato_operacoes
[0m13:45:07.577442 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.579346 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.580446 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sacados
[0m13:45:07.582443 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.fato_operacoes"
[0m13:45:07.611366 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sacados"
[0m13:45:07.612366 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.dimcedentesconsolidado
[0m13:45:07.613350 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.fato_operacoes
[0m13:45:07.614351 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_detalhes_operacoes
[0m13:45:07.614351 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.617350 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.620349 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.fato_operacoes"
[0m13:45:07.623855 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.624861 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: BEGIN
[0m13:45:07.625862 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.625862 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.626865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:45:07.626865 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.627862 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: BEGIN
[0m13:45:07.627862 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: BEGIN
[0m13:45:07.628861 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: BEGIN
[0m13:45:07.629861 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:45:07.629861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:45:07.629861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:45:07.691560 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m13:45:07.692577 [debug] [Thread-4 (]: SQL status: BEGIN in 0.062 seconds
[0m13:45:07.692577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m13:45:07.693569 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.693569 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.693569 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.694560 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */

  create view "operacoes"."public"."dimcedentesconsolidado__dbt_tmp"
    
    
  as (
    

SELECT
    dc.nome::VARCHAR(8000) AS nome,
    CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    dc.endereco::VARCHAR(8000) AS endereco,
    dc.cep::VARCHAR(8000) AS cep,
    dc.cidade::VARCHAR(8000) AS cidade,
    dc.uf::VARCHAR(2) AS uf,
    dc.email::VARCHAR(8000) AS email,
    dc.telefone::VARCHAR(20) AS telefone,
    dc.gerente::VARCHAR(8000) AS gerente,
    dc.operador::VARCHAR(8000) AS operador,
    dc.captador::VARCHAR(8000) AS captador,
    dc.controlador::VARCHAR(8000) AS controlador,
    CAST(REPLACE(dc.fator_percentual, ',', '.') AS DECIMAL(10, 5)) AS fator_percentual,
    CAST(REPLACE(dc.advalorem_percentual, ',', '.') AS DECIMAL(10, 5)) AS advalorem_percentual,
    TO_DATE(dc.data_cadastro, 'DD-MM-YYYY') AS data_cadastro,
    dc.fonte_captacao::VARCHAR(8000) AS fonte_captacao,
    dc.setor::VARCHAR(8000) AS setor,
    dc.grupo_economico::VARCHAR(8000) AS grupo_economico,
    CASE
        WHEN dc.primeira_operacao IS NULL OR TRIM(dc.primeira_operacao) = '' THEN
            CASE
                WHEN df.primeira_operacao_fidc IS NULL THEN NULL
                ELSE df.primeira_operacao_fidc
            END
        ELSE
            TO_DATE(dc.primeira_operacao, 'DD/MM/YYYY')
    END AS primeira_operacao,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_global, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_global,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_comissaria, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_comissaria,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_especial_tranche, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_especial_tranche,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_boleto_garantido, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_boleto_garantido,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.limite_operacao_clean, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS limite_operacao_clean,
    dc.risco_atual::VARCHAR(8000) AS risco_atual,
    CAST(REPLACE(REPLACE(REGEXP_REPLACE(dc.saldo, '[^0-9,.]', '', 'g'), '.', ''), ',', '.') AS DECIMAL(15, 2)) AS saldo,
    dc.id_cedente::INT AS id_cedente
FROM "operacoes"."public"."d_cedentes" dc
LEFT JOIN (
    SELECT
        CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
        CASE
            WHEN primeira_operacao IS NULL OR TRIM(primeira_operacao) = '' THEN NULL
            ELSE TO_DATE(primeira_operacao,'DD-MM-YYYY')
        END AS primeira_operacao_fidc
    FROM "operacoes"."public"."d_cedentes_fidc"
) df ON CAST(NULLIF(REGEXP_REPLACE(dc.cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) = df.cpf_cnpj
  );
[0m13:45:07.694560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m13:45:07.695560 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */

  create view "operacoes"."public"."fato_operacoes__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_desagio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_recompra_pendencia, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
    operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS CEDENTE,
    etapa::VARCHAR(8000) AS ETAPA,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS CPF_CNPJ_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(prazo_medio, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS PRAZO_MEDIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_bruto, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_BRUTO,
    NULL AS VALOR_DESAGIO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_liquido, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_LIQUIDO,
    NULL AS VALOR_RECOMPRA_PENDENCIA,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(cred_cedente, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS CRED_CEDENTE,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_pagto_operacao, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_PAGTO_OPERACAO,
    CAST(NULLIF(REGEXP_REPLACE(REGEXP_REPLACE(valor_saldo, '[^0-9,]', '', 'g'), ',', '.', 'g'), '') AS DECIMAL(10,2)) AS VALOR_SALDO,
     operacao::INT AS OPERACAO,
    TO_DATE("data", 'DD-MM-YYYY') AS DATA,
    operador::VARCHAR(8000) AS OPERADOR,
    captador::VARCHAR(8000) AS CAPTADOR,
    TO_DATE(pagamento_operacao, 'DD-MM-YYYY') AS PAGAMENTO_OPERACAO,
    CAST(NULL AS VARCHAR(8000)) AS CONTA_PAGTO
FROM "operacoes"."public"."f_operacoes_fidc"
  );
[0m13:45:07.696560 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */

  create view "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp"
    
    
  as (
    SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_detalhes"

UNION ALL

SELECT id, operacao_id, tipotitulo, cmc7, numero, documentosacado, numeronota, vencimento, valorface, nomesacado, classerisco, timestamp_extracao
FROM "operacoes"."public"."f_operacoes_fidc_detalhes"
  );
[0m13:45:07.696560 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.697561 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */

  create view "operacoes"."public"."dim_sacados__dbt_tmp"
    
    
  as (
    SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,
    endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados"

UNION  -- Remove registros duplicados automaticamente

SELECT 
    id,
    nome,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj,endereco,
    cep,
    cidade,
    uf,
    e_mail,
    telefone,
    sms,
    data_cadastro,
    timestamp_extracao
FROM "operacoes"."public"."d_sacados_fidc"
  );
[0m13:45:07.706652 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:45:07.706652 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:45:07.706652 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:45:07.711694 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.714679 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.717789 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.717789 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados" rename to "dim_sacados__dbt_backup"
[0m13:45:07.718680 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes" rename to "fato_detalhes_operacoes__dbt_backup"
[0m13:45:07.718680 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes" rename to "fato_operacoes__dbt_backup"
[0m13:45:07.722719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.722719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.722719 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m13:45:07.724415 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.726423 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.770420 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.773421 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.775441 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.776422 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
alter table "operacoes"."public"."dim_sacados__dbt_tmp" rename to "dim_sacados"
[0m13:45:07.776422 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
alter table "operacoes"."public"."fato_detalhes_operacoes__dbt_tmp" rename to "fato_detalhes_operacoes"
[0m13:45:07.776422 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado" rename to "dimcedentesconsolidado__dbt_backup"
[0m13:45:07.777422 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
alter table "operacoes"."public"."fato_operacoes__dbt_tmp" rename to "fato_operacoes"
[0m13:45:07.791428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:45:07.792428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:45:07.792428 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:45:07.793428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m13:45:07.803429 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m13:45:07.804428 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m13:45:07.806019 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m13:45:07.808090 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.809090 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.809090 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.810094 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.810094 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
alter table "operacoes"."public"."dimcedentesconsolidado__dbt_tmp" rename to "dimcedentesconsolidado"
[0m13:45:07.811094 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: COMMIT
[0m13:45:07.811094 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: COMMIT
[0m13:45:07.812093 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: COMMIT
[0m13:45:07.816094 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.817094 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m13:45:07.817094 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.818115 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: COMMIT
[0m13:45:07.835257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m13:45:07.840256 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."dim_sacados__dbt_backup"
[0m13:45:07.843256 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.dim_sacados"
[0m13:45:07.843256 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sacados"} */
drop view if exists "operacoes"."public"."dim_sacados__dbt_backup" cascade
[0m13:45:07.849995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m13:45:07.849995 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m13:45:07.849995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m13:45:07.852009 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_detalhes_operacoes__dbt_backup"
[0m13:45:07.854110 [debug] [Thread-4 (]: Applying DROP to: "operacoes"."public"."fato_operacoes__dbt_backup"
[0m13:45:07.856009 [debug] [Thread-2 (]: Applying DROP to: "operacoes"."public"."dimcedentesconsolidado__dbt_backup"
[0m13:45:07.856338 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_detalhes_operacoes"
[0m13:45:07.857130 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.fato_operacoes"
[0m13:45:07.858148 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.dimcedentesconsolidado"
[0m13:45:07.858148 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_detalhes_operacoes"} */
drop view if exists "operacoes"."public"."fato_detalhes_operacoes__dbt_backup" cascade
[0m13:45:07.858148 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_operacoes"} */
drop view if exists "operacoes"."public"."fato_operacoes__dbt_backup" cascade
[0m13:45:07.859149 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dimcedentesconsolidado"} */
drop view if exists "operacoes"."public"."dimcedentesconsolidado__dbt_backup" cascade
[0m13:45:07.859149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m13:45:07.862149 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sacados: Close
[0m13:45:07.863152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50CB1C90>]}
[0m13:45:07.864148 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.dim_sacados ............................ [[32mCREATE VIEW[0m in 0.30s]
[0m13:45:07.865150 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sacados
[0m13:45:07.865150 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fato_quitados
[0m13:45:07.865150 [info ] [Thread-1 (]: 5 of 6 START sql view model public.fato_quitados ............................... [RUN]
[0m13:45:07.866150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sacados, now model.my_dbt_project.fato_quitados)
[0m13:45:07.866150 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fato_quitados
[0m13:45:07.869150 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fato_quitados"
[0m13:45:07.870150 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fato_quitados
[0m13:45:07.873150 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fato_quitados"
[0m13:45:07.874149 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m13:45:07.875157 [debug] [Thread-3 (]: On model.my_dbt_project.fato_detalhes_operacoes: Close
[0m13:45:07.875157 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.876149 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4C523B50>]}
[0m13:45:07.876149 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: BEGIN
[0m13:45:07.877149 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.fato_detalhes_operacoes ................ [[32mCREATE VIEW[0m in 0.31s]
[0m13:45:07.882147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:07.883147 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_detalhes_operacoes
[0m13:45:07.884147 [debug] [Thread-3 (]: Began running node model.my_dbt_project.fato_titulosabertos
[0m13:45:07.889148 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.029 seconds
[0m13:45:07.889148 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.029 seconds
[0m13:45:07.884147 [info ] [Thread-3 (]: 6 of 6 START sql view model public.fato_titulosabertos ......................... [RUN]
[0m13:45:07.891150 [debug] [Thread-2 (]: On model.my_dbt_project.dimcedentesconsolidado: Close
[0m13:45:07.893147 [debug] [Thread-4 (]: On model.my_dbt_project.fato_operacoes: Close
[0m13:45:07.893147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fato_detalhes_operacoes, now model.my_dbt_project.fato_titulosabertos)
[0m13:45:07.895154 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5072F710>]}
[0m13:45:07.895154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5072CBD0>]}
[0m13:45:07.896150 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.fato_titulosabertos
[0m13:45:07.897149 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.fato_operacoes ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:45:07.903149 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.897149 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.dimcedentesconsolidado ................. [[32mCREATE VIEW[0m in 0.33s]
[0m13:45:07.904151 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.fato_operacoes
[0m13:45:07.905150 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.dimcedentesconsolidado
[0m13:45:07.906150 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.fato_titulosabertos
[0m13:45:07.910155 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.912155 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.912155 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: BEGIN
[0m13:45:07.913154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:45:07.920269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m13:45:07.920269 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.921284 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */

  create view "operacoes"."public"."fato_quitados__dbt_tmp"
    
    
  as (
    SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados"


UNION ALL


SELECT
    numero::VARCHAR(8000) AS numero,
    m::VARCHAR(8000) AS m,
    classe_risco::VARCHAR(8000) AS classe_risco,
    tipo::VARCHAR(8000) AS tipo,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    sacado::VARCHAR(8000) AS sacado,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    cedente::VARCHAR(8000) AS cedente,
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    TO_DATE(original, 'DD/MM/YYYY') AS original, --conversao para data correta
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    TO_DATE(quitacao, 'DD/MM/YYYY') AS quitacao, --conversao para data correta,
    status::VARCHAR(8000) AS status,
    TO_DATE(emissao, 'DD/MM/YYYY') AS emissao,
    CAST(
    REPLACE(REGEXP_REPLACE(valor_face_, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_face_,
CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,
CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,
CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,
CAST(
    REPLACE(REGEXP_REPLACE(valor_desconto, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_desconto,
CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,
CAST(
    REPLACE(REGEXP_REPLACE(valor_liquidado, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_liquidado,
    NULLIF(op, '')::INT AS op,
    situacao::VARCHAR(8000) AS situacao,
    tipo_quitacao::VARCHAR(8000) AS tipo_quitacao,
    op_de_pagamento::VARCHAR(8000) AS op_de_pagamento,
    observacao::VARCHAR(8000) AS observacao,
    conta::VARCHAR(8000) AS conta,
    CAST(REPLACE(valor_tar_dev_cheque, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_dev_cheque,
    CAST(REPLACE(valor_tar_recompra, ',', '.') AS DECIMAL(10, 2)) AS valor_tar_recompra,
    categoria::VARCHAR(8000) AS categoria,
    banco_cobrador::VARCHAR(8000) AS banco_cobrador,
    agencia_cobradora::VARCHAR(8000) AS agencia_cobradora,
    motivo_devolucao::VARCHAR(8000) AS motivo_devolucao
FROM "operacoes"."public"."f_titulosquitados_fidc"
  );
[0m13:45:07.930217 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:45:07.934203 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.934203 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados" rename to "fato_quitados__dbt_backup"
[0m13:45:07.940201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:45:07.943201 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.943201 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
alter table "operacoes"."public"."fato_quitados__dbt_tmp" rename to "fato_quitados"
[0m13:45:07.944204 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m13:45:07.945202 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.945202 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */

  create view "operacoes"."public"."fato_titulosabertos__dbt_tmp"
    
    
  as (
    SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
    TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
    CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto"

UNION ALL

SELECT 
    cedente::VARCHAR(8000) AS cedente,
    conf::VARCHAR(8000) AS conf,
    conta::VARCHAR(8000) AS conta,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_cedente, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_cedente,
    CAST(NULLIF(REGEXP_REPLACE(cpf_cnpj_sacado, '[^0-9]', '', 'g'), '') AS BIGINT) AS cpf_cnpj_sacado,      
    cr::VARCHAR(8000) AS cr,
    TO_DATE(data_emissao, 'DD/MM/YYYY') AS data_emissao, --conversao para data correta
    documento::VARCHAR(8000) AS documento,
    etapa::VARCHAR(8000) AS etapa,
    historico::VARCHAR(8000) AS historico,
    NULLIF(id_titulo, '')::INT AS id_titulo,   -- EVITA ERRO
    NULLIF(id_titulo_original, '')::VARCHAR(8000) AS id_titulo_original,
    m::VARCHAR(8000) AS m,
    motivo::VARCHAR(8000) AS motivo,
      TO_DATE(vencimento, 'DD/MM/YYYY') AS vencimento, --conversao para data correta
    nosso_numero::VARCHAR(8000) AS nosso_numero,
    NULLIF(op,'')::INT AS op,
    original::VARCHAR(8000) AS original,
    sacado::VARCHAR(8000) AS sacado,
    situacao::VARCHAR(8000) AS situacao,
    tipo::VARCHAR(8000) AS tipo,
CAST(
    REPLACE(REGEXP_REPLACE(valor, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor,

CAST(
    REPLACE(REGEXP_REPLACE(valor_juros, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_juros,

CAST(
    REPLACE(REGEXP_REPLACE(valor_multa, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_multa,

CAST(
    REPLACE(REGEXP_REPLACE(valor_tarifas, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_tarifas,

CAST(
    REPLACE(REGEXP_REPLACE(valor_total, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS valor_total,

CAST(
    REPLACE(REGEXP_REPLACE(desagio, '[^0-9,]', '', 'g'), ',', '.') 
    AS DECIMAL(10,2)
) AS desagio

FROM "operacoes"."public"."f_titulosemaberto_fidc"
  );
[0m13:45:07.947966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.948934 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m13:45:07.949935 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.949935 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: COMMIT
[0m13:45:07.955877 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:45:07.959857 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.959857 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos" rename to "fato_titulosabertos__dbt_backup"
[0m13:45:07.964856 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.966856 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.966856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m13:45:07.966856 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
alter table "operacoes"."public"."fato_titulosabertos__dbt_tmp" rename to "fato_titulosabertos"
[0m13:45:07.968858 [debug] [Thread-1 (]: Applying DROP to: "operacoes"."public"."fato_quitados__dbt_backup"
[0m13:45:07.969857 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.fato_quitados"
[0m13:45:07.969857 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_quitados"} */
drop view if exists "operacoes"."public"."fato_quitados__dbt_backup" cascade
[0m13:45:07.972856 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:45:07.973875 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m13:45:07.974857 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.974857 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: COMMIT
[0m13:45:07.987537 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m13:45:07.989539 [debug] [Thread-1 (]: On model.my_dbt_project.fato_quitados: Close
[0m13:45:07.989539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50A9DB10>]}
[0m13:45:07.990538 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.fato_quitados .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:45:07.991539 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fato_quitados
[0m13:45:07.995833 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m13:45:07.997836 [debug] [Thread-3 (]: Applying DROP to: "operacoes"."public"."fato_titulosabertos__dbt_backup"
[0m13:45:07.998836 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.fato_titulosabertos"
[0m13:45:07.998836 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.fato_titulosabertos"} */
drop view if exists "operacoes"."public"."fato_titulosabertos__dbt_backup" cascade
[0m13:45:08.015866 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m13:45:08.016866 [debug] [Thread-3 (]: On model.my_dbt_project.fato_titulosabertos: Close
[0m13:45:08.017867 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f22a1d4-629d-4cef-a8a8-da76e7990d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C50C0E950>]}
[0m13:45:08.018867 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.fato_titulosabertos .................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:45:08.019866 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.fato_titulosabertos
[0m13:45:08.021866 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:08.021866 [debug] [MainThread]: On master: BEGIN
[0m13:45:08.021866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:08.052372 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m13:45:08.052372 [debug] [MainThread]: On master: COMMIT
[0m13:45:08.053372 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:08.053372 [debug] [MainThread]: On master: COMMIT
[0m13:45:08.059373 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m13:45:08.059373 [debug] [MainThread]: On master: Close
[0m13:45:08.060372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:08.060372 [debug] [MainThread]: Connection 'list_operacoes' was properly closed.
[0m13:45:08.060372 [debug] [MainThread]: Connection 'list_operacoes_public' was properly closed.
[0m13:45:08.061372 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_quitados' was properly closed.
[0m13:45:08.061372 [debug] [MainThread]: Connection 'model.my_dbt_project.dimcedentesconsolidado' was properly closed.
[0m13:45:08.061372 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_titulosabertos' was properly closed.
[0m13:45:08.061372 [debug] [MainThread]: Connection 'model.my_dbt_project.fato_operacoes' was properly closed.
[0m13:45:08.062372 [info ] [MainThread]: 
[0m13:45:08.063392 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m13:45:08.064372 [debug] [MainThread]: Command end result
[0m13:45:08.079374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\henrique.soares\Desktop\dbt\target\manifest.json
[0m13:45:08.082397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\henrique.soares\Desktop\dbt\target\semantic_manifest.json
[0m13:45:08.089373 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\henrique.soares\Desktop\dbt\target\run_results.json
[0m13:45:08.089373 [info ] [MainThread]: 
[0m13:45:08.090372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:08.090372 [info ] [MainThread]: 
[0m13:45:08.091374 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:45:08.092374 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:08.092374 after 1.84 seconds
[0m13:45:08.093375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4A841C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4A7C9A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4A7C8E10>]}
[0m13:45:08.093375 [debug] [MainThread]: Flushing usage events
[0m13:45:08.923576 [debug] [MainThread]: An error was encountered while trying to flush usage events
